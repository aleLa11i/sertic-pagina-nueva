var Hu=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function wE(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function bE(i){if(i.__esModule)return i;var o=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(i).forEach(function(u){var m=Object.getOwnPropertyDescriptor(i,u);Object.defineProperty(o,u,m.get?m:{enumerable:!0,get:function(){return i[u]}})}),o}var Yi={exports:{}},Jt={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var wx=Object.getOwnPropertySymbols,TE=Object.prototype.hasOwnProperty,SE=Object.prototype.propertyIsEnumerable;function EE(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function CE(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var o={},u=0;u<10;u++)o["_"+String.fromCharCode(u)]=u;var m=Object.getOwnPropertyNames(o).map(function(S){return o[S]});if(m.join("")!=="0123456789")return!1;var _={};return"abcdefghijklmnopqrst".split("").forEach(function(S){_[S]=S}),Object.keys(Object.assign({},_)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var bx=CE()?Object.assign:function(i,o){for(var u,m=EE(i),_,S=1;S<arguments.length;S++){u=Object(arguments[S]);for(var k in u)TE.call(u,k)&&(m[k]=u[k]);if(wx){_=wx(u);for(var a=0;a<_.length;a++)SE.call(u,_[a])&&(m[_[a]]=u[_[a]])}}return m};/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b_=bx,fc=60103,Tx=60106;Jt.Fragment=60107;Jt.StrictMode=60108;Jt.Profiler=60114;var Sx=60109,Ex=60110,Cx=60112;Jt.Suspense=60113;var kx=60115,Mx=60116;if(typeof Symbol=="function"&&Symbol.for){var Ki=Symbol.for;fc=Ki("react.element"),Tx=Ki("react.portal"),Jt.Fragment=Ki("react.fragment"),Jt.StrictMode=Ki("react.strict_mode"),Jt.Profiler=Ki("react.profiler"),Sx=Ki("react.provider"),Ex=Ki("react.context"),Cx=Ki("react.forward_ref"),Jt.Suspense=Ki("react.suspense"),kx=Ki("react.memo"),Mx=Ki("react.lazy")}var Ix=typeof Symbol=="function"&&Symbol.iterator;function kE(i){return i===null||typeof i!="object"?null:(i=Ix&&i[Ix]||i["@@iterator"],typeof i=="function"?i:null)}function Xu(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ax={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zx={};function mc(i,o,u){this.props=i,this.context=o,this.refs=zx,this.updater=u||Ax}mc.prototype.isReactComponent={};mc.prototype.setState=function(i,o){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error(Xu(85));this.updater.enqueueSetState(this,i,o,"setState")};mc.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function Px(){}Px.prototype=mc.prototype;function T_(i,o,u){this.props=i,this.context=o,this.refs=zx,this.updater=u||Ax}var S_=T_.prototype=new Px;S_.constructor=T_;b_(S_,mc.prototype);S_.isPureReactComponent=!0;var E_={current:null},Dx=Object.prototype.hasOwnProperty,Lx={key:!0,ref:!0,__self:!0,__source:!0};function Ox(i,o,u){var m,_={},S=null,k=null;if(o!=null)for(m in o.ref!==void 0&&(k=o.ref),o.key!==void 0&&(S=""+o.key),o)Dx.call(o,m)&&!Lx.hasOwnProperty(m)&&(_[m]=o[m]);var a=arguments.length-2;if(a===1)_.children=u;else if(1<a){for(var O=Array(a),X=0;X<a;X++)O[X]=arguments[X+2];_.children=O}if(i&&i.defaultProps)for(m in a=i.defaultProps,a)_[m]===void 0&&(_[m]=a[m]);return{$$typeof:fc,type:i,key:S,ref:k,props:_,_owner:E_.current}}function ME(i,o){return{$$typeof:fc,type:i.type,key:o,ref:i.ref,props:i.props,_owner:i._owner}}function C_(i){return typeof i=="object"&&i!==null&&i.$$typeof===fc}function IE(i){var o={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(u){return o[u]})}var Rx=/\/+/g;function k_(i,o){return typeof i=="object"&&i!==null&&i.key!=null?IE(""+i.key):o.toString(36)}function xp(i,o,u,m,_){var S=typeof i;(S==="undefined"||S==="boolean")&&(i=null);var k=!1;if(i===null)k=!0;else switch(S){case"string":case"number":k=!0;break;case"object":switch(i.$$typeof){case fc:case Tx:k=!0}}if(k)return k=i,_=_(k),i=m===""?"."+k_(k,0):m,Array.isArray(_)?(u="",i!=null&&(u=i.replace(Rx,"$&/")+"/"),xp(_,o,u,"",function(X){return X})):_!=null&&(C_(_)&&(_=ME(_,u+(!_.key||k&&k.key===_.key?"":(""+_.key).replace(Rx,"$&/")+"/")+i)),o.push(_)),1;if(k=0,m=m===""?".":m+":",Array.isArray(i))for(var a=0;a<i.length;a++){S=i[a];var O=m+k_(S,a);k+=xp(S,o,u,O,_)}else if(O=kE(i),typeof O=="function")for(i=O.call(i),a=0;!(S=i.next()).done;)S=S.value,O=m+k_(S,a++),k+=xp(S,o,u,O,_);else if(S==="object")throw o=""+i,Error(Xu(31,o==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":o));return k}function wp(i,o,u){if(i==null)return i;var m=[],_=0;return xp(i,m,"","",function(S){return o.call(u,S,_++)}),m}function AE(i){if(i._status===-1){var o=i._result;o=o(),i._status=0,i._result=o,o.then(function(u){i._status===0&&(u=u.default,i._status=1,i._result=u)},function(u){i._status===0&&(i._status=2,i._result=u)})}if(i._status===1)return i._result;throw i._result}var Bx={current:null};function Zo(){var i=Bx.current;if(i===null)throw Error(Xu(321));return i}var zE={ReactCurrentDispatcher:Bx,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:E_,IsSomeRendererActing:{current:!1},assign:b_};Jt.Children={map:wp,forEach:function(i,o,u){wp(i,function(){o.apply(this,arguments)},u)},count:function(i){var o=0;return wp(i,function(){o++}),o},toArray:function(i){return wp(i,function(o){return o})||[]},only:function(i){if(!C_(i))throw Error(Xu(143));return i}};Jt.Component=mc;Jt.PureComponent=T_;Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zE;Jt.cloneElement=function(i,o,u){if(i==null)throw Error(Xu(267,i));var m=b_({},i.props),_=i.key,S=i.ref,k=i._owner;if(o!=null){if(o.ref!==void 0&&(S=o.ref,k=E_.current),o.key!==void 0&&(_=""+o.key),i.type&&i.type.defaultProps)var a=i.type.defaultProps;for(O in o)Dx.call(o,O)&&!Lx.hasOwnProperty(O)&&(m[O]=o[O]===void 0&&a!==void 0?a[O]:o[O])}var O=arguments.length-2;if(O===1)m.children=u;else if(1<O){a=Array(O);for(var X=0;X<O;X++)a[X]=arguments[X+2];m.children=a}return{$$typeof:fc,type:i.type,key:_,ref:S,props:m,_owner:k}};Jt.createContext=function(i,o){return o===void 0&&(o=null),i={$$typeof:Ex,_calculateChangedBits:o,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null},i.Provider={$$typeof:Sx,_context:i},i.Consumer=i};Jt.createElement=Ox;Jt.createFactory=function(i){var o=Ox.bind(null,i);return o.type=i,o};Jt.createRef=function(){return{current:null}};Jt.forwardRef=function(i){return{$$typeof:Cx,render:i}};Jt.isValidElement=C_;Jt.lazy=function(i){return{$$typeof:Mx,_payload:{_status:-1,_result:i},_init:AE}};Jt.memo=function(i,o){return{$$typeof:kx,type:i,compare:o===void 0?null:o}};Jt.useCallback=function(i,o){return Zo().useCallback(i,o)};Jt.useContext=function(i,o){return Zo().useContext(i,o)};Jt.useDebugValue=function(){};Jt.useEffect=function(i,o){return Zo().useEffect(i,o)};Jt.useImperativeHandle=function(i,o,u){return Zo().useImperativeHandle(i,o,u)};Jt.useLayoutEffect=function(i,o){return Zo().useLayoutEffect(i,o)};Jt.useMemo=function(i,o){return Zo().useMemo(i,o)};Jt.useReducer=function(i,o,u){return Zo().useReducer(i,o,u)};Jt.useRef=function(i){return Zo().useRef(i)};Jt.useState=function(i){return Zo().useState(i)};Jt.version="17.0.2";Yi.exports=Jt;var PE=Yi.exports,Fx={exports:{}},zi={},Ux={exports:{}},Nx={};/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){var o,u,m,_;if(typeof performance=="object"&&typeof performance.now=="function"){var S=performance;i.unstable_now=function(){return S.now()}}else{var k=Date,a=k.now();i.unstable_now=function(){return k.now()-a}}if(typeof window=="undefined"||typeof MessageChannel!="function"){var O=null,X=null,xe=function(){if(O!==null)try{var je=i.unstable_now();O(!0,je),O=null}catch(gt){throw setTimeout(xe,0),gt}};o=function(je){O!==null?setTimeout(o,0,je):(O=je,setTimeout(xe,0))},u=function(je,gt){X=setTimeout(je,gt)},m=function(){clearTimeout(X)},i.unstable_shouldYield=function(){return!1},_=i.unstable_forceFrameRate=function(){}}else{var ce=window.setTimeout,he=window.clearTimeout;if(typeof console!="undefined"){var se=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof se!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var De=!1,Te=null,ne=-1,Y=5,Q=0;i.unstable_shouldYield=function(){return i.unstable_now()>=Q},_=function(){},i.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<je?Math.floor(1e3/je):5};var ge=new MessageChannel,we=ge.port2;ge.port1.onmessage=function(){if(Te!==null){var je=i.unstable_now();Q=je+Y;try{Te(!0,je)?we.postMessage(null):(De=!1,Te=null)}catch(gt){throw we.postMessage(null),gt}}else De=!1},o=function(je){Te=je,De||(De=!0,we.postMessage(null))},u=function(je,gt){ne=ce(function(){je(i.unstable_now())},gt)},m=function(){he(ne),ne=-1}}function He(je,gt){var St=je.length;je.push(gt);e:for(;;){var $t=St-1>>>1,zr=je[$t];if(zr!==void 0&&0<Ve(zr,gt))je[$t]=gt,je[St]=zr,St=$t;else break e}}function Ee(je){return je=je[0],je===void 0?null:je}function Qe(je){var gt=je[0];if(gt!==void 0){var St=je.pop();if(St!==gt){je[0]=St;e:for(var $t=0,zr=je.length;$t<zr;){var xn=2*($t+1)-1,Hr=je[xn],si=xn+1,ai=je[si];if(Hr!==void 0&&0>Ve(Hr,St))ai!==void 0&&0>Ve(ai,Hr)?(je[$t]=ai,je[si]=St,$t=si):(je[$t]=Hr,je[xn]=St,$t=xn);else if(ai!==void 0&&0>Ve(ai,St))je[$t]=ai,je[si]=St,$t=si;else break e}}return gt}return null}function Ve(je,gt){var St=je.sortIndex-gt.sortIndex;return St!==0?St:je.id-gt.id}var Fe=[],nt=[],bt=1,ut=null,st=3,$r=!1,ar=!1,ur=!1;function wr(je){for(var gt=Ee(nt);gt!==null;){if(gt.callback===null)Qe(nt);else if(gt.startTime<=je)Qe(nt),gt.sortIndex=gt.expirationTime,He(Fe,gt);else break;gt=Ee(nt)}}function Gr(je){if(ur=!1,wr(je),!ar)if(Ee(Fe)!==null)ar=!0,o(Wr);else{var gt=Ee(nt);gt!==null&&u(Gr,gt.startTime-je)}}function Wr(je,gt){ar=!1,ur&&(ur=!1,m()),$r=!0;var St=st;try{for(wr(gt),ut=Ee(Fe);ut!==null&&(!(ut.expirationTime>gt)||je&&!i.unstable_shouldYield());){var $t=ut.callback;if(typeof $t=="function"){ut.callback=null,st=ut.priorityLevel;var zr=$t(ut.expirationTime<=gt);gt=i.unstable_now(),typeof zr=="function"?ut.callback=zr:ut===Ee(Fe)&&Qe(Fe),wr(gt)}else Qe(Fe);ut=Ee(Fe)}if(ut!==null)var xn=!0;else{var Hr=Ee(nt);Hr!==null&&u(Gr,Hr.startTime-gt),xn=!1}return xn}finally{ut=null,st=St,$r=!1}}var dn=_;i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(je){je.callback=null},i.unstable_continueExecution=function(){ar||$r||(ar=!0,o(Wr))},i.unstable_getCurrentPriorityLevel=function(){return st},i.unstable_getFirstCallbackNode=function(){return Ee(Fe)},i.unstable_next=function(je){switch(st){case 1:case 2:case 3:var gt=3;break;default:gt=st}var St=st;st=gt;try{return je()}finally{st=St}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=dn,i.unstable_runWithPriority=function(je,gt){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var St=st;st=je;try{return gt()}finally{st=St}},i.unstable_scheduleCallback=function(je,gt,St){var $t=i.unstable_now();switch(typeof St=="object"&&St!==null?(St=St.delay,St=typeof St=="number"&&0<St?$t+St:$t):St=$t,je){case 1:var zr=-1;break;case 2:zr=250;break;case 5:zr=1073741823;break;case 4:zr=1e4;break;default:zr=5e3}return zr=St+zr,je={id:bt++,callback:gt,priorityLevel:je,startTime:St,expirationTime:zr,sortIndex:-1},St>$t?(je.sortIndex=St,He(nt,je),Ee(Fe)===null&&je===Ee(nt)&&(ur?m():ur=!0,u(Gr,St-$t))):(je.sortIndex=zr,He(Fe,je),ar||$r||(ar=!0,o(Wr))),je},i.unstable_wrapCallback=function(je){var gt=st;return function(){var St=st;st=gt;try{return je.apply(this,arguments)}finally{st=St}}}})(Nx);Ux.exports=Nx;/** @license React v17.0.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bp=Yi.exports,Ir=bx,un=Ux.exports;function Je(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!bp)throw Error(Je(227));var jx=new Set,Yu={};function Wa(i,o){_c(i,o),_c(i+"Capture",o)}function _c(i,o){for(Yu[i]=o,i=0;i<o.length;i++)jx.add(o[i])}var qo=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),DE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vx=Object.prototype.hasOwnProperty,$x={},Gx={};function LE(i){return Vx.call(Gx,i)?!0:Vx.call($x,i)?!1:DE.test(i)?Gx[i]=!0:($x[i]=!0,!1)}function OE(i,o,u,m){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function RE(i,o,u,m){if(o===null||typeof o=="undefined"||OE(i,o,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Un(i,o,u,m,_,S,k){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=m,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=i,this.type=o,this.sanitizeURL=S,this.removeEmptyString=k}var gn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){gn[i]=new Un(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];gn[o]=new Un(o,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){gn[i]=new Un(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){gn[i]=new Un(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){gn[i]=new Un(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){gn[i]=new Un(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){gn[i]=new Un(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){gn[i]=new Un(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){gn[i]=new Un(i,5,!1,i.toLowerCase(),null,!1,!1)});var M_=/[\-:]([a-z])/g;function I_(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(M_,I_);gn[o]=new Un(o,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(M_,I_);gn[o]=new Un(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(M_,I_);gn[o]=new Un(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){gn[i]=new Un(i,1,!1,i.toLowerCase(),null,!1,!1)});gn.xlinkHref=new Un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){gn[i]=new Un(i,1,!1,i.toLowerCase(),null,!0,!0)});function A_(i,o,u,m){var _=gn.hasOwnProperty(o)?gn[o]:null,S=_!==null?_.type===0:m?!1:!(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N");S||(RE(o,u,_,m)&&(u=null),m||_===null?LE(o)&&(u===null?i.removeAttribute(o):i.setAttribute(o,""+u)):_.mustUseProperty?i[_.propertyName]=u===null?_.type===3?!1:"":u:(o=_.attributeName,m=_.attributeNamespace,u===null?i.removeAttribute(o):(_=_.type,u=_===3||_===4&&u===!0?"":""+u,m?i.setAttributeNS(m,o,u):i.setAttribute(o,u))))}var Ha=bp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ku=60103,Xa=60106,Os=60107,z_=60108,Ju=60114,P_=60109,D_=60110,Tp=60112,Qu=60113,Sp=60120,Ep=60115,L_=60116,O_=60121,R_=60128,Zx=60129,B_=60130,F_=60131;if(typeof Symbol=="function"&&Symbol.for){var hn=Symbol.for;Ku=hn("react.element"),Xa=hn("react.portal"),Os=hn("react.fragment"),z_=hn("react.strict_mode"),Ju=hn("react.profiler"),P_=hn("react.provider"),D_=hn("react.context"),Tp=hn("react.forward_ref"),Qu=hn("react.suspense"),Sp=hn("react.suspense_list"),Ep=hn("react.memo"),L_=hn("react.lazy"),O_=hn("react.block"),hn("react.scope"),R_=hn("react.opaque.id"),Zx=hn("react.debug_trace_mode"),B_=hn("react.offscreen"),F_=hn("react.legacy_hidden")}var qx=typeof Symbol=="function"&&Symbol.iterator;function eh(i){return i===null||typeof i!="object"?null:(i=qx&&i[qx]||i["@@iterator"],typeof i=="function"?i:null)}var U_;function th(i){if(U_===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);U_=o&&o[1]||""}return`
`+U_+i}var N_=!1;function Cp(i,o){if(!i||N_)return"";N_=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(O){var m=O}Reflect.construct(i,[],o)}else{try{o.call()}catch(O){m=O}i.call(o.prototype)}else{try{throw Error()}catch(O){m=O}i()}}catch(O){if(O&&m&&typeof O.stack=="string"){for(var _=O.stack.split(`
`),S=m.stack.split(`
`),k=_.length-1,a=S.length-1;1<=k&&0<=a&&_[k]!==S[a];)a--;for(;1<=k&&0<=a;k--,a--)if(_[k]!==S[a]){if(k!==1||a!==1)do if(k--,a--,0>a||_[k]!==S[a])return`
`+_[k].replace(" at new "," at ");while(1<=k&&0<=a);break}}}finally{N_=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?th(i):""}function BE(i){switch(i.tag){case 5:return th(i.type);case 16:return th("Lazy");case 13:return th("Suspense");case 19:return th("SuspenseList");case 0:case 2:case 15:return i=Cp(i.type,!1),i;case 11:return i=Cp(i.type.render,!1),i;case 22:return i=Cp(i.type._render,!1),i;case 1:return i=Cp(i.type,!0),i;default:return""}}function gc(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Os:return"Fragment";case Xa:return"Portal";case Ju:return"Profiler";case z_:return"StrictMode";case Qu:return"Suspense";case Sp:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case D_:return(i.displayName||"Context")+".Consumer";case P_:return(i._context.displayName||"Context")+".Provider";case Tp:var o=i.render;return o=o.displayName||o.name||"",i.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case Ep:return gc(i.type);case O_:return gc(i._render);case L_:o=i._payload,i=i._init;try{return gc(i(o))}catch{}}return null}function Rs(i){switch(typeof i){case"boolean":case"number":case"object":case"string":case"undefined":return i;default:return""}}function Wx(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function FE(i){var o=Wx(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),m=""+i[o];if(!i.hasOwnProperty(o)&&typeof u!="undefined"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,S=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return _.call(this)},set:function(k){m=""+k,S.call(this,k)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(k){m=""+k},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function kp(i){i._valueTracker||(i._valueTracker=FE(i))}function Hx(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),m="";return i&&(m=Wx(i)?i.checked?"true":"false":i.value),i=m,i!==u?(o.setValue(i),!0):!1}function Mp(i){if(i=i||(typeof document!="undefined"?document:void 0),typeof i=="undefined")return null;try{return i.activeElement||i.body}catch{return i.body}}function j_(i,o){var u=o.checked;return Ir({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u!=null?u:i._wrapperState.initialChecked})}function Xx(i,o){var u=o.defaultValue==null?"":o.defaultValue,m=o.checked!=null?o.checked:o.defaultChecked;u=Rs(o.value!=null?o.value:u),i._wrapperState={initialChecked:m,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Yx(i,o){o=o.checked,o!=null&&A_(i,"checked",o,!1)}function V_(i,o){Yx(i,o);var u=Rs(o.value),m=o.type;if(u!=null)m==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(m==="submit"||m==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?$_(i,o.type,u):o.hasOwnProperty("defaultValue")&&$_(i,o.type,Rs(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Kx(i,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var m=o.type;if(!(m!=="submit"&&m!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,u||o===i.value||(i.value=o),i.defaultValue=o}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function $_(i,o,u){(o!=="number"||Mp(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}function UE(i){var o="";return bp.Children.forEach(i,function(u){u!=null&&(o+=u)}),o}function G_(i,o){return i=Ir({children:void 0},o),(o=UE(o.children))&&(i.children=o),i}function yc(i,o,u,m){if(i=i.options,o){o={};for(var _=0;_<u.length;_++)o["$"+u[_]]=!0;for(u=0;u<i.length;u++)_=o.hasOwnProperty("$"+i[u].value),i[u].selected!==_&&(i[u].selected=_),_&&m&&(i[u].defaultSelected=!0)}else{for(u=""+Rs(u),o=null,_=0;_<i.length;_++){if(i[_].value===u){i[_].selected=!0,m&&(i[_].defaultSelected=!0);return}o!==null||i[_].disabled||(o=i[_])}o!==null&&(o.selected=!0)}}function Z_(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Je(91));return Ir({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Jx(i,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(Je(92));if(Array.isArray(u)){if(!(1>=u.length))throw Error(Je(93));u=u[0]}o=u}o==null&&(o=""),u=o}i._wrapperState={initialValue:Rs(u)}}function Qx(i,o){var u=Rs(o.value),m=Rs(o.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),o.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),m!=null&&(i.defaultValue=""+m)}function e1(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}var q_={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function t1(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function W_(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?t1(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Ip,r1=function(i){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(o,u,m,_){MSApp.execUnsafeLocalFunction(function(){return i(o,u,m,_)})}:i}(function(i,o){if(i.namespaceURI!==q_.svg||"innerHTML"in i)i.innerHTML=o;else{for(Ip=Ip||document.createElement("div"),Ip.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ip.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function rh(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var nh={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NE=["Webkit","ms","Moz","O"];Object.keys(nh).forEach(function(i){NE.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),nh[o]=nh[i]})});function n1(i,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||nh.hasOwnProperty(i)&&nh[i]?(""+o).trim():o+"px"}function i1(i,o){i=i.style;for(var u in o)if(o.hasOwnProperty(u)){var m=u.indexOf("--")===0,_=n1(u,o[u],m);u==="float"&&(u="cssFloat"),m?i.setProperty(u,_):i[u]=_}}var jE=Ir({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function H_(i,o){if(o){if(jE[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Je(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Je(60));if(!(typeof o.dangerouslySetInnerHTML=="object"&&"__html"in o.dangerouslySetInnerHTML))throw Error(Je(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Je(62))}}function X_(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Y_(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var K_=null,vc=null,xc=null;function o1(i){if(i=bh(i)){if(typeof K_!="function")throw Error(Je(280));var o=i.stateNode;o&&(o=Wp(o),K_(i.stateNode,i.type,o))}}function s1(i){vc?xc?xc.push(i):xc=[i]:vc=i}function a1(){if(vc){var i=vc,o=xc;if(xc=vc=null,o1(i),o)for(i=0;i<o.length;i++)o1(o[i])}}function J_(i,o){return i(o)}function l1(i,o,u,m,_){return i(o,u,m,_)}function Q_(){}var c1=J_,Ya=!1,eg=!1;function tg(){(vc!==null||xc!==null)&&(Q_(),a1())}function VE(i,o,u){if(eg)return i(o,u);eg=!0;try{return c1(i,o,u)}finally{eg=!1,tg()}}function ih(i,o){var u=i.stateNode;if(u===null)return null;var m=Wp(u);if(m===null)return null;u=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(Je(231,o,typeof u));return u}var rg=!1;if(qo)try{var oh={};Object.defineProperty(oh,"passive",{get:function(){rg=!0}}),window.addEventListener("test",oh,oh),window.removeEventListener("test",oh,oh)}catch{rg=!1}function $E(i,o,u,m,_,S,k,a,O){var X=Array.prototype.slice.call(arguments,3);try{o.apply(u,X)}catch(xe){this.onError(xe)}}var sh=!1,Ap=null,zp=!1,ng=null,GE={onError:function(i){sh=!0,Ap=i}};function ZE(i,o,u,m,_,S,k,a,O){sh=!1,Ap=null,$E.apply(GE,arguments)}function qE(i,o,u,m,_,S,k,a,O){if(ZE.apply(this,arguments),sh){if(sh){var X=Ap;sh=!1,Ap=null}else throw Error(Je(198));zp||(zp=!0,ng=X)}}function Ka(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&1026)!=0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function u1(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function h1(i){if(Ka(i)!==i)throw Error(Je(188))}function WE(i){var o=i.alternate;if(!o){if(o=Ka(i),o===null)throw Error(Je(188));return o!==i?null:i}for(var u=i,m=o;;){var _=u.return;if(_===null)break;var S=_.alternate;if(S===null){if(m=_.return,m!==null){u=m;continue}break}if(_.child===S.child){for(S=_.child;S;){if(S===u)return h1(_),i;if(S===m)return h1(_),o;S=S.sibling}throw Error(Je(188))}if(u.return!==m.return)u=_,m=S;else{for(var k=!1,a=_.child;a;){if(a===u){k=!0,u=_,m=S;break}if(a===m){k=!0,m=_,u=S;break}a=a.sibling}if(!k){for(a=S.child;a;){if(a===u){k=!0,u=S,m=_;break}if(a===m){k=!0,m=S,u=_;break}a=a.sibling}if(!k)throw Error(Je(189))}}if(u.alternate!==m)throw Error(Je(190))}if(u.tag!==3)throw Error(Je(188));return u.stateNode.current===u?i:o}function d1(i){if(i=WE(i),!i)return null;for(var o=i;;){if(o.tag===5||o.tag===6)return o;if(o.child)o.child.return=o,o=o.child;else{if(o===i)break;for(;!o.sibling;){if(!o.return||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}}return null}function p1(i,o){for(var u=i.alternate;o!==null;){if(o===i||o===u)return!0;o=o.return}return!1}var f1,ig,m1,_1,og=!1,To=[],Bs=null,Fs=null,Us=null,ah=new Map,lh=new Map,ch=[],g1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sg(i,o,u,m,_){return{blockedOn:i,domEventName:o,eventSystemFlags:u|16,nativeEvent:_,targetContainers:[m]}}function y1(i,o){switch(i){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":Us=null;break;case"pointerover":case"pointerout":ah.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":lh.delete(o.pointerId)}}function uh(i,o,u,m,_,S){return i===null||i.nativeEvent!==S?(i=sg(o,u,m,_,S),o!==null&&(o=bh(o),o!==null&&ig(o)),i):(i.eventSystemFlags|=m,o=i.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),i)}function HE(i,o,u,m,_){switch(o){case"focusin":return Bs=uh(Bs,i,o,u,m,_),!0;case"dragenter":return Fs=uh(Fs,i,o,u,m,_),!0;case"mouseover":return Us=uh(Us,i,o,u,m,_),!0;case"pointerover":var S=_.pointerId;return ah.set(S,uh(ah.get(S)||null,i,o,u,m,_)),!0;case"gotpointercapture":return S=_.pointerId,lh.set(S,uh(lh.get(S)||null,i,o,u,m,_)),!0}return!1}function XE(i){var o=Ja(i.target);if(o!==null){var u=Ka(o);if(u!==null){if(o=u.tag,o===13){if(o=u1(u),o!==null){i.blockedOn=o,_1(i.lanePriority,function(){un.unstable_runWithPriority(i.priority,function(){m1(u)})});return}}else if(o===3&&u.stateNode.hydrate){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pp(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=dg(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u!==null)return o=bh(u),o!==null&&ig(o),i.blockedOn=u,!1;o.shift()}return!0}function v1(i,o,u){Pp(i)&&u.delete(o)}function YE(){for(og=!1;0<To.length;){var i=To[0];if(i.blockedOn!==null){i=bh(i.blockedOn),i!==null&&f1(i);break}for(var o=i.targetContainers;0<o.length;){var u=dg(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u!==null){i.blockedOn=u;break}o.shift()}i.blockedOn===null&&To.shift()}Bs!==null&&Pp(Bs)&&(Bs=null),Fs!==null&&Pp(Fs)&&(Fs=null),Us!==null&&Pp(Us)&&(Us=null),ah.forEach(v1),lh.forEach(v1)}function hh(i,o){i.blockedOn===o&&(i.blockedOn=null,og||(og=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,YE)))}function x1(i){function o(_){return hh(_,i)}if(0<To.length){hh(To[0],i);for(var u=1;u<To.length;u++){var m=To[u];m.blockedOn===i&&(m.blockedOn=null)}}for(Bs!==null&&hh(Bs,i),Fs!==null&&hh(Fs,i),Us!==null&&hh(Us,i),ah.forEach(o),lh.forEach(o),u=0;u<ch.length;u++)m=ch[u],m.blockedOn===i&&(m.blockedOn=null);for(;0<ch.length&&(u=ch[0],u.blockedOn===null);)XE(u),u.blockedOn===null&&ch.shift()}function Dp(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var wc={animationend:Dp("Animation","AnimationEnd"),animationiteration:Dp("Animation","AnimationIteration"),animationstart:Dp("Animation","AnimationStart"),transitionend:Dp("Transition","TransitionEnd")},ag={},w1={};qo&&(w1=document.createElement("div").style,"AnimationEvent"in window||(delete wc.animationend.animation,delete wc.animationiteration.animation,delete wc.animationstart.animation),"TransitionEvent"in window||delete wc.transitionend.transition);function Lp(i){if(ag[i])return ag[i];if(!wc[i])return i;var o=wc[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in w1)return ag[i]=o[u];return i}var b1=Lp("animationend"),T1=Lp("animationiteration"),S1=Lp("animationstart"),E1=Lp("transitionend"),C1=new Map,lg=new Map,KE=["abort","abort",b1,"animationEnd",T1,"animationIteration",S1,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",E1,"transitionEnd","waiting","waiting"];function cg(i,o){for(var u=0;u<i.length;u+=2){var m=i[u],_=i[u+1];_="on"+(_[0].toUpperCase()+_.slice(1)),lg.set(m,o),C1.set(m,_),Wa(_,[m])}}var JE=un.unstable_now;JE();var xr=8;function bc(i){if((1&i)!=0)return xr=15,1;if((2&i)!=0)return xr=14,2;if((4&i)!=0)return xr=13,4;var o=24&i;return o!==0?(xr=12,o):(i&32)!=0?(xr=11,32):(o=192&i,o!==0?(xr=10,o):(i&256)!=0?(xr=9,256):(o=3584&i,o!==0?(xr=8,o):(i&4096)!=0?(xr=7,4096):(o=4186112&i,o!==0?(xr=6,o):(o=62914560&i,o!==0?(xr=5,o):i&67108864?(xr=4,67108864):(i&134217728)!=0?(xr=3,134217728):(o=805306368&i,o!==0?(xr=2,o):(1073741824&i)!=0?(xr=1,1073741824):(xr=8,i))))))}function QE(i){switch(i){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function eC(i){switch(i){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Je(358,i))}}function dh(i,o){var u=i.pendingLanes;if(u===0)return xr=0;var m=0,_=0,S=i.expiredLanes,k=i.suspendedLanes,a=i.pingedLanes;if(S!==0)m=S,_=xr=15;else if(S=u&134217727,S!==0){var O=S&~k;O!==0?(m=bc(O),_=xr):(a&=S,a!==0&&(m=bc(a),_=xr))}else S=u&~k,S!==0?(m=bc(S),_=xr):a!==0&&(m=bc(a),_=xr);if(m===0)return 0;if(m=31-Ns(m),m=u&((0>m?0:1<<m)<<1)-1,o!==0&&o!==m&&(o&k)==0){if(bc(o),_<=xr)return o;xr=_}if(o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=m;0<o;)u=31-Ns(o),_=1<<u,m|=i[u],o&=~_;return m}function k1(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Op(i,o){switch(i){case 15:return 1;case 14:return 2;case 12:return i=Tc(24&~o),i===0?Op(10,o):i;case 10:return i=Tc(192&~o),i===0?Op(8,o):i;case 8:return i=Tc(3584&~o),i===0&&(i=Tc(4186112&~o),i===0&&(i=512)),i;case 2:return o=Tc(805306368&~o),o===0&&(o=268435456),o}throw Error(Je(358,i))}function Tc(i){return i&-i}function ug(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Rp(i,o,u){i.pendingLanes|=o;var m=o-1;i.suspendedLanes&=m,i.pingedLanes&=m,i=i.eventTimes,o=31-Ns(o),i[o]=u}var Ns=Math.clz32?Math.clz32:nC,tC=Math.log,rC=Math.LN2;function nC(i){return i===0?32:31-(tC(i)/rC|0)|0}var iC=un.unstable_UserBlockingPriority,oC=un.unstable_runWithPriority,Bp=!0;function sC(i,o,u,m){Ya||Q_();var _=hg,S=Ya;Ya=!0;try{l1(_,i,o,u,m)}finally{(Ya=S)||tg()}}function aC(i,o,u,m){oC(iC,hg.bind(null,i,o,u,m))}function hg(i,o,u,m){if(Bp){var _;if((_=(o&4)==0)&&0<To.length&&-1<g1.indexOf(i))i=sg(null,i,o,u,m),To.push(i);else{var S=dg(i,o,u,m);if(S===null)_&&y1(i,m);else{if(_){if(-1<g1.indexOf(i)){i=sg(S,i,o,u,m),To.push(i);return}if(HE(S,i,o,u,m))return;y1(i,m)}nw(i,o,m,null,u)}}}}function dg(i,o,u,m){var _=Y_(m);if(_=Ja(_),_!==null){var S=Ka(_);if(S===null)_=null;else{var k=S.tag;if(k===13){if(_=u1(S),_!==null)return _;_=null}else if(k===3){if(S.stateNode.hydrate)return S.tag===3?S.stateNode.containerInfo:null;_=null}else S!==_&&(_=null)}}return nw(i,o,m,_,u),null}var js=null,pg=null,Fp=null;function M1(){if(Fp)return Fp;var i,o=pg,u=o.length,m,_="value"in js?js.value:js.textContent,S=_.length;for(i=0;i<u&&o[i]===_[i];i++);var k=u-i;for(m=1;m<=k&&o[u-m]===_[S-m];m++);return Fp=_.slice(i,1<m?1-m:void 0)}function Up(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Np(){return!0}function I1(){return!1}function gi(i){function o(u,m,_,S,k){this._reactName=u,this._targetInst=_,this.type=m,this.nativeEvent=S,this.target=k,this.currentTarget=null;for(var a in i)i.hasOwnProperty(a)&&(u=i[a],this[a]=u?u(S):S[a]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Np:I1,this.isPropagationStopped=I1,this}return Ir(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Np)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Np)},persist:function(){},isPersistent:Np}),o}var Sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fg=gi(Sc),ph=Ir({},Sc,{view:0,detail:0}),lC=gi(ph),mg,_g,fh,jp=Ir({},ph,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yg,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==fh&&(fh&&i.type==="mousemove"?(mg=i.screenX-fh.screenX,_g=i.screenY-fh.screenY):_g=mg=0,fh=i),mg)},movementY:function(i){return"movementY"in i?i.movementY:_g}}),A1=gi(jp),cC=Ir({},jp,{dataTransfer:0}),uC=gi(cC),hC=Ir({},ph,{relatedTarget:0}),gg=gi(hC),dC=Ir({},Sc,{animationName:0,elapsedTime:0,pseudoElement:0}),pC=gi(dC),fC=Ir({},Sc,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),mC=gi(fC),_C=Ir({},Sc,{data:0}),z1=gi(_C),gC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xC(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=vC[i])?!!o[i]:!1}function yg(){return xC}var wC=Ir({},ph,{key:function(i){if(i.key){var o=gC[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Up(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?yC[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yg,charCode:function(i){return i.type==="keypress"?Up(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Up(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),bC=gi(wC),TC=Ir({},jp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),P1=gi(TC),SC=Ir({},ph,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yg}),EC=gi(SC),CC=Ir({},Sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),kC=gi(CC),MC=Ir({},jp,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),IC=gi(MC),AC=[9,13,27,32],vg=qo&&"CompositionEvent"in window,mh=null;qo&&"documentMode"in document&&(mh=document.documentMode);var zC=qo&&"TextEvent"in window&&!mh,D1=qo&&(!vg||mh&&8<mh&&11>=mh),L1=String.fromCharCode(32),O1=!1;function R1(i,o){switch(i){case"keyup":return AC.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function B1(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ec=!1;function PC(i,o){switch(i){case"compositionend":return B1(o);case"keypress":return o.which!==32?null:(O1=!0,L1);case"textInput":return i=o.data,i===L1&&O1?null:i;default:return null}}function DC(i,o){if(Ec)return i==="compositionend"||!vg&&R1(i,o)?(i=M1(),Fp=pg=js=null,Ec=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return D1&&o.locale!=="ko"?null:o.data;default:return null}}var LC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F1(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!LC[i.type]:o==="textarea"}function U1(i,o,u,m){s1(m),o=$p(o,"onChange"),0<o.length&&(u=new fg("onChange","change",null,u,m),i.push({event:u,listeners:o}))}var _h=null,gh=null;function OC(i){J1(i,0)}function Vp(i){var o=Ac(i);if(Hx(o))return i}function RC(i,o){if(i==="change")return o}var N1=!1;if(qo){var xg;if(qo){var wg="oninput"in document;if(!wg){var j1=document.createElement("div");j1.setAttribute("oninput","return;"),wg=typeof j1.oninput=="function"}xg=wg}else xg=!1;N1=xg&&(!document.documentMode||9<document.documentMode)}function V1(){_h&&(_h.detachEvent("onpropertychange",$1),gh=_h=null)}function $1(i){if(i.propertyName==="value"&&Vp(gh)){var o=[];if(U1(o,gh,i,Y_(i)),i=OC,Ya)i(o);else{Ya=!0;try{J_(i,o)}finally{Ya=!1,tg()}}}}function BC(i,o,u){i==="focusin"?(V1(),_h=o,gh=u,_h.attachEvent("onpropertychange",$1)):i==="focusout"&&V1()}function FC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Vp(gh)}function UC(i,o){if(i==="click")return Vp(o)}function NC(i,o){if(i==="input"||i==="change")return Vp(o)}function jC(i,o){return i===o&&(i!==0||1/i==1/o)||i!==i&&o!==o}var Pi=typeof Object.is=="function"?Object.is:jC,VC=Object.prototype.hasOwnProperty;function yh(i,o){if(Pi(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),m=Object.keys(o);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++)if(!VC.call(o,u[m])||!Pi(i[u[m]],o[u[m]]))return!1;return!0}function G1(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Z1(i,o){var u=G1(i);i=0;for(var m;u;){if(u.nodeType===3){if(m=i+u.textContent.length,i<=o&&m>=o)return{node:u,offset:o-i};i=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=G1(u)}}function q1(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?q1(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function W1(){for(var i=window,o=Mp();o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=Mp(i.document)}return o}function bg(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var $C=qo&&"documentMode"in document&&11>=document.documentMode,Cc=null,Tg=null,vh=null,Sg=!1;function H1(i,o,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Sg||Cc==null||Cc!==Mp(m)||(m=Cc,"selectionStart"in m&&bg(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),vh&&yh(vh,m)||(vh=m,m=$p(Tg,"onSelect"),0<m.length&&(o=new fg("onSelect","select",null,o,u),i.push({event:o,listeners:m}),o.target=Cc)))}cg("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);cg("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);cg(KE,2);for(var X1="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Eg=0;Eg<X1.length;Eg++)lg.set(X1[Eg],0);_c("onMouseEnter",["mouseout","mouseover"]);_c("onMouseLeave",["mouseout","mouseover"]);_c("onPointerEnter",["pointerout","pointerover"]);_c("onPointerLeave",["pointerout","pointerover"]);Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y1=new Set("cancel close invalid load scroll toggle".split(" ").concat(xh));function K1(i,o,u){var m=i.type||"unknown-event";i.currentTarget=u,qE(m,o,void 0,i),i.currentTarget=null}function J1(i,o){o=(o&4)!=0;for(var u=0;u<i.length;u++){var m=i[u],_=m.event;m=m.listeners;e:{var S=void 0;if(o)for(var k=m.length-1;0<=k;k--){var a=m[k],O=a.instance,X=a.currentTarget;if(a=a.listener,O!==S&&_.isPropagationStopped())break e;K1(_,a,X),S=O}else for(k=0;k<m.length;k++){if(a=m[k],O=a.instance,X=a.currentTarget,a=a.listener,O!==S&&_.isPropagationStopped())break e;K1(_,a,X),S=O}}}if(zp)throw i=ng,zp=!1,ng=null,i}function Er(i,o){var u=cw(o),m=i+"__bubble";u.has(m)||(rw(o,i,2,!1),u.add(m))}var Q1="_reactListening"+Math.random().toString(36).slice(2);function ew(i){i[Q1]||(i[Q1]=!0,jx.forEach(function(o){Y1.has(o)||tw(o,!1,i,null),tw(o,!0,i,null)}))}function tw(i,o,u,m){var _=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,S=u;if(i==="selectionchange"&&u.nodeType!==9&&(S=u.ownerDocument),m!==null&&!o&&Y1.has(i)){if(i!=="scroll")return;_|=2,S=m}var k=cw(S),a=i+"__"+(o?"capture":"bubble");k.has(a)||(o&&(_|=4),rw(S,i,_,o),k.add(a))}function rw(i,o,u,m){var _=lg.get(o);switch(_===void 0?2:_){case 0:_=sC;break;case 1:_=aC;break;default:_=hg}u=_.bind(null,o,u,i),_=void 0,!rg||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),m?_!==void 0?i.addEventListener(o,u,{capture:!0,passive:_}):i.addEventListener(o,u,!0):_!==void 0?i.addEventListener(o,u,{passive:_}):i.addEventListener(o,u,!1)}function nw(i,o,u,m,_){var S=m;if((o&1)==0&&(o&2)==0&&m!==null)e:for(;;){if(m===null)return;var k=m.tag;if(k===3||k===4){var a=m.stateNode.containerInfo;if(a===_||a.nodeType===8&&a.parentNode===_)break;if(k===4)for(k=m.return;k!==null;){var O=k.tag;if((O===3||O===4)&&(O=k.stateNode.containerInfo,O===_||O.nodeType===8&&O.parentNode===_))return;k=k.return}for(;a!==null;){if(k=Ja(a),k===null)return;if(O=k.tag,O===5||O===6){m=S=k;continue e}a=a.parentNode}}m=m.return}VE(function(){var X=S,xe=Y_(u),ce=[];e:{var he=C1.get(i);if(he!==void 0){var se=fg,De=i;switch(i){case"keypress":if(Up(u)===0)break e;case"keydown":case"keyup":se=bC;break;case"focusin":De="focus",se=gg;break;case"focusout":De="blur",se=gg;break;case"beforeblur":case"afterblur":se=gg;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=A1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=uC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=EC;break;case b1:case T1:case S1:se=pC;break;case E1:se=kC;break;case"scroll":se=lC;break;case"wheel":se=IC;break;case"copy":case"cut":case"paste":se=mC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=P1}var Te=(o&4)!=0,ne=!Te&&i==="scroll",Y=Te?he!==null?he+"Capture":null:he;Te=[];for(var Q=X,ge;Q!==null;){ge=Q;var we=ge.stateNode;if(ge.tag===5&&we!==null&&(ge=we,Y!==null&&(we=ih(Q,Y),we!=null&&Te.push(wh(Q,we,ge)))),ne)break;Q=Q.return}0<Te.length&&(he=new se(he,De,null,u,xe),ce.push({event:he,listeners:Te}))}}if((o&7)==0){e:{if(he=i==="mouseover"||i==="pointerover",se=i==="mouseout"||i==="pointerout",he&&(o&16)==0&&(De=u.relatedTarget||u.fromElement)&&(Ja(De)||De[Ic]))break e;if((se||he)&&(he=xe.window===xe?xe:(he=xe.ownerDocument)?he.defaultView||he.parentWindow:window,se?(De=u.relatedTarget||u.toElement,se=X,De=De?Ja(De):null,De!==null&&(ne=Ka(De),De!==ne||De.tag!==5&&De.tag!==6)&&(De=null)):(se=null,De=X),se!==De)){if(Te=A1,we="onMouseLeave",Y="onMouseEnter",Q="mouse",(i==="pointerout"||i==="pointerover")&&(Te=P1,we="onPointerLeave",Y="onPointerEnter",Q="pointer"),ne=se==null?he:Ac(se),ge=De==null?he:Ac(De),he=new Te(we,Q+"leave",se,u,xe),he.target=ne,he.relatedTarget=ge,we=null,Ja(xe)===X&&(Te=new Te(Y,Q+"enter",De,u,xe),Te.target=ge,Te.relatedTarget=ne,we=Te),ne=we,se&&De)t:{for(Te=se,Y=De,Q=0,ge=Te;ge;ge=kc(ge))Q++;for(ge=0,we=Y;we;we=kc(we))ge++;for(;0<Q-ge;)Te=kc(Te),Q--;for(;0<ge-Q;)Y=kc(Y),ge--;for(;Q--;){if(Te===Y||Y!==null&&Te===Y.alternate)break t;Te=kc(Te),Y=kc(Y)}Te=null}else Te=null;se!==null&&iw(ce,he,se,Te,!1),De!==null&&ne!==null&&iw(ce,ne,De,Te,!0)}}e:{if(he=X?Ac(X):window,se=he.nodeName&&he.nodeName.toLowerCase(),se==="select"||se==="input"&&he.type==="file")var He=RC;else if(F1(he))if(N1)He=NC;else{He=FC;var Ee=BC}else(se=he.nodeName)&&se.toLowerCase()==="input"&&(he.type==="checkbox"||he.type==="radio")&&(He=UC);if(He&&(He=He(i,X))){U1(ce,He,u,xe);break e}Ee&&Ee(i,he,X),i==="focusout"&&(Ee=he._wrapperState)&&Ee.controlled&&he.type==="number"&&$_(he,"number",he.value)}switch(Ee=X?Ac(X):window,i){case"focusin":(F1(Ee)||Ee.contentEditable==="true")&&(Cc=Ee,Tg=X,vh=null);break;case"focusout":vh=Tg=Cc=null;break;case"mousedown":Sg=!0;break;case"contextmenu":case"mouseup":case"dragend":Sg=!1,H1(ce,u,xe);break;case"selectionchange":if($C)break;case"keydown":case"keyup":H1(ce,u,xe)}var Qe;if(vg)e:{switch(i){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else Ec?R1(i,u)&&(Ve="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Ve="onCompositionStart");Ve&&(D1&&u.locale!=="ko"&&(Ec||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Ec&&(Qe=M1()):(js=xe,pg="value"in js?js.value:js.textContent,Ec=!0)),Ee=$p(X,Ve),0<Ee.length&&(Ve=new z1(Ve,i,null,u,xe),ce.push({event:Ve,listeners:Ee}),Qe?Ve.data=Qe:(Qe=B1(u),Qe!==null&&(Ve.data=Qe)))),(Qe=zC?PC(i,u):DC(i,u))&&(X=$p(X,"onBeforeInput"),0<X.length&&(xe=new z1("onBeforeInput","beforeinput",null,u,xe),ce.push({event:xe,listeners:X}),xe.data=Qe))}J1(ce,o)})}function wh(i,o,u){return{instance:i,listener:o,currentTarget:u}}function $p(i,o){for(var u=o+"Capture",m=[];i!==null;){var _=i,S=_.stateNode;_.tag===5&&S!==null&&(_=S,S=ih(i,u),S!=null&&m.unshift(wh(i,S,_)),S=ih(i,o),S!=null&&m.push(wh(i,S,_))),i=i.return}return m}function kc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function iw(i,o,u,m,_){for(var S=o._reactName,k=[];u!==null&&u!==m;){var a=u,O=a.alternate,X=a.stateNode;if(O!==null&&O===m)break;a.tag===5&&X!==null&&(a=X,_?(O=ih(u,S),O!=null&&k.unshift(wh(u,O,a))):_||(O=ih(u,S),O!=null&&k.push(wh(u,O,a)))),u=u.return}k.length!==0&&i.push({event:o,listeners:k})}function Gp(){}var Cg=null,kg=null;function ow(i,o){switch(i){case"button":case"input":case"select":case"textarea":return!!o.autoFocus}return!1}function Mg(i,o){return i==="textarea"||i==="option"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var sw=typeof setTimeout=="function"?setTimeout:void 0,GC=typeof clearTimeout=="function"?clearTimeout:void 0;function Ig(i){i.nodeType===1?i.textContent="":i.nodeType===9&&(i=i.body,i!=null&&(i.textContent=""))}function Mc(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break}return i}function aw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}var Ag=0;function ZC(i){return{$$typeof:R_,toString:i,valueOf:i}}var Zp=Math.random().toString(36).slice(2),Vs="__reactFiber$"+Zp,qp="__reactProps$"+Zp,Ic="__reactContainer$"+Zp,lw="__reactEvents$"+Zp;function Ja(i){var o=i[Vs];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Ic]||u[Vs]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=aw(i);i!==null;){if(u=i[Vs])return u;i=aw(i)}return o}i=u,u=i.parentNode}return null}function bh(i){return i=i[Vs]||i[Ic],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Ac(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Je(33))}function Wp(i){return i[qp]||null}function cw(i){var o=i[lw];return o===void 0&&(o=i[lw]=new Set),o}var zg=[],zc=-1;function $s(i){return{current:i}}function Cr(i){0>zc||(i.current=zg[zc],zg[zc]=null,zc--)}function jr(i,o){zc++,zg[zc]=i.current,i.current=o}var Gs={},kn=$s(Gs),ti=$s(!1),Qa=Gs;function Pc(i,o){var u=i.type.contextTypes;if(!u)return Gs;var m=i.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===o)return m.__reactInternalMemoizedMaskedChildContext;var _={},S;for(S in u)_[S]=o[S];return m&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=_),_}function ri(i){return i=i.childContextTypes,i!=null}function Hp(){Cr(ti),Cr(kn)}function uw(i,o,u){if(kn.current!==Gs)throw Error(Je(168));jr(kn,o),jr(ti,u)}function hw(i,o,u){var m=i.stateNode;if(i=o.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var _ in m)if(!(_ in i))throw Error(Je(108,gc(o)||"Unknown",_));return Ir({},u,m)}function Xp(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Gs,Qa=kn.current,jr(kn,i),jr(ti,ti.current),!0}function dw(i,o,u){var m=i.stateNode;if(!m)throw Error(Je(169));u?(i=hw(i,o,Qa),m.__reactInternalMemoizedMergedChildContext=i,Cr(ti),Cr(kn),jr(kn,i)):Cr(ti),jr(ti,u)}var Pg=null,el=null,qC=un.unstable_runWithPriority,Dg=un.unstable_scheduleCallback,Lg=un.unstable_cancelCallback,WC=un.unstable_shouldYield,pw=un.unstable_requestPaint,Og=un.unstable_now,HC=un.unstable_getCurrentPriorityLevel,Yp=un.unstable_ImmediatePriority,fw=un.unstable_UserBlockingPriority,mw=un.unstable_NormalPriority,_w=un.unstable_LowPriority,gw=un.unstable_IdlePriority,Rg={},XC=pw!==void 0?pw:function(){},Wo=null,Kp=null,Bg=!1,yw=Og(),Mn=1e4>yw?Og:function(){return Og()-yw};function Dc(){switch(HC()){case Yp:return 99;case fw:return 98;case mw:return 97;case _w:return 96;case gw:return 95;default:throw Error(Je(332))}}function vw(i){switch(i){case 99:return Yp;case 98:return fw;case 97:return mw;case 96:return _w;case 95:return gw;default:throw Error(Je(332))}}function tl(i,o){return i=vw(i),qC(i,o)}function Th(i,o,u){return i=vw(i),Dg(i,o,u)}function So(){if(Kp!==null){var i=Kp;Kp=null,Lg(i)}xw()}function xw(){if(!Bg&&Wo!==null){Bg=!0;var i=0;try{var o=Wo;tl(99,function(){for(;i<o.length;i++){var u=o[i];do u=u(!0);while(u!==null)}}),Wo=null}catch(u){throw Wo!==null&&(Wo=Wo.slice(i+1)),Dg(Yp,So),u}finally{Bg=!1}}}var YC=Ha.ReactCurrentBatchConfig;function Ji(i,o){if(i&&i.defaultProps){o=Ir({},o),i=i.defaultProps;for(var u in i)o[u]===void 0&&(o[u]=i[u]);return o}return o}var Jp=$s(null),Qp=null,Lc=null,ef=null;function Fg(){ef=Lc=Qp=null}function Ug(i){var o=Jp.current;Cr(Jp),i.type._context._currentValue=o}function ww(i,o){for(;i!==null;){var u=i.alternate;if((i.childLanes&o)===o){if(u===null||(u.childLanes&o)===o)break;u.childLanes|=o}else i.childLanes|=o,u!==null&&(u.childLanes|=o);i=i.return}}function Oc(i,o){Qp=i,ef=Lc=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!=0&&(Qi=!0),i.firstContext=null)}function Di(i,o){if(ef!==i&&o!==!1&&o!==0)if((typeof o!="number"||o===1073741823)&&(ef=i,o=1073741823),o={context:i,observedBits:o,next:null},Lc===null){if(Qp===null)throw Error(Je(308));Lc=o,Qp.dependencies={lanes:0,firstContext:o,responders:null}}else Lc=Lc.next=o;return i._currentValue}var Zs=!1;function Ng(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function bw(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function qs(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Ws(i,o){if(i=i.updateQueue,i!==null){i=i.shared;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}}function Tw(i,o){var u=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var _=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var k={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};S===null?_=S=k:S=S.next=k,u=u.next}while(u!==null);S===null?_=S=o:S=S.next=o}else _=S=o;u={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:S,shared:m.shared,effects:m.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}function Sh(i,o,u,m){var _=i.updateQueue;Zs=!1;var S=_.firstBaseUpdate,k=_.lastBaseUpdate,a=_.shared.pending;if(a!==null){_.shared.pending=null;var O=a,X=O.next;O.next=null,k===null?S=X:k.next=X,k=O;var xe=i.alternate;if(xe!==null){xe=xe.updateQueue;var ce=xe.lastBaseUpdate;ce!==k&&(ce===null?xe.firstBaseUpdate=X:ce.next=X,xe.lastBaseUpdate=O)}}if(S!==null){ce=_.baseState,k=0,xe=X=O=null;do{a=S.lane;var he=S.eventTime;if((m&a)===a){xe!==null&&(xe=xe.next={eventTime:he,lane:0,tag:S.tag,payload:S.payload,callback:S.callback,next:null});e:{var se=i,De=S;switch(a=o,he=u,De.tag){case 1:if(se=De.payload,typeof se=="function"){ce=se.call(he,ce,a);break e}ce=se;break e;case 3:se.flags=se.flags&-4097|64;case 0:if(se=De.payload,a=typeof se=="function"?se.call(he,ce,a):se,a==null)break e;ce=Ir({},ce,a);break e;case 2:Zs=!0}}S.callback!==null&&(i.flags|=32,a=_.effects,a===null?_.effects=[S]:a.push(S))}else he={eventTime:he,lane:a,tag:S.tag,payload:S.payload,callback:S.callback,next:null},xe===null?(X=xe=he,O=ce):xe=xe.next=he,k|=a;if(S=S.next,S===null){if(a=_.shared.pending,a===null)break;S=a.next,a.next=null,_.lastBaseUpdate=a,_.shared.pending=null}}while(1);xe===null&&(O=ce),_.baseState=O,_.firstBaseUpdate=X,_.lastBaseUpdate=xe,Rh|=k,i.lanes=k,i.memoizedState=ce}}function Sw(i,o,u){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var m=i[o],_=m.callback;if(_!==null){if(m.callback=null,m=u,typeof _!="function")throw Error(Je(191,_));_.call(m)}}}var Ew=new bp.Component().refs;function tf(i,o,u,m){o=i.memoizedState,u=u(m,o),u=u==null?o:Ir({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var rf={isMounted:function(i){return(i=i._reactInternals)?Ka(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var m=yi(),_=Ys(i),S=qs(m,_);S.payload=o,u!=null&&(S.callback=u),Ws(i,S),Ks(i,_,m)},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var m=yi(),_=Ys(i),S=qs(m,_);S.tag=1,S.payload=o,u!=null&&(S.callback=u),Ws(i,S),Ks(i,_,m)},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=yi(),m=Ys(i),_=qs(u,m);_.tag=2,o!=null&&(_.callback=o),Ws(i,_),Ks(i,m,u)}};function Cw(i,o,u,m,_,S,k){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,S,k):o.prototype&&o.prototype.isPureReactComponent?!yh(u,m)||!yh(_,S):!0}function kw(i,o,u){var m=!1,_=Gs,S=o.contextType;return typeof S=="object"&&S!==null?S=Di(S):(_=ri(o)?Qa:kn.current,m=o.contextTypes,S=(m=m!=null)?Pc(i,_):Gs),o=new o(u,S),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=rf,i.stateNode=o,o._reactInternals=i,m&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=S),o}function Mw(i,o,u,m){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,m),o.state!==i&&rf.enqueueReplaceState(o,o.state,null)}function jg(i,o,u,m){var _=i.stateNode;_.props=u,_.state=i.memoizedState,_.refs=Ew,Ng(i);var S=o.contextType;typeof S=="object"&&S!==null?_.context=Di(S):(S=ri(o)?Qa:kn.current,_.context=Pc(i,S)),Sh(i,u,_,m),_.state=i.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(tf(i,o,S,u),_.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&rf.enqueueReplaceState(_,_.state,null),Sh(i,u,_,m),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4)}var nf=Array.isArray;function Eh(i,o,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(Je(309));var m=u.stateNode}if(!m)throw Error(Je(147,i));var _=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===_?o.ref:(o=function(S){var k=m.refs;k===Ew&&(k=m.refs={}),S===null?delete k[_]:k[_]=S},o._stringRef=_,o)}if(typeof i!="string")throw Error(Je(284));if(!u._owner)throw Error(Je(290,i))}return i}function of(i,o){if(i.type!=="textarea")throw Error(Je(31,Object.prototype.toString.call(o)==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":o))}function Iw(i){function o(ne,Y){if(i){var Q=ne.lastEffect;Q!==null?(Q.nextEffect=Y,ne.lastEffect=Y):ne.firstEffect=ne.lastEffect=Y,Y.nextEffect=null,Y.flags=8}}function u(ne,Y){if(!i)return null;for(;Y!==null;)o(ne,Y),Y=Y.sibling;return null}function m(ne,Y){for(ne=new Map;Y!==null;)Y.key!==null?ne.set(Y.key,Y):ne.set(Y.index,Y),Y=Y.sibling;return ne}function _(ne,Y){return ne=ea(ne,Y),ne.index=0,ne.sibling=null,ne}function S(ne,Y,Q){return ne.index=Q,i?(Q=ne.alternate,Q!==null?(Q=Q.index,Q<Y?(ne.flags=2,Y):Q):(ne.flags=2,Y)):Y}function k(ne){return i&&ne.alternate===null&&(ne.flags=2),ne}function a(ne,Y,Q,ge){return Y===null||Y.tag!==6?(Y=Ty(Q,ne.mode,ge),Y.return=ne,Y):(Y=_(Y,Q),Y.return=ne,Y)}function O(ne,Y,Q,ge){return Y!==null&&Y.elementType===Q.type?(ge=_(Y,Q.props),ge.ref=Eh(ne,Y,Q),ge.return=ne,ge):(ge=Tf(Q.type,Q.key,Q.props,null,ne.mode,ge),ge.ref=Eh(ne,Y,Q),ge.return=ne,ge)}function X(ne,Y,Q,ge){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==Q.containerInfo||Y.stateNode.implementation!==Q.implementation?(Y=Sy(Q,ne.mode,ge),Y.return=ne,Y):(Y=_(Y,Q.children||[]),Y.return=ne,Y)}function xe(ne,Y,Q,ge,we){return Y===null||Y.tag!==7?(Y=$c(Q,ne.mode,ge,we),Y.return=ne,Y):(Y=_(Y,Q),Y.return=ne,Y)}function ce(ne,Y,Q){if(typeof Y=="string"||typeof Y=="number")return Y=Ty(""+Y,ne.mode,Q),Y.return=ne,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case Ku:return Q=Tf(Y.type,Y.key,Y.props,null,ne.mode,Q),Q.ref=Eh(ne,null,Y),Q.return=ne,Q;case Xa:return Y=Sy(Y,ne.mode,Q),Y.return=ne,Y}if(nf(Y)||eh(Y))return Y=$c(Y,ne.mode,Q,null),Y.return=ne,Y;of(ne,Y)}return null}function he(ne,Y,Q,ge){var we=Y!==null?Y.key:null;if(typeof Q=="string"||typeof Q=="number")return we!==null?null:a(ne,Y,""+Q,ge);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Ku:return Q.key===we?Q.type===Os?xe(ne,Y,Q.props.children,ge,we):O(ne,Y,Q,ge):null;case Xa:return Q.key===we?X(ne,Y,Q,ge):null}if(nf(Q)||eh(Q))return we!==null?null:xe(ne,Y,Q,ge,null);of(ne,Q)}return null}function se(ne,Y,Q,ge,we){if(typeof ge=="string"||typeof ge=="number")return ne=ne.get(Q)||null,a(Y,ne,""+ge,we);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case Ku:return ne=ne.get(ge.key===null?Q:ge.key)||null,ge.type===Os?xe(Y,ne,ge.props.children,we,ge.key):O(Y,ne,ge,we);case Xa:return ne=ne.get(ge.key===null?Q:ge.key)||null,X(Y,ne,ge,we)}if(nf(ge)||eh(ge))return ne=ne.get(Q)||null,xe(Y,ne,ge,we,null);of(Y,ge)}return null}function De(ne,Y,Q,ge){for(var we=null,He=null,Ee=Y,Qe=Y=0,Ve=null;Ee!==null&&Qe<Q.length;Qe++){Ee.index>Qe?(Ve=Ee,Ee=null):Ve=Ee.sibling;var Fe=he(ne,Ee,Q[Qe],ge);if(Fe===null){Ee===null&&(Ee=Ve);break}i&&Ee&&Fe.alternate===null&&o(ne,Ee),Y=S(Fe,Y,Qe),He===null?we=Fe:He.sibling=Fe,He=Fe,Ee=Ve}if(Qe===Q.length)return u(ne,Ee),we;if(Ee===null){for(;Qe<Q.length;Qe++)Ee=ce(ne,Q[Qe],ge),Ee!==null&&(Y=S(Ee,Y,Qe),He===null?we=Ee:He.sibling=Ee,He=Ee);return we}for(Ee=m(ne,Ee);Qe<Q.length;Qe++)Ve=se(Ee,ne,Qe,Q[Qe],ge),Ve!==null&&(i&&Ve.alternate!==null&&Ee.delete(Ve.key===null?Qe:Ve.key),Y=S(Ve,Y,Qe),He===null?we=Ve:He.sibling=Ve,He=Ve);return i&&Ee.forEach(function(nt){return o(ne,nt)}),we}function Te(ne,Y,Q,ge){var we=eh(Q);if(typeof we!="function")throw Error(Je(150));if(Q=we.call(Q),Q==null)throw Error(Je(151));for(var He=we=null,Ee=Y,Qe=Y=0,Ve=null,Fe=Q.next();Ee!==null&&!Fe.done;Qe++,Fe=Q.next()){Ee.index>Qe?(Ve=Ee,Ee=null):Ve=Ee.sibling;var nt=he(ne,Ee,Fe.value,ge);if(nt===null){Ee===null&&(Ee=Ve);break}i&&Ee&&nt.alternate===null&&o(ne,Ee),Y=S(nt,Y,Qe),He===null?we=nt:He.sibling=nt,He=nt,Ee=Ve}if(Fe.done)return u(ne,Ee),we;if(Ee===null){for(;!Fe.done;Qe++,Fe=Q.next())Fe=ce(ne,Fe.value,ge),Fe!==null&&(Y=S(Fe,Y,Qe),He===null?we=Fe:He.sibling=Fe,He=Fe);return we}for(Ee=m(ne,Ee);!Fe.done;Qe++,Fe=Q.next())Fe=se(Ee,ne,Qe,Fe.value,ge),Fe!==null&&(i&&Fe.alternate!==null&&Ee.delete(Fe.key===null?Qe:Fe.key),Y=S(Fe,Y,Qe),He===null?we=Fe:He.sibling=Fe,He=Fe);return i&&Ee.forEach(function(bt){return o(ne,bt)}),we}return function(ne,Y,Q,ge){var we=typeof Q=="object"&&Q!==null&&Q.type===Os&&Q.key===null;we&&(Q=Q.props.children);var He=typeof Q=="object"&&Q!==null;if(He)switch(Q.$$typeof){case Ku:e:{for(He=Q.key,we=Y;we!==null;){if(we.key===He){switch(we.tag){case 7:if(Q.type===Os){u(ne,we.sibling),Y=_(we,Q.props.children),Y.return=ne,ne=Y;break e}break;default:if(we.elementType===Q.type){u(ne,we.sibling),Y=_(we,Q.props),Y.ref=Eh(ne,we,Q),Y.return=ne,ne=Y;break e}}u(ne,we);break}else o(ne,we);we=we.sibling}Q.type===Os?(Y=$c(Q.props.children,ne.mode,ge,Q.key),Y.return=ne,ne=Y):(ge=Tf(Q.type,Q.key,Q.props,null,ne.mode,ge),ge.ref=Eh(ne,Y,Q),ge.return=ne,ne=ge)}return k(ne);case Xa:e:{for(we=Q.key;Y!==null;){if(Y.key===we)if(Y.tag===4&&Y.stateNode.containerInfo===Q.containerInfo&&Y.stateNode.implementation===Q.implementation){u(ne,Y.sibling),Y=_(Y,Q.children||[]),Y.return=ne,ne=Y;break e}else{u(ne,Y);break}else o(ne,Y);Y=Y.sibling}Y=Sy(Q,ne.mode,ge),Y.return=ne,ne=Y}return k(ne)}if(typeof Q=="string"||typeof Q=="number")return Q=""+Q,Y!==null&&Y.tag===6?(u(ne,Y.sibling),Y=_(Y,Q),Y.return=ne,ne=Y):(u(ne,Y),Y=Ty(Q,ne.mode,ge),Y.return=ne,ne=Y),k(ne);if(nf(Q))return De(ne,Y,Q,ge);if(eh(Q))return Te(ne,Y,Q,ge);if(He&&of(ne,Q),typeof Q=="undefined"&&!we)switch(ne.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Je(152,gc(ne.type)||"Component"))}return u(ne,Y)}}var sf=Iw(!0),Aw=Iw(!1),Ch={},Eo=$s(Ch),kh=$s(Ch),Mh=$s(Ch);function rl(i){if(i===Ch)throw Error(Je(174));return i}function Vg(i,o){switch(jr(Mh,o),jr(kh,i),jr(Eo,Ch),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:W_(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=W_(o,i)}Cr(Eo),jr(Eo,o)}function Rc(){Cr(Eo),Cr(kh),Cr(Mh)}function zw(i){rl(Mh.current);var o=rl(Eo.current),u=W_(o,i.type);o!==u&&(jr(kh,i),jr(Eo,u))}function $g(i){kh.current===i&&(Cr(Eo),Cr(kh))}var Vr=$s(0);function af(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&64)!=0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ho=null,Hs=null,Co=!1;function Pw(i,o){var u=Ri(5,null,null,0);u.elementType="DELETED",u.type="DELETED",u.stateNode=o,u.return=i,u.flags=8,i.lastEffect!==null?(i.lastEffect.nextEffect=u,i.lastEffect=u):i.firstEffect=i.lastEffect=u}function Dw(i,o){switch(i.tag){case 5:var u=i.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,!0):!1;case 13:return!1;default:return!1}}function Gg(i){if(Co){var o=Hs;if(o){var u=o;if(!Dw(i,o)){if(o=Mc(u.nextSibling),!o||!Dw(i,o)){i.flags=i.flags&-1025|2,Co=!1,Ho=i;return}Pw(Ho,u)}Ho=i,Hs=Mc(o.firstChild)}else i.flags=i.flags&-1025|2,Co=!1,Ho=i}}function Lw(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Ho=i}function lf(i){if(i!==Ho)return!1;if(!Co)return Lw(i),Co=!0,!1;var o=i.type;if(i.tag!==5||o!=="head"&&o!=="body"&&!Mg(o,i.memoizedProps))for(o=Hs;o;)Pw(i,o),o=Mc(o.nextSibling);if(Lw(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Je(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(o===0){Hs=Mc(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}i=i.nextSibling}Hs=null}}else Hs=Ho?Mc(i.stateNode.nextSibling):null;return!0}function Zg(){Hs=Ho=null,Co=!1}var Bc=[];function qg(){for(var i=0;i<Bc.length;i++)Bc[i]._workInProgressVersionPrimary=null;Bc.length=0}var Ih=Ha.ReactCurrentDispatcher,Li=Ha.ReactCurrentBatchConfig,Ah=0,qr=null,In=null,yn=null,cf=!1,zh=!1;function ni(){throw Error(Je(321))}function Wg(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!Pi(i[u],o[u]))return!1;return!0}function Hg(i,o,u,m,_,S){if(Ah=S,qr=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ih.current=i===null||i.memoizedState===null?JC:QC,i=u(m,_),zh){S=0;do{if(zh=!1,!(25>S))throw Error(Je(301));S+=1,yn=In=null,o.updateQueue=null,Ih.current=ek,i=u(m,_)}while(zh)}if(Ih.current=pf,o=In!==null&&In.next!==null,Ah=0,yn=In=qr=null,cf=!1,o)throw Error(Je(300));return i}function nl(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?qr.memoizedState=yn=i:yn=yn.next=i,yn}function il(){if(In===null){var i=qr.alternate;i=i!==null?i.memoizedState:null}else i=In.next;var o=yn===null?qr.memoizedState:yn.next;if(o!==null)yn=o,In=i;else{if(i===null)throw Error(Je(310));In=i,i={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},yn===null?qr.memoizedState=yn=i:yn=yn.next=i}return yn}function ko(i,o){return typeof o=="function"?o(i):o}function Ph(i){var o=il(),u=o.queue;if(u===null)throw Error(Je(311));u.lastRenderedReducer=i;var m=In,_=m.baseQueue,S=u.pending;if(S!==null){if(_!==null){var k=_.next;_.next=S.next,S.next=k}m.baseQueue=_=S,u.pending=null}if(_!==null){_=_.next,m=m.baseState;var a=k=S=null,O=_;do{var X=O.lane;if((Ah&X)===X)a!==null&&(a=a.next={lane:0,action:O.action,eagerReducer:O.eagerReducer,eagerState:O.eagerState,next:null}),m=O.eagerReducer===i?O.eagerState:i(m,O.action);else{var xe={lane:X,action:O.action,eagerReducer:O.eagerReducer,eagerState:O.eagerState,next:null};a===null?(k=a=xe,S=m):a=a.next=xe,qr.lanes|=X,Rh|=X}O=O.next}while(O!==null&&O!==_);a===null?S=m:a.next=k,Pi(m,o.memoizedState)||(Qi=!0),o.memoizedState=m,o.baseState=S,o.baseQueue=a,u.lastRenderedState=m}return[o.memoizedState,u.dispatch]}function Dh(i){var o=il(),u=o.queue;if(u===null)throw Error(Je(311));u.lastRenderedReducer=i;var m=u.dispatch,_=u.pending,S=o.memoizedState;if(_!==null){u.pending=null;var k=_=_.next;do S=i(S,k.action),k=k.next;while(k!==_);Pi(S,o.memoizedState)||(Qi=!0),o.memoizedState=S,o.baseQueue===null&&(o.baseState=S),u.lastRenderedState=S}return[S,m]}function Ow(i,o,u){var m=o._getVersion;m=m(o._source);var _=o._workInProgressVersionPrimary;if(_!==null?i=_===m:(i=i.mutableReadLanes,(i=(Ah&i)===i)&&(o._workInProgressVersionPrimary=m,Bc.push(o))),i)return u(o._source);throw Bc.push(o),Error(Je(350))}function Rw(i,o,u,m){var _=Nn;if(_===null)throw Error(Je(349));var S=o._getVersion,k=S(o._source),a=Ih.current,O=a.useState(function(){return Ow(_,o,u)}),X=O[1],xe=O[0];O=yn;var ce=i.memoizedState,he=ce.refs,se=he.getSnapshot,De=ce.source;ce=ce.subscribe;var Te=qr;return i.memoizedState={refs:he,source:o,subscribe:m},a.useEffect(function(){he.getSnapshot=u,he.setSnapshot=X;var ne=S(o._source);if(!Pi(k,ne)){ne=u(o._source),Pi(xe,ne)||(X(ne),ne=Ys(Te),_.mutableReadLanes|=ne&_.pendingLanes),ne=_.mutableReadLanes,_.entangledLanes|=ne;for(var Y=_.entanglements,Q=ne;0<Q;){var ge=31-Ns(Q),we=1<<ge;Y[ge]|=ne,Q&=~we}}},[u,o,m]),a.useEffect(function(){return m(o._source,function(){var ne=he.getSnapshot,Y=he.setSnapshot;try{Y(ne(o._source));var Q=Ys(Te);_.mutableReadLanes|=Q&_.pendingLanes}catch(ge){Y(function(){throw ge})}})},[o,m]),Pi(se,u)&&Pi(De,o)&&Pi(ce,m)||(i={pending:null,dispatch:null,lastRenderedReducer:ko,lastRenderedState:xe},i.dispatch=X=Jg.bind(null,qr,i),O.queue=i,O.baseQueue=null,xe=Ow(_,o,u),O.memoizedState=O.baseState=xe),xe}function Bw(i,o,u){var m=il();return Rw(m,i,o,u)}function Lh(i){var o=nl();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i=o.queue={pending:null,dispatch:null,lastRenderedReducer:ko,lastRenderedState:i},i=i.dispatch=Jg.bind(null,qr,i),[o.memoizedState,i]}function uf(i,o,u,m){return i={tag:i,create:o,destroy:u,deps:m,next:null},o=qr.updateQueue,o===null?(o={lastEffect:null},qr.updateQueue=o,o.lastEffect=i.next=i):(u=o.lastEffect,u===null?o.lastEffect=i.next=i:(m=u.next,u.next=i,i.next=m,o.lastEffect=i)),i}function Fw(i){var o=nl();return i={current:i},o.memoizedState=i}function hf(){return il().memoizedState}function Xg(i,o,u,m){var _=nl();qr.flags|=i,_.memoizedState=uf(1|o,u,void 0,m===void 0?null:m)}function Yg(i,o,u,m){var _=il();m=m===void 0?null:m;var S=void 0;if(In!==null){var k=In.memoizedState;if(S=k.destroy,m!==null&&Wg(m,k.deps)){uf(o,u,S,m);return}}qr.flags|=i,_.memoizedState=uf(1|o,u,S,m)}function Uw(i,o){return Xg(516,4,i,o)}function df(i,o){return Yg(516,4,i,o)}function Nw(i,o){return Yg(4,2,i,o)}function jw(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Vw(i,o,u){return u=u!=null?u.concat([i]):null,Yg(4,2,jw.bind(null,o,i),u)}function Kg(){}function $w(i,o){var u=il();o=o===void 0?null:o;var m=u.memoizedState;return m!==null&&o!==null&&Wg(o,m[1])?m[0]:(u.memoizedState=[i,o],i)}function Gw(i,o){var u=il();o=o===void 0?null:o;var m=u.memoizedState;return m!==null&&o!==null&&Wg(o,m[1])?m[0]:(i=i(),u.memoizedState=[i,o],i)}function KC(i,o){var u=Dc();tl(98>u?98:u,function(){i(!0)}),tl(97<u?97:u,function(){var m=Li.transition;Li.transition=1;try{i(!1),o()}finally{Li.transition=m}})}function Jg(i,o,u){var m=yi(),_=Ys(i),S={lane:_,action:u,eagerReducer:null,eagerState:null,next:null},k=o.pending;if(k===null?S.next=S:(S.next=k.next,k.next=S),o.pending=S,k=i.alternate,i===qr||k!==null&&k===qr)zh=cf=!0;else{if(i.lanes===0&&(k===null||k.lanes===0)&&(k=o.lastRenderedReducer,k!==null))try{var a=o.lastRenderedState,O=k(a,u);if(S.eagerReducer=k,S.eagerState=O,Pi(O,a))return}catch{}finally{}Ks(i,_,m)}}var pf={readContext:Di,useCallback:ni,useContext:ni,useEffect:ni,useImperativeHandle:ni,useLayoutEffect:ni,useMemo:ni,useReducer:ni,useRef:ni,useState:ni,useDebugValue:ni,useDeferredValue:ni,useTransition:ni,useMutableSource:ni,useOpaqueIdentifier:ni,unstable_isNewReconciler:!1},JC={readContext:Di,useCallback:function(i,o){return nl().memoizedState=[i,o===void 0?null:o],i},useContext:Di,useEffect:Uw,useImperativeHandle:function(i,o,u){return u=u!=null?u.concat([i]):null,Xg(4,2,jw.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Xg(4,2,i,o)},useMemo:function(i,o){var u=nl();return o=o===void 0?null:o,i=i(),u.memoizedState=[i,o],i},useReducer:function(i,o,u){var m=nl();return o=u!==void 0?u(o):o,m.memoizedState=m.baseState=o,i=m.queue={pending:null,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},i=i.dispatch=Jg.bind(null,qr,i),[m.memoizedState,i]},useRef:Fw,useState:Lh,useDebugValue:Kg,useDeferredValue:function(i){var o=Lh(i),u=o[0],m=o[1];return Uw(function(){var _=Li.transition;Li.transition=1;try{m(i)}finally{Li.transition=_}},[i]),u},useTransition:function(){var i=Lh(!1),o=i[0];return i=KC.bind(null,i[1]),Fw(i),[i,o]},useMutableSource:function(i,o,u){var m=nl();return m.memoizedState={refs:{getSnapshot:o,setSnapshot:null},source:i,subscribe:u},Rw(m,i,o,u)},useOpaqueIdentifier:function(){if(Co){var i=!1,o=ZC(function(){throw i||(i=!0,u("r:"+(Ag++).toString(36))),Error(Je(355))}),u=Lh(o)[1];return(qr.mode&2)==0&&(qr.flags|=516,uf(5,function(){u("r:"+(Ag++).toString(36))},void 0,null)),o}return o="r:"+(Ag++).toString(36),Lh(o),o},unstable_isNewReconciler:!1},QC={readContext:Di,useCallback:$w,useContext:Di,useEffect:df,useImperativeHandle:Vw,useLayoutEffect:Nw,useMemo:Gw,useReducer:Ph,useRef:hf,useState:function(){return Ph(ko)},useDebugValue:Kg,useDeferredValue:function(i){var o=Ph(ko),u=o[0],m=o[1];return df(function(){var _=Li.transition;Li.transition=1;try{m(i)}finally{Li.transition=_}},[i]),u},useTransition:function(){var i=Ph(ko)[0];return[hf().current,i]},useMutableSource:Bw,useOpaqueIdentifier:function(){return Ph(ko)[0]},unstable_isNewReconciler:!1},ek={readContext:Di,useCallback:$w,useContext:Di,useEffect:df,useImperativeHandle:Vw,useLayoutEffect:Nw,useMemo:Gw,useReducer:Dh,useRef:hf,useState:function(){return Dh(ko)},useDebugValue:Kg,useDeferredValue:function(i){var o=Dh(ko),u=o[0],m=o[1];return df(function(){var _=Li.transition;Li.transition=1;try{m(i)}finally{Li.transition=_}},[i]),u},useTransition:function(){var i=Dh(ko)[0];return[hf().current,i]},useMutableSource:Bw,useOpaqueIdentifier:function(){return Dh(ko)[0]},unstable_isNewReconciler:!1},tk=Ha.ReactCurrentOwner,Qi=!1;function ii(i,o,u,m){o.child=i===null?Aw(o,null,u,m):sf(o,i.child,u,m)}function Zw(i,o,u,m,_){u=u.render;var S=o.ref;return Oc(o,_),m=Hg(i,o,u,m,S,_),i!==null&&!Qi?(o.updateQueue=i.updateQueue,o.flags&=-517,i.lanes&=~_,Xo(i,o,_)):(o.flags|=1,ii(i,o,m,_),o.child)}function qw(i,o,u,m,_,S){if(i===null){var k=u.type;return typeof k=="function"&&!wy(k)&&k.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=k,Ww(i,o,k,m,_,S)):(i=Tf(u.type,null,m,o,o.mode,S),i.ref=o.ref,i.return=o,o.child=i)}return k=i.child,(_&S)==0&&(_=k.memoizedProps,u=u.compare,u=u!==null?u:yh,u(_,m)&&i.ref===o.ref)?Xo(i,o,S):(o.flags|=1,i=ea(k,m),i.ref=o.ref,i.return=o,o.child=i)}function Ww(i,o,u,m,_,S){if(i!==null&&yh(i.memoizedProps,m)&&i.ref===o.ref)if(Qi=!1,(S&_)!=0)(i.flags&16384)!=0&&(Qi=!0);else return o.lanes=i.lanes,Xo(i,o,S);return ey(i,o,u,m,S)}function Qg(i,o,u){var m=o.pendingProps,_=m.children,S=i!==null?i.memoizedState:null;if(m.mode==="hidden"||m.mode==="unstable-defer-without-hiding")if((o.mode&4)==0)o.memoizedState={baseLanes:0},bf(o,u);else if((u&1073741824)!=0)o.memoizedState={baseLanes:0},bf(o,S!==null?S.baseLanes:u);else return i=S!==null?S.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i},bf(o,i),null;else S!==null?(m=S.baseLanes|u,o.memoizedState=null):m=u,bf(o,m);return ii(i,o,_,u),o.child}function Hw(i,o){var u=o.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(o.flags|=128)}function ey(i,o,u,m,_){var S=ri(u)?Qa:kn.current;return S=Pc(o,S),Oc(o,_),u=Hg(i,o,u,m,S,_),i!==null&&!Qi?(o.updateQueue=i.updateQueue,o.flags&=-517,i.lanes&=~_,Xo(i,o,_)):(o.flags|=1,ii(i,o,u,_),o.child)}function Xw(i,o,u,m,_){if(ri(u)){var S=!0;Xp(o)}else S=!1;if(Oc(o,_),o.stateNode===null)i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2),kw(o,u,m),jg(o,u,m,_),m=!0;else if(i===null){var k=o.stateNode,a=o.memoizedProps;k.props=a;var O=k.context,X=u.contextType;typeof X=="object"&&X!==null?X=Di(X):(X=ri(u)?Qa:kn.current,X=Pc(o,X));var xe=u.getDerivedStateFromProps,ce=typeof xe=="function"||typeof k.getSnapshotBeforeUpdate=="function";ce||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(a!==m||O!==X)&&Mw(o,k,m,X),Zs=!1;var he=o.memoizedState;k.state=he,Sh(o,m,k,_),O=o.memoizedState,a!==m||he!==O||ti.current||Zs?(typeof xe=="function"&&(tf(o,u,xe,m),O=o.memoizedState),(a=Zs||Cw(o,u,a,m,he,O,X))?(ce||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(o.flags|=4)):(typeof k.componentDidMount=="function"&&(o.flags|=4),o.memoizedProps=m,o.memoizedState=O),k.props=m,k.state=O,k.context=X,m=a):(typeof k.componentDidMount=="function"&&(o.flags|=4),m=!1)}else{k=o.stateNode,bw(i,o),a=o.memoizedProps,X=o.type===o.elementType?a:Ji(o.type,a),k.props=X,ce=o.pendingProps,he=k.context,O=u.contextType,typeof O=="object"&&O!==null?O=Di(O):(O=ri(u)?Qa:kn.current,O=Pc(o,O));var se=u.getDerivedStateFromProps;(xe=typeof se=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(a!==ce||he!==O)&&Mw(o,k,m,O),Zs=!1,he=o.memoizedState,k.state=he,Sh(o,m,k,_);var De=o.memoizedState;a!==ce||he!==De||ti.current||Zs?(typeof se=="function"&&(tf(o,u,se,m),De=o.memoizedState),(X=Zs||Cw(o,u,X,m,he,De,O))?(xe||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(m,De,O),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(m,De,O)),typeof k.componentDidUpdate=="function"&&(o.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(o.flags|=256)):(typeof k.componentDidUpdate!="function"||a===i.memoizedProps&&he===i.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&he===i.memoizedState||(o.flags|=256),o.memoizedProps=m,o.memoizedState=De),k.props=m,k.state=De,k.context=O,m=X):(typeof k.componentDidUpdate!="function"||a===i.memoizedProps&&he===i.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&he===i.memoizedState||(o.flags|=256),m=!1)}return ty(i,o,u,m,S,_)}function ty(i,o,u,m,_,S){Hw(i,o);var k=(o.flags&64)!=0;if(!m&&!k)return _&&dw(o,u,!1),Xo(i,o,S);m=o.stateNode,tk.current=o;var a=k&&typeof u.getDerivedStateFromError!="function"?null:m.render();return o.flags|=1,i!==null&&k?(o.child=sf(o,i.child,null,S),o.child=sf(o,null,a,S)):ii(i,o,a,S),o.memoizedState=m.state,_&&dw(o,u,!0),o.child}function Yw(i){var o=i.stateNode;o.pendingContext?uw(i,o.pendingContext,o.pendingContext!==o.context):o.context&&uw(i,o.context,!1),Vg(i,o.containerInfo)}var ff={dehydrated:null,retryLane:0};function Kw(i,o,u){var m=o.pendingProps,_=Vr.current,S=!1,k;return(k=(o.flags&64)!=0)||(k=i!==null&&i.memoizedState===null?!1:(_&2)!=0),k?(S=!0,o.flags&=-65):i!==null&&i.memoizedState===null||m.fallback===void 0||m.unstable_avoidThisFallback===!0||(_|=1),jr(Vr,_&1),i===null?(m.fallback!==void 0&&Gg(o),i=m.children,_=m.fallback,S?(i=Jw(o,i,_,u),o.child.memoizedState={baseLanes:u},o.memoizedState=ff,i):typeof m.unstable_expectedLoadTime=="number"?(i=Jw(o,i,_,u),o.child.memoizedState={baseLanes:u},o.memoizedState=ff,o.lanes=33554432,i):(u=by({mode:"visible",children:i},o.mode,u,null),u.return=o,o.child=u)):i.memoizedState!==null?S?(m=eb(i,o,m.children,m.fallback,u),S=o.child,_=i.child.memoizedState,S.memoizedState=_===null?{baseLanes:u}:{baseLanes:_.baseLanes|u},S.childLanes=i.childLanes&~u,o.memoizedState=ff,m):(u=Qw(i,o,m.children,u),o.memoizedState=null,u):S?(m=eb(i,o,m.children,m.fallback,u),S=o.child,_=i.child.memoizedState,S.memoizedState=_===null?{baseLanes:u}:{baseLanes:_.baseLanes|u},S.childLanes=i.childLanes&~u,o.memoizedState=ff,m):(u=Qw(i,o,m.children,u),o.memoizedState=null,u)}function Jw(i,o,u,m){var _=i.mode,S=i.child;return o={mode:"hidden",children:o},(_&2)==0&&S!==null?(S.childLanes=0,S.pendingProps=o):S=by(o,_,0,null),u=$c(u,_,m,null),S.return=i,u.return=i,S.sibling=u,i.child=S,u}function Qw(i,o,u,m){var _=i.child;return i=_.sibling,u=ea(_,{mode:"visible",children:u}),(o.mode&2)==0&&(u.lanes=m),u.return=o,u.sibling=null,i!==null&&(i.nextEffect=null,i.flags=8,o.firstEffect=o.lastEffect=i),o.child=u}function eb(i,o,u,m,_){var S=o.mode,k=i.child;i=k.sibling;var a={mode:"hidden",children:u};return(S&2)==0&&o.child!==k?(u=o.child,u.childLanes=0,u.pendingProps=a,k=u.lastEffect,k!==null?(o.firstEffect=u.firstEffect,o.lastEffect=k,k.nextEffect=null):o.firstEffect=o.lastEffect=null):u=ea(k,a),i!==null?m=ea(i,m):(m=$c(m,S,_,null),m.flags|=2),m.return=o,u.return=o,u.sibling=m,o.child=u,m}function tb(i,o){i.lanes|=o;var u=i.alternate;u!==null&&(u.lanes|=o),ww(i.return,o)}function ry(i,o,u,m,_,S){var k=i.memoizedState;k===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:_,lastEffect:S}:(k.isBackwards=o,k.rendering=null,k.renderingStartTime=0,k.last=m,k.tail=u,k.tailMode=_,k.lastEffect=S)}function rb(i,o,u){var m=o.pendingProps,_=m.revealOrder,S=m.tail;if(ii(i,o,m.children,u),m=Vr.current,(m&2)!=0)m=m&1|2,o.flags|=64;else{if(i!==null&&(i.flags&64)!=0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&tb(i,u);else if(i.tag===19)tb(i,u);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}m&=1}if(jr(Vr,m),(o.mode&2)==0)o.memoizedState=null;else switch(_){case"forwards":for(u=o.child,_=null;u!==null;)i=u.alternate,i!==null&&af(i)===null&&(_=u),u=u.sibling;u=_,u===null?(_=o.child,o.child=null):(_=u.sibling,u.sibling=null),ry(o,!1,_,u,S,o.lastEffect);break;case"backwards":for(u=null,_=o.child,o.child=null;_!==null;){if(i=_.alternate,i!==null&&af(i)===null){o.child=_;break}i=_.sibling,_.sibling=u,u=_,_=i}ry(o,!0,u,null,S,o.lastEffect);break;case"together":ry(o,!1,null,null,void 0,o.lastEffect);break;default:o.memoizedState=null}return o.child}function Xo(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),Rh|=o.lanes,(u&o.childLanes)!=0){if(i!==null&&o.child!==i.child)throw Error(Je(153));if(o.child!==null){for(i=o.child,u=ea(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=ea(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}return null}var nb,ny,ib,ob;nb=function(i,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};ny=function(){};ib=function(i,o,u,m){var _=i.memoizedProps;if(_!==m){i=o.stateNode,rl(Eo.current);var S=null;switch(u){case"input":_=j_(i,_),m=j_(i,m),S=[];break;case"option":_=G_(i,_),m=G_(i,m),S=[];break;case"select":_=Ir({},_,{value:void 0}),m=Ir({},m,{value:void 0}),S=[];break;case"textarea":_=Z_(i,_),m=Z_(i,m),S=[];break;default:typeof _.onClick!="function"&&typeof m.onClick=="function"&&(i.onclick=Gp)}H_(u,m);var k;u=null;for(X in _)if(!m.hasOwnProperty(X)&&_.hasOwnProperty(X)&&_[X]!=null)if(X==="style"){var a=_[X];for(k in a)a.hasOwnProperty(k)&&(u||(u={}),u[k]="")}else X!=="dangerouslySetInnerHTML"&&X!=="children"&&X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(Yu.hasOwnProperty(X)?S||(S=[]):(S=S||[]).push(X,null));for(X in m){var O=m[X];if(a=_!=null?_[X]:void 0,m.hasOwnProperty(X)&&O!==a&&(O!=null||a!=null))if(X==="style")if(a){for(k in a)!a.hasOwnProperty(k)||O&&O.hasOwnProperty(k)||(u||(u={}),u[k]="");for(k in O)O.hasOwnProperty(k)&&a[k]!==O[k]&&(u||(u={}),u[k]=O[k])}else u||(S||(S=[]),S.push(X,u)),u=O;else X==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,a=a?a.__html:void 0,O!=null&&a!==O&&(S=S||[]).push(X,O)):X==="children"?typeof O!="string"&&typeof O!="number"||(S=S||[]).push(X,""+O):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&(Yu.hasOwnProperty(X)?(O!=null&&X==="onScroll"&&Er("scroll",i),S||a===O||(S=[])):typeof O=="object"&&O!==null&&O.$$typeof===R_?O.toString():(S=S||[]).push(X,O))}u&&(S=S||[]).push("style",u);var X=S;(o.updateQueue=X)&&(o.flags|=4)}};ob=function(i,o,u,m){u!==m&&(o.flags|=4)};function Oh(i,o){if(!Co)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function rk(i,o,u){var m=o.pendingProps;switch(o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ri(o.type)&&Hp(),null;case 3:return Rc(),Cr(ti),Cr(kn),qg(),m=o.stateNode,m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(i===null||i.child===null)&&(lf(o)?o.flags|=4:m.hydrate||(o.flags|=256)),ny(o),null;case 5:$g(o);var _=rl(Mh.current);if(u=o.type,i!==null&&o.stateNode!=null)ib(i,o,u,m,_),i.ref!==o.ref&&(o.flags|=128);else{if(!m){if(o.stateNode===null)throw Error(Je(166));return null}if(i=rl(Eo.current),lf(o)){m=o.stateNode,u=o.type;var S=o.memoizedProps;switch(m[Vs]=o,m[qp]=S,u){case"dialog":Er("cancel",m),Er("close",m);break;case"iframe":case"object":case"embed":Er("load",m);break;case"video":case"audio":for(i=0;i<xh.length;i++)Er(xh[i],m);break;case"source":Er("error",m);break;case"img":case"image":case"link":Er("error",m),Er("load",m);break;case"details":Er("toggle",m);break;case"input":Xx(m,S),Er("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!S.multiple},Er("invalid",m);break;case"textarea":Jx(m,S),Er("invalid",m)}H_(u,S),i=null;for(var k in S)S.hasOwnProperty(k)&&(_=S[k],k==="children"?typeof _=="string"?m.textContent!==_&&(i=["children",_]):typeof _=="number"&&m.textContent!==""+_&&(i=["children",""+_]):Yu.hasOwnProperty(k)&&_!=null&&k==="onScroll"&&Er("scroll",m));switch(u){case"input":kp(m),Kx(m,S,!0);break;case"textarea":kp(m),e1(m);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(m.onclick=Gp)}m=i,o.updateQueue=m,m!==null&&(o.flags|=4)}else{switch(k=_.nodeType===9?_:_.ownerDocument,i===q_.html&&(i=t1(u)),i===q_.html?u==="script"?(i=k.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof m.is=="string"?i=k.createElement(u,{is:m.is}):(i=k.createElement(u),u==="select"&&(k=i,m.multiple?k.multiple=!0:m.size&&(k.size=m.size))):i=k.createElementNS(i,u),i[Vs]=o,i[qp]=m,nb(i,o,!1,!1),o.stateNode=i,k=X_(u,m),u){case"dialog":Er("cancel",i),Er("close",i),_=m;break;case"iframe":case"object":case"embed":Er("load",i),_=m;break;case"video":case"audio":for(_=0;_<xh.length;_++)Er(xh[_],i);_=m;break;case"source":Er("error",i),_=m;break;case"img":case"image":case"link":Er("error",i),Er("load",i),_=m;break;case"details":Er("toggle",i),_=m;break;case"input":Xx(i,m),_=j_(i,m),Er("invalid",i);break;case"option":_=G_(i,m);break;case"select":i._wrapperState={wasMultiple:!!m.multiple},_=Ir({},m,{value:void 0}),Er("invalid",i);break;case"textarea":Jx(i,m),_=Z_(i,m),Er("invalid",i);break;default:_=m}H_(u,_);var a=_;for(S in a)if(a.hasOwnProperty(S)){var O=a[S];S==="style"?i1(i,O):S==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,O!=null&&r1(i,O)):S==="children"?typeof O=="string"?(u!=="textarea"||O!=="")&&rh(i,O):typeof O=="number"&&rh(i,""+O):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(Yu.hasOwnProperty(S)?O!=null&&S==="onScroll"&&Er("scroll",i):O!=null&&A_(i,S,O,k))}switch(u){case"input":kp(i),Kx(i,m,!1);break;case"textarea":kp(i),e1(i);break;case"option":m.value!=null&&i.setAttribute("value",""+Rs(m.value));break;case"select":i.multiple=!!m.multiple,S=m.value,S!=null?yc(i,!!m.multiple,S,!1):m.defaultValue!=null&&yc(i,!!m.multiple,m.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=Gp)}ow(u,m)&&(o.flags|=4)}o.ref!==null&&(o.flags|=128)}return null;case 6:if(i&&o.stateNode!=null)ob(i,o,i.memoizedProps,m);else{if(typeof m!="string"&&o.stateNode===null)throw Error(Je(166));u=rl(Mh.current),rl(Eo.current),lf(o)?(m=o.stateNode,u=o.memoizedProps,m[Vs]=o,m.nodeValue!==u&&(o.flags|=4)):(m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[Vs]=o,o.stateNode=m)}return null;case 13:return Cr(Vr),m=o.memoizedState,(o.flags&64)!=0?(o.lanes=u,o):(m=m!==null,u=!1,i===null?o.memoizedProps.fallback!==void 0&&lf(o):u=i.memoizedState!==null,m&&!u&&(o.mode&2)!=0&&(i===null&&o.memoizedProps.unstable_avoidThisFallback!==!0||(Vr.current&1)!=0?vn===0&&(vn=3):((vn===0||vn===3)&&(vn=4),Nn===null||(Rh&134217727)==0&&(Uc&134217727)==0||jc(Nn,An))),(m||u)&&(o.flags|=4),null);case 4:return Rc(),ny(o),i===null&&ew(o.stateNode.containerInfo),null;case 10:return Ug(o),null;case 17:return ri(o.type)&&Hp(),null;case 19:if(Cr(Vr),m=o.memoizedState,m===null)return null;if(S=(o.flags&64)!=0,k=m.rendering,k===null)if(S)Oh(m,!1);else{if(vn!==0||i!==null&&(i.flags&64)!=0)for(i=o.child;i!==null;){if(k=af(i),k!==null){for(o.flags|=64,Oh(m,!1),S=k.updateQueue,S!==null&&(o.updateQueue=S,o.flags|=4),m.lastEffect===null&&(o.firstEffect=null),o.lastEffect=m.lastEffect,m=u,u=o.child;u!==null;)S=u,i=m,S.flags&=2,S.nextEffect=null,S.firstEffect=null,S.lastEffect=null,k=S.alternate,k===null?(S.childLanes=0,S.lanes=i,S.child=null,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=k.childLanes,S.lanes=k.lanes,S.child=k.child,S.memoizedProps=k.memoizedProps,S.memoizedState=k.memoizedState,S.updateQueue=k.updateQueue,S.type=k.type,i=k.dependencies,S.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return jr(Vr,Vr.current&1|2),o.child}i=i.sibling}m.tail!==null&&Mn()>fy&&(o.flags|=64,S=!0,Oh(m,!1),o.lanes=33554432)}else{if(!S)if(i=af(k),i!==null){if(o.flags|=64,S=!0,u=i.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Oh(m,!0),m.tail===null&&m.tailMode==="hidden"&&!k.alternate&&!Co)return o=o.lastEffect=m.lastEffect,o!==null&&(o.nextEffect=null),null}else 2*Mn()-m.renderingStartTime>fy&&u!==1073741824&&(o.flags|=64,S=!0,Oh(m,!1),o.lanes=33554432);m.isBackwards?(k.sibling=o.child,o.child=k):(u=m.last,u!==null?u.sibling=k:o.child=k,m.last=k)}return m.tail!==null?(u=m.tail,m.rendering=u,m.tail=u.sibling,m.lastEffect=o.lastEffect,m.renderingStartTime=Mn(),u.sibling=null,o=Vr.current,jr(Vr,S?o&1|2:o&1),u):null;case 23:case 24:return xy(),i!==null&&i.memoizedState!==null!=(o.memoizedState!==null)&&m.mode!=="unstable-defer-without-hiding"&&(o.flags|=4),null}throw Error(Je(156,o.tag))}function nk(i){switch(i.tag){case 1:ri(i.type)&&Hp();var o=i.flags;return o&4096?(i.flags=o&-4097|64,i):null;case 3:if(Rc(),Cr(ti),Cr(kn),qg(),o=i.flags,(o&64)!=0)throw Error(Je(285));return i.flags=o&-4097|64,i;case 5:return $g(i),null;case 13:return Cr(Vr),o=i.flags,o&4096?(i.flags=o&-4097|64,i):null;case 19:return Cr(Vr),null;case 4:return Rc(),null;case 10:return Ug(i),null;case 23:case 24:return xy(),null;default:return null}}function iy(i,o){try{var u="",m=o;do u+=BE(m),m=m.return;while(m);var _=u}catch(S){_=`
Error generating stack: `+S.message+`
`+S.stack}return{value:i,source:o,stack:_}}function oy(i,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var ik=typeof WeakMap=="function"?WeakMap:Map;function sb(i,o,u){u=qs(-1,u),u.tag=3,u.payload={element:null};var m=o.value;return u.callback=function(){gf||(gf=!0,my=m),oy(i,o)},u}function ab(i,o,u){u=qs(-1,u),u.tag=3;var m=i.type.getDerivedStateFromError;if(typeof m=="function"){var _=o.value;u.payload=function(){return oy(i,o),m(_)}}var S=i.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(u.callback=function(){typeof m!="function"&&(Mo===null?Mo=new Set([this]):Mo.add(this),oy(i,o));var k=o.stack;this.componentDidCatch(o.value,{componentStack:k!==null?k:""})}),u}var ok=typeof WeakSet=="function"?WeakSet:Set;function lb(i){var o=i.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(u){Qs(i,u)}else o.current=null}function sk(i,o){switch(o.tag){case 0:case 11:case 15:case 22:return;case 1:if(o.flags&256&&i!==null){var u=i.memoizedProps,m=i.memoizedState;i=o.stateNode,o=i.getSnapshotBeforeUpdate(o.elementType===o.type?u:Ji(o.type,u),m),i.__reactInternalSnapshotBeforeUpdate=o}return;case 3:o.flags&256&&Ig(o.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(Je(163))}function ak(i,o,u){switch(u.tag){case 0:case 11:case 15:case 22:if(o=u.updateQueue,o=o!==null?o.lastEffect:null,o!==null){i=o=o.next;do{if((i.tag&3)==3){var m=i.create;i.destroy=m()}i=i.next}while(i!==o)}if(o=u.updateQueue,o=o!==null?o.lastEffect:null,o!==null){i=o=o.next;do{var _=i;m=_.next,_=_.tag,(_&4)!=0&&(_&1)!=0&&(Tb(u,i),mk(u,i)),i=m}while(i!==o)}return;case 1:i=u.stateNode,u.flags&4&&(o===null?i.componentDidMount():(m=u.elementType===u.type?o.memoizedProps:Ji(u.type,o.memoizedProps),i.componentDidUpdate(m,o.memoizedState,i.__reactInternalSnapshotBeforeUpdate))),o=u.updateQueue,o!==null&&Sw(u,o,i);return;case 3:if(o=u.updateQueue,o!==null){if(i=null,u.child!==null)switch(u.child.tag){case 5:i=u.child.stateNode;break;case 1:i=u.child.stateNode}Sw(u,o,i)}return;case 5:i=u.stateNode,o===null&&u.flags&4&&ow(u.type,u.memoizedProps)&&i.focus();return;case 6:return;case 4:return;case 12:return;case 13:u.memoizedState===null&&(u=u.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&x1(u))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Je(163))}function cb(i,o){for(var u=i;;){if(u.tag===5){var m=u.stateNode;if(o)m=m.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{m=u.stateNode;var _=u.memoizedProps.style;_=_!=null&&_.hasOwnProperty("display")?_.display:null,m.style.display=n1("display",_)}}else if(u.tag===6)u.stateNode.nodeValue=o?"":u.memoizedProps;else if((u.tag!==23&&u.tag!==24||u.memoizedState===null||u===i)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}}function ub(i,o){if(el&&typeof el.onCommitFiberUnmount=="function")try{el.onCommitFiberUnmount(Pg,o)}catch{}switch(o.tag){case 0:case 11:case 14:case 15:case 22:if(i=o.updateQueue,i!==null&&(i=i.lastEffect,i!==null)){var u=i=i.next;do{var m=u,_=m.destroy;if(m=m.tag,_!==void 0)if((m&4)!=0)Tb(o,u);else{m=o;try{_()}catch(S){Qs(m,S)}}u=u.next}while(u!==i)}break;case 1:if(lb(o),i=o.stateNode,typeof i.componentWillUnmount=="function")try{i.props=o.memoizedProps,i.state=o.memoizedState,i.componentWillUnmount()}catch(S){Qs(o,S)}break;case 5:lb(o);break;case 4:fb(i,o)}}function hb(i){i.alternate=null,i.child=null,i.dependencies=null,i.firstEffect=null,i.lastEffect=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.return=null,i.updateQueue=null}function db(i){return i.tag===5||i.tag===3||i.tag===4}function pb(i){e:{for(var o=i.return;o!==null;){if(db(o))break e;o=o.return}throw Error(Je(160))}var u=o;switch(o=u.stateNode,u.tag){case 5:var m=!1;break;case 3:o=o.containerInfo,m=!0;break;case 4:o=o.containerInfo,m=!0;break;default:throw Error(Je(161))}u.flags&16&&(rh(o,""),u.flags&=-17);e:t:for(u=i;;){for(;u.sibling===null;){if(u.return===null||db(u.return)){u=null;break e}u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue t;u.child.return=u,u=u.child}if(!(u.flags&2)){u=u.stateNode;break e}}m?sy(i,u,o):ay(i,u,o)}function sy(i,o,u){var m=i.tag,_=m===5||m===6;if(_)i=_?i.stateNode:i.stateNode.instance,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Gp));else if(m!==4&&(i=i.child,i!==null))for(sy(i,o,u),i=i.sibling;i!==null;)sy(i,o,u),i=i.sibling}function ay(i,o,u){var m=i.tag,_=m===5||m===6;if(_)i=_?i.stateNode:i.stateNode.instance,o?u.insertBefore(i,o):u.appendChild(i);else if(m!==4&&(i=i.child,i!==null))for(ay(i,o,u),i=i.sibling;i!==null;)ay(i,o,u),i=i.sibling}function fb(i,o){for(var u=o,m=!1,_,S;;){if(!m){m=u.return;e:for(;;){if(m===null)throw Error(Je(160));switch(_=m.stateNode,m.tag){case 5:S=!1;break e;case 3:_=_.containerInfo,S=!0;break e;case 4:_=_.containerInfo,S=!0;break e}m=m.return}m=!0}if(u.tag===5||u.tag===6){e:for(var k=i,a=u,O=a;;)if(ub(k,O),O.child!==null&&O.tag!==4)O.child.return=O,O=O.child;else{if(O===a)break e;for(;O.sibling===null;){if(O.return===null||O.return===a)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}S?(k=_,a=u.stateNode,k.nodeType===8?k.parentNode.removeChild(a):k.removeChild(a)):_.removeChild(u.stateNode)}else if(u.tag===4){if(u.child!==null){_=u.stateNode.containerInfo,S=!0,u.child.return=u,u=u.child;continue}}else if(ub(i,u),u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return,u.tag===4&&(m=!1)}u.sibling.return=u.return,u=u.sibling}}function ly(i,o){switch(o.tag){case 0:case 11:case 14:case 15:case 22:var u=o.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var m=u=u.next;do(m.tag&3)==3&&(i=m.destroy,m.destroy=void 0,i!==void 0&&i()),m=m.next;while(m!==u)}return;case 1:return;case 5:if(u=o.stateNode,u!=null){m=o.memoizedProps;var _=i!==null?i.memoizedProps:m;i=o.type;var S=o.updateQueue;if(o.updateQueue=null,S!==null){for(u[qp]=m,i==="input"&&m.type==="radio"&&m.name!=null&&Yx(u,m),X_(i,_),o=X_(i,m),_=0;_<S.length;_+=2){var k=S[_],a=S[_+1];k==="style"?i1(u,a):k==="dangerouslySetInnerHTML"?r1(u,a):k==="children"?rh(u,a):A_(u,k,a,o)}switch(i){case"input":V_(u,m);break;case"textarea":Qx(u,m);break;case"select":i=u._wrapperState.wasMultiple,u._wrapperState.wasMultiple=!!m.multiple,S=m.value,S!=null?yc(u,!!m.multiple,S,!1):i!==!!m.multiple&&(m.defaultValue!=null?yc(u,!!m.multiple,m.defaultValue,!0):yc(u,!!m.multiple,m.multiple?[]:"",!1))}}}return;case 6:if(o.stateNode===null)throw Error(Je(162));o.stateNode.nodeValue=o.memoizedProps;return;case 3:u=o.stateNode,u.hydrate&&(u.hydrate=!1,x1(u.containerInfo));return;case 12:return;case 13:o.memoizedState!==null&&(py=Mn(),cb(o.child,!0)),mb(o);return;case 19:mb(o);return;case 17:return;case 23:case 24:cb(o,o.memoizedState!==null);return}throw Error(Je(163))}function mb(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new ok),o.forEach(function(m){var _=yk.bind(null,i,m);u.has(m)||(u.add(m),m.then(_,_))})}}function lk(i,o){return i!==null&&(i=i.memoizedState,i===null||i.dehydrated!==null)?(o=o.memoizedState,o!==null&&o.dehydrated===null):!1}var ck=Math.ceil,mf=Ha.ReactCurrentDispatcher,cy=Ha.ReactCurrentOwner,Ct=0,Nn=null,an=null,An=0,ol=0,uy=$s(0),vn=0,_f=null,Fc=0,Rh=0,Uc=0,hy=0,dy=null,py=0,fy=1/0;function Nc(){fy=Mn()+500}var ht=null,gf=!1,my=null,Mo=null,Xs=!1,Bh=null,Fh=90,_y=[],gy=[],Yo=null,Uh=0,yy=null,yf=-1,Ko=0,vf=0,Nh=null,xf=!1;function yi(){return(Ct&48)!=0?Mn():yf!==-1?yf:yf=Mn()}function Ys(i){if(i=i.mode,(i&2)==0)return 1;if((i&4)==0)return Dc()===99?1:2;if(Ko===0&&(Ko=Fc),YC.transition!==0){vf!==0&&(vf=dy!==null?dy.pendingLanes:0),i=Ko;var o=4186112&~vf;return o&=-o,o===0&&(i=4186112&~i,o=i&-i,o===0&&(o=8192)),o}return i=Dc(),(Ct&4)!=0&&i===98?i=Op(12,Ko):(i=QE(i),i=Op(i,Ko)),i}function Ks(i,o,u){if(50<Uh)throw Uh=0,yy=null,Error(Je(185));if(i=wf(i,o),i===null)return null;Rp(i,o,u),i===Nn&&(Uc|=o,vn===4&&jc(i,An));var m=Dc();o===1?(Ct&8)!=0&&(Ct&48)==0?vy(i):(Oi(i,u),Ct===0&&(Nc(),So())):((Ct&4)==0||m!==98&&m!==99||(Yo===null?Yo=new Set([i]):Yo.add(i)),Oi(i,u)),dy=i}function wf(i,o){i.lanes|=o;var u=i.alternate;for(u!==null&&(u.lanes|=o),u=i,i=i.return;i!==null;)i.childLanes|=o,u=i.alternate,u!==null&&(u.childLanes|=o),u=i,i=i.return;return u.tag===3?u.stateNode:null}function Oi(i,o){for(var u=i.callbackNode,m=i.suspendedLanes,_=i.pingedLanes,S=i.expirationTimes,k=i.pendingLanes;0<k;){var a=31-Ns(k),O=1<<a,X=S[a];if(X===-1){if((O&m)==0||(O&_)!=0){X=o,bc(O);var xe=xr;S[a]=10<=xe?X+250:6<=xe?X+5e3:-1}}else X<=o&&(i.expiredLanes|=O);k&=~O}if(m=dh(i,i===Nn?An:0),o=xr,m===0)u!==null&&(u!==Rg&&Lg(u),i.callbackNode=null,i.callbackPriority=0);else{if(u!==null){if(i.callbackPriority===o)return;u!==Rg&&Lg(u)}o===15?(u=vy.bind(null,i),Wo===null?(Wo=[u],Kp=Dg(Yp,xw)):Wo.push(u),u=Rg):o===14?u=Th(99,vy.bind(null,i)):(u=eC(o),u=Th(u,_b.bind(null,i))),i.callbackPriority=o,i.callbackNode=u}}function _b(i){if(yf=-1,vf=Ko=0,(Ct&48)!=0)throw Error(Je(327));var o=i.callbackNode;if(Js()&&i.callbackNode!==o)return null;var u=dh(i,i===Nn?An:0);if(u===0)return null;var m=u,_=Ct;Ct|=16;var S=xb();(Nn!==i||An!==m)&&(Nc(),Vc(i,m));do try{dk();break}catch(a){vb(i,a)}while(1);if(Fg(),mf.current=S,Ct=_,an!==null?m=0:(Nn=null,An=0,m=vn),(Fc&Uc)!=0)Vc(i,0);else if(m!==0){if(m===2&&(Ct|=64,i.hydrate&&(i.hydrate=!1,Ig(i.containerInfo)),u=k1(i),u!==0&&(m=jh(i,u))),m===1)throw o=_f,Vc(i,0),jc(i,u),Oi(i,Mn()),o;switch(i.finishedWork=i.current.alternate,i.finishedLanes=u,m){case 0:case 1:throw Error(Je(345));case 2:sl(i);break;case 3:if(jc(i,u),(u&62914560)===u&&(m=py+500-Mn(),10<m)){if(dh(i,0)!==0)break;if(_=i.suspendedLanes,(_&u)!==u){yi(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=sw(sl.bind(null,i),m);break}sl(i);break;case 4:if(jc(i,u),(u&4186112)===u)break;for(m=i.eventTimes,_=-1;0<u;){var k=31-Ns(u);S=1<<k,k=m[k],k>_&&(_=k),u&=~S}if(u=_,u=Mn()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*ck(u/1960))-u,10<u){i.timeoutHandle=sw(sl.bind(null,i),u);break}sl(i);break;case 5:sl(i);break;default:throw Error(Je(329))}}return Oi(i,Mn()),i.callbackNode===o?_b.bind(null,i):null}function jc(i,o){for(o&=~hy,o&=~Uc,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var u=31-Ns(o),m=1<<u;i[u]=-1,o&=~m}}function vy(i){if((Ct&48)!=0)throw Error(Je(327));if(Js(),i===Nn&&(i.expiredLanes&An)!=0){var o=An,u=jh(i,o);(Fc&Uc)!=0&&(o=dh(i,o),u=jh(i,o))}else o=dh(i,0),u=jh(i,o);if(i.tag!==0&&u===2&&(Ct|=64,i.hydrate&&(i.hydrate=!1,Ig(i.containerInfo)),o=k1(i),o!==0&&(u=jh(i,o))),u===1)throw u=_f,Vc(i,0),jc(i,o),Oi(i,Mn()),u;return i.finishedWork=i.current.alternate,i.finishedLanes=o,sl(i),Oi(i,Mn()),null}function uk(){if(Yo!==null){var i=Yo;Yo=null,i.forEach(function(o){o.expiredLanes|=24&o.pendingLanes,Oi(o,Mn())})}So()}function gb(i,o){var u=Ct;Ct|=1;try{return i(o)}finally{Ct=u,Ct===0&&(Nc(),So())}}function yb(i,o){var u=Ct;Ct&=-2,Ct|=8;try{return i(o)}finally{Ct=u,Ct===0&&(Nc(),So())}}function bf(i,o){jr(uy,ol),ol|=o,Fc|=o}function xy(){ol=uy.current,Cr(uy)}function Vc(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,GC(u)),an!==null)for(u=an.return;u!==null;){var m=u;switch(m.tag){case 1:m=m.type.childContextTypes,m!=null&&Hp();break;case 3:Rc(),Cr(ti),Cr(kn),qg();break;case 5:$g(m);break;case 4:Rc();break;case 13:Cr(Vr);break;case 19:Cr(Vr);break;case 10:Ug(m);break;case 23:case 24:xy()}u=u.return}Nn=i,an=ea(i.current,null),An=ol=Fc=o,vn=0,_f=null,hy=Uc=Rh=0}function vb(i,o){do{var u=an;try{if(Fg(),Ih.current=pf,cf){for(var m=qr.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}cf=!1}if(Ah=0,yn=In=qr=null,zh=!1,cy.current=null,u===null||u.return===null){vn=1,_f=o,an=null;break}e:{var S=i,k=u.return,a=u,O=o;if(o=An,a.flags|=2048,a.firstEffect=a.lastEffect=null,O!==null&&typeof O=="object"&&typeof O.then=="function"){var X=O;if((a.mode&2)==0){var xe=a.alternate;xe?(a.updateQueue=xe.updateQueue,a.memoizedState=xe.memoizedState,a.lanes=xe.lanes):(a.updateQueue=null,a.memoizedState=null)}var ce=(Vr.current&1)!=0,he=k;do{var se;if(se=he.tag===13){var De=he.memoizedState;if(De!==null)se=De.dehydrated!==null;else{var Te=he.memoizedProps;se=Te.fallback===void 0?!1:Te.unstable_avoidThisFallback!==!0?!0:!ce}}if(se){var ne=he.updateQueue;if(ne===null){var Y=new Set;Y.add(X),he.updateQueue=Y}else ne.add(X);if((he.mode&2)==0){if(he.flags|=64,a.flags|=16384,a.flags&=-2981,a.tag===1)if(a.alternate===null)a.tag=17;else{var Q=qs(-1,1);Q.tag=2,Ws(a,Q)}a.lanes|=1;break e}O=void 0,a=o;var ge=S.pingCache;if(ge===null?(ge=S.pingCache=new ik,O=new Set,ge.set(X,O)):(O=ge.get(X),O===void 0&&(O=new Set,ge.set(X,O))),!O.has(a)){O.add(a);var we=gk.bind(null,S,X,a);X.then(we,we)}he.flags|=4096,he.lanes=o;break e}he=he.return}while(he!==null);O=Error((gc(a.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}vn!==5&&(vn=2),O=iy(O,a),he=k;do{switch(he.tag){case 3:S=O,he.flags|=4096,o&=-o,he.lanes|=o;var He=sb(he,S,o);Tw(he,He);break e;case 1:S=O;var Ee=he.type,Qe=he.stateNode;if((he.flags&64)==0&&(typeof Ee.getDerivedStateFromError=="function"||Qe!==null&&typeof Qe.componentDidCatch=="function"&&(Mo===null||!Mo.has(Qe)))){he.flags|=4096,o&=-o,he.lanes|=o;var Ve=ab(he,S,o);Tw(he,Ve);break e}}he=he.return}while(he!==null)}bb(u)}catch(Fe){o=Fe,an===u&&u!==null&&(an=u=u.return);continue}break}while(1)}function xb(){var i=mf.current;return mf.current=pf,i===null?pf:i}function jh(i,o){var u=Ct;Ct|=16;var m=xb();Nn===i&&An===o||Vc(i,o);do try{hk();break}catch(_){vb(i,_)}while(1);if(Fg(),Ct=u,mf.current=m,an!==null)throw Error(Je(261));return Nn=null,An=0,vn}function hk(){for(;an!==null;)wb(an)}function dk(){for(;an!==null&&!WC();)wb(an)}function wb(i){var o=Eb(i.alternate,i,ol);i.memoizedProps=i.pendingProps,o===null?bb(i):an=o,cy.current=null}function bb(i){var o=i;do{var u=o.alternate;if(i=o.return,(o.flags&2048)==0){if(u=rk(u,o,ol),u!==null){an=u;return}if(u=o,u.tag!==24&&u.tag!==23||u.memoizedState===null||(ol&1073741824)!=0||(u.mode&4)==0){for(var m=0,_=u.child;_!==null;)m|=_.lanes|_.childLanes,_=_.sibling;u.childLanes=m}i!==null&&(i.flags&2048)==0&&(i.firstEffect===null&&(i.firstEffect=o.firstEffect),o.lastEffect!==null&&(i.lastEffect!==null&&(i.lastEffect.nextEffect=o.firstEffect),i.lastEffect=o.lastEffect),1<o.flags&&(i.lastEffect!==null?i.lastEffect.nextEffect=o:i.firstEffect=o,i.lastEffect=o))}else{if(u=nk(o),u!==null){u.flags&=2047,an=u;return}i!==null&&(i.firstEffect=i.lastEffect=null,i.flags|=2048)}if(o=o.sibling,o!==null){an=o;return}an=o=i}while(o!==null);vn===0&&(vn=5)}function sl(i){var o=Dc();return tl(99,pk.bind(null,i,o)),null}function pk(i,o){do Js();while(Bh!==null);if((Ct&48)!=0)throw Error(Je(327));var u=i.finishedWork;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(Je(177));i.callbackNode=null;var m=u.lanes|u.childLanes,_=m,S=i.pendingLanes&~_;i.pendingLanes=_,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=_,i.mutableReadLanes&=_,i.entangledLanes&=_,_=i.entanglements;for(var k=i.eventTimes,a=i.expirationTimes;0<S;){var O=31-Ns(S),X=1<<O;_[O]=0,k[O]=-1,a[O]=-1,S&=~X}if(Yo!==null&&(m&24)==0&&Yo.has(i)&&Yo.delete(i),i===Nn&&(an=Nn=null,An=0),1<u.flags?u.lastEffect!==null?(u.lastEffect.nextEffect=u,m=u.firstEffect):m=u:m=u.firstEffect,m!==null){if(_=Ct,Ct|=32,cy.current=null,Cg=Bp,k=W1(),bg(k)){if("selectionStart"in k)a={start:k.selectionStart,end:k.selectionEnd};else e:if(a=(a=k.ownerDocument)&&a.defaultView||window,(X=a.getSelection&&a.getSelection())&&X.rangeCount!==0){a=X.anchorNode,S=X.anchorOffset,O=X.focusNode,X=X.focusOffset;try{a.nodeType,O.nodeType}catch{a=null;break e}var xe=0,ce=-1,he=-1,se=0,De=0,Te=k,ne=null;t:for(;;){for(var Y;Te!==a||S!==0&&Te.nodeType!==3||(ce=xe+S),Te!==O||X!==0&&Te.nodeType!==3||(he=xe+X),Te.nodeType===3&&(xe+=Te.nodeValue.length),(Y=Te.firstChild)!==null;)ne=Te,Te=Y;for(;;){if(Te===k)break t;if(ne===a&&++se===S&&(ce=xe),ne===O&&++De===X&&(he=xe),(Y=Te.nextSibling)!==null)break;Te=ne,ne=Te.parentNode}Te=Y}a=ce===-1||he===-1?null:{start:ce,end:he}}else a=null;a=a||{start:0,end:0}}else a=null;kg={focusedElem:k,selectionRange:a},Bp=!1,Nh=null,xf=!1,ht=m;do try{fk()}catch(Fe){if(ht===null)throw Error(Je(330));Qs(ht,Fe),ht=ht.nextEffect}while(ht!==null);Nh=null,ht=m;do try{for(k=i;ht!==null;){var Q=ht.flags;if(Q&16&&rh(ht.stateNode,""),Q&128){var ge=ht.alternate;if(ge!==null){var we=ge.ref;we!==null&&(typeof we=="function"?we(null):we.current=null)}}switch(Q&1038){case 2:pb(ht),ht.flags&=-3;break;case 6:pb(ht),ht.flags&=-3,ly(ht.alternate,ht);break;case 1024:ht.flags&=-1025;break;case 1028:ht.flags&=-1025,ly(ht.alternate,ht);break;case 4:ly(ht.alternate,ht);break;case 8:a=ht,fb(k,a);var He=a.alternate;hb(a),He!==null&&hb(He)}ht=ht.nextEffect}}catch(Fe){if(ht===null)throw Error(Je(330));Qs(ht,Fe),ht=ht.nextEffect}while(ht!==null);if(we=kg,ge=W1(),Q=we.focusedElem,k=we.selectionRange,ge!==Q&&Q&&Q.ownerDocument&&q1(Q.ownerDocument.documentElement,Q)){for(k!==null&&bg(Q)&&(ge=k.start,we=k.end,we===void 0&&(we=ge),"selectionStart"in Q?(Q.selectionStart=ge,Q.selectionEnd=Math.min(we,Q.value.length)):(we=(ge=Q.ownerDocument||document)&&ge.defaultView||window,we.getSelection&&(we=we.getSelection(),a=Q.textContent.length,He=Math.min(k.start,a),k=k.end===void 0?He:Math.min(k.end,a),!we.extend&&He>k&&(a=k,k=He,He=a),a=Z1(Q,He),S=Z1(Q,k),a&&S&&(we.rangeCount!==1||we.anchorNode!==a.node||we.anchorOffset!==a.offset||we.focusNode!==S.node||we.focusOffset!==S.offset)&&(ge=ge.createRange(),ge.setStart(a.node,a.offset),we.removeAllRanges(),He>k?(we.addRange(ge),we.extend(S.node,S.offset)):(ge.setEnd(S.node,S.offset),we.addRange(ge)))))),ge=[],we=Q;we=we.parentNode;)we.nodeType===1&&ge.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<ge.length;Q++)we=ge[Q],we.element.scrollLeft=we.left,we.element.scrollTop=we.top}Bp=!!Cg,kg=Cg=null,i.current=u,ht=m;do try{for(Q=i;ht!==null;){var Ee=ht.flags;if(Ee&36&&ak(Q,ht.alternate,ht),Ee&128){ge=void 0;var Qe=ht.ref;if(Qe!==null){var Ve=ht.stateNode;switch(ht.tag){case 5:ge=Ve;break;default:ge=Ve}typeof Qe=="function"?Qe(ge):Qe.current=ge}}ht=ht.nextEffect}}catch(Fe){if(ht===null)throw Error(Je(330));Qs(ht,Fe),ht=ht.nextEffect}while(ht!==null);ht=null,XC(),Ct=_}else i.current=u;if(Xs)Xs=!1,Bh=i,Fh=o;else for(ht=m;ht!==null;)o=ht.nextEffect,ht.nextEffect=null,ht.flags&8&&(Ee=ht,Ee.sibling=null,Ee.stateNode=null),ht=o;if(m=i.pendingLanes,m===0&&(Mo=null),m===1?i===yy?Uh++:(Uh=0,yy=i):Uh=0,u=u.stateNode,el&&typeof el.onCommitFiberRoot=="function")try{el.onCommitFiberRoot(Pg,u,void 0,(u.current.flags&64)==64)}catch{}if(Oi(i,Mn()),gf)throw gf=!1,i=my,my=null,i;return(Ct&8)!=0||So(),null}function fk(){for(;ht!==null;){var i=ht.alternate;xf||Nh===null||((ht.flags&8)!=0?p1(ht,Nh)&&(xf=!0):ht.tag===13&&lk(i,ht)&&p1(ht,Nh)&&(xf=!0));var o=ht.flags;(o&256)!=0&&sk(i,ht),(o&512)==0||Xs||(Xs=!0,Th(97,function(){return Js(),null})),ht=ht.nextEffect}}function Js(){if(Fh!==90){var i=97<Fh?97:Fh;return Fh=90,tl(i,_k)}return!1}function mk(i,o){_y.push(o,i),Xs||(Xs=!0,Th(97,function(){return Js(),null}))}function Tb(i,o){gy.push(o,i),Xs||(Xs=!0,Th(97,function(){return Js(),null}))}function _k(){if(Bh===null)return!1;var i=Bh;if(Bh=null,(Ct&48)!=0)throw Error(Je(331));var o=Ct;Ct|=32;var u=gy;gy=[];for(var m=0;m<u.length;m+=2){var _=u[m],S=u[m+1],k=_.destroy;if(_.destroy=void 0,typeof k=="function")try{k()}catch(O){if(S===null)throw Error(Je(330));Qs(S,O)}}for(u=_y,_y=[],m=0;m<u.length;m+=2){_=u[m],S=u[m+1];try{var a=_.create;_.destroy=a()}catch(O){if(S===null)throw Error(Je(330));Qs(S,O)}}for(a=i.current.firstEffect;a!==null;)i=a.nextEffect,a.nextEffect=null,a.flags&8&&(a.sibling=null,a.stateNode=null),a=i;return Ct=o,So(),!0}function Sb(i,o,u){o=iy(u,o),o=sb(i,o,1),Ws(i,o),o=yi(),i=wf(i,1),i!==null&&(Rp(i,1,o),Oi(i,o))}function Qs(i,o){if(i.tag===3)Sb(i,i,o);else for(var u=i.return;u!==null;){if(u.tag===3){Sb(u,i,o);break}else if(u.tag===1){var m=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Mo===null||!Mo.has(m))){i=iy(o,i);var _=ab(u,i,1);if(Ws(u,_),_=yi(),u=wf(u,1),u!==null)Rp(u,1,_),Oi(u,_);else if(typeof m.componentDidCatch=="function"&&(Mo===null||!Mo.has(m)))try{m.componentDidCatch(o,i)}catch{}break}}u=u.return}}function gk(i,o,u){var m=i.pingCache;m!==null&&m.delete(o),o=yi(),i.pingedLanes|=i.suspendedLanes&u,Nn===i&&(An&u)===u&&(vn===4||vn===3&&(An&62914560)===An&&500>Mn()-py?Vc(i,0):hy|=u),Oi(i,o)}function yk(i,o){var u=i.stateNode;u!==null&&u.delete(o),o=0,o===0&&(o=i.mode,(o&2)==0?o=1:(o&4)==0?o=Dc()===99?1:2:(Ko===0&&(Ko=Fc),o=Tc(62914560&~Ko),o===0&&(o=4194304))),u=yi(),i=wf(i,o),i!==null&&(Rp(i,o,u),Oi(i,u))}var Eb;Eb=function(i,o,u){var m=o.lanes;if(i!==null)if(i.memoizedProps!==o.pendingProps||ti.current)Qi=!0;else if((u&m)!=0)Qi=(i.flags&16384)!=0;else{switch(Qi=!1,o.tag){case 3:Yw(o),Zg();break;case 5:zw(o);break;case 1:ri(o.type)&&Xp(o);break;case 4:Vg(o,o.stateNode.containerInfo);break;case 10:m=o.memoizedProps.value;var _=o.type._context;jr(Jp,_._currentValue),_._currentValue=m;break;case 13:if(o.memoizedState!==null)return(u&o.child.childLanes)!=0?Kw(i,o,u):(jr(Vr,Vr.current&1),o=Xo(i,o,u),o!==null?o.sibling:null);jr(Vr,Vr.current&1);break;case 19:if(m=(u&o.childLanes)!=0,(i.flags&64)!=0){if(m)return rb(i,o,u);o.flags|=64}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),jr(Vr,Vr.current),m)break;return null;case 23:case 24:return o.lanes=0,Qg(i,o,u)}return Xo(i,o,u)}else Qi=!1;switch(o.lanes=0,o.tag){case 2:if(m=o.type,i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2),i=o.pendingProps,_=Pc(o,kn.current),Oc(o,u),_=Hg(null,o,m,i,_,u),o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0){if(o.tag=1,o.memoizedState=null,o.updateQueue=null,ri(m)){var S=!0;Xp(o)}else S=!1;o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Ng(o);var k=m.getDerivedStateFromProps;typeof k=="function"&&tf(o,m,k,i),_.updater=rf,o.stateNode=_,_._reactInternals=o,jg(o,m,i,u),o=ty(null,o,m,!0,S,u)}else o.tag=0,ii(null,o,_,u),o=o.child;return o;case 16:_=o.elementType;e:{switch(i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2),i=o.pendingProps,S=_._init,_=S(_._payload),o.type=_,S=o.tag=xk(_),i=Ji(_,i),S){case 0:o=ey(null,o,_,i,u);break e;case 1:o=Xw(null,o,_,i,u);break e;case 11:o=Zw(null,o,_,i,u);break e;case 14:o=qw(null,o,_,Ji(_.type,i),m,u);break e}throw Error(Je(306,_,""))}return o;case 0:return m=o.type,_=o.pendingProps,_=o.elementType===m?_:Ji(m,_),ey(i,o,m,_,u);case 1:return m=o.type,_=o.pendingProps,_=o.elementType===m?_:Ji(m,_),Xw(i,o,m,_,u);case 3:if(Yw(o),m=o.updateQueue,i===null||m===null)throw Error(Je(282));if(m=o.pendingProps,_=o.memoizedState,_=_!==null?_.element:null,bw(i,o),Sh(o,m,null,u),m=o.memoizedState.element,m===_)Zg(),o=Xo(i,o,u);else{if(_=o.stateNode,(S=_.hydrate)&&(Hs=Mc(o.stateNode.containerInfo.firstChild),Ho=o,S=Co=!0),S){if(i=_.mutableSourceEagerHydrationData,i!=null)for(_=0;_<i.length;_+=2)S=i[_],S._workInProgressVersionPrimary=i[_+1],Bc.push(S);for(u=Aw(o,null,m,u),o.child=u;u;)u.flags=u.flags&-3|1024,u=u.sibling}else ii(i,o,m,u),Zg();o=o.child}return o;case 5:return zw(o),i===null&&Gg(o),m=o.type,_=o.pendingProps,S=i!==null?i.memoizedProps:null,k=_.children,Mg(m,_)?k=null:S!==null&&Mg(m,S)&&(o.flags|=16),Hw(i,o),ii(i,o,k,u),o.child;case 6:return i===null&&Gg(o),null;case 13:return Kw(i,o,u);case 4:return Vg(o,o.stateNode.containerInfo),m=o.pendingProps,i===null?o.child=sf(o,null,m,u):ii(i,o,m,u),o.child;case 11:return m=o.type,_=o.pendingProps,_=o.elementType===m?_:Ji(m,_),Zw(i,o,m,_,u);case 7:return ii(i,o,o.pendingProps,u),o.child;case 8:return ii(i,o,o.pendingProps.children,u),o.child;case 12:return ii(i,o,o.pendingProps.children,u),o.child;case 10:e:{m=o.type._context,_=o.pendingProps,k=o.memoizedProps,S=_.value;var a=o.type._context;if(jr(Jp,a._currentValue),a._currentValue=S,k!==null)if(a=k.value,S=Pi(a,S)?0:(typeof m._calculateChangedBits=="function"?m._calculateChangedBits(a,S):1073741823)|0,S===0){if(k.children===_.children&&!ti.current){o=Xo(i,o,u);break e}}else for(a=o.child,a!==null&&(a.return=o);a!==null;){var O=a.dependencies;if(O!==null){k=a.child;for(var X=O.firstContext;X!==null;){if(X.context===m&&(X.observedBits&S)!=0){a.tag===1&&(X=qs(-1,u&-u),X.tag=2,Ws(a,X)),a.lanes|=u,X=a.alternate,X!==null&&(X.lanes|=u),ww(a.return,u),O.lanes|=u;break}X=X.next}}else k=a.tag===10&&a.type===o.type?null:a.child;if(k!==null)k.return=a;else for(k=a;k!==null;){if(k===o){k=null;break}if(a=k.sibling,a!==null){a.return=k.return,k=a;break}k=k.return}a=k}ii(i,o,_.children,u),o=o.child}return o;case 9:return _=o.type,S=o.pendingProps,m=S.children,Oc(o,u),_=Di(_,S.unstable_observedBits),m=m(_),o.flags|=1,ii(i,o,m,u),o.child;case 14:return _=o.type,S=Ji(_,o.pendingProps),S=Ji(_.type,S),qw(i,o,_,S,m,u);case 15:return Ww(i,o,o.type,o.pendingProps,m,u);case 17:return m=o.type,_=o.pendingProps,_=o.elementType===m?_:Ji(m,_),i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2),o.tag=1,ri(m)?(i=!0,Xp(o)):i=!1,Oc(o,u),kw(o,m,_),jg(o,m,_,u),ty(null,o,m,!0,i,u);case 19:return rb(i,o,u);case 23:return Qg(i,o,u);case 24:return Qg(i,o,u)}throw Error(Je(156,o.tag))};function vk(i,o,u,m){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ri(i,o,u,m){return new vk(i,o,u,m)}function wy(i){return i=i.prototype,!(!i||!i.isReactComponent)}function xk(i){if(typeof i=="function")return wy(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Tp)return 11;if(i===Ep)return 14}return 2}function ea(i,o){var u=i.alternate;return u===null?(u=Ri(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.nextEffect=null,u.firstEffect=null,u.lastEffect=null),u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function Tf(i,o,u,m,_,S){var k=2;if(m=i,typeof i=="function")wy(i)&&(k=1);else if(typeof i=="string")k=5;else e:switch(i){case Os:return $c(u.children,_,S,o);case Zx:k=8,_|=16;break;case z_:k=8,_|=1;break;case Ju:return i=Ri(12,u,o,_|8),i.elementType=Ju,i.type=Ju,i.lanes=S,i;case Qu:return i=Ri(13,u,o,_),i.type=Qu,i.elementType=Qu,i.lanes=S,i;case Sp:return i=Ri(19,u,o,_),i.elementType=Sp,i.lanes=S,i;case B_:return by(u,_,S,o);case F_:return i=Ri(24,u,o,_),i.elementType=F_,i.lanes=S,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case P_:k=10;break e;case D_:k=9;break e;case Tp:k=11;break e;case Ep:k=14;break e;case L_:k=16,m=null;break e;case O_:k=22;break e}throw Error(Je(130,i==null?i:typeof i,""))}return o=Ri(k,u,o,_),o.elementType=i,o.type=m,o.lanes=S,o}function $c(i,o,u,m){return i=Ri(7,i,m,o),i.lanes=u,i}function by(i,o,u,m){return i=Ri(23,i,m,o),i.elementType=B_,i.lanes=u,i}function Ty(i,o,u){return i=Ri(6,i,null,o),i.lanes=u,i}function Sy(i,o,u){return o=Ri(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function wk(i,o,u){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=u,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=ug(0),this.expirationTimes=ug(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ug(0),this.mutableSourceEagerHydrationData=null}function bk(i,o,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xa,key:m==null?null:""+m,children:i,containerInfo:o,implementation:u}}function Sf(i,o,u,m){var _=o.current,S=yi(),k=Ys(_);e:if(u){u=u._reactInternals;t:{if(Ka(u)!==u||u.tag!==1)throw Error(Je(170));var a=u;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(ri(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(a!==null);throw Error(Je(171))}if(u.tag===1){var O=u.type;if(ri(O)){u=hw(u,O,a);break e}}u=a}else u=Gs;return o.context===null?o.context=u:o.pendingContext=u,o=qs(S,k),o.payload={element:i},m=m===void 0?null:m,m!==null&&(o.callback=m),Ws(_,o),Ks(_,k,S),k}function Ey(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Cb(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function Cy(i,o){Cb(i,o),(i=i.alternate)&&Cb(i,o)}function Tk(){return null}function ky(i,o,u){var m=u!=null&&u.hydrationOptions!=null&&u.hydrationOptions.mutableSources||null;if(u=new wk(i,o,u!=null&&u.hydrate===!0),o=Ri(3,null,null,o===2?7:o===1?3:0),u.current=o,o.stateNode=u,Ng(o),i[Ic]=u.current,ew(i.nodeType===8?i.parentNode:i),m)for(i=0;i<m.length;i++){o=m[i];var _=o._getVersion;_=_(o._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[o,_]:u.mutableSourceEagerHydrationData.push(o,_)}this._internalRoot=u}ky.prototype.render=function(i){Sf(i,this._internalRoot,null,null)};ky.prototype.unmount=function(){var i=this._internalRoot,o=i.containerInfo;Sf(null,i,null,function(){o[Ic]=null})};function Vh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Sk(i,o){if(o||(o=i?i.nodeType===9?i.documentElement:i.firstChild:null,o=!(!o||o.nodeType!==1||!o.hasAttribute("data-reactroot"))),!o)for(var u;u=i.lastChild;)i.removeChild(u);return new ky(i,0,o?{hydrate:!0}:void 0)}function Ef(i,o,u,m,_){var S=u._reactRootContainer;if(S){var k=S._internalRoot;if(typeof _=="function"){var a=_;_=function(){var X=Ey(k);a.call(X)}}Sf(o,k,i,_)}else{if(S=u._reactRootContainer=Sk(u,m),k=S._internalRoot,typeof _=="function"){var O=_;_=function(){var X=Ey(k);O.call(X)}}yb(function(){Sf(o,k,i,_)})}return Ey(k)}f1=function(i){if(i.tag===13){var o=yi();Ks(i,4,o),Cy(i,4)}};ig=function(i){if(i.tag===13){var o=yi();Ks(i,67108864,o),Cy(i,67108864)}};m1=function(i){if(i.tag===13){var o=yi(),u=Ys(i);Ks(i,u,o),Cy(i,u)}};_1=function(i,o){return o()};K_=function(i,o,u){switch(o){case"input":if(V_(i,u),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var m=u[o];if(m!==i&&m.form===i.form){var _=Wp(m);if(!_)throw Error(Je(90));Hx(m),V_(m,_)}}}break;case"textarea":Qx(i,u);break;case"select":o=u.value,o!=null&&yc(i,!!u.multiple,o,!1)}};J_=gb;l1=function(i,o,u,m,_){var S=Ct;Ct|=4;try{return tl(98,i.bind(null,o,u,m,_))}finally{Ct=S,Ct===0&&(Nc(),So())}};Q_=function(){(Ct&49)==0&&(uk(),Js())};c1=function(i,o){var u=Ct;Ct|=2;try{return i(o)}finally{Ct=u,Ct===0&&(Nc(),So())}};function kb(i,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vh(o))throw Error(Je(200));return bk(i,o,null,u)}var Ek={Events:[bh,Ac,Wp,s1,a1,Js,{current:!1}]},$h={findFiberByHostInstance:Ja,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},Ck={bundleType:$h.bundleType,version:$h.version,rendererPackageName:$h.rendererPackageName,rendererConfig:$h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ha.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=d1(i),i===null?null:i.stateNode},findFiberByHostInstance:$h.findFiberByHostInstance||Tk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var Cf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cf.isDisabled&&Cf.supportsFiber)try{Pg=Cf.inject(Ck),el=Cf}catch{}}zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ek;zi.createPortal=kb;zi.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(Je(188)):Error(Je(268,Object.keys(i)));return i=d1(o),i=i===null?null:i.stateNode,i};zi.flushSync=function(i,o){var u=Ct;if((u&48)!=0)return i(o);Ct|=1;try{if(i)return tl(99,i.bind(null,o))}finally{Ct=u,So()}};zi.hydrate=function(i,o,u){if(!Vh(o))throw Error(Je(200));return Ef(null,i,o,!0,u)};zi.render=function(i,o,u){if(!Vh(o))throw Error(Je(200));return Ef(null,i,o,!1,u)};zi.unmountComponentAtNode=function(i){if(!Vh(i))throw Error(Je(40));return i._reactRootContainer?(yb(function(){Ef(null,null,i,!1,function(){i._reactRootContainer=null,i[Ic]=null})}),!0):!1};zi.unstable_batchedUpdates=gb;zi.unstable_createPortal=function(i,o){return kb(i,o,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};zi.unstable_renderSubtreeIntoContainer=function(i,o,u,m){if(!Vh(u))throw Error(Je(200));if(i==null||i._reactInternals===void 0)throw Error(Je(38));return Ef(i,o,u,!1,m)};zi.version="17.0.2";function Mb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Mb)}catch(i){console.error(i)}}Mb(),Fx.exports=zi;var OA=Fx.exports,Ib={},Ab={},kf={},zb={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0},u=o;i.default=u})(zb);var kk="Expected a function",Pb=0/0,Mk="[object Symbol]",Ik=/^\s+|\s+$/g,Ak=/^[-+]0x[0-9a-f]+$/i,zk=/^0b[01]+$/i,Pk=/^0o[0-7]+$/i,Dk=parseInt,Lk=typeof Hu=="object"&&Hu&&Hu.Object===Object&&Hu,Ok=typeof self=="object"&&self&&self.Object===Object&&self,Rk=Lk||Ok||Function("return this")(),Bk=Object.prototype,Fk=Bk.toString,Uk=Math.max,Nk=Math.min,My=function(){return Rk.Date.now()};function jk(i,o,u){var m,_,S,k,a,O,X=0,xe=!1,ce=!1,he=!0;if(typeof i!="function")throw new TypeError(kk);o=Db(o)||0,Iy(u)&&(xe=!!u.leading,ce="maxWait"in u,S=ce?Uk(Db(u.maxWait)||0,o):S,he="trailing"in u?!!u.trailing:he);function se(Ee){var Qe=m,Ve=_;return m=_=void 0,X=Ee,k=i.apply(Ve,Qe),k}function De(Ee){return X=Ee,a=setTimeout(Y,o),xe?se(Ee):k}function Te(Ee){var Qe=Ee-O,Ve=Ee-X,Fe=o-Qe;return ce?Nk(Fe,S-Ve):Fe}function ne(Ee){var Qe=Ee-O,Ve=Ee-X;return O===void 0||Qe>=o||Qe<0||ce&&Ve>=S}function Y(){var Ee=My();if(ne(Ee))return Q(Ee);a=setTimeout(Y,Te(Ee))}function Q(Ee){return a=void 0,he&&m?se(Ee):(m=_=void 0,k)}function ge(){a!==void 0&&clearTimeout(a),X=0,m=O=_=a=void 0}function we(){return a===void 0?k:Q(My())}function He(){var Ee=My(),Qe=ne(Ee);if(m=arguments,_=this,O=Ee,Qe){if(a===void 0)return De(O);if(ce)return a=setTimeout(Y,o),se(O)}return a===void 0&&(a=setTimeout(Y,o)),k}return He.cancel=ge,He.flush=we,He}function Iy(i){var o=typeof i;return!!i&&(o=="object"||o=="function")}function Vk(i){return!!i&&typeof i=="object"}function $k(i){return typeof i=="symbol"||Vk(i)&&Fk.call(i)==Mk}function Db(i){if(typeof i=="number")return i;if($k(i))return Pb;if(Iy(i)){var o=typeof i.valueOf=="function"?i.valueOf():i;i=Iy(o)?o+"":o}if(typeof i!="string")return i===0?i:+i;i=i.replace(Ik,"");var u=zk.test(i);return u||Pk.test(i)?Dk(i.slice(2),u?2:8):Ak.test(i)?Pb:+i}var Gk=jk,Gh={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(i){(function(){var o={}.hasOwnProperty;function u(){for(var m=[],_=0;_<arguments.length;_++){var S=arguments[_];if(!!S){var k=typeof S;if(k==="string"||k==="number")m.push(S);else if(Array.isArray(S)){if(S.length){var a=u.apply(null,S);a&&m.push(a)}}else if(k==="object")if(S.toString===Object.prototype.toString)for(var O in S)o.call(S,O)&&S[O]&&m.push(O);else m.push(S.toString())}}return m.join(" ")}i.exports?(u.default=u,i.exports=u):window.classNames=u})()})(Gh);var at={};Object.defineProperty(at,"__esModule",{value:!0});at.clamp=Ob;at.canUseDOM=at.slidesOnLeft=at.slidesOnRight=at.siblingDirection=at.getTotalSlides=at.getPostClones=at.getPreClones=at.getTrackLeft=at.getTrackAnimateCSS=at.getTrackCSS=at.checkSpecKeys=at.getSlideCount=at.checkNavigable=at.getNavigableIndexes=at.swipeEnd=at.swipeMove=at.swipeStart=at.keyHandler=at.changeSlide=at.slideHandler=at.initializedState=at.extractObject=at.canGoNext=at.getSwipeDirection=at.getHeight=at.getWidth=at.lazySlidesOnRight=at.lazySlidesOnLeft=at.lazyEndIndex=at.lazyStartIndex=at.getRequiredLazySlides=at.getOnDemandLazySlides=at.safePreventDefault=void 0;var Zk=qk(Yi.exports);function qk(i){return i&&i.__esModule?i:{default:i}}function Lb(i,o){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);o&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),u.push.apply(u,m)}return u}function Ar(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?Lb(Object(u),!0).forEach(function(m){Wk(i,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(u)):Lb(Object(u)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(u,m))})}return i}function Wk(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}function Ob(i,o,u){return Math.max(o,Math.min(i,u))}var al=function(o){var u=["onTouchStart","onTouchMove","onWheel"];u.includes(o._reactName)||o.preventDefault()};at.safePreventDefault=al;var Ay=function(o){for(var u=[],m=zy(o),_=Py(o),S=m;S<_;S++)o.lazyLoadedList.indexOf(S)<0&&u.push(S);return u};at.getOnDemandLazySlides=Ay;var Hk=function(o){for(var u=[],m=zy(o),_=Py(o),S=m;S<_;S++)u.push(S);return u};at.getRequiredLazySlides=Hk;var zy=function(o){return o.currentSlide-Rb(o)};at.lazyStartIndex=zy;var Py=function(o){return o.currentSlide+Bb(o)};at.lazyEndIndex=Py;var Rb=function(o){return o.centerMode?Math.floor(o.slidesToShow/2)+(parseInt(o.centerPadding)>0?1:0):0};at.lazySlidesOnLeft=Rb;var Bb=function(o){return o.centerMode?Math.floor((o.slidesToShow-1)/2)+1+(parseInt(o.centerPadding)>0?1:0):o.slidesToShow};at.lazySlidesOnRight=Bb;var Mf=function(o){return o&&o.offsetWidth||0};at.getWidth=Mf;var Dy=function(o){return o&&o.offsetHeight||0};at.getHeight=Dy;var Ly=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m,_,S,k;return m=o.startX-o.curX,_=o.startY-o.curY,S=Math.atan2(_,m),k=Math.round(S*180/Math.PI),k<0&&(k=360-Math.abs(k)),k<=45&&k>=0||k<=360&&k>=315?"left":k>=135&&k<=225?"right":u===!0?k>=35&&k<=135?"up":"down":"vertical"};at.getSwipeDirection=Ly;var Oy=function(o){var u=!0;return o.infinite||(o.centerMode&&o.currentSlide>=o.slideCount-1||o.slideCount<=o.slidesToShow||o.currentSlide>=o.slideCount-o.slidesToShow)&&(u=!1),u};at.canGoNext=Oy;var Xk=function(o,u){var m={};return u.forEach(function(_){return m[_]=o[_]}),m};at.extractObject=Xk;var Yk=function(o){var u=Zk.default.Children.count(o.children),m=o.listRef,_=Math.ceil(Mf(m)),S=o.trackRef&&o.trackRef.node,k=Math.ceil(Mf(S)),a;if(o.vertical)a=_;else{var O=o.centerMode&&parseInt(o.centerPadding)*2;typeof o.centerPadding=="string"&&o.centerPadding.slice(-1)==="%"&&(O*=_/100),a=Math.ceil((_-O)/o.slidesToShow)}var X=m&&Dy(m.querySelector('[data-index="0"]')),xe=X*o.slidesToShow,ce=o.currentSlide===void 0?o.initialSlide:o.currentSlide;o.rtl&&o.currentSlide===void 0&&(ce=u-1-o.initialSlide);var he=o.lazyLoadedList||[],se=Ay(Ar(Ar({},o),{},{currentSlide:ce,lazyLoadedList:he}));he=he.concat(se);var De={slideCount:u,slideWidth:a,listWidth:_,trackWidth:k,currentSlide:ce,slideHeight:X,listHeight:xe,lazyLoadedList:he};return o.autoplaying===null&&o.autoplay&&(De.autoplaying="playing"),De};at.initializedState=Yk;var Kk=function(o){var u=o.waitForAnimate,m=o.animating,_=o.fade,S=o.infinite,k=o.index,a=o.slideCount,O=o.lazyLoad,X=o.currentSlide,xe=o.centerMode,ce=o.slidesToScroll,he=o.slidesToShow,se=o.useCSS,De=o.lazyLoadedList;if(u&&m)return{};var Te=k,ne,Y,Q,ge={},we={},He=S?k:Ob(k,0,a-1);if(_){if(!S&&(k<0||k>=a))return{};k<0?Te=k+a:k>=a&&(Te=k-a),O&&De.indexOf(Te)<0&&(De=De.concat(Te)),ge={animating:!0,currentSlide:Te,lazyLoadedList:De,targetSlide:Te},we={animating:!1,targetSlide:Te}}else ne=Te,Te<0?(ne=Te+a,S?a%ce!=0&&(ne=a-a%ce):ne=0):!Oy(o)&&Te>X?Te=ne=X:xe&&Te>=a?(Te=S?a:a-1,ne=S?0:a-1):Te>=a&&(ne=Te-a,S?a%ce!=0&&(ne=0):ne=a-he),!S&&Te+he>=a&&(ne=a-he),Y=qh(Ar(Ar({},o),{},{slideIndex:Te})),Q=qh(Ar(Ar({},o),{},{slideIndex:ne})),S||(Y===Q&&(Te=ne),Y=Q),O&&(De=De.concat(Ay(Ar(Ar({},o),{},{currentSlide:Te})))),se?(ge={animating:!0,currentSlide:ne,trackStyle:Fy(Ar(Ar({},o),{},{left:Y})),lazyLoadedList:De,targetSlide:He},we={animating:!1,currentSlide:ne,trackStyle:Zh(Ar(Ar({},o),{},{left:Q})),swipeLeft:null,targetSlide:He}):ge={currentSlide:ne,trackStyle:Zh(Ar(Ar({},o),{},{left:Q})),lazyLoadedList:De,targetSlide:He};return{state:ge,nextState:we}};at.slideHandler=Kk;var Jk=function(o,u){var m,_,S,k,a,O=o.slidesToScroll,X=o.slidesToShow,xe=o.slideCount,ce=o.currentSlide,he=o.targetSlide,se=o.lazyLoad,De=o.infinite;if(k=xe%O!=0,m=k?0:(xe-ce)%O,u.message==="previous")S=m===0?O:X-m,a=ce-S,se&&!De&&(_=ce-S,a=_===-1?xe-1:_),De||(a=he-O);else if(u.message==="next")S=m===0?O:m,a=ce+S,se&&!De&&(a=(ce+O)%xe+m),De||(a=he+O);else if(u.message==="dots")a=u.index*u.slidesToScroll;else if(u.message==="children"){if(a=u.index,De){var Te=jb(Ar(Ar({},o),{},{targetSlide:a}));a>u.currentSlide&&Te==="left"?a=a-xe:a<u.currentSlide&&Te==="right"&&(a=a+xe)}}else u.message==="index"&&(a=Number(u.index));return a};at.changeSlide=Jk;var Qk=function(o,u,m){return o.target.tagName.match("TEXTAREA|INPUT|SELECT")||!u?"":o.keyCode===37?m?"next":"previous":o.keyCode===39?m?"previous":"next":""};at.keyHandler=Qk;var eM=function(o,u,m){return o.target.tagName==="IMG"&&al(o),!u||!m&&o.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:o.touches?o.touches[0].pageX:o.clientX,startY:o.touches?o.touches[0].pageY:o.clientY,curX:o.touches?o.touches[0].pageX:o.clientX,curY:o.touches?o.touches[0].pageY:o.clientY}}};at.swipeStart=eM;var tM=function(o,u){var m=u.scrolling,_=u.animating,S=u.vertical,k=u.swipeToSlide,a=u.verticalSwiping,O=u.rtl,X=u.currentSlide,xe=u.edgeFriction,ce=u.edgeDragged,he=u.onEdge,se=u.swiped,De=u.swiping,Te=u.slideCount,ne=u.slidesToScroll,Y=u.infinite,Q=u.touchObject,ge=u.swipeEvent,we=u.listHeight,He=u.listWidth;if(!m){if(_)return al(o);S&&k&&a&&al(o);var Ee,Qe={},Ve=qh(u);Q.curX=o.touches?o.touches[0].pageX:o.clientX,Q.curY=o.touches?o.touches[0].pageY:o.clientY,Q.swipeLength=Math.round(Math.sqrt(Math.pow(Q.curX-Q.startX,2)));var Fe=Math.round(Math.sqrt(Math.pow(Q.curY-Q.startY,2)));if(!a&&!De&&Fe>10)return{scrolling:!0};a&&(Q.swipeLength=Fe);var nt=(O?-1:1)*(Q.curX>Q.startX?1:-1);a&&(nt=Q.curY>Q.startY?1:-1);var bt=Math.ceil(Te/ne),ut=Ly(u.touchObject,a),st=Q.swipeLength;return Y||(X===0&&(ut==="right"||ut==="down")||X+1>=bt&&(ut==="left"||ut==="up")||!Oy(u)&&(ut==="left"||ut==="up"))&&(st=Q.swipeLength*xe,ce===!1&&he&&(he(ut),Qe.edgeDragged=!0)),!se&&ge&&(ge(ut),Qe.swiped=!0),S?Ee=Ve+st*(we/He)*nt:O?Ee=Ve-st*nt:Ee=Ve+st*nt,a&&(Ee=Ve+st*nt),Qe=Ar(Ar({},Qe),{},{touchObject:Q,swipeLeft:Ee,trackStyle:Zh(Ar(Ar({},u),{},{left:Ee}))}),Math.abs(Q.curX-Q.startX)<Math.abs(Q.curY-Q.startY)*.8||Q.swipeLength>10&&(Qe.swiping=!0,al(o)),Qe}};at.swipeMove=tM;var rM=function(o,u){var m=u.dragging,_=u.swipe,S=u.touchObject,k=u.listWidth,a=u.touchThreshold,O=u.verticalSwiping,X=u.listHeight,xe=u.swipeToSlide,ce=u.scrolling,he=u.onSwipe,se=u.targetSlide,De=u.currentSlide,Te=u.infinite;if(!m)return _&&al(o),{};var ne=O?X/a:k/a,Y=Ly(S,O),Q={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(ce||!S.swipeLength)return Q;if(S.swipeLength>ne){al(o),he&&he(Y);var ge,we,He=Te?De:se;switch(Y){case"left":case"up":we=He+By(u),ge=xe?Ry(u,we):we,Q.currentDirection=0;break;case"right":case"down":we=He-By(u),ge=xe?Ry(u,we):we,Q.currentDirection=1;break;default:ge=He}Q.triggerSlideHandler=ge}else{var Ee=qh(u);Q.trackStyle=Fy(Ar(Ar({},u),{},{left:Ee}))}return Q};at.swipeEnd=rM;var Fb=function(o){for(var u=o.infinite?o.slideCount*2:o.slideCount,m=o.infinite?o.slidesToShow*-1:0,_=o.infinite?o.slidesToShow*-1:0,S=[];m<u;)S.push(m),m=_+o.slidesToScroll,_+=Math.min(o.slidesToScroll,o.slidesToShow);return S};at.getNavigableIndexes=Fb;var Ry=function(o,u){var m=Fb(o),_=0;if(u>m[m.length-1])u=m[m.length-1];else for(var S in m){if(u<m[S]){u=_;break}_=m[S]}return u};at.checkNavigable=Ry;var By=function(o){var u=o.centerMode?o.slideWidth*Math.floor(o.slidesToShow/2):0;if(o.swipeToSlide){var m,_=o.listRef,S=_.querySelectorAll&&_.querySelectorAll(".slick-slide")||[];if(Array.from(S).every(function(O){if(o.vertical){if(O.offsetTop+Dy(O)/2>o.swipeLeft*-1)return m=O,!1}else if(O.offsetLeft-u+Mf(O)/2>o.swipeLeft*-1)return m=O,!1;return!0}),!m)return 0;var k=o.rtl===!0?o.slideCount-o.currentSlide:o.currentSlide,a=Math.abs(m.dataset.index-k)||1;return a}else return o.slidesToScroll};at.getSlideCount=By;var If=function(o,u){return u.reduce(function(m,_){return m&&o.hasOwnProperty(_)},!0)?null:console.error("Keys Missing:",o)};at.checkSpecKeys=If;var Zh=function(o){If(o,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var u,m,_=o.slideCount+2*o.slidesToShow;o.vertical?m=_*o.slideHeight:u=Nb(o)*o.slideWidth;var S={opacity:1,transition:"",WebkitTransition:""};if(o.useTransform){var k=o.vertical?"translate3d(0px, "+o.left+"px, 0px)":"translate3d("+o.left+"px, 0px, 0px)",a=o.vertical?"translate3d(0px, "+o.left+"px, 0px)":"translate3d("+o.left+"px, 0px, 0px)",O=o.vertical?"translateY("+o.left+"px)":"translateX("+o.left+"px)";S=Ar(Ar({},S),{},{WebkitTransform:k,transform:a,msTransform:O})}else o.vertical?S.top=o.left:S.left=o.left;return o.fade&&(S={opacity:1}),u&&(S.width=u),m&&(S.height=m),window&&!window.addEventListener&&window.attachEvent&&(o.vertical?S.marginTop=o.left+"px":S.marginLeft=o.left+"px"),S};at.getTrackCSS=Zh;var Fy=function(o){If(o,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var u=Zh(o);return o.useTransform?(u.WebkitTransition="-webkit-transform "+o.speed+"ms "+o.cssEase,u.transition="transform "+o.speed+"ms "+o.cssEase):o.vertical?u.transition="top "+o.speed+"ms "+o.cssEase:u.transition="left "+o.speed+"ms "+o.cssEase,u};at.getTrackAnimateCSS=Fy;var qh=function(o){if(o.unslick)return 0;If(o,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var u=o.slideIndex,m=o.trackRef,_=o.infinite,S=o.centerMode,k=o.slideCount,a=o.slidesToShow,O=o.slidesToScroll,X=o.slideWidth,xe=o.listWidth,ce=o.variableWidth,he=o.slideHeight,se=o.fade,De=o.vertical,Te=0,ne,Y,Q=0;if(se||o.slideCount===1)return 0;var ge=0;if(_?(ge=-Wh(o),k%O!=0&&u+O>k&&(ge=-(u>k?a-(u-k):k%O)),S&&(ge+=parseInt(a/2))):(k%O!=0&&u+O>k&&(ge=a-k%O),S&&(ge=parseInt(a/2))),Te=ge*X,Q=ge*he,De?ne=u*he*-1+Q:ne=u*X*-1+Te,ce===!0){var we,He=m&&m.node;if(we=u+Wh(o),Y=He&&He.childNodes[we],ne=Y?Y.offsetLeft*-1:0,S===!0){we=_?u+Wh(o):u,Y=He&&He.children[we],ne=0;for(var Ee=0;Ee<we;Ee++)ne-=He&&He.children[Ee]&&He.children[Ee].offsetWidth;ne-=parseInt(o.centerPadding),ne+=Y&&(xe-Y.offsetWidth)/2}}return ne};at.getTrackLeft=qh;var Wh=function(o){return o.unslick||!o.infinite?0:o.variableWidth?o.slideCount:o.slidesToShow+(o.centerMode?1:0)};at.getPreClones=Wh;var Ub=function(o){return o.unslick||!o.infinite?0:o.slideCount};at.getPostClones=Ub;var Nb=function(o){return o.slideCount===1?1:Wh(o)+o.slideCount+Ub(o)};at.getTotalSlides=Nb;var jb=function(o){return o.targetSlide>o.currentSlide?o.targetSlide>o.currentSlide+Vb(o)?"left":"right":o.targetSlide<o.currentSlide-$b(o)?"right":"left"};at.siblingDirection=jb;var Vb=function(o){var u=o.slidesToShow,m=o.centerMode,_=o.rtl,S=o.centerPadding;if(m){var k=(u-1)/2+1;return parseInt(S)>0&&(k+=1),_&&u%2==0&&(k+=1),k}return _?0:u-1};at.slidesOnRight=Vb;var $b=function(o){var u=o.slidesToShow,m=o.centerMode,_=o.rtl,S=o.centerPadding;if(m){var k=(u-1)/2+1;return parseInt(S)>0&&(k+=1),!_&&u%2==0&&(k+=1),k}return _?u-1:0};at.slidesOnLeft=$b;var nM=function(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)};at.canUseDOM=nM;var Af={};Object.defineProperty(Af,"__esModule",{value:!0});Af.Track=void 0;var ta=Gb(Yi.exports),Uy=Gb(Gh.exports),Ny=at;function Gb(i){return i&&i.__esModule?i:{default:i}}function zf(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zf=function(u){return typeof u}:zf=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},zf(i)}function jy(){return jy=Object.assign||function(i){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(i[m]=u[m])}return i},jy.apply(this,arguments)}function iM(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")}function Zb(i,o){for(var u=0;u<o.length;u++){var m=o[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}function oM(i,o,u){return o&&Zb(i.prototype,o),u&&Zb(i,u),i}function sM(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(o&&o.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),o&&Vy(i,o)}function Vy(i,o){return Vy=Object.setPrototypeOf||function(m,_){return m.__proto__=_,m},Vy(i,o)}function aM(i){var o=cM();return function(){var m=Pf(i),_;if(o){var S=Pf(this).constructor;_=Reflect.construct(m,arguments,S)}else _=m.apply(this,arguments);return lM(this,_)}}function lM(i,o){return o&&(zf(o)==="object"||typeof o=="function")?o:$y(i)}function $y(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function cM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Pf(i){return Pf=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},Pf(i)}function qb(i,o){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);o&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),u.push.apply(u,m)}return u}function oi(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?qb(Object(u),!0).forEach(function(m){Gy(i,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(u)):qb(Object(u)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(u,m))})}return i}function Gy(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}var Zy=function(o){var u,m,_,S,k;o.rtl?k=o.slideCount-1-o.index:k=o.index,_=k<0||k>=o.slideCount,o.centerMode?(S=Math.floor(o.slidesToShow/2),m=(k-o.currentSlide)%o.slideCount==0,k>o.currentSlide-S-1&&k<=o.currentSlide+S&&(u=!0)):u=o.currentSlide<=k&&k<o.currentSlide+o.slidesToShow;var a;o.targetSlide<0?a=o.targetSlide+o.slideCount:o.targetSlide>=o.slideCount?a=o.targetSlide-o.slideCount:a=o.targetSlide;var O=k===a;return{"slick-slide":!0,"slick-active":u,"slick-center":m,"slick-cloned":_,"slick-current":O}},uM=function(o){var u={};return(o.variableWidth===void 0||o.variableWidth===!1)&&(u.width=o.slideWidth),o.fade&&(u.position="relative",o.vertical?u.top=-o.index*parseInt(o.slideHeight):u.left=-o.index*parseInt(o.slideWidth),u.opacity=o.currentSlide===o.index?1:0,o.useCSS&&(u.transition="opacity "+o.speed+"ms "+o.cssEase+", visibility "+o.speed+"ms "+o.cssEase)),u},qy=function(o,u){return o.key||u},hM=function(o){var u,m=[],_=[],S=[],k=ta.default.Children.count(o.children),a=(0,Ny.lazyStartIndex)(o),O=(0,Ny.lazyEndIndex)(o);return ta.default.Children.forEach(o.children,function(X,xe){var ce,he={message:"children",index:xe,slidesToScroll:o.slidesToScroll,currentSlide:o.currentSlide};!o.lazyLoad||o.lazyLoad&&o.lazyLoadedList.indexOf(xe)>=0?ce=X:ce=ta.default.createElement("div",null);var se=uM(oi(oi({},o),{},{index:xe})),De=ce.props.className||"",Te=Zy(oi(oi({},o),{},{index:xe}));if(m.push(ta.default.cloneElement(ce,{key:"original"+qy(ce,xe),"data-index":xe,className:(0,Uy.default)(Te,De),tabIndex:"-1","aria-hidden":!Te["slick-active"],style:oi(oi({outline:"none"},ce.props.style||{}),se),onClick:function(Q){ce.props&&ce.props.onClick&&ce.props.onClick(Q),o.focusOnSelect&&o.focusOnSelect(he)}})),o.infinite&&o.fade===!1){var ne=k-xe;ne<=(0,Ny.getPreClones)(o)&&k!==o.slidesToShow&&(u=-ne,u>=a&&(ce=X),Te=Zy(oi(oi({},o),{},{index:u})),_.push(ta.default.cloneElement(ce,{key:"precloned"+qy(ce,u),"data-index":u,tabIndex:"-1",className:(0,Uy.default)(Te,De),"aria-hidden":!Te["slick-active"],style:oi(oi({},ce.props.style||{}),se),onClick:function(Q){ce.props&&ce.props.onClick&&ce.props.onClick(Q),o.focusOnSelect&&o.focusOnSelect(he)}}))),k!==o.slidesToShow&&(u=k+xe,u<O&&(ce=X),Te=Zy(oi(oi({},o),{},{index:u})),S.push(ta.default.cloneElement(ce,{key:"postcloned"+qy(ce,u),"data-index":u,tabIndex:"-1",className:(0,Uy.default)(Te,De),"aria-hidden":!Te["slick-active"],style:oi(oi({},ce.props.style||{}),se),onClick:function(Q){ce.props&&ce.props.onClick&&ce.props.onClick(Q),o.focusOnSelect&&o.focusOnSelect(he)}})))}}),o.rtl?_.concat(m,S).reverse():_.concat(m,S)},dM=function(i){sM(u,i);var o=aM(u);function u(){var m;iM(this,u);for(var _=arguments.length,S=new Array(_),k=0;k<_;k++)S[k]=arguments[k];return m=o.call.apply(o,[this].concat(S)),Gy($y(m),"node",null),Gy($y(m),"handleRef",function(a){m.node=a}),m}return oM(u,[{key:"render",value:function(){var _=hM(this.props),S=this.props,k=S.onMouseEnter,a=S.onMouseOver,O=S.onMouseLeave,X={onMouseEnter:k,onMouseOver:a,onMouseLeave:O};return ta.default.createElement("div",jy({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},X),_)}}]),u}(ta.default.PureComponent);Af.Track=dM;var Df={};Object.defineProperty(Df,"__esModule",{value:!0});Df.Dots=void 0;var Lf=Hb(Yi.exports),pM=Hb(Gh.exports),Wb=at;function Hb(i){return i&&i.__esModule?i:{default:i}}function Of(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Of=function(u){return typeof u}:Of=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},Of(i)}function Xb(i,o){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);o&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),u.push.apply(u,m)}return u}function fM(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?Xb(Object(u),!0).forEach(function(m){mM(i,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(u)):Xb(Object(u)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(u,m))})}return i}function mM(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}function _M(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")}function Yb(i,o){for(var u=0;u<o.length;u++){var m=o[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}function gM(i,o,u){return o&&Yb(i.prototype,o),u&&Yb(i,u),i}function yM(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(o&&o.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),o&&Wy(i,o)}function Wy(i,o){return Wy=Object.setPrototypeOf||function(m,_){return m.__proto__=_,m},Wy(i,o)}function vM(i){var o=bM();return function(){var m=Rf(i),_;if(o){var S=Rf(this).constructor;_=Reflect.construct(m,arguments,S)}else _=m.apply(this,arguments);return xM(this,_)}}function xM(i,o){return o&&(Of(o)==="object"||typeof o=="function")?o:wM(i)}function wM(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function bM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Rf(i){return Rf=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},Rf(i)}var TM=function(o){var u;return o.infinite?u=Math.ceil(o.slideCount/o.slidesToScroll):u=Math.ceil((o.slideCount-o.slidesToShow)/o.slidesToScroll)+1,u},SM=function(i){yM(u,i);var o=vM(u);function u(){return _M(this,u),o.apply(this,arguments)}return gM(u,[{key:"clickHandler",value:function(_,S){S.preventDefault(),this.props.clickHandler(_)}},{key:"render",value:function(){for(var _=this.props,S=_.onMouseEnter,k=_.onMouseOver,a=_.onMouseLeave,O=_.infinite,X=_.slidesToScroll,xe=_.slidesToShow,ce=_.slideCount,he=_.currentSlide,se=TM({slideCount:ce,slidesToScroll:X,slidesToShow:xe,infinite:O}),De={onMouseEnter:S,onMouseOver:k,onMouseLeave:a},Te=[],ne=0;ne<se;ne++){var Y=(ne+1)*X-1,Q=O?Y:(0,Wb.clamp)(Y,0,ce-1),ge=Q-(X-1),we=O?ge:(0,Wb.clamp)(ge,0,ce-1),He=(0,pM.default)({"slick-active":O?he>=we&&he<=Q:he===we}),Ee={message:"dots",index:ne,slidesToScroll:X,currentSlide:he},Qe=this.clickHandler.bind(this,Ee);Te=Te.concat(Lf.default.createElement("li",{key:ne,className:He},Lf.default.cloneElement(this.props.customPaging(ne),{onClick:Qe})))}return Lf.default.cloneElement(this.props.appendDots(Te),fM({className:this.props.dotsClass},De))}}]),u}(Lf.default.PureComponent);Df.Dots=SM;var Gc={};Object.defineProperty(Gc,"__esModule",{value:!0});Gc.NextArrow=Gc.PrevArrow=void 0;var Zc=Jb(Yi.exports),Kb=Jb(Gh.exports),EM=at;function Jb(i){return i&&i.__esModule?i:{default:i}}function Bf(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bf=function(u){return typeof u}:Bf=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},Bf(i)}function Ff(){return Ff=Object.assign||function(i){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(i[m]=u[m])}return i},Ff.apply(this,arguments)}function Qb(i,o){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);o&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),u.push.apply(u,m)}return u}function Uf(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?Qb(Object(u),!0).forEach(function(m){CM(i,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(u)):Qb(Object(u)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(u,m))})}return i}function CM(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}function e2(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")}function t2(i,o){for(var u=0;u<o.length;u++){var m=o[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}function r2(i,o,u){return o&&t2(i.prototype,o),u&&t2(i,u),i}function n2(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(o&&o.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),o&&Hy(i,o)}function Hy(i,o){return Hy=Object.setPrototypeOf||function(m,_){return m.__proto__=_,m},Hy(i,o)}function i2(i){var o=IM();return function(){var m=Nf(i),_;if(o){var S=Nf(this).constructor;_=Reflect.construct(m,arguments,S)}else _=m.apply(this,arguments);return kM(this,_)}}function kM(i,o){return o&&(Bf(o)==="object"||typeof o=="function")?o:MM(i)}function MM(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function IM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Nf(i){return Nf=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},Nf(i)}var AM=function(i){n2(u,i);var o=i2(u);function u(){return e2(this,u),o.apply(this,arguments)}return r2(u,[{key:"clickHandler",value:function(_,S){S&&S.preventDefault(),this.props.clickHandler(_,S)}},{key:"render",value:function(){var _={"slick-arrow":!0,"slick-prev":!0},S=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(_["slick-disabled"]=!0,S=null);var k={key:"0","data-role":"none",className:(0,Kb.default)(_),style:{display:"block"},onClick:S},a={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},O;return this.props.prevArrow?O=Zc.default.cloneElement(this.props.prevArrow,Uf(Uf({},k),a)):O=Zc.default.createElement("button",Ff({key:"0",type:"button"},k)," ","Previous"),O}}]),u}(Zc.default.PureComponent);Gc.PrevArrow=AM;var zM=function(i){n2(u,i);var o=i2(u);function u(){return e2(this,u),o.apply(this,arguments)}return r2(u,[{key:"clickHandler",value:function(_,S){S&&S.preventDefault(),this.props.clickHandler(_,S)}},{key:"render",value:function(){var _={"slick-arrow":!0,"slick-next":!0},S=this.clickHandler.bind(this,{message:"next"});(0,EM.canGoNext)(this.props)||(_["slick-disabled"]=!0,S=null);var k={key:"1","data-role":"none",className:(0,Kb.default)(_),style:{display:"block"},onClick:S},a={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},O;return this.props.nextArrow?O=Zc.default.cloneElement(this.props.nextArrow,Uf(Uf({},k),a)):O=Zc.default.createElement("button",Ff({key:"1",type:"button"},k)," ","Next"),O}}]),u}(Zc.default.PureComponent);Gc.NextArrow=zM;var o2=function(){if(typeof Map!="undefined")return Map;function i(o,u){var m=-1;return o.some(function(_,S){return _[0]===u?(m=S,!0):!1}),m}return function(){function o(){this.__entries__=[]}return Object.defineProperty(o.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),o.prototype.get=function(u){var m=i(this.__entries__,u),_=this.__entries__[m];return _&&_[1]},o.prototype.set=function(u,m){var _=i(this.__entries__,u);~_?this.__entries__[_][1]=m:this.__entries__.push([u,m])},o.prototype.delete=function(u){var m=this.__entries__,_=i(m,u);~_&&m.splice(_,1)},o.prototype.has=function(u){return!!~i(this.__entries__,u)},o.prototype.clear=function(){this.__entries__.splice(0)},o.prototype.forEach=function(u,m){m===void 0&&(m=null);for(var _=0,S=this.__entries__;_<S.length;_++){var k=S[_];u.call(m,k[1],k[0])}},o}()}(),Xy=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,jf=function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()}(),PM=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(jf):function(i){return setTimeout(function(){return i(Date.now())},1e3/60)}}(),DM=2;function LM(i,o){var u=!1,m=!1,_=0;function S(){u&&(u=!1,i()),m&&a()}function k(){PM(S)}function a(){var O=Date.now();if(u){if(O-_<DM)return;m=!0}else u=!0,m=!1,setTimeout(k,o);_=O}return a}var OM=20,RM=["top","right","bottom","left","width","height","size","weight"],BM=typeof MutationObserver!="undefined",FM=function(){function i(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=LM(this.refresh.bind(this),OM)}return i.prototype.addObserver=function(o){~this.observers_.indexOf(o)||this.observers_.push(o),this.connected_||this.connect_()},i.prototype.removeObserver=function(o){var u=this.observers_,m=u.indexOf(o);~m&&u.splice(m,1),!u.length&&this.connected_&&this.disconnect_()},i.prototype.refresh=function(){var o=this.updateObservers_();o&&this.refresh()},i.prototype.updateObservers_=function(){var o=this.observers_.filter(function(u){return u.gatherActive(),u.hasActive()});return o.forEach(function(u){return u.broadcastActive()}),o.length>0},i.prototype.connect_=function(){!Xy||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),BM?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},i.prototype.disconnect_=function(){!Xy||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},i.prototype.onTransitionEnd_=function(o){var u=o.propertyName,m=u===void 0?"":u,_=RM.some(function(S){return!!~m.indexOf(S)});_&&this.refresh()},i.getInstance=function(){return this.instance_||(this.instance_=new i),this.instance_},i.instance_=null,i}(),s2=function(i,o){for(var u=0,m=Object.keys(o);u<m.length;u++){var _=m[u];Object.defineProperty(i,_,{value:o[_],enumerable:!1,writable:!1,configurable:!0})}return i},qc=function(i){var o=i&&i.ownerDocument&&i.ownerDocument.defaultView;return o||jf},a2=$f(0,0,0,0);function Vf(i){return parseFloat(i)||0}function l2(i){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];return o.reduce(function(m,_){var S=i["border-"+_+"-width"];return m+Vf(S)},0)}function UM(i){for(var o=["top","right","bottom","left"],u={},m=0,_=o;m<_.length;m++){var S=_[m],k=i["padding-"+S];u[S]=Vf(k)}return u}function NM(i){var o=i.getBBox();return $f(0,0,o.width,o.height)}function jM(i){var o=i.clientWidth,u=i.clientHeight;if(!o&&!u)return a2;var m=qc(i).getComputedStyle(i),_=UM(m),S=_.left+_.right,k=_.top+_.bottom,a=Vf(m.width),O=Vf(m.height);if(m.boxSizing==="border-box"&&(Math.round(a+S)!==o&&(a-=l2(m,"left","right")+S),Math.round(O+k)!==u&&(O-=l2(m,"top","bottom")+k)),!$M(i)){var X=Math.round(a+S)-o,xe=Math.round(O+k)-u;Math.abs(X)!==1&&(a-=X),Math.abs(xe)!==1&&(O-=xe)}return $f(_.left,_.top,a,O)}var VM=function(){return typeof SVGGraphicsElement!="undefined"?function(i){return i instanceof qc(i).SVGGraphicsElement}:function(i){return i instanceof qc(i).SVGElement&&typeof i.getBBox=="function"}}();function $M(i){return i===qc(i).document.documentElement}function GM(i){return Xy?VM(i)?NM(i):jM(i):a2}function ZM(i){var o=i.x,u=i.y,m=i.width,_=i.height,S=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,k=Object.create(S.prototype);return s2(k,{x:o,y:u,width:m,height:_,top:u,right:o+m,bottom:_+u,left:o}),k}function $f(i,o,u,m){return{x:i,y:o,width:u,height:m}}var qM=function(){function i(o){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=$f(0,0,0,0),this.target=o}return i.prototype.isActive=function(){var o=GM(this.target);return this.contentRect_=o,o.width!==this.broadcastWidth||o.height!==this.broadcastHeight},i.prototype.broadcastRect=function(){var o=this.contentRect_;return this.broadcastWidth=o.width,this.broadcastHeight=o.height,o},i}(),WM=function(){function i(o,u){var m=ZM(u);s2(this,{target:o,contentRect:m})}return i}(),HM=function(){function i(o,u,m){if(this.activeObservations_=[],this.observations_=new o2,typeof o!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=o,this.controller_=u,this.callbackCtx_=m}return i.prototype.observe=function(o){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(o instanceof qc(o).Element))throw new TypeError('parameter 1 is not of type "Element".');var u=this.observations_;u.has(o)||(u.set(o,new qM(o)),this.controller_.addObserver(this),this.controller_.refresh())}},i.prototype.unobserve=function(o){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(o instanceof qc(o).Element))throw new TypeError('parameter 1 is not of type "Element".');var u=this.observations_;!u.has(o)||(u.delete(o),u.size||this.controller_.removeObserver(this))}},i.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},i.prototype.gatherActive=function(){var o=this;this.clearActive(),this.observations_.forEach(function(u){u.isActive()&&o.activeObservations_.push(u)})},i.prototype.broadcastActive=function(){if(!!this.hasActive()){var o=this.callbackCtx_,u=this.activeObservations_.map(function(m){return new WM(m.target,m.broadcastRect())});this.callback_.call(o,u,o),this.clearActive()}},i.prototype.clearActive=function(){this.activeObservations_.splice(0)},i.prototype.hasActive=function(){return this.activeObservations_.length>0},i}(),c2=typeof WeakMap!="undefined"?new WeakMap:new o2,u2=function(){function i(o){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var u=FM.getInstance(),m=new HM(o,u,this);c2.set(this,m)}return i}();["observe","unobserve","disconnect"].forEach(function(i){u2.prototype[i]=function(){var o;return(o=c2.get(this))[i].apply(o,arguments)}});var XM=function(){return typeof jf.ResizeObserver!="undefined"?jf.ResizeObserver:u2}(),YM=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:XM}),KM=bE(YM);Object.defineProperty(kf,"__esModule",{value:!0});kf.InnerSlider=void 0;var jn=Hh(Yi.exports),JM=Hh(zb),QM=Hh(Gk),eI=Hh(Gh.exports),Fr=at,tI=Af,rI=Df,h2=Gc,nI=Hh(KM);function Hh(i){return i&&i.__esModule?i:{default:i}}function Xh(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xh=function(u){return typeof u}:Xh=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},Xh(i)}function Gf(){return Gf=Object.assign||function(i){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(i[m]=u[m])}return i},Gf.apply(this,arguments)}function iI(i,o){if(i==null)return{};var u=oI(i,o),m,_;if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(i);for(_=0;_<S.length;_++)m=S[_],!(o.indexOf(m)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,m)||(u[m]=i[m]))}return u}function oI(i,o){if(i==null)return{};var u={},m=Object.keys(i),_,S;for(S=0;S<m.length;S++)_=m[S],!(o.indexOf(_)>=0)&&(u[_]=i[_]);return u}function d2(i,o){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);o&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),u.push.apply(u,m)}return u}function Tt(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?d2(Object(u),!0).forEach(function(m){Zt(i,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(u)):d2(Object(u)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(u,m))})}return i}function sI(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")}function p2(i,o){for(var u=0;u<o.length;u++){var m=o[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}function aI(i,o,u){return o&&p2(i.prototype,o),u&&p2(i,u),i}function lI(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(o&&o.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),o&&Yy(i,o)}function Yy(i,o){return Yy=Object.setPrototypeOf||function(m,_){return m.__proto__=_,m},Yy(i,o)}function cI(i){var o=hI();return function(){var m=Zf(i),_;if(o){var S=Zf(this).constructor;_=Reflect.construct(m,arguments,S)}else _=m.apply(this,arguments);return uI(this,_)}}function uI(i,o){return o&&(Xh(o)==="object"||typeof o=="function")?o:Gt(i)}function Gt(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function hI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Zf(i){return Zf=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},Zf(i)}function Zt(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}var dI=function(i){lI(u,i);var o=cI(u);function u(m){var _;sI(this,u),_=o.call(this,m),Zt(Gt(_),"listRefHandler",function(k){return _.list=k}),Zt(Gt(_),"trackRefHandler",function(k){return _.track=k}),Zt(Gt(_),"adaptHeight",function(){if(_.props.adaptiveHeight&&_.list){var k=_.list.querySelector('[data-index="'.concat(_.state.currentSlide,'"]'));_.list.style.height=(0,Fr.getHeight)(k)+"px"}}),Zt(Gt(_),"componentDidMount",function(){if(_.props.onInit&&_.props.onInit(),_.props.lazyLoad){var k=(0,Fr.getOnDemandLazySlides)(Tt(Tt({},_.props),_.state));k.length>0&&(_.setState(function(O){return{lazyLoadedList:O.lazyLoadedList.concat(k)}}),_.props.onLazyLoad&&_.props.onLazyLoad(k))}var a=Tt({listRef:_.list,trackRef:_.track},_.props);_.updateState(a,!0,function(){_.adaptHeight(),_.props.autoplay&&_.autoPlay("update")}),_.props.lazyLoad==="progressive"&&(_.lazyLoadTimer=setInterval(_.progressiveLazyLoad,1e3)),_.ro=new nI.default(function(){_.state.animating?(_.onWindowResized(!1),_.callbackTimers.push(setTimeout(function(){return _.onWindowResized()},_.props.speed))):_.onWindowResized()}),_.ro.observe(_.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(O){O.onfocus=_.props.pauseOnFocus?_.onSlideFocus:null,O.onblur=_.props.pauseOnFocus?_.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",_.onWindowResized):window.attachEvent("onresize",_.onWindowResized)}),Zt(Gt(_),"componentWillUnmount",function(){_.animationEndCallback&&clearTimeout(_.animationEndCallback),_.lazyLoadTimer&&clearInterval(_.lazyLoadTimer),_.callbackTimers.length&&(_.callbackTimers.forEach(function(k){return clearTimeout(k)}),_.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",_.onWindowResized):window.detachEvent("onresize",_.onWindowResized),_.autoplayTimer&&clearInterval(_.autoplayTimer),_.ro.disconnect()}),Zt(Gt(_),"componentDidUpdate",function(k){if(_.checkImagesLoad(),_.props.onReInit&&_.props.onReInit(),_.props.lazyLoad){var a=(0,Fr.getOnDemandLazySlides)(Tt(Tt({},_.props),_.state));a.length>0&&(_.setState(function(xe){return{lazyLoadedList:xe.lazyLoadedList.concat(a)}}),_.props.onLazyLoad&&_.props.onLazyLoad(a))}_.adaptHeight();var O=Tt(Tt({listRef:_.list,trackRef:_.track},_.props),_.state),X=_.didPropsChange(k);X&&_.updateState(O,X,function(){_.state.currentSlide>=jn.default.Children.count(_.props.children)&&_.changeSlide({message:"index",index:jn.default.Children.count(_.props.children)-_.props.slidesToShow,currentSlide:_.state.currentSlide}),_.props.autoplay?_.autoPlay("update"):_.pause("paused")})}),Zt(Gt(_),"onWindowResized",function(k){_.debouncedResize&&_.debouncedResize.cancel(),_.debouncedResize=(0,QM.default)(function(){return _.resizeWindow(k)},50),_.debouncedResize()}),Zt(Gt(_),"resizeWindow",function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=Boolean(_.track&&_.track.node);if(!!a){var O=Tt(Tt({listRef:_.list,trackRef:_.track},_.props),_.state);_.updateState(O,k,function(){_.props.autoplay?_.autoPlay("update"):_.pause("paused")}),_.setState({animating:!1}),clearTimeout(_.animationEndCallback),delete _.animationEndCallback}}),Zt(Gt(_),"updateState",function(k,a,O){var X=(0,Fr.initializedState)(k);k=Tt(Tt(Tt({},k),X),{},{slideIndex:X.currentSlide});var xe=(0,Fr.getTrackLeft)(k);k=Tt(Tt({},k),{},{left:xe});var ce=(0,Fr.getTrackCSS)(k);(a||jn.default.Children.count(_.props.children)!==jn.default.Children.count(k.children))&&(X.trackStyle=ce),_.setState(X,O)}),Zt(Gt(_),"ssrInit",function(){if(_.props.variableWidth){var k=0,a=0,O=[],X=(0,Fr.getPreClones)(Tt(Tt(Tt({},_.props),_.state),{},{slideCount:_.props.children.length})),xe=(0,Fr.getPostClones)(Tt(Tt(Tt({},_.props),_.state),{},{slideCount:_.props.children.length}));_.props.children.forEach(function(Qe){O.push(Qe.props.style.width),k+=Qe.props.style.width});for(var ce=0;ce<X;ce++)a+=O[O.length-1-ce],k+=O[O.length-1-ce];for(var he=0;he<xe;he++)k+=O[he];for(var se=0;se<_.state.currentSlide;se++)a+=O[se];var De={width:k+"px",left:-a+"px"};if(_.props.centerMode){var Te="".concat(O[_.state.currentSlide],"px");De.left="calc(".concat(De.left," + (100% - ").concat(Te,") / 2 ) ")}return{trackStyle:De}}var ne=jn.default.Children.count(_.props.children),Y=Tt(Tt(Tt({},_.props),_.state),{},{slideCount:ne}),Q=(0,Fr.getPreClones)(Y)+(0,Fr.getPostClones)(Y)+ne,ge=100/_.props.slidesToShow*Q,we=100/Q,He=-we*((0,Fr.getPreClones)(Y)+_.state.currentSlide)*ge/100;_.props.centerMode&&(He+=(100-we*ge/100)/2);var Ee={width:ge+"%",left:He+"%"};return{slideWidth:we+"%",trackStyle:Ee}}),Zt(Gt(_),"checkImagesLoad",function(){var k=_.list&&_.list.querySelectorAll&&_.list.querySelectorAll(".slick-slide img")||[],a=k.length,O=0;Array.prototype.forEach.call(k,function(X){var xe=function(){return++O&&O>=a&&_.onWindowResized()};if(!X.onclick)X.onclick=function(){return X.parentNode.focus()};else{var ce=X.onclick;X.onclick=function(){ce(),X.parentNode.focus()}}X.onload||(_.props.lazyLoad?X.onload=function(){_.adaptHeight(),_.callbackTimers.push(setTimeout(_.onWindowResized,_.props.speed))}:(X.onload=xe,X.onerror=function(){xe(),_.props.onLazyLoadError&&_.props.onLazyLoadError()}))})}),Zt(Gt(_),"progressiveLazyLoad",function(){for(var k=[],a=Tt(Tt({},_.props),_.state),O=_.state.currentSlide;O<_.state.slideCount+(0,Fr.getPostClones)(a);O++)if(_.state.lazyLoadedList.indexOf(O)<0){k.push(O);break}for(var X=_.state.currentSlide-1;X>=-(0,Fr.getPreClones)(a);X--)if(_.state.lazyLoadedList.indexOf(X)<0){k.push(X);break}k.length>0?(_.setState(function(xe){return{lazyLoadedList:xe.lazyLoadedList.concat(k)}}),_.props.onLazyLoad&&_.props.onLazyLoad(k)):_.lazyLoadTimer&&(clearInterval(_.lazyLoadTimer),delete _.lazyLoadTimer)}),Zt(Gt(_),"slideHandler",function(k){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,O=_.props,X=O.asNavFor,xe=O.beforeChange,ce=O.onLazyLoad,he=O.speed,se=O.afterChange,De=_.state.currentSlide,Te=(0,Fr.slideHandler)(Tt(Tt(Tt({index:k},_.props),_.state),{},{trackRef:_.track,useCSS:_.props.useCSS&&!a})),ne=Te.state,Y=Te.nextState;if(!!ne){xe&&xe(De,ne.currentSlide);var Q=ne.lazyLoadedList.filter(function(ge){return _.state.lazyLoadedList.indexOf(ge)<0});ce&&Q.length>0&&ce(Q),!_.props.waitForAnimate&&_.animationEndCallback&&(clearTimeout(_.animationEndCallback),se&&se(De),delete _.animationEndCallback),_.setState(ne,function(){X&&_.asNavForIndex!==k&&(_.asNavForIndex=k,X.innerSlider.slideHandler(k)),!!Y&&(_.animationEndCallback=setTimeout(function(){var ge=Y.animating,we=iI(Y,["animating"]);_.setState(we,function(){_.callbackTimers.push(setTimeout(function(){return _.setState({animating:ge})},10)),se&&se(ne.currentSlide),delete _.animationEndCallback})},he))})}}),Zt(Gt(_),"changeSlide",function(k){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,O=Tt(Tt({},_.props),_.state),X=(0,Fr.changeSlide)(O,k);if(!(X!==0&&!X)&&(a===!0?_.slideHandler(X,a):_.slideHandler(X),_.props.autoplay&&_.autoPlay("update"),_.props.focusOnSelect)){var xe=_.list.querySelectorAll(".slick-current");xe[0]&&xe[0].focus()}}),Zt(Gt(_),"clickHandler",function(k){_.clickable===!1&&(k.stopPropagation(),k.preventDefault()),_.clickable=!0}),Zt(Gt(_),"keyHandler",function(k){var a=(0,Fr.keyHandler)(k,_.props.accessibility,_.props.rtl);a!==""&&_.changeSlide({message:a})}),Zt(Gt(_),"selectHandler",function(k){_.changeSlide(k)}),Zt(Gt(_),"disableBodyScroll",function(){var k=function(O){O=O||window.event,O.preventDefault&&O.preventDefault(),O.returnValue=!1};window.ontouchmove=k}),Zt(Gt(_),"enableBodyScroll",function(){window.ontouchmove=null}),Zt(Gt(_),"swipeStart",function(k){_.props.verticalSwiping&&_.disableBodyScroll();var a=(0,Fr.swipeStart)(k,_.props.swipe,_.props.draggable);a!==""&&_.setState(a)}),Zt(Gt(_),"swipeMove",function(k){var a=(0,Fr.swipeMove)(k,Tt(Tt(Tt({},_.props),_.state),{},{trackRef:_.track,listRef:_.list,slideIndex:_.state.currentSlide}));!a||(a.swiping&&(_.clickable=!1),_.setState(a))}),Zt(Gt(_),"swipeEnd",function(k){var a=(0,Fr.swipeEnd)(k,Tt(Tt(Tt({},_.props),_.state),{},{trackRef:_.track,listRef:_.list,slideIndex:_.state.currentSlide}));if(!!a){var O=a.triggerSlideHandler;delete a.triggerSlideHandler,_.setState(a),O!==void 0&&(_.slideHandler(O),_.props.verticalSwiping&&_.enableBodyScroll())}}),Zt(Gt(_),"touchEnd",function(k){_.swipeEnd(k),_.clickable=!0}),Zt(Gt(_),"slickPrev",function(){_.callbackTimers.push(setTimeout(function(){return _.changeSlide({message:"previous"})},0))}),Zt(Gt(_),"slickNext",function(){_.callbackTimers.push(setTimeout(function(){return _.changeSlide({message:"next"})},0))}),Zt(Gt(_),"slickGoTo",function(k){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(k=Number(k),isNaN(k))return"";_.callbackTimers.push(setTimeout(function(){return _.changeSlide({message:"index",index:k,currentSlide:_.state.currentSlide},a)},0))}),Zt(Gt(_),"play",function(){var k;if(_.props.rtl)k=_.state.currentSlide-_.props.slidesToScroll;else if((0,Fr.canGoNext)(Tt(Tt({},_.props),_.state)))k=_.state.currentSlide+_.props.slidesToScroll;else return!1;_.slideHandler(k)}),Zt(Gt(_),"autoPlay",function(k){_.autoplayTimer&&clearInterval(_.autoplayTimer);var a=_.state.autoplaying;if(k==="update"){if(a==="hovered"||a==="focused"||a==="paused")return}else if(k==="leave"){if(a==="paused"||a==="focused")return}else if(k==="blur"&&(a==="paused"||a==="hovered"))return;_.autoplayTimer=setInterval(_.play,_.props.autoplaySpeed+50),_.setState({autoplaying:"playing"})}),Zt(Gt(_),"pause",function(k){_.autoplayTimer&&(clearInterval(_.autoplayTimer),_.autoplayTimer=null);var a=_.state.autoplaying;k==="paused"?_.setState({autoplaying:"paused"}):k==="focused"?(a==="hovered"||a==="playing")&&_.setState({autoplaying:"focused"}):a==="playing"&&_.setState({autoplaying:"hovered"})}),Zt(Gt(_),"onDotsOver",function(){return _.props.autoplay&&_.pause("hovered")}),Zt(Gt(_),"onDotsLeave",function(){return _.props.autoplay&&_.state.autoplaying==="hovered"&&_.autoPlay("leave")}),Zt(Gt(_),"onTrackOver",function(){return _.props.autoplay&&_.pause("hovered")}),Zt(Gt(_),"onTrackLeave",function(){return _.props.autoplay&&_.state.autoplaying==="hovered"&&_.autoPlay("leave")}),Zt(Gt(_),"onSlideFocus",function(){return _.props.autoplay&&_.pause("focused")}),Zt(Gt(_),"onSlideBlur",function(){return _.props.autoplay&&_.state.autoplaying==="focused"&&_.autoPlay("blur")}),Zt(Gt(_),"render",function(){var k=(0,eI.default)("slick-slider",_.props.className,{"slick-vertical":_.props.vertical,"slick-initialized":!0}),a=Tt(Tt({},_.props),_.state),O=(0,Fr.extractObject)(a,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),X=_.props.pauseOnHover;O=Tt(Tt({},O),{},{onMouseEnter:X?_.onTrackOver:null,onMouseLeave:X?_.onTrackLeave:null,onMouseOver:X?_.onTrackOver:null,focusOnSelect:_.props.focusOnSelect&&_.clickable?_.selectHandler:null});var xe;if(_.props.dots===!0&&_.state.slideCount>=_.props.slidesToShow){var ce=(0,Fr.extractObject)(a,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),he=_.props.pauseOnDotsHover;ce=Tt(Tt({},ce),{},{clickHandler:_.changeSlide,onMouseEnter:he?_.onDotsLeave:null,onMouseOver:he?_.onDotsOver:null,onMouseLeave:he?_.onDotsLeave:null}),xe=jn.default.createElement(rI.Dots,ce)}var se,De,Te=(0,Fr.extractObject)(a,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);Te.clickHandler=_.changeSlide,_.props.arrows&&(se=jn.default.createElement(h2.PrevArrow,Te),De=jn.default.createElement(h2.NextArrow,Te));var ne=null;_.props.vertical&&(ne={height:_.state.listHeight});var Y=null;_.props.vertical===!1?_.props.centerMode===!0&&(Y={padding:"0px "+_.props.centerPadding}):_.props.centerMode===!0&&(Y={padding:_.props.centerPadding+" 0px"});var Q=Tt(Tt({},ne),Y),ge=_.props.touchMove,we={className:"slick-list",style:Q,onClick:_.clickHandler,onMouseDown:ge?_.swipeStart:null,onMouseMove:_.state.dragging&&ge?_.swipeMove:null,onMouseUp:ge?_.swipeEnd:null,onMouseLeave:_.state.dragging&&ge?_.swipeEnd:null,onTouchStart:ge?_.swipeStart:null,onTouchMove:_.state.dragging&&ge?_.swipeMove:null,onTouchEnd:ge?_.touchEnd:null,onTouchCancel:_.state.dragging&&ge?_.swipeEnd:null,onKeyDown:_.props.accessibility?_.keyHandler:null},He={className:k,dir:"ltr",style:_.props.style};return _.props.unslick&&(we={className:"slick-list"},He={className:k}),jn.default.createElement("div",He,_.props.unslick?"":se,jn.default.createElement("div",Gf({ref:_.listRefHandler},we),jn.default.createElement(tI.Track,Gf({ref:_.trackRefHandler},O),_.props.children)),_.props.unslick?"":De,_.props.unslick?"":xe)}),_.list=null,_.track=null,_.state=Tt(Tt({},JM.default),{},{currentSlide:_.props.initialSlide,slideCount:jn.default.Children.count(_.props.children)}),_.callbackTimers=[],_.clickable=!0,_.debouncedResize=null;var S=_.ssrInit();return _.state=Tt(Tt({},_.state),S),_}return aI(u,[{key:"didPropsChange",value:function(_){for(var S=!1,k=0,a=Object.keys(this.props);k<a.length;k++){var O=a[k];if(!_.hasOwnProperty(O)){S=!0;break}if(!(Xh(_[O])==="object"||typeof _[O]=="function")&&_[O]!==this.props[O]){S=!0;break}}return S||jn.default.Children.count(this.props.children)!==jn.default.Children.count(_.children)}}]),u}(jn.default.Component);kf.InnerSlider=dI;var pI=function(i){return i.replace(/[A-Z]/g,function(o){return"-"+o.toLowerCase()}).toLowerCase()},fI=pI,mI=fI,_I=function(i){var o=/[height|width]$/;return o.test(i)},f2=function(i){var o="",u=Object.keys(i);return u.forEach(function(m,_){var S=i[m];m=mI(m),_I(m)&&typeof S=="number"&&(S=S+"px"),S===!0?o+=m:S===!1?o+="not "+m:o+="("+m+": "+S+")",_<u.length-1&&(o+=" and ")}),o},gI=function(i){var o="";return typeof i=="string"?i:i instanceof Array?(i.forEach(function(u,m){o+=f2(u),m<i.length-1&&(o+=", ")}),o):f2(i)},yI=gI,m2={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=u(Yi.exports);function u(S){return S&&S.__esModule?S:{default:S}}var m={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(k){return o.default.createElement("ul",{style:{display:"block"}},k)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(k){return o.default.createElement("button",null,k+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0},_=m;i.default=_})(m2);function Ky(i){this.options=i,!i.deferSetup&&this.setup()}Ky.prototype={constructor:Ky,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(i){return this.options===i||this.options.match===i}};var vI=Ky;function xI(i,o){var u=0,m=i.length,_;for(u;u<m&&(_=o(i[u],u),_!==!1);u++);}function wI(i){return Object.prototype.toString.apply(i)==="[object Array]"}function bI(i){return typeof i=="function"}var _2={isFunction:bI,isArray:wI,each:xI},TI=vI,Jy=_2.each;function Qy(i,o){this.query=i,this.isUnconditional=o,this.handlers=[],this.mql=window.matchMedia(i);var u=this;this.listener=function(m){u.mql=m.currentTarget||m,u.assess()},this.mql.addListener(this.listener)}Qy.prototype={constuctor:Qy,addHandler:function(i){var o=new TI(i);this.handlers.push(o),this.matches()&&o.on()},removeHandler:function(i){var o=this.handlers;Jy(o,function(u,m){if(u.equals(i))return u.destroy(),!o.splice(m,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){Jy(this.handlers,function(i){i.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var i=this.matches()?"on":"off";Jy(this.handlers,function(o){o[i]()})}};var SI=Qy,EI=SI,ev=_2,CI=ev.each,g2=ev.isFunction,kI=ev.isArray;function tv(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}tv.prototype={constructor:tv,register:function(i,o,u){var m=this.queries,_=u&&this.browserIsIncapable;return m[i]||(m[i]=new EI(i,_)),g2(o)&&(o={match:o}),kI(o)||(o=[o]),CI(o,function(S){g2(S)&&(S={match:S}),m[i].addHandler(S)}),this},unregister:function(i,o){var u=this.queries[i];return u&&(o?u.removeHandler(o):(u.clear(),delete this.queries[i])),this}};var MI=tv,II=MI,AI=new II;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=k(Yi.exports),u=kf,m=k(yI),_=k(m2),S=at;function k(Ve){return Ve&&Ve.__esModule?Ve:{default:Ve}}function a(Ve){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(nt){return typeof nt}:a=function(nt){return nt&&typeof Symbol=="function"&&nt.constructor===Symbol&&nt!==Symbol.prototype?"symbol":typeof nt},a(Ve)}function O(){return O=Object.assign||function(Ve){for(var Fe=1;Fe<arguments.length;Fe++){var nt=arguments[Fe];for(var bt in nt)Object.prototype.hasOwnProperty.call(nt,bt)&&(Ve[bt]=nt[bt])}return Ve},O.apply(this,arguments)}function X(Ve,Fe){var nt=Object.keys(Ve);if(Object.getOwnPropertySymbols){var bt=Object.getOwnPropertySymbols(Ve);Fe&&(bt=bt.filter(function(ut){return Object.getOwnPropertyDescriptor(Ve,ut).enumerable})),nt.push.apply(nt,bt)}return nt}function xe(Ve){for(var Fe=1;Fe<arguments.length;Fe++){var nt=arguments[Fe]!=null?arguments[Fe]:{};Fe%2?X(Object(nt),!0).forEach(function(bt){He(Ve,bt,nt[bt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ve,Object.getOwnPropertyDescriptors(nt)):X(Object(nt)).forEach(function(bt){Object.defineProperty(Ve,bt,Object.getOwnPropertyDescriptor(nt,bt))})}return Ve}function ce(Ve,Fe){if(!(Ve instanceof Fe))throw new TypeError("Cannot call a class as a function")}function he(Ve,Fe){for(var nt=0;nt<Fe.length;nt++){var bt=Fe[nt];bt.enumerable=bt.enumerable||!1,bt.configurable=!0,"value"in bt&&(bt.writable=!0),Object.defineProperty(Ve,bt.key,bt)}}function se(Ve,Fe,nt){return Fe&&he(Ve.prototype,Fe),nt&&he(Ve,nt),Ve}function De(Ve,Fe){if(typeof Fe!="function"&&Fe!==null)throw new TypeError("Super expression must either be null or a function");Ve.prototype=Object.create(Fe&&Fe.prototype,{constructor:{value:Ve,writable:!0,configurable:!0}}),Fe&&Te(Ve,Fe)}function Te(Ve,Fe){return Te=Object.setPrototypeOf||function(bt,ut){return bt.__proto__=ut,bt},Te(Ve,Fe)}function ne(Ve){var Fe=ge();return function(){var bt=we(Ve),ut;if(Fe){var st=we(this).constructor;ut=Reflect.construct(bt,arguments,st)}else ut=bt.apply(this,arguments);return Y(this,ut)}}function Y(Ve,Fe){return Fe&&(a(Fe)==="object"||typeof Fe=="function")?Fe:Q(Ve)}function Q(Ve){if(Ve===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ve}function ge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function we(Ve){return we=Object.setPrototypeOf?Object.getPrototypeOf:function(nt){return nt.__proto__||Object.getPrototypeOf(nt)},we(Ve)}function He(Ve,Fe,nt){return Fe in Ve?Object.defineProperty(Ve,Fe,{value:nt,enumerable:!0,configurable:!0,writable:!0}):Ve[Fe]=nt,Ve}var Ee=(0,S.canUseDOM)()&&AI,Qe=function(Ve){De(nt,Ve);var Fe=ne(nt);function nt(bt){var ut;return ce(this,nt),ut=Fe.call(this,bt),He(Q(ut),"innerSliderRefHandler",function(st){return ut.innerSlider=st}),He(Q(ut),"slickPrev",function(){return ut.innerSlider.slickPrev()}),He(Q(ut),"slickNext",function(){return ut.innerSlider.slickNext()}),He(Q(ut),"slickGoTo",function(st){var $r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return ut.innerSlider.slickGoTo(st,$r)}),He(Q(ut),"slickPause",function(){return ut.innerSlider.pause("paused")}),He(Q(ut),"slickPlay",function(){return ut.innerSlider.autoPlay("play")}),ut.state={breakpoint:null},ut._responsiveMediaHandlers=[],ut}return se(nt,[{key:"media",value:function(ut,st){Ee.register(ut,st),this._responsiveMediaHandlers.push({query:ut,handler:st})}},{key:"componentDidMount",value:function(){var ut=this;if(this.props.responsive){var st=this.props.responsive.map(function(ar){return ar.breakpoint});st.sort(function(ar,ur){return ar-ur}),st.forEach(function(ar,ur){var wr;ur===0?wr=(0,m.default)({minWidth:0,maxWidth:ar}):wr=(0,m.default)({minWidth:st[ur-1]+1,maxWidth:ar}),(0,S.canUseDOM)()&&ut.media(wr,function(){ut.setState({breakpoint:ar})})});var $r=(0,m.default)({minWidth:st.slice(-1)[0]});(0,S.canUseDOM)()&&this.media($r,function(){ut.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(ut){Ee.unregister(ut.query,ut.handler)})}},{key:"render",value:function(){var ut=this,st,$r;this.state.breakpoint?($r=this.props.responsive.filter(function($t){return $t.breakpoint===ut.state.breakpoint}),st=$r[0].settings==="unslick"?"unslick":xe(xe(xe({},_.default),this.props),$r[0].settings)):st=xe(xe({},_.default),this.props),st.centerMode&&(st.slidesToScroll>1,st.slidesToScroll=1),st.fade&&(st.slidesToShow>1,st.slidesToScroll>1,st.slidesToShow=1,st.slidesToScroll=1);var ar=o.default.Children.toArray(this.props.children);ar=ar.filter(function($t){return typeof $t=="string"?!!$t.trim():!!$t}),st.variableWidth&&(st.rows>1||st.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),st.variableWidth=!1);for(var ur=[],wr=null,Gr=0;Gr<ar.length;Gr+=st.rows*st.slidesPerRow){for(var Wr=[],dn=Gr;dn<Gr+st.rows*st.slidesPerRow;dn+=st.slidesPerRow){for(var je=[],gt=dn;gt<dn+st.slidesPerRow&&(st.variableWidth&&ar[gt].props.style&&(wr=ar[gt].props.style.width),!(gt>=ar.length));gt+=1)je.push(o.default.cloneElement(ar[gt],{key:100*Gr+10*dn+gt,tabIndex:-1,style:{width:"".concat(100/st.slidesPerRow,"%"),display:"inline-block"}}));Wr.push(o.default.createElement("div",{key:10*Gr+dn},je))}st.variableWidth?ur.push(o.default.createElement("div",{key:Gr,style:{width:wr}},Wr)):ur.push(o.default.createElement("div",{key:Gr},Wr))}if(st==="unslick"){var St="regular slider "+(this.props.className||"");return o.default.createElement("div",{className:St},ar)}else ur.length<=st.slidesToShow&&(st.unslick=!0);return o.default.createElement(u.InnerSlider,O({style:this.props.style,ref:this.innerSliderRefHandler},st),ur)}}]),nt}(o.default.Component);i.default=Qe})(Ab);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=u(Ab);function u(_){return _&&_.__esModule?_:{default:_}}var m=o.default;i.default=m})(Ib);var RA=wE(Ib),zI={exports:{}},Yh={};/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PI=Yi.exports,y2=60103;Yh.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var v2=Symbol.for;y2=v2("react.element"),Yh.Fragment=v2("react.fragment")}var DI=PI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LI=Object.prototype.hasOwnProperty,OI={key:!0,ref:!0,__self:!0,__source:!0};function x2(i,o,u){var m,_={},S=null,k=null;u!==void 0&&(S=""+u),o.key!==void 0&&(S=""+o.key),o.ref!==void 0&&(k=o.ref);for(m in o)LI.call(o,m)&&!OI.hasOwnProperty(m)&&(_[m]=o[m]);if(i&&i.defaultProps)for(m in o=i.defaultProps,o)_[m]===void 0&&(_[m]=o[m]);return{$$typeof:y2,type:i,key:S,ref:k,props:_,_owner:DI.current}}Yh.jsx=x2;Yh.jsxs=x2;zI.exports=Yh;var w2={exports:{}};(function(i,o){(function(u,m){i.exports=m()})(Hu,function(){var u,m,_;function S(a,O){if(!u)u=O;else if(!m)m=O;else{var X="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+u+")(sharedChunk); ("+m+")(sharedChunk); self.onerror = null;",xe={};u(xe),_=O(xe),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(_.workerUrl=window.URL.createObjectURL(new Blob([X],{type:"text/javascript"})))}}S(["exports"],function(a){var O="2.7.0",X=xe;function xe(t,e,n,s){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=n,this.p2y=s}xe.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},xe.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},xe.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},xe.prototype.solveCurveX=function(t,e){var n,s,c,h,f;for(e===void 0&&(e=1e-6),c=t,f=0;f<8;f++){if(h=this.sampleCurveX(c)-t,Math.abs(h)<e)return c;var y=this.sampleCurveDerivativeX(c);if(Math.abs(y)<1e-6)break;c-=h/y}if((c=t)<(n=0))return n;if(c>(s=1))return s;for(;n<s;){if(h=this.sampleCurveX(c),Math.abs(h-t)<e)return c;t>h?n=c:s=c,c=.5*(s-n)+n}return c},xe.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var ce=he;function he(t,e){this.x=t,this.y=e}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),s=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=s,this},_rotateAround:function(t,e){var n=Math.cos(t),s=Math.sin(t),c=e.y+s*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-s*(this.y-e.y),this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(t){return t instanceof he?t:Array.isArray(t)?new he(t[0],t[1]):t};var se=typeof self!="undefined"?self:{},De=1e-6,Te=typeof Float32Array!="undefined"?Float32Array:Array;function ne(){var t=new Te(9);return Te!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Q(t,e,n){var s=e[0],c=e[1],h=e[2],f=e[3],y=e[4],x=e[5],b=e[6],E=e[7],C=e[8],M=e[9],D=e[10],R=e[11],U=e[12],j=e[13],W=e[14],re=e[15],le=n[0],de=n[1],pe=n[2],fe=n[3];return t[0]=le*s+de*y+pe*C+fe*U,t[1]=le*c+de*x+pe*M+fe*j,t[2]=le*h+de*b+pe*D+fe*W,t[3]=le*f+de*E+pe*R+fe*re,t[4]=(le=n[4])*s+(de=n[5])*y+(pe=n[6])*C+(fe=n[7])*U,t[5]=le*c+de*x+pe*M+fe*j,t[6]=le*h+de*b+pe*D+fe*W,t[7]=le*f+de*E+pe*R+fe*re,t[8]=(le=n[8])*s+(de=n[9])*y+(pe=n[10])*C+(fe=n[11])*U,t[9]=le*c+de*x+pe*M+fe*j,t[10]=le*h+de*b+pe*D+fe*W,t[11]=le*f+de*E+pe*R+fe*re,t[12]=(le=n[12])*s+(de=n[13])*y+(pe=n[14])*C+(fe=n[15])*U,t[13]=le*c+de*x+pe*M+fe*j,t[14]=le*h+de*b+pe*D+fe*W,t[15]=le*f+de*E+pe*R+fe*re,t}function ge(t,e,n){var s,c,h,f,y,x,b,E,C,M,D,R,U=n[0],j=n[1],W=n[2];return e===t?(t[12]=e[0]*U+e[4]*j+e[8]*W+e[12],t[13]=e[1]*U+e[5]*j+e[9]*W+e[13],t[14]=e[2]*U+e[6]*j+e[10]*W+e[14],t[15]=e[3]*U+e[7]*j+e[11]*W+e[15]):(c=e[1],h=e[2],f=e[3],y=e[4],x=e[5],b=e[6],E=e[7],C=e[8],M=e[9],D=e[10],R=e[11],t[0]=s=e[0],t[1]=c,t[2]=h,t[3]=f,t[4]=y,t[5]=x,t[6]=b,t[7]=E,t[8]=C,t[9]=M,t[10]=D,t[11]=R,t[12]=s*U+y*j+C*W+e[12],t[13]=c*U+x*j+M*W+e[13],t[14]=h*U+b*j+D*W+e[14],t[15]=f*U+E*j+R*W+e[15]),t}function we(t,e,n){var s=n[0],c=n[1],h=n[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*c,t[5]=e[5]*c,t[6]=e[6]*c,t[7]=e[7]*c,t[8]=e[8]*h,t[9]=e[9]*h,t[10]=e[10]*h,t[11]=e[11]*h,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function He(t,e,n){var s=Math.sin(n),c=Math.cos(n),h=e[4],f=e[5],y=e[6],x=e[7],b=e[8],E=e[9],C=e[10],M=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=h*c+b*s,t[5]=f*c+E*s,t[6]=y*c+C*s,t[7]=x*c+M*s,t[8]=b*c-h*s,t[9]=E*c-f*s,t[10]=C*c-y*s,t[11]=M*c-x*s,t}function Ee(t,e,n){var s=Math.sin(n),c=Math.cos(n),h=e[0],f=e[1],y=e[2],x=e[3],b=e[8],E=e[9],C=e[10],M=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=h*c-b*s,t[1]=f*c-E*s,t[2]=y*c-C*s,t[3]=x*c-M*s,t[8]=h*s+b*c,t[9]=f*s+E*c,t[10]=y*s+C*c,t[11]=x*s+M*c,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Qe=Q;function Ve(){var t=new Te(3);return Te!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Fe(t){var e=new Te(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function nt(t){return Math.hypot(t[0],t[1],t[2])}function bt(t,e,n){var s=new Te(3);return s[0]=t,s[1]=e,s[2]=n,s}function ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function st(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function $r(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function ar(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function ur(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function wr(t,e,n,s){return t[0]=e[0]+n[0]*s,t[1]=e[1]+n[1]*s,t[2]=e[2]+n[2]*s,t}function Gr(t,e){var n=e[0],s=e[1],c=e[2],h=n*n+s*s+c*c;return h>0&&(h=1/Math.sqrt(h)),t[0]=e[0]*h,t[1]=e[1]*h,t[2]=e[2]*h,t}function Wr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function dn(t,e,n){var s=e[0],c=e[1],h=e[2],f=n[0],y=n[1],x=n[2];return t[0]=c*x-h*y,t[1]=h*f-s*x,t[2]=s*y-c*f,t}function je(t,e,n){var s=e[0],c=e[1],h=e[2],f=n[3]*s+n[7]*c+n[11]*h+n[15];return t[0]=(n[0]*s+n[4]*c+n[8]*h+n[12])/(f=f||1),t[1]=(n[1]*s+n[5]*c+n[9]*h+n[13])/f,t[2]=(n[2]*s+n[6]*c+n[10]*h+n[14])/f,t}function gt(t,e,n){var s=n[0],c=n[1],h=n[2],f=e[0],y=e[1],x=e[2],b=c*x-h*y,E=h*f-s*x,C=s*y-c*f,M=c*C-h*E,D=h*b-s*C,R=s*E-c*b,U=2*n[3];return E*=U,C*=U,D*=2,R*=2,t[0]=f+(b*=U)+(M*=2),t[1]=y+E+D,t[2]=x+C+R,t}var St,$t=st,zr=$r,xn=nt;function Hr(t,e,n){var s=e[0],c=e[1],h=e[2],f=e[3];return t[0]=n[0]*s+n[4]*c+n[8]*h+n[12]*f,t[1]=n[1]*s+n[5]*c+n[9]*h+n[13]*f,t[2]=n[2]*s+n[6]*c+n[10]*h+n[14]*f,t[3]=n[3]*s+n[7]*c+n[11]*h+n[15]*f,t}function si(){var t=new Te(4);return Te!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ai(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ll(t,e,n){n*=.5;var s=e[0],c=e[1],h=e[2],f=e[3],y=Math.sin(n),x=Math.cos(n);return t[0]=s*x+f*y,t[1]=c*x+h*y,t[2]=h*x-c*y,t[3]=f*x-s*y,t}function na(t,e){return t[0]===e[0]&&t[1]===e[1]}Ve(),St=new Te(4),Te!=Float32Array&&(St[0]=0,St[1]=0,St[2]=0,St[3]=0),Ve(),bt(1,0,0),bt(0,1,0),si(),si(),ne(),function(){var t;t=new Te(2),Te!=Float32Array&&(t[0]=0,t[1]=0)}();const cl=Math.PI/180,es=180/Math.PI;function Pt(t){return t*cl}function zn(t){return t*es}const Ao=[[0,0],[1,0],[1,1],[0,1]];function ia(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function oa(t,e,n,s){const c=new X(t,e,n,s);return function(h){return c.solve(h)}}const sa=oa(.25,.1,.25,1);function Kt(t,e,n){return Math.min(n,Math.max(e,t))}function eo(t,e,n){return(n=Kt((n-t)/(e-t),0,1))*n*(3-2*n)}function Bi(t,e,n){const s=n-e,c=((t-e)%s+s)%s+e;return c===e?n:c}function zo(t,e,n){if(!t.length)return n(null,[]);let s=t.length;const c=new Array(t.length);let h=null;t.forEach((f,y)=>{e(f,(x,b)=>{x&&(h=x),c[y]=b,--s==0&&n(h,c)})})}function ts(t){const e=[];for(const n in t)e.push(t[n]);return e}function br(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}let aa=1;function la(){return aa++}function ca(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function $n(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function ul(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function rs(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function ns(t,e){return t.indexOf(e,t.length-e.length)!==-1}function to(t,e,n){const s={};for(const c in t)s[c]=e.call(n||this,t[c],c,t);return s}function is(t,e,n){const s={};for(const c in t)e.call(n||this,t[c],c,t)&&(s[c]=t[c]);return s}function Gn(t){return Array.isArray(t)?t.map(Gn):typeof t=="object"&&t?to(t,Gn):t}const hl={};function gr(t){hl[t]||(typeof console!="undefined"&&console.warn(t),hl[t]=!0)}function Zn(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function os(t){let e=0;for(let n,s,c=0,h=t.length,f=h-1;c<h;f=c++)n=t[c],s=t[f],e+=(s.x-n.x)*(n.y+s.y);return e}function xi(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ss(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,s,c,h)=>{const f=c||h;return e[s]=!f||f.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Po,Fi,li,ro=null;function wi(t){if(ro==null){const e=t.navigator?t.navigator.userAgent:null;ro=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return ro}function as(t){try{const e=se[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const Pn={now:()=>li!==void 0?li:se.performance.now(),setNow(t){li=t},restoreNow(){li=void 0},frame(t){const e=se.requestAnimationFrame(t);return{cancel:()=>se.cancelAnimationFrame(e)}},getImageData(t,e=0){const n=se.document.createElement("canvas"),s=n.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,s.drawImage(t,0,0,t.width,t.height),s.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(Po||(Po=se.document.createElement("a")),Po.href=t,Po.href),get devicePixelRatio(){return se.devicePixelRatio},get prefersReducedMotion(){return!!se.matchMedia&&(Fi==null&&(Fi=se.matchMedia("(prefers-reduced-motion: reduce)")),Fi.matches)}};let q;const P={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(q==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{q={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):t}catch{q=t}}return q},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},B={supported:!1,testSupport:function(t){!ae&&H&&(me?_e(t):Z=t)}};let Z,H,ae=!1,me=!1;function _e(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,H),t.isContextLost())return;B.supported=!0}catch{}t.deleteTexture(e),ae=!0}se.document&&(H=se.document.createElement("img"),H.onload=function(){Z&&_e(Z),Z=null,me=!0},H.onerror=function(){ae=!0,Z=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ue="01",ve="NO_ACCESS_TOKEN";function ze(t){return t.indexOf("mapbox:")===0}function Le(t){return P.API_URL_REGEX.test(t)}const Ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function lt(t){const e=t.match(Ue);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function ft(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function mt(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(se.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class yt{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=mt(P.ACCESS_TOKEN);let s="";return s=n&&n.u?se.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(c,h)=>String.fromCharCode(Number("0x"+h)))):P.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=as("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const c=se.localStorage.getItem(n);c&&(this.eventData=JSON.parse(c));const h=se.localStorage.getItem(s);h&&(this.anonId=h)}catch{gr("Unable to read from LocalStorage")}}saveEventData(){const e=as("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{se.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&se.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{gr("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,s,c){if(!P.EVENTS_URL)return;const h=lt(P.EVENTS_URL);h.params.push(`access_token=${c||P.ACCESS_TOKEN||""}`);const f={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:ue,userId:this.anonId},y=n?br(f,n):f,x={url:ft(h),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=Ti(x,b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(c)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const At=new class extends yt{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){P.EVENTS_URL&&P.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>ze(n)||Le(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=mt(P.ACCESS_TOKEN),n=e?e.u:P.ACCESS_TOKEN;let s=n!==this.eventData.tokenU;ul(this.anonId)||(this.anonId=ca(),s=!0);const c=this.queue.shift();if(this.eventData.lastSuccess){const h=new Date(this.eventData.lastSuccess),f=new Date(c),y=(c-this.eventData.lastSuccess)/864e5;s=s||y>=1||y<-1||h.getDate()!==f.getDate()}else s=!0;if(!s)return this.processRequests();this.postEvent(c,{"enabled.telemetry":!1},h=>{h||(this.eventData.lastSuccess=c,this.eventData.tokenU=n)},t)}},lr=At.postTurnstileEvent.bind(At),hr=new class extends yt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,s){this.skuToken=e,this.errorCb=s,P.EVENTS_URL&&(n||P.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(ve)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),ul(this.anonId)||(this.anonId=ca()),this.postEvent(n,{skuToken:this.skuToken},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t))}},rr=hr.postMapLoadEvent.bind(hr),dr=new class extends yt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,s){if(!P.API_URL||!P.SESSION_PATH)return;const c=lt(P.API_URL+P.SESSION_PATH);c.params.push(`sku=${e||""}`),c.params.push(`access_token=${s||P.ACCESS_TOKEN||""}`);const h={url:ft(c),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Jf(h,f=>{this.pendingRequest=null,n(f),this.saveEventData(),this.processRequests(s)})}getSessionAPI(t,e,n,s){this.skuToken=e,this.errorCb=s,P.SESSION_PATH&&P.API_URL&&(n||P.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(ve)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t)}},no=dr.getSessionAPI.bind(dr),Ui=new Set,rn="mapbox-tiles";let bi,dl,Kh=500,Xc=50;function ua(){se.caches&&!bi&&(bi=se.caches.open(rn))}function Yc(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let pl=1/0;const fl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(fl);class ha extends Error{constructor(e,n,s){n===401&&Le(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Kc=xi()?()=>self.worker&&self.worker.referrer:()=>(se.location.protocol==="blob:"?se.parent:se).location.href,ci=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Kc())&&!/^\w+:/.test(n))){if(se.fetch&&se.Request&&se.AbortController&&se.Request.prototype.hasOwnProperty("signal"))return function(s,c){const h=new se.AbortController,f=new se.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Kc(),signal:h.signal});let y=!1,x=!1;const b=(E=f.url).indexOf("sku=")>0&&Le(E);var E;s.type==="json"&&f.headers.set("Accept","application/json");const C=(D,R,U)=>{if(x)return;if(D&&D.message!=="SecurityError"&&gr(D),R&&U)return M(R);const j=Date.now();se.fetch(f).then(W=>{if(W.ok){const re=b?W.clone():null;return M(W,re,j)}return c(new ha(W.statusText,W.status,s.url))}).catch(W=>{W.code!==20&&c(new Error(W.message))})},M=(D,R,U)=>{(s.type==="arrayBuffer"?D.arrayBuffer():s.type==="json"?D.json():D.text()).then(j=>{x||(R&&U&&function(W,re,le){if(ua(),!bi)return;const de={status:re.status,statusText:re.statusText,headers:new se.Headers};re.headers.forEach((fe,Ae)=>de.headers.set(Ae,fe));const pe=ss(re.headers.get("Cache-Control")||"");pe["no-store"]||(pe["max-age"]&&de.headers.set("Expires",new Date(le+1e3*pe["max-age"]).toUTCString()),new Date(de.headers.get("Expires")).getTime()-le<42e4||function(fe,Ae){if(dl===void 0)try{new Response(new ReadableStream),dl=!0}catch{dl=!1}dl?Ae(fe.body):fe.blob().then(Ae)}(re,fe=>{const Ae=new se.Response(fe,de);ua(),bi&&bi.then(Me=>Me.put(Yc(W.url),Ae)).catch(Me=>gr(Me.message))}))}(f,R,U),y=!0,c(null,j,D.headers.get("Cache-Control"),D.headers.get("Expires")))}).catch(j=>{x||c(new Error(j.message))})};return b?function(D,R){if(ua(),!bi)return R(null);const U=Yc(D.url);bi.then(j=>{j.match(U).then(W=>{const re=function(le){if(!le)return!1;const de=new Date(le.headers.get("Expires")||0),pe=ss(le.headers.get("Cache-Control")||"");return de>Date.now()&&!pe["no-cache"]}(W);j.delete(U),re&&j.put(U,W.clone()),R(null,W,re)}).catch(R)}).catch(R)}(f,C):C(null,null),{cancel:()=>{x=!0,y||h.abort()}}}(t,e);if(xi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(s,c){const h=new se.XMLHttpRequest;h.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const f in s.headers)h.setRequestHeader(f,s.headers[f]);return s.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=s.credentials==="include",h.onerror=()=>{c(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let f=h.response;if(s.type==="json")try{f=JSON.parse(h.response)}catch(y){return c(y)}c(null,f,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else c(new ha(h.statusText,h.status,s.url))},h.send(s.body),{cancel:()=>h.abort()}}(t,e)},da=function(t,e){return ci(br(t,{type:"arrayBuffer"}),e)},Ti=function(t,e){return ci(br(t,{method:"POST"}),e)},Jf=function(t,e){return ci(br(t,{method:"GET"}),e)};function Jh(t){const e=se.document.createElement("a");return e.href=t,e.protocol===se.document.location.protocol&&e.host===se.document.location.host}const ls="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let cs,pa;cs=[],pa=0;const Qh=function(t,e){if(B.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),pa>=P.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return cs.push(h),h}pa++;let n=!1;const s=()=>{if(!n)for(n=!0,pa--;cs.length&&pa<P.MAX_PARALLEL_IMAGE_REQUESTS;){const h=cs.shift(),{requestParameters:f,callback:y,cancelled:x}=h;x||(h.cancel=Qh(f,y).cancel)}},c=da(t,(h,f,y,x)=>{s(),h?e(h):f&&(se.createImageBitmap?function(b,E){const C=new se.Blob([new Uint8Array(b)],{type:"image/png"});se.createImageBitmap(C).then(M=>{E(null,M)}).catch(M=>{E(new Error(`Could not load image because of ${M.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(f,(b,E)=>e(b,E,y,x)):function(b,E){const C=new se.Image,M=se.URL;C.onload=()=>{E(null,C),M.revokeObjectURL(C.src),C.onload=null,se.requestAnimationFrame(()=>{C.src=ls})},C.onerror=()=>E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new se.Blob([new Uint8Array(b)],{type:"image/png"});C.src=b.byteLength?M.createObjectURL(D):ls}(f,(b,E)=>e(b,E,y,x)))});return{cancel:()=>{c.cancel(),s()}}};function ed(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function ml(t,e,n){if(n&&n[t]){const s=n[t].indexOf(e);s!==-1&&n[t].splice(s,1)}}class io{constructor(e,n={}){br(this,n),this.type=e}}class _l extends io{constructor(e,n={}){super("error",br({error:e},n))}}class oo{on(e,n){return this._listeners=this._listeners||{},ed(e,n,this._listeners),this}off(e,n){return ml(e,n,this._listeners),ml(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},ed(e,n,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,n){typeof e=="string"&&(e=new io(e,n||{}));const s=e.type;if(this.listens(s)){e.target=this;const c=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const y of c)y.call(this,e);const h=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const y of h)ml(s,y,this._oneTimeListeners),y.call(this,e);const f=this._eventedParent;f&&(br(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),f.fire(e))}else e instanceof _l&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var Ce=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class et{constructor(e,n,s,c){this.message=(e?`${e}: `:"")+s,c&&(this.identifier=c),n!=null&&n.__line__&&(this.line=n.__line__)}}function td(t){const e=t.value;return e?[new et(t.key,e,"constants have been deprecated as of v8")]:[]}function so(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}function kr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ni(t){if(Array.isArray(t))return t.map(Ni);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Ni(t[n]);return e}return kr(t)}class Si extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class gl{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[s,c]of n)this.bindings[s]=c}concat(e){return new gl(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ao={kind:"null"},Ke={kind:"number"},Lt={kind:"string"},Mt={kind:"boolean"},Ei={kind:"color"},us={kind:"object"},It={kind:"value"},fa={kind:"collator"},lo={kind:"formatted"},ma={kind:"resolvedImage"};function qn(t,e){return{kind:"array",itemType:t,N:e}}function yr(t){if(t.kind==="array"){const e=yr(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const Qf=[ao,Ke,Lt,Mt,Ei,lo,us,qn(It),ma];function wn(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!wn(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const n of Qf)if(!wn(n,e))return null}}return`Expected ${yr(t)} but found ${yr(e)} instead.`}function yl(t,e){return e.some(n=>n.kind===t.kind)}function hs(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}function ds(t){var e={exports:{}};return t(e,e.exports),e.exports}var ps=ds(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(y){return(y=Math.round(y))<0?0:y>255?255:y}function c(y){return s(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function h(y){return(x=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:x>1?1:x;var x}function f(y,x,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?y+(x-y)*b*6:2*b<1?x:3*b<2?y+(x-y)*(2/3-b)*6:y}try{e.parseCSSColor=function(y){var x,b=y.replace(/ /g,"").toLowerCase();if(b in n)return n[b].slice();if(b[0]==="#")return b.length===4?(x=parseInt(b.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:b.length===7&&(x=parseInt(b.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var E=b.indexOf("("),C=b.indexOf(")");if(E!==-1&&C+1===b.length){var M=b.substr(0,E),D=b.substr(E+1,C-(E+1)).split(","),R=1;switch(M){case"rgba":if(D.length!==4)return null;R=h(D.pop());case"rgb":return D.length!==3?null:[c(D[0]),c(D[1]),c(D[2]),R];case"hsla":if(D.length!==4)return null;R=h(D.pop());case"hsl":if(D.length!==3)return null;var U=(parseFloat(D[0])%360+360)%360/360,j=h(D[1]),W=h(D[2]),re=W<=.5?W*(j+1):W+j-W*j,le=2*W-re;return[s(255*f(le,re,U+1/3)),s(255*f(le,re,U)),s(255*f(le,re,U-1/3)),R];default:return null}}return null}}catch{}});class jt{constructor(e,n,s,c=1){this.r=e,this.g=n,this.b=s,this.a=c}static parse(e){if(!e)return;if(e instanceof jt)return e;if(typeof e!="string")return;const n=ps.parseCSSColor(e);return n?new jt(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,s,c]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(s)},${c})`}toArray(){const{r:e,g:n,b:s,a:c}=this;return c===0?[0,0,0,0]:[255*e/c,255*n/c,255*s/c,c]}}jt.black=new jt(0,0,0,1),jt.white=new jt(1,1,1,1),jt.transparent=new jt(0,0,0,0),jt.red=new jt(1,0,0,1),jt.blue=new jt(0,0,1,1);class vl{constructor(e,n,s){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Jc{constructor(e,n,s,c,h){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=s,this.fontStack=c,this.textColor=h}}class Et{constructor(e){this.sections=e}static fromString(e){return new Et([new Jc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Et?e:Et.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const s={};n.fontStack&&(s["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(s["font-scale"]=n.scale),n.textColor&&(s["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(s)}return e}}class Wn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Wn({name:e,available:!1}):null}serialize(){return["image",this.name]}}function rd(t,e,n,s){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[t,e,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[t,e,n,s]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function xl(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof jt||t instanceof vl||t instanceof Et||t instanceof Wn)return!0;if(Array.isArray(t)){for(const e of t)if(!xl(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!xl(t[e]))return!1;return!0}return!1}function Pr(t){if(t===null)return ao;if(typeof t=="string")return Lt;if(typeof t=="boolean")return Mt;if(typeof t=="number")return Ke;if(t instanceof jt)return Ei;if(t instanceof vl)return fa;if(t instanceof Et)return lo;if(t instanceof Wn)return ma;if(Array.isArray(t)){const e=t.length;let n;for(const s of t){const c=Pr(s);if(n){if(n===c)continue;n=It;break}n=c}return qn(n||It,e)}return us}function _a(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof jt||t instanceof Et||t instanceof Wn?t.toString():JSON.stringify(t)}class co{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!xl(e[1]))return n.error("invalid value");const s=e[1];let c=Pr(s);const h=n.expectedType;return c.kind!=="array"||c.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(c=h),new co(c,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof jt?["rgba"].concat(this.value.toArray()):this.value instanceof Et?this.value.serialize():this.value}}class Xr{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const wl={string:Lt,number:Ke,boolean:Mt,object:us};class Hn{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let s,c=1;const h=e[0];if(h==="array"){let y,x;if(e.length>2){const b=e[1];if(typeof b!="string"||!(b in wl)||b==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);y=wl[b],c++}else y=It;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);x=e[2],c++}s=qn(y,x)}else s=wl[h];const f=[];for(;c<e.length;c++){const y=n.parse(e[c],c,It);if(!y)return null;f.push(y)}return new Hn(s,f)}evaluate(e){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(e);if(!wn(this.type,Pr(s)))return s;if(n===this.args.length-1)throw new Xr(`Expected value to be of type ${yr(this.type)}, but found ${yr(Pr(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const s=e.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){n.push(s.kind);const c=e.N;(typeof c=="number"||this.args.length>1)&&n.push(c)}}return n.concat(this.args.map(s=>s.serialize()))}}class Ci{constructor(e){this.type=lo,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&typeof s=="object")return n.error("First argument must be an image or text section.");const c=[];let h=!1;for(let f=1;f<=e.length-1;++f){const y=e[f];if(h&&typeof y=="object"&&!Array.isArray(y)){h=!1;let x=null;if(y["font-scale"]&&(x=n.parse(y["font-scale"],1,Ke),!x))return null;let b=null;if(y["text-font"]&&(b=n.parse(y["text-font"],1,qn(Lt)),!b))return null;let E=null;if(y["text-color"]&&(E=n.parse(y["text-color"],1,Ei),!E))return null;const C=c[c.length-1];C.scale=x,C.font=b,C.textColor=E}else{const x=n.parse(e[f],1,It);if(!x)return null;const b=x.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,c.push({content:x,scale:null,font:null,textColor:null})}}return new Ci(c)}evaluate(e){return new Et(this.sections.map(n=>{const s=n.content.evaluate(e);return Pr(s)===ma?new Jc("",s,null,null,null):new Jc(_a(s),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const s={};n.scale&&(s["font-scale"]=n.scale.serialize()),n.font&&(s["text-font"]=n.font.serialize()),n.textColor&&(s["text-color"]=n.textColor.serialize()),e.push(s)}return e}}class Do{constructor(e){this.type=ma,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Lt);return s?new Do(s):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),s=Wn.fromString(n);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(n)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const em={"to-boolean":Mt,"to-color":Ei,"to-number":Ke,"to-string":Lt};class ki{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[0];if((s==="to-boolean"||s==="to-string")&&e.length!==2)return n.error("Expected one argument.");const c=em[s],h=[];for(let f=1;f<e.length;f++){const y=n.parse(e[f],f,It);if(!y)return null;h.push(y)}return new ki(c,h)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let n,s;for(const c of this.args){if(n=c.evaluate(e),s=null,n instanceof jt)return n;if(typeof n=="string"){const h=e.parseColor(n);if(h)return h}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:rd(n[0],n[1],n[2],n[3]),!s))return new jt(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Xr(s||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const s of this.args){if(n=s.evaluate(e),n===null)return 0;const c=Number(n);if(!isNaN(c))return c}throw new Xr(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Et.fromString(_a(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Wn.fromString(_a(this.args[0].evaluate(e))):_a(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ci([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Do(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}const nd=["Unknown","Point","LineString","Polygon"];class id{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?nd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:s,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*n-e[0])+this.featureDistanceData.bearing[1]*(c*n-e[1])}return 0}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=jt.parse(e)),n}}class Dn{constructor(e,n,s,c){this.name=e,this.type=n,this._evaluate=s,this.args=c}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const s=e[0],c=Dn.definitions[s];if(!c)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(c)?c[0]:c.type,f=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,y=f.filter(([b])=>!Array.isArray(b)||b.length===e.length-1);let x=null;for(const[b,E]of y){x=new Sl(n.registry,n.path,null,n.scope);const C=[];let M=!1;for(let D=1;D<e.length;D++){const R=e[D],U=Array.isArray(b)?b[D-1]:b.type,j=x.parse(R,1+C.length,U);if(!j){M=!0;break}C.push(j)}if(!M)if(Array.isArray(b)&&b.length!==C.length)x.error(`Expected ${b.length} arguments, but found ${C.length} instead.`);else{for(let D=0;D<C.length;D++){const R=Array.isArray(b)?b[D]:b.type,U=C[D];x.concat(D+1).checkSubtype(R,U.type)}if(x.errors.length===0)return new Dn(s,h,E,C)}}if(y.length===1)n.errors.push(...x.errors);else{const b=(y.length?y:f).map(([C])=>{return M=C,Array.isArray(M)?`(${M.map(yr).join(", ")})`:`(${yr(M.type)}...)`;var M}).join(" | "),E=[];for(let C=1;C<e.length;C++){const M=n.parse(e[C],1+E.length);if(!M)return null;E.push(yr(M.type))}n.error(`Expected arguments of type ${b}, but found (${E.join(", ")}) instead.`)}return null}static register(e,n){Dn.definitions=n;for(const s in n)e[s]=Dn}}class ga{constructor(e,n,s){this.type=fa,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const s=e[1];if(typeof s!="object"||Array.isArray(s))return n.error("Collator options argument must be an object.");const c=n.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Mt);if(!c)return null;const h=n.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Mt);if(!h)return null;let f=null;return s.locale&&(f=n.parse(s.locale,1,Lt),!f)?null:new ga(c,h,f)}evaluate(e){return new vl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const uo=8192;function bl(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ya(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function od(t,e){const n=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,c=Math.pow(2,e.z);return[Math.round(n*c*uo),Math.round(s*c*uo)]}function sd(t,e,n){const s=t[0]-e[0],c=t[1]-e[1],h=t[0]-n[0],f=t[1]-n[1];return s*f-h*c==0&&s*h<=0&&c*f<=0}function Qc(t,e){let n=!1;for(let f=0,y=e.length;f<y;f++){const x=e[f];for(let b=0,E=x.length;b<E-1;b++){if(sd(t,x[b],x[b+1]))return!1;(c=x[b])[1]>(s=t)[1]!=(h=x[b+1])[1]>s[1]&&s[0]<(h[0]-c[0])*(s[1]-c[1])/(h[1]-c[1])+c[0]&&(n=!n)}}var s,c,h;return n}function ad(t,e){for(let n=0;n<e.length;n++)if(Qc(t,e[n]))return!0;return!1}function eu(t,e,n,s){const c=s[0]-n[0],h=s[1]-n[1],f=(t[0]-n[0])*h-c*(t[1]-n[1]),y=(e[0]-n[0])*h-c*(e[1]-n[1]);return f>0&&y<0||f<0&&y>0}function tm(t,e,n){for(const b of n)for(let E=0;E<b.length-1;++E)if((y=[(f=b[E+1])[0]-(h=b[E])[0],f[1]-h[1]])[0]*(x=[(c=e)[0]-(s=t)[0],c[1]-s[1]])[1]-y[1]*x[0]!=0&&eu(s,c,h,f)&&eu(h,f,s,c))return!0;var s,c,h,f,y,x;return!1}function ld(t,e){for(let n=0;n<t.length;++n)if(!Qc(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(tm(t[n],t[n+1],e))return!1;return!0}function rm(t,e){for(let n=0;n<e.length;n++)if(ld(t,e[n]))return!0;return!1}function tu(t,e,n){const s=[];for(let c=0;c<t.length;c++){const h=[];for(let f=0;f<t[c].length;f++){const y=od(t[c][f],n);bl(e,y),h.push(y)}s.push(h)}return s}function cd(t,e,n){const s=[];for(let c=0;c<t.length;c++){const h=tu(t[c],e,n);s.push(h)}return s}function ru(t,e,n,s){if(t[0]<n[0]||t[0]>n[2]){const c=.5*s;let h=t[0]-n[0]>c?-s:n[0]-t[0]>c?s:0;h===0&&(h=t[0]-n[2]>c?-s:n[2]-t[0]>c?s:0),t[0]+=h}bl(e,t)}function ud(t,e,n,s){const c=Math.pow(2,s.z)*uo,h=[s.x*uo,s.y*uo],f=[];for(const y of t)for(const x of y){const b=[x.x+h[0],x.y+h[1]];ru(b,e,n,c),f.push(b)}return f}function hd(t,e,n,s){const c=Math.pow(2,s.z)*uo,h=[s.x*uo,s.y*uo],f=[];for(const x of t){const b=[];for(const E of x){const C=[E.x+h[0],E.y+h[1]];bl(e,C),b.push(C)}f.push(b)}if(e[2]-e[0]<=c/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const x of f)for(const b of x)ru(b,e,n,c)}var y;return f}class Lo{constructor(e,n){this.type=Mt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(xl(e[1])){const s=e[1];if(s.type==="FeatureCollection")for(let c=0;c<s.features.length;++c){const h=s.features[c].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Lo(s,s.features[c].geometry)}else if(s.type==="Feature"){const c=s.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new Lo(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Lo(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,s){const c=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],f=n.canonicalID();if(s.type==="Polygon"){const y=tu(s.coordinates,h,f),x=ud(n.geometry(),c,h,f);if(!ya(c,h))return!1;for(const b of x)if(!Qc(b,y))return!1}if(s.type==="MultiPolygon"){const y=cd(s.coordinates,h,f),x=ud(n.geometry(),c,h,f);if(!ya(c,h))return!1;for(const b of x)if(!ad(b,y))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,s){const c=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],f=n.canonicalID();if(s.type==="Polygon"){const y=tu(s.coordinates,h,f),x=hd(n.geometry(),c,h,f);if(!ya(c,h))return!1;for(const b of x)if(!ld(b,y))return!1}if(s.type==="MultiPolygon"){const y=cd(s.coordinates,h,f),x=hd(n.geometry(),c,h,f);if(!ya(c,h))return!1;for(const b of x)if(!rm(b,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function fs(t){if(t instanceof Dn&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof Lo)return!1;let e=!0;return t.eachChild(n=>{e&&!fs(n)&&(e=!1)}),e}function va(t){if(t instanceof Dn&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!va(n)&&(e=!1)}),e}function xa(t,e){if(t instanceof Dn&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(s=>{n&&!xa(s,e)&&(n=!1)}),n}class Tl{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const s=e[1];return n.scope.has(s)?new Tl(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Sl{constructor(e,n=[],s,c=new gl,h=[]){this.registry=e,this.path=n,this.key=n.map(f=>`[${f}]`).join(""),this.scope=c,this.errors=h,this.expectedType=s}parse(e,n,s,c,h={}){return n?this.concat(n,s,c)._parse(e,h):this._parse(e,h)}_parse(e,n){function s(c,h,f){return f==="assert"?new Hn(h,[c]):f==="coerce"?new ki(h,[c]):c}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c=e[0];if(typeof c!="string")return this.error(`Expression name must be a string, but found ${typeof c} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const h=this.registry[c];if(h){let f=h.parse(e,this);if(!f)return null;if(this.expectedType){const y=this.expectedType,x=f.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||x.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(y,x))return null}else f=s(f,y,n.typeAnnotation||"coerce");else f=s(f,y,n.typeAnnotation||"assert")}if(!(f instanceof co)&&f.type.kind!=="resolvedImage"&&El(f)){const y=new id;try{f=new co(f.type,f.evaluate(y))}catch(x){return this.error(x.message),null}}return f}return this.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,s){const c=typeof e=="number"?this.path.concat(e):this.path,h=s?this.scope.concat(s):this.scope;return new Sl(this.registry,c,n||null,h,this.errors)}error(e,...n){const s=`${this.key}${n.map(c=>`[${c}]`).join("")}`;this.errors.push(new Si(s,e))}checkSubtype(e,n){const s=wn(e,n);return s&&this.error(s),s}}function El(t){if(t instanceof Tl)return El(t.boundExpression);if(t instanceof Dn&&t.name==="error"||t instanceof ga||t instanceof Lo)return!1;const e=t instanceof ki||t instanceof Hn;let n=!0;return t.eachChild(s=>{n=e?n&&El(s):n&&s instanceof co}),!!n&&fs(t)&&xa(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function wa(t,e){const n=t.length-1;let s,c,h=0,f=n,y=0;for(;h<=f;)if(y=Math.floor((h+f)/2),s=t[y],c=t[y+1],s<=e){if(y===n||e<c)return y;h=y+1}else{if(!(s>e))throw new Xr("Input is not a number.");f=y-1}return 0}class ba{constructor(e,n,s){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[c,h]of s)this.labels.push(c),this.outputs.push(h)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(e[1],1,Ke);if(!s)return null;const c=[];let h=null;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);for(let f=1;f<e.length;f+=2){const y=f===1?-1/0:e[f],x=e[f+1],b=f,E=f+1;if(typeof y!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(c.length&&c[c.length-1][0]>=y)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const C=n.parse(x,E,h);if(!C)return null;h=h||C.type,c.push([y,C])}return new ba(h,s,c)}evaluate(e){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(e);const c=this.input.evaluate(e);if(c<=n[0])return s[0].evaluate(e);const h=n.length;return c>=n[h-1]?s[h-1].evaluate(e):s[wa(n,c)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}function Xt(t,e,n){return t*(1-n)+e*n}var Cl=Object.freeze({__proto__:null,number:Xt,color:function(t,e,n){return new jt(Xt(t.r,e.r,n),Xt(t.g,e.g,n),Xt(t.b,e.b,n),Xt(t.a,e.a,n))},array:function(t,e,n){return t.map((s,c)=>Xt(s,e[c],n))}});const dd=.95047,Ta=1.08883,nu=4/29,kl=6/29,pd=3*kl*kl,nm=Math.PI/180,im=180/Math.PI;function Ml(t){return t>.008856451679035631?Math.pow(t,1/3):t/pd+nu}function Il(t){return t>kl?t*t*t:pd*(t-nu)}function Al(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Sa(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fd(t){const e=Sa(t.r),n=Sa(t.g),s=Sa(t.b),c=Ml((.4124564*e+.3575761*n+.1804375*s)/dd),h=Ml((.2126729*e+.7151522*n+.072175*s)/1);return{l:116*h-16,a:500*(c-h),b:200*(h-Ml((.0193339*e+.119192*n+.9503041*s)/Ta)),alpha:t.a}}function md(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*Il(e),n=dd*Il(n),s=Ta*Il(s),new jt(Al(3.2404542*n-1.5371385*e-.4985314*s),Al(-.969266*n+1.8760108*e+.041556*s),Al(.0556434*n-.2040259*e+1.0572252*s),t.alpha)}function om(t,e,n){const s=e-t;return t+n*(s>180||s<-180?s-360*Math.round(s/360):s)}const Ea={forward:fd,reverse:md,interpolate:function(t,e,n){return{l:Xt(t.l,e.l,n),a:Xt(t.a,e.a,n),b:Xt(t.b,e.b,n),alpha:Xt(t.alpha,e.alpha,n)}}},Ca={forward:function(t){const{l:e,a:n,b:s}=fd(t),c=Math.atan2(s,n)*im;return{h:c<0?c+360:c,c:Math.sqrt(n*n+s*s),l:e,alpha:t.a}},reverse:function(t){const e=t.h*nm,n=t.c;return md({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:om(t.h,e.h,n),c:Xt(t.c,e.c,n),l:Xt(t.l,e.l,n),alpha:Xt(t.alpha,e.alpha,n)}}};var _d=Object.freeze({__proto__:null,lab:Ea,hcl:Ca});class bn{constructor(e,n,s,c,h){this.type=e,this.operator=n,this.interpolation=s,this.input=c,this.labels=[],this.outputs=[];for(const[f,y]of h)this.labels.push(f),this.outputs.push(y)}static interpolationFactor(e,n,s,c){let h=0;if(e.name==="exponential")h=zl(n,e.base,s,c);else if(e.name==="linear")h=zl(n,1,s,c);else if(e.name==="cubic-bezier"){const f=e.controlPoints;h=new X(f[0],f[1],f[2],f[3]).solve(zl(n,1,s,c))}return h}static parse(e,n){let[s,c,h,...f]=e;if(!Array.isArray(c)||c.length===0)return n.error("Expected an interpolation type expression.",1);if(c[0]==="linear")c={name:"linear"};else if(c[0]==="exponential"){const b=c[1];if(typeof b!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:b}}else{if(c[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const b=c.slice(1);if(b.length!==4||b.some(E=>typeof E!="number"||E<0||E>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:b}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(h=n.parse(h,2,Ke),!h)return null;const y=[];let x=null;s==="interpolate-hcl"||s==="interpolate-lab"?x=Ei:n.expectedType&&n.expectedType.kind!=="value"&&(x=n.expectedType);for(let b=0;b<f.length;b+=2){const E=f[b],C=f[b+1],M=b+3,D=b+4;if(typeof E!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(y.length&&y[y.length-1][0]>=E)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',M);const R=n.parse(C,D,x);if(!R)return null;x=x||R.type,y.push([E,R])}return x.kind==="number"||x.kind==="color"||x.kind==="array"&&x.itemType.kind==="number"&&typeof x.N=="number"?new bn(x,s,c,h,y):n.error(`Type ${yr(x)} is not interpolatable.`)}evaluate(e){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(e);const c=this.input.evaluate(e);if(c<=n[0])return s[0].evaluate(e);const h=n.length;if(c>=n[h-1])return s[h-1].evaluate(e);const f=wa(n,c),y=bn.interpolationFactor(this.interpolation,c,n[f],n[f+1]),x=s[f].evaluate(e),b=s[f+1].evaluate(e);return this.operator==="interpolate"?Cl[this.type.kind.toLowerCase()](x,b,y):this.operator==="interpolate-hcl"?Ca.reverse(Ca.interpolate(Ca.forward(x),Ca.forward(b),y)):Ea.reverse(Ea.interpolate(Ea.forward(x),Ea.forward(b),y))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)n.push(this.labels[s],this.outputs[s].serialize());return n}}function zl(t,e,n,s){const c=s-n,h=t-n;return c===0?0:e===1?h/c:(Math.pow(e,h)-1)/(Math.pow(e,c)-1)}class Oo{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let s=null;const c=n.expectedType;c&&c.kind!=="value"&&(s=c);const h=[];for(const y of e.slice(1)){const x=n.parse(y,1+h.length,s,void 0,{typeAnnotation:"omit"});if(!x)return null;s=s||x.type,h.push(x)}const f=c&&h.some(y=>wn(c,y.type));return new Oo(f?It:s,h)}evaluate(e){let n,s=null,c=0;for(const h of this.args){if(c++,s=h.evaluate(e),s&&s instanceof Wn&&!s.available&&(n||(n=s),s=null,c===this.args.length))return n;if(s!==null)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class Pl{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let h=1;h<e.length-1;h+=2){const f=e[h];if(typeof f!="string")return n.error(`Expected string, but found ${typeof f} instead.`,h);if(/[^a-zA-Z0-9_]/.test(f))return n.error("Variable names must contain only alphanumeric characters or '_'.",h);const y=n.parse(e[h+1],h+1);if(!y)return null;s.push([f,y])}const c=n.parse(e[e.length-1],e.length-1,n.expectedType,s);return c?new Pl(s,c):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,s]of this.bindings)e.push(n,s.serialize());return e.push(this.result.serialize()),e}}class iu{constructor(e,n,s){this.type=e,this.index=n,this.input=s}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,Ke),c=n.parse(e[2],2,qn(n.expectedType||It));return s&&c?new iu(c.type.itemType,s,c):null}evaluate(e){const n=this.index.evaluate(e),s=this.input.evaluate(e);if(n<0)throw new Xr(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new Xr(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new Xr(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ou{constructor(e,n){this.type=Mt,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,It),c=n.parse(e[2],2,It);return s&&c?yl(s.type,[Mt,Lt,Ke,ao,It])?new ou(s,c):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${yr(s.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!hs(n,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${yr(Pr(n))} instead.`);if(!hs(s,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${yr(Pr(s))} instead.`);return s.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ui{constructor(e,n,s){this.type=Ke,this.needle=e,this.haystack=n,this.fromIndex=s}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,It),c=n.parse(e[2],2,It);if(!s||!c)return null;if(!yl(s.type,[Mt,Lt,Ke,ao,It]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${yr(s.type)} instead`);if(e.length===4){const h=n.parse(e[3],3,Ke);return h?new ui(s,c,h):null}return new ui(s,c)}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!hs(n,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${yr(Pr(n))} instead.`);if(!hs(s,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${yr(Pr(s))} instead.`);if(this.fromIndex){const c=this.fromIndex.evaluate(e);return s.indexOf(n,c)}return s.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Dl{constructor(e,n,s,c,h,f){this.inputType=e,this.type=n,this.input=s,this.cases=c,this.outputs=h,this.otherwise=f}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let s,c;n.expectedType&&n.expectedType.kind!=="value"&&(c=n.expectedType);const h={},f=[];for(let b=2;b<e.length-1;b+=2){let E=e[b];const C=e[b+1];Array.isArray(E)||(E=[E]);const M=n.concat(b);if(E.length===0)return M.error("Expected at least one branch label.");for(const R of E){if(typeof R!="number"&&typeof R!="string")return M.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return M.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return M.error("Numeric branch labels must be integer values.");if(s){if(M.checkSubtype(s,Pr(R)))return null}else s=Pr(R);if(h[String(R)]!==void 0)return M.error("Branch labels must be unique.");h[String(R)]=f.length}const D=n.parse(C,b,c);if(!D)return null;c=c||D.type,f.push(D)}const y=n.parse(e[1],1,It);if(!y)return null;const x=n.parse(e[e.length-1],e.length-1,c);return x?y.type.kind!=="value"&&n.concat(1).checkSubtype(s,y.type)?null:new Dl(s,c,y,h,f,x):null}evaluate(e){const n=this.input.evaluate(e);return(Pr(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),s=[],c={};for(const f of n){const y=c[this.cases[f]];y===void 0?(c[this.cases[f]]=s.length,s.push([this.cases[f],[f]])):s[y][1].push(f)}const h=f=>this.inputType.kind==="number"?Number(f):f;for(const[f,y]of s)e.push(y.length===1?h(y[0]):y.map(h)),e.push(this.outputs[f].serialize());return e.push(this.otherwise.serialize()),e}}class ho{constructor(e,n,s){this.type=e,this.branches=n,this.otherwise=s}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&n.expectedType.kind!=="value"&&(s=n.expectedType);const c=[];for(let f=1;f<e.length-1;f+=2){const y=n.parse(e[f],f,Mt);if(!y)return null;const x=n.parse(e[f+1],f+1,s);if(!x)return null;c.push([y,x]),s=s||x.type}const h=n.parse(e[e.length-1],e.length-1,s);return h?new ho(s,c,h):null}evaluate(e){for(const[n,s]of this.branches)if(n.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,s]of this.branches)e(n),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class ka{constructor(e,n,s,c){this.type=e,this.input=n,this.beginIndex=s,this.endIndex=c}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,It),c=n.parse(e[2],2,Ke);if(!s||!c)return null;if(!yl(s.type,[qn(It),Lt,It]))return n.error(`Expected first argument to be of type array or string, but found ${yr(s.type)} instead`);if(e.length===4){const h=n.parse(e[3],3,Ke);return h?new ka(s.type,s,c,h):null}return new ka(s.type,s,c)}evaluate(e){const n=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!hs(n,["string","array"]))throw new Xr(`Expected first argument to be of type array or string, but found ${yr(Pr(n))} instead.`);if(this.endIndex){const c=this.endIndex.evaluate(e);return n.slice(s,c)}return n.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function gd(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Ll(t,e,n,s){return s.compare(e,n)===0}function po(t,e,n){const s=t!=="=="&&t!=="!=";return class b2{constructor(h,f,y){this.type=Mt,this.lhs=h,this.rhs=f,this.collator=y,this.hasUntypedArgument=h.type.kind==="value"||f.type.kind==="value"}static parse(h,f){if(h.length!==3&&h.length!==4)return f.error("Expected two or three arguments.");const y=h[0];let x=f.parse(h[1],1,It);if(!x)return null;if(!gd(y,x.type))return f.concat(1).error(`"${y}" comparisons are not supported for type '${yr(x.type)}'.`);let b=f.parse(h[2],2,It);if(!b)return null;if(!gd(y,b.type))return f.concat(2).error(`"${y}" comparisons are not supported for type '${yr(b.type)}'.`);if(x.type.kind!==b.type.kind&&x.type.kind!=="value"&&b.type.kind!=="value")return f.error(`Cannot compare types '${yr(x.type)}' and '${yr(b.type)}'.`);s&&(x.type.kind==="value"&&b.type.kind!=="value"?x=new Hn(b.type,[x]):x.type.kind!=="value"&&b.type.kind==="value"&&(b=new Hn(x.type,[b])));let E=null;if(h.length===4){if(x.type.kind!=="string"&&b.type.kind!=="string"&&x.type.kind!=="value"&&b.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(E=f.parse(h[3],3,fa),!E)return null}return new b2(x,b,E)}evaluate(h){const f=this.lhs.evaluate(h),y=this.rhs.evaluate(h);if(s&&this.hasUntypedArgument){const x=Pr(f),b=Pr(y);if(x.kind!==b.kind||x.kind!=="string"&&x.kind!=="number")throw new Xr(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${x.kind}, ${b.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const x=Pr(f),b=Pr(y);if(x.kind!=="string"||b.kind!=="string")return e(h,f,y)}return this.collator?n(h,f,y,this.collator.evaluate(h)):e(h,f,y)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[t];return this.eachChild(f=>{h.push(f.serialize())}),h}}}const yd=po("==",function(t,e,n){return e===n},Ll),su=po("!=",function(t,e,n){return e!==n},function(t,e,n,s){return!Ll(0,e,n,s)}),au=po("<",function(t,e,n){return e<n},function(t,e,n,s){return s.compare(e,n)<0}),vd=po(">",function(t,e,n){return e>n},function(t,e,n,s){return s.compare(e,n)>0}),lu=po("<=",function(t,e,n){return e<=n},function(t,e,n,s){return s.compare(e,n)<=0}),xd=po(">=",function(t,e,n){return e>=n},function(t,e,n,s){return s.compare(e,n)>=0});class Ol{constructor(e,n,s,c,h){this.type=Lt,this.number=e,this.locale=n,this.currency=s,this.minFractionDigits=c,this.maxFractionDigits=h}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Ke);if(!s)return null;const c=e[2];if(typeof c!="object"||Array.isArray(c))return n.error("NumberFormat options argument must be an object.");let h=null;if(c.locale&&(h=n.parse(c.locale,1,Lt),!h))return null;let f=null;if(c.currency&&(f=n.parse(c.currency,1,Lt),!f))return null;let y=null;if(c["min-fraction-digits"]&&(y=n.parse(c["min-fraction-digits"],1,Ke),!y))return null;let x=null;return c["max-fraction-digits"]&&(x=n.parse(c["max-fraction-digits"],1,Ke),!x)?null:new Ol(s,h,f,y,x)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Rl{constructor(e){this.type=Ke,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=n.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${yr(s.type)} instead.`):new Rl(s):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Xr(`Expected value to be of type string or array, but found ${yr(Pr(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const hi={"==":yd,"!=":su,">":vd,"<":au,">=":xd,"<=":lu,array:Hn,at:iu,boolean:Hn,case:ho,coalesce:Oo,collator:ga,format:Ci,image:Do,in:ou,"index-of":ui,interpolate:bn,"interpolate-hcl":bn,"interpolate-lab":bn,length:Rl,let:Pl,literal:co,match:Dl,number:Hn,"number-format":Ol,object:Hn,slice:ka,step:ba,string:Hn,"to-boolean":ki,"to-color":ki,"to-number":ki,"to-string":ki,var:Tl,within:Lo};function cu(t,[e,n,s,c]){e=e.evaluate(t),n=n.evaluate(t),s=s.evaluate(t);const h=c?c.evaluate(t):1,f=rd(e,n,s,h);if(f)throw new Xr(f);return new jt(e/255*h,n/255*h,s/255*h,h)}function uu(t,e){return t in e}function Ma(t,e){const n=e[t];return n===void 0?null:n}function fo(t){return{type:t}}function wd(t){return{result:"success",value:t}}function ji(t){return{result:"error",value:t}}function ms(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function bd(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function hu(t){return!!t.expression&&t.expression.interpolated}function qt(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Bl(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Fl(t){return t}function Ia(t,e){const n=e.type==="color",s=t.stops&&typeof t.stops[0][0]=="object",c=s||!(s||t.property!==void 0),h=t.type||(hu(e)?"exponential":"interval");if(n&&((t=so({},t)).stops&&(t.stops=t.stops.map(b=>[b[0],jt.parse(b[1])])),t.default=jt.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!_d[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let f,y,x;if(h==="exponential")f=Td;else if(h==="interval")f=sm;else if(h==="categorical"){f=Ul,y=Object.create(null);for(const b of t.stops)y[b[0]]=b[1];x=typeof t.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);f=am}if(s){const b={},E=[];for(let D=0;D<t.stops.length;D++){const R=t.stops[D],U=R[0].zoom;b[U]===void 0&&(b[U]={zoom:U,type:t.type,property:t.property,default:t.default,stops:[]},E.push(U)),b[U].stops.push([R[0].value,R[1]])}const C=[];for(const D of E)C.push([b[D].zoom,Ia(b[D],e)]);const M={name:"linear"};return{kind:"composite",interpolationType:M,interpolationFactor:bn.interpolationFactor.bind(void 0,M),zoomStops:C.map(D=>D[0]),evaluate:({zoom:D},R)=>Td({stops:C,base:t.base},e,D).evaluate(D,R)}}if(c){const b=h==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:bn.interpolationFactor.bind(void 0,b),zoomStops:t.stops.map(E=>E[0]),evaluate:({zoom:E})=>f(t,e,E,y,x)}}return{kind:"source",evaluate(b,E){const C=E&&E.properties?E.properties[t.property]:void 0;return C===void 0?nn(t.default,e.default):f(t,e,C,y,x)}}}function nn(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function Ul(t,e,n,s,c){return nn(typeof n===c?s[n]:void 0,t.default,e.default)}function sm(t,e,n){if(qt(n)!=="number")return nn(t.default,e.default);const s=t.stops.length;if(s===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[s-1][0])return t.stops[s-1][1];const c=wa(t.stops.map(h=>h[0]),n);return t.stops[c][1]}function Td(t,e,n){const s=t.base!==void 0?t.base:1;if(qt(n)!=="number")return nn(t.default,e.default);const c=t.stops.length;if(c===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[c-1][0])return t.stops[c-1][1];const h=wa(t.stops.map(E=>E[0]),n),f=function(E,C,M,D){const R=D-M,U=E-M;return R===0?0:C===1?U/R:(Math.pow(C,U)-1)/(Math.pow(C,R)-1)}(n,s,t.stops[h][0],t.stops[h+1][0]),y=t.stops[h][1],x=t.stops[h+1][1];let b=Cl[e.type]||Fl;if(t.colorSpace&&t.colorSpace!=="rgb"){const E=_d[t.colorSpace];b=(C,M)=>E.reverse(E.interpolate(E.forward(C),E.forward(M),f))}return typeof y.evaluate=="function"?{evaluate(...E){const C=y.evaluate.apply(void 0,E),M=x.evaluate.apply(void 0,E);if(C!==void 0&&M!==void 0)return b(C,M,f)}}:b(y,x,f)}function am(t,e,n){return e.type==="color"?n=jt.parse(n):e.type==="formatted"?n=Et.fromString(n.toString()):e.type==="resolvedImage"?n=Wn.fromString(n.toString()):qt(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),nn(n,t.default,e.default)}Dn.register(hi,{error:[{kind:"error"},[Lt],(t,[e])=>{throw new Xr(e.evaluate(t))}],typeof:[Lt,[It],(t,[e])=>yr(Pr(e.evaluate(t)))],"to-rgba":[qn(Ke,4),[Ei],(t,[e])=>e.evaluate(t).toArray()],rgb:[Ei,[Ke,Ke,Ke],cu],rgba:[Ei,[Ke,Ke,Ke,Ke],cu],has:{type:Mt,overloads:[[[Lt],(t,[e])=>uu(e.evaluate(t),t.properties())],[[Lt,us],(t,[e,n])=>uu(e.evaluate(t),n.evaluate(t))]]},get:{type:It,overloads:[[[Lt],(t,[e])=>Ma(e.evaluate(t),t.properties())],[[Lt,us],(t,[e,n])=>Ma(e.evaluate(t),n.evaluate(t))]]},"feature-state":[It,[Lt],(t,[e])=>Ma(e.evaluate(t),t.featureState||{})],properties:[us,[],t=>t.properties()],"geometry-type":[Lt,[],t=>t.geometryType()],id:[It,[],t=>t.id()],zoom:[Ke,[],t=>t.globals.zoom],pitch:[Ke,[],t=>t.globals.pitch||0],"distance-from-center":[Ke,[],t=>t.distanceFromCenter()],"heatmap-density":[Ke,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ke,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Ke,[],t=>t.globals.skyRadialProgress||0],accumulated:[It,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[Ke,fo(Ke),(t,e)=>{let n=0;for(const s of e)n+=s.evaluate(t);return n}],"*":[Ke,fo(Ke),(t,e)=>{let n=1;for(const s of e)n*=s.evaluate(t);return n}],"-":{type:Ke,overloads:[[[Ke,Ke],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Ke],(t,[e])=>-e.evaluate(t)]]},"/":[Ke,[Ke,Ke],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Ke,[Ke,Ke],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Ke,[],()=>Math.LN2],pi:[Ke,[],()=>Math.PI],e:[Ke,[],()=>Math.E],"^":[Ke,[Ke,Ke],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Ke,[Ke],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ke,[Ke],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ke,[Ke],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ke,[Ke],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ke,[Ke],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ke,[Ke],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ke,[Ke],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ke,[Ke],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ke,[Ke],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ke,[Ke],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ke,fo(Ke),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[Ke,fo(Ke),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[Ke,[Ke],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ke,[Ke],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ke,[Ke],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ke,[Ke],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Mt,[Lt,It],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Mt,[It],(t,[e])=>t.id()===e.value],"filter-type-==":[Mt,[Lt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Mt,[Lt,It],(t,[e,n])=>{const s=t.properties()[e.value],c=n.value;return typeof s==typeof c&&s<c}],"filter-id-<":[Mt,[It],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<s}],"filter->":[Mt,[Lt,It],(t,[e,n])=>{const s=t.properties()[e.value],c=n.value;return typeof s==typeof c&&s>c}],"filter-id->":[Mt,[It],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>s}],"filter-<=":[Mt,[Lt,It],(t,[e,n])=>{const s=t.properties()[e.value],c=n.value;return typeof s==typeof c&&s<=c}],"filter-id-<=":[Mt,[It],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<=s}],"filter->=":[Mt,[Lt,It],(t,[e,n])=>{const s=t.properties()[e.value],c=n.value;return typeof s==typeof c&&s>=c}],"filter-id->=":[Mt,[It],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>=s}],"filter-has":[Mt,[It],(t,[e])=>e.value in t.properties()],"filter-has-id":[Mt,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Mt,[qn(Lt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Mt,[qn(It)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Mt,[Lt,qn(It)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Mt,[Lt,qn(It)],(t,[e,n])=>function(s,c,h,f){for(;h<=f;){const y=h+f>>1;if(c[y]===s)return!0;c[y]>s?f=y-1:h=y+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Mt,overloads:[[[Mt,Mt],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[fo(Mt),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Mt,overloads:[[[Mt,Mt],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[fo(Mt),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Mt,[Mt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Mt,[Lt],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Lt,[Lt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Lt,[Lt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Lt,fo(It),(t,e)=>e.map(n=>_a(n.evaluate(t))).join("")],"resolved-locale":[Lt,[fa],(t,[e])=>e.evaluate(t).resolvedLocale()]});class du{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new id,this._defaultValue=n?function(s){return s.type==="color"&&Bl(s.default)?new jt(0,0,0,0):s.type==="color"?jt.parse(s.default)||null:s.default===void 0?null:s.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,s,c,h,f,y,x){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=c,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=x||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,s,c,h,f,y,x){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=c,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Xr(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console!="undefined"&&console.warn(b.message)),this._defaultValue}}}function _s(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in hi}function Aa(t,e){const n=new Sl(hi,[],e?function(c){const h={color:Ei,string:Lt,number:Ke,enum:Lt,boolean:Mt,formatted:lo,resolvedImage:ma};return c.type==="array"?qn(h[c.value]||It,c.length):h[c.type]}(e):void 0),s=n.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?wd(new du(s,e)):ji(n.errors)}class za{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!va(n.expression)}evaluateWithoutErrorHandling(e,n,s,c,h,f){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,c,h,f)}evaluate(e,n,s,c,h,f){return this._styleExpression.evaluate(e,n,s,c,h,f)}}class pu{constructor(e,n,s,c){this.kind=e,this.zoomStops=s,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!va(n.expression),this.interpolationType=c}evaluateWithoutErrorHandling(e,n,s,c,h,f){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,c,h,f)}evaluate(e,n,s,c,h,f){return this._styleExpression.evaluate(e,n,s,c,h,f)}interpolationFactor(e,n,s){return this.interpolationType?bn.interpolationFactor(this.interpolationType,e,n,s):0}}function Sd(t,e){if((t=Aa(t,e)).result==="error")return t;const n=t.value.expression,s=fs(n);if(!s&&!ms(e))return ji([new Si("","data expressions not supported")]);const c=xa(n,["zoom","pitch","distance-from-center"]);if(!c&&!bd(e))return ji([new Si("","zoom expressions not supported")]);const h=Nl(n);return h||c?h instanceof Si?ji([h]):h instanceof bn&&!hu(e)?ji([new Si("",'"interpolate" expressions cannot be used with this property')]):wd(h?new pu(s?"camera":"composite",t.value,h.labels,h instanceof bn?h.interpolation:void 0):new za(s?"constant":"source",t.value)):ji([new Si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class gs{constructor(e,n){this._parameters=e,this._specification=n,so(this,Ia(this._parameters,this._specification))}static deserialize(e){return new gs(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Nl(t){let e=null;if(t instanceof Pl)e=Nl(t.result);else if(t instanceof Oo){for(const n of t.args)if(e=Nl(n),e)break}else(t instanceof ba||t instanceof bn)&&t.input instanceof Dn&&t.input.name==="zoom"&&(e=t);return e instanceof Si||t.eachChild(n=>{const s=Nl(n);s instanceof Si?e=s:!e&&s?e=new Si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Si("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Xn(t){const e=t.key,n=t.value,s=t.valueSpec||{},c=t.objectElementValidators||{},h=t.style,f=t.styleSpec;let y=[];const x=qt(n);if(x!=="object")return[new et(e,n,`object expected, ${x} found`)];for(const b in n){const E=b.split(".")[0],C=s[E]||s["*"];let M;if(c[E])M=c[E];else if(s[E])M=Yr;else if(c["*"])M=c["*"];else{if(!s["*"]){y.push(new et(e,n[b],`unknown property "${b}"`));continue}M=Yr}y=y.concat(M({key:(e&&`${e}.`)+b,value:n[b],valueSpec:C,style:h,styleSpec:f,object:n,objectKey:b},n))}for(const b in s)c[b]||s[b].required&&s[b].default===void 0&&n[b]===void 0&&y.push(new et(e,n,`missing required property "${b}"`));return y}function fu(t){const e=t.value,n=t.valueSpec,s=t.style,c=t.styleSpec,h=t.key,f=t.arrayElementValidator||Yr;if(qt(e)!=="array")return[new et(h,e,`array expected, ${qt(e)} found`)];if(n.length&&e.length!==n.length)return[new et(h,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new et(h,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let y={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum};c.$version<7&&(y.function=n.function),qt(n.value)==="object"&&(y=n.value);let x=[];for(let b=0;b<e.length;b++)x=x.concat(f({array:e,arrayIndex:b,value:e[b],valueSpec:y,style:s,styleSpec:c,key:`${h}[${b}]`}));return x}function Ed(t){const e=t.key,n=t.value,s=t.valueSpec;let c=qt(n);if(c==="number"&&n!=n&&(c="NaN"),c!=="number")return[new et(e,n,`number expected, ${c} found`)];if("minimum"in s){let h=s.minimum;if(qt(s.minimum)==="array"&&(h=s.minimum[t.arrayIndex]),n<h)return[new et(e,n,`${n} is less than the minimum value ${h}`)]}if("maximum"in s){let h=s.maximum;if(qt(s.maximum)==="array"&&(h=s.maximum[t.arrayIndex]),n>h)return[new et(e,n,`${n} is greater than the maximum value ${h}`)]}return[]}function jl(t){const e=t.valueSpec,n=kr(t.value.type);let s,c,h,f={};const y=n!=="categorical"&&t.value.property===void 0,x=!y,b=qt(t.value.stops)==="array"&&qt(t.value.stops[0])==="array"&&qt(t.value.stops[0][0])==="object",E=Xn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(D){if(n==="identity")return[new et(D.key,D.value,'identity function may not have a "stops" property')];let R=[];const U=D.value;return R=R.concat(fu({key:D.key,value:U,valueSpec:D.valueSpec,style:D.style,styleSpec:D.styleSpec,arrayElementValidator:C})),qt(U)==="array"&&U.length===0&&R.push(new et(D.key,U,"array must have at least one stop")),R},default:function(D){return Yr({key:D.key,value:D.value,valueSpec:e,style:D.style,styleSpec:D.styleSpec})}}});return n==="identity"&&y&&E.push(new et(t.key,t.value,'missing required property "property"')),n==="identity"||t.value.stops||E.push(new et(t.key,t.value,'missing required property "stops"')),n==="exponential"&&t.valueSpec.expression&&!hu(t.valueSpec)&&E.push(new et(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(x&&!ms(t.valueSpec)?E.push(new et(t.key,t.value,"property functions not supported")):y&&!bd(t.valueSpec)&&E.push(new et(t.key,t.value,"zoom functions not supported"))),n!=="categorical"&&!b||t.value.property!==void 0||E.push(new et(t.key,t.value,'"property" property is required')),E;function C(D){let R=[];const U=D.value,j=D.key;if(qt(U)!=="array")return[new et(j,U,`array expected, ${qt(U)} found`)];if(U.length!==2)return[new et(j,U,`array length 2 expected, length ${U.length} found`)];if(b){if(qt(U[0])!=="object")return[new et(j,U,`object expected, ${qt(U[0])} found`)];if(U[0].zoom===void 0)return[new et(j,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new et(j,U,"object stop key must have value")];if(h&&h>kr(U[0].zoom))return[new et(j,U[0].zoom,"stop zoom values must appear in ascending order")];kr(U[0].zoom)!==h&&(h=kr(U[0].zoom),c=void 0,f={}),R=R.concat(Xn({key:`${j}[0]`,value:U[0],valueSpec:{zoom:{}},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{zoom:Ed,value:M}}))}else R=R.concat(M({key:`${j}[0]`,value:U[0],valueSpec:{},style:D.style,styleSpec:D.styleSpec},U));return _s(Ni(U[1]))?R.concat([new et(`${j}[1]`,U[1],"expressions are not allowed in function stops.")]):R.concat(Yr({key:`${j}[1]`,value:U[1],valueSpec:e,style:D.style,styleSpec:D.styleSpec}))}function M(D,R){const U=qt(D.value),j=kr(D.value),W=D.value!==null?D.value:R;if(s){if(U!==s)return[new et(D.key,W,`${U} stop domain type must match previous stop domain type ${s}`)]}else s=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new et(D.key,W,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&n!=="categorical"){let re=`number expected, ${U} found`;return ms(e)&&n===void 0&&(re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(D.key,W,re)]}return n!=="categorical"||U!=="number"||isFinite(j)&&Math.floor(j)===j?n!=="categorical"&&U==="number"&&c!==void 0&&j<c?[new et(D.key,W,"stop domain values must appear in ascending order")]:(c=j,n==="categorical"&&j in f?[new et(D.key,W,"stop domain values must be unique")]:(f[j]=!0,[])):[new et(D.key,W,`integer expected, found ${j}`)]}}function Vi(t){const e=(t.expressionContext==="property"?Sd:Aa)(Ni(t.value),t.valueSpec);if(e.result==="error")return e.value.map(s=>new et(`${t.key}${s.key}`,t.value,s.message));const n=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!n.outputDefined())return[new et(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!va(n))return[new et(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter")return mu(n,t);if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!xa(n,["zoom","feature-state"]))return[new et(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!fs(n))return[new et(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mu(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const c of e.valueSpec.expression.parameters)n.delete(c);if(n.size===0)return[];const s=[];return t instanceof Dn&&n.has(t.name)?[new et(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(c=>{s.push(...mu(c,e))}),s)}function Vl(t){const e=t.key,n=t.value,s=t.valueSpec,c=[];return Array.isArray(s.values)?s.values.indexOf(kr(n))===-1&&c.push(new et(e,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(s.values).indexOf(kr(n))===-1&&c.push(new et(e,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),c}function $l(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!$l(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Gl(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};$l(t)||(t=ql(t));const n=t;let s=!0;try{s=function(b){if(!ys(b))return b;let E=Ni(b);return Cd(E),E=Zl(E),E}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const c=Ce[`filter_${e}`],h=Aa(s,c);let f=null;if(h.result==="error")throw new Error(h.value.map(b=>`${b.key}: ${b.message}`).join(", "));f=(b,E,C)=>h.value.evaluate(b,E,{},C);let y=null,x=null;if(s!==n){const b=Aa(n,c);if(b.result==="error")throw new Error(b.value.map(E=>`${E.key}: ${E.message}`).join(", "));y=(E,C,M,D,R)=>b.value.evaluate(E,C,{},M,void 0,void 0,D,R),x=!fs(b.value.expression)}return f=f,{filter:f,dynamicFilter:y||void 0,needGeometry:_u(s),needFeature:!!x}}function Zl(t){if(!Array.isArray(t))return t;const e=function(n){if(lm.has(n[0])){for(let s=1;s<n.length;s++)if(ys(n[s]))return!0}return n}(t);return e===!0?e:e.map(n=>Zl(n))}function Cd(t){let e=!1;const n=[];if(t[0]==="case"){for(let s=1;s<t.length-1;s+=2)e=e||ys(t[s]),n.push(t[s+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||ys(t[1]);for(let s=2;s<t.length-1;s+=2)n.push(t[s+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||ys(t[1]);for(let s=1;s<t.length-1;s+=2)n.push(t[s+1])}e&&(t.length=0,t.push("any",...n));for(let s=1;s<t.length;s++)Cd(t[s])}function ys(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(ys(t[n]))return!0;return!1}const lm=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function cm(t,e){return t<e?-1:t>e?1:0}function _u(t){if(!Array.isArray(t))return!1;if(t[0]==="within")return!0;for(let e=1;e<t.length;e++)if(_u(t[e]))return!0;return!1}function ql(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?gu(t[1],t[2],"=="):e==="!="?Wl(gu(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?gu(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map(ql))):e==="all"?["all"].concat(t.slice(1).map(ql)):e==="none"?["all"].concat(t.slice(1).map(ql).map(Wl)):e==="in"?kd(t[1],t.slice(2)):e==="!in"?Wl(kd(t[1],t.slice(2))):e==="has"?Md(t[1]):e==="!has"?Wl(Md(t[1])):e!=="within"||t;var n}function gu(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function kd(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(cm)]]:["filter-in-small",t,["literal",e]]}}function Md(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Wl(t){return["!",t]}function yu(t){if($l(Ni(t.value))){const e=Ni(t.layerType);return Vi(so({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${e||"fill"}`]}))}return Id(t)}function Id(t){const e=t.value,n=t.key;if(qt(e)!=="array")return[new et(n,e,`array expected, ${qt(e)} found`)];const s=t.styleSpec;let c,h=[];if(e.length<1)return[new et(n,e,"filter array must have at least 1 element")];switch(h=h.concat(Vl({key:`${n}[0]`,value:e[0],valueSpec:s.filter_operator,style:t.style,styleSpec:t.styleSpec})),kr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&kr(e[1])==="$type"&&h.push(new et(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&h.push(new et(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(c=qt(e[1]),c!=="string"&&h.push(new et(`${n}[1]`,e[1],`string expected, ${c} found`)));for(let f=2;f<e.length;f++)c=qt(e[f]),kr(e[1])==="$type"?h=h.concat(Vl({key:`${n}[${f}]`,value:e[f],valueSpec:s.geometry_type,style:t.style,styleSpec:t.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&h.push(new et(`${n}[${f}]`,e[f],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let f=1;f<e.length;f++)h=h.concat(Id({key:`${n}[${f}]`,value:e[f],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":c=qt(e[1]),e.length!==2?h.push(new et(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):c!=="string"&&h.push(new et(`${n}[1]`,e[1],`string expected, ${c} found`));break;case"within":c=qt(e[1]),e.length!==2?h.push(new et(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):c!=="object"&&h.push(new et(`${n}[1]`,e[1],`object expected, ${c} found`))}return h}function Pa(t,e){const n=t.key,s=t.style,c=t.styleSpec,h=t.value,f=t.objectKey,y=c[`${e}_${t.layerType}`];if(!y)return[];const x=f.match(/^(.*)-transition$/);if(e==="paint"&&x&&y[x[1]]&&y[x[1]].transition)return Yr({key:n,value:h,valueSpec:c.transition,style:s,styleSpec:c});const b=t.valueSpec||y[f];if(!b)return[new et(n,h,`unknown property "${f}"`)];let E;if(qt(h)==="string"&&ms(b)&&!b.tokens&&(E=/^{([^}]+)}$/.exec(h)))return[new et(n,h,`"${f}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(E[1])} }\`.`)];const C=[];return t.layerType==="symbol"&&(f==="text-field"&&s&&!s.glyphs&&C.push(new et(n,h,'use of "text-field" requires a style "glyphs" property')),f==="text-font"&&Bl(Ni(h))&&kr(h.type)==="identity"&&C.push(new et(n,h,'"text-font" does not support identity functions'))),C.concat(Yr({key:t.key,value:h,valueSpec:b,style:s,styleSpec:c,expressionContext:"property",propertyType:e,propertyKey:f}))}function Ad(t){return Pa(t,"paint")}function zd(t){return Pa(t,"layout")}function Da(t){let e=[];const n=t.value,s=t.key,c=t.style,h=t.styleSpec;n.type||n.ref||e.push(new et(s,n,'either "type" or "ref" is required'));let f=kr(n.type);const y=kr(n.ref);if(n.id){const x=kr(n.id);for(let b=0;b<t.arrayIndex;b++){const E=c.layers[b];kr(E.id)===x&&e.push(new et(s,n.id,`duplicate layer id "${n.id}", previously used at line ${E.id.__line__}`))}}if("ref"in n){let x;["type","source","source-layer","filter","layout"].forEach(b=>{b in n&&e.push(new et(s,n[b],`"${b}" is prohibited for ref layers`))}),c.layers.forEach(b=>{kr(b.id)===y&&(x=b)}),x?x.ref?e.push(new et(s,n.ref,"ref cannot reference another ref layer")):f=kr(x.type):e.push(new et(s,n.ref,`ref layer "${y}" not found`))}else if(f!=="background"&&f!=="sky")if(n.source){const x=c.sources&&c.sources[n.source],b=x&&kr(x.type);x?b==="vector"&&f==="raster"?e.push(new et(s,n.source,`layer "${n.id}" requires a raster source`)):b==="raster"&&f!=="raster"?e.push(new et(s,n.source,`layer "${n.id}" requires a vector source`)):b!=="vector"||n["source-layer"]?b==="raster-dem"&&f!=="hillshade"?e.push(new et(s,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):f!=="line"||!n.paint||!n.paint["line-gradient"]||b==="geojson"&&x.lineMetrics||e.push(new et(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new et(s,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new et(s,n.source,`source "${n.source}" not found`))}else e.push(new et(s,n,'missing required property "source"'));return e=e.concat(Xn({key:s,value:n,valueSpec:h.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Yr({key:`${s}.type`,value:n.type,valueSpec:h.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:x=>yu(so({layerType:f},x)),layout:x=>Xn({layer:n,key:x.key,value:x.value,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":b=>zd(so({layerType:f},b))}}),paint:x=>Xn({layer:n,key:x.key,value:x.value,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":b=>Ad(so({layerType:f},b))}})}})),e}function vs(t){const e=t.value,n=t.key,s=qt(e);return s!=="string"?[new et(n,e,`string expected, ${s} found`)]:[]}const vu={promoteId:function({key:t,value:e}){if(qt(e)==="string")return vs({key:t,value:e});{const n=[];for(const s in e)n.push(...vs({key:`${t}.${s}`,value:e[s]}));return n}}};function Pd(t){const e=t.value,n=t.key,s=t.styleSpec,c=t.style;if(!e.type)return[new et(n,e,'"type" is required')];const h=kr(e.type);let f;switch(h){case"vector":case"raster":case"raster-dem":return f=Xn({key:n,value:e,valueSpec:s[`source_${h.replace("-","_")}`],style:t.style,styleSpec:s,objectElementValidators:vu}),f;case"geojson":if(f=Xn({key:n,value:e,valueSpec:s.source_geojson,style:c,styleSpec:s,objectElementValidators:vu}),e.cluster)for(const y in e.clusterProperties){const[x,b]=e.clusterProperties[y],E=typeof x=="string"?[x,["accumulated"],["get",y]]:x;f.push(...Vi({key:`${n}.${y}.map`,value:b,expressionContext:"cluster-map"})),f.push(...Vi({key:`${n}.${y}.reduce`,value:E,expressionContext:"cluster-reduce"}))}return f;case"video":return Xn({key:n,value:e,valueSpec:s.source_video,style:c,styleSpec:s});case"image":return Xn({key:n,value:e,valueSpec:s.source_image,style:c,styleSpec:s});case"canvas":return[new et(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vl({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:c,styleSpec:s})}}function xu(t){const e=t.value,n=t.styleSpec,s=n.light,c=t.style;let h=[];const f=qt(e);if(e===void 0)return h;if(f!=="object")return h=h.concat([new et("light",e,`object expected, ${f} found`)]),h;for(const y in e){const x=y.match(/^(.*)-transition$/);h=h.concat(x&&s[x[1]]&&s[x[1]].transition?Yr({key:y,value:e[y],valueSpec:n.transition,style:c,styleSpec:n}):s[y]?Yr({key:y,value:e[y],valueSpec:s[y],style:c,styleSpec:n}):[new et(y,e[y],`unknown property "${y}"`)])}return h}function wu(t){const e=t.value,n=t.key,s=t.style,c=t.styleSpec,h=c.terrain;let f=[];const y=qt(e);if(e===void 0)return f;if(y!=="object")return f=f.concat([new et("terrain",e,`object expected, ${y} found`)]),f;for(const x in e){const b=x.match(/^(.*)-transition$/);f=f.concat(b&&h[b[1]]&&h[b[1]].transition?Yr({key:x,value:e[x],valueSpec:c.transition,style:s,styleSpec:c}):h[x]?Yr({key:x,value:e[x],valueSpec:h[x],style:s,styleSpec:c}):[new et(x,e[x],`unknown property "${x}"`)])}if(e.source){const x=s.sources&&s.sources[e.source],b=x&&kr(x.type);x?b!=="raster-dem"&&f.push(new et(n,e.source,`terrain cannot be used with a source of type ${b}, it only be used with a "raster-dem" source type`)):f.push(new et(n,e.source,`source "${e.source}" not found`))}else f.push(new et(n,e,'terrain is missing required property "source"'));return f}function bu(t){const e=t.value,n=t.style,s=t.styleSpec,c=s.fog;let h=[];const f=qt(e);if(e===void 0)return h;if(f!=="object")return h=h.concat([new et("fog",e,`object expected, ${f} found`)]),h;for(const y in e){const x=y.match(/^(.*)-transition$/);h=h.concat(x&&c[x[1]]&&c[x[1]].transition?Yr({key:y,value:e[y],valueSpec:s.transition,style:n,styleSpec:s}):c[y]?Yr({key:y,value:e[y],valueSpec:c[y],style:n,styleSpec:s}):[new et(y,e[y],`unknown property "${y}"`)])}return h}const Tu={"*":()=>[],array:fu,boolean:function(t){const e=t.value,n=t.key,s=qt(e);return s!=="boolean"?[new et(n,e,`boolean expected, ${s} found`)]:[]},number:Ed,color:function(t){const e=t.key,n=t.value,s=qt(n);return s!=="string"?[new et(e,n,`color expected, ${s} found`)]:ps.parseCSSColor(n)===null?[new et(e,n,`color expected, "${n}" found`)]:[]},constants:td,enum:Vl,filter:yu,function:jl,layer:Da,object:Xn,source:Pd,light:xu,terrain:wu,fog:bu,string:vs,formatted:function(t){return vs(t).length===0?[]:Vi(t)},resolvedImage:function(t){return vs(t).length===0?[]:Vi(t)},projection:function(t){const e=t.value,n=t.styleSpec,s=n.projection,c=t.style;let h=[];const f=qt(e);if(f==="object")for(const y in e)h=h.concat(Yr({key:y,value:e[y],valueSpec:s[y],style:c,styleSpec:n}));else f!=="string"&&(h=h.concat([new et("projection",e,`object or string expected, ${f} found`)]));return h}};function Yr(t){const e=t.value,n=t.valueSpec,s=t.styleSpec;return n.expression&&Bl(kr(e))?jl(t):n.expression&&_s(Ni(e))?Vi(t):n.type&&Tu[n.type]?Tu[n.type](t):Xn(so({},t,{valueSpec:n.type?s[n.type]:n}))}function Su(t){const e=t.value,n=t.key,s=vs(t);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new et(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new et(n,e,'"glyphs" url must include a "{range}" token'))),s}function $i(t,e=Ce){let n=[];return n=n.concat(Yr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Su,"*":()=>[]}})),t.constants&&(n=n.concat(td({key:"constants",value:t.constants,style:t,styleSpec:e}))),Dd(n)}function Dd(t){return[].concat(t).sort((e,n)=>e.line-n.line)}function di(t){return function(...e){return Dd(t.apply(this,e))}}$i.source=di(Pd),$i.light=di(xu),$i.terrain=di(wu),$i.fog=di(bu),$i.layer=di(Da),$i.filter=di(yu),$i.paintProperty=di(Ad),$i.layoutProperty=di(zd);const xs=$i,ws=xs.light,um=xs.fog,Eu=xs.paintProperty,hm=xs.layoutProperty;function Ld(t,e){let n=!1;if(e&&e.length)for(const s of e)t.fire(new _l(new Error(s.message))),n=!0;return n}var La=pn;function pn(t,e,n){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var c=new Int32Array(this.arrayBuffer);t=c[0],this.d=(e=c[1])+2*(n=c[2]);for(var h=0;h<this.d*this.d;h++){var f=c[3+h],y=c[3+h+1];s.push(f===y?null:c.subarray(f,y))}var x=c[3+s.length+1];this.keys=c.subarray(c[3+s.length],x),this.bboxes=c.subarray(x),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var b=0;b<this.d*this.d;b++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var E=n/e*t;this.min=-E,this.max=t+E}pn.prototype.insert=function(t,e,n,s,c){this._forEachCell(e,n,s,c,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(c)},pn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},pn.prototype._insertCell=function(t,e,n,s,c,h){this.cells[c].push(h)},pn.prototype.query=function(t,e,n,s,c){var h=this.min,f=this.max;if(t<=h&&e<=h&&f<=n&&f<=s&&!c)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(t,e,n,s,this._queryCell,y,{},c),y},pn.prototype._queryCell=function(t,e,n,s,c,h,f,y){var x=this.cells[c];if(x!==null)for(var b=this.keys,E=this.bboxes,C=0;C<x.length;C++){var M=x[C];if(f[M]===void 0){var D=4*M;(y?y(E[D+0],E[D+1],E[D+2],E[D+3]):t<=E[D+2]&&e<=E[D+3]&&n>=E[D+0]&&s>=E[D+1])?(f[M]=!0,h.push(b[M])):f[M]=!1}}},pn.prototype._forEachCell=function(t,e,n,s,c,h,f,y){for(var x=this._convertToCellCoord(t),b=this._convertToCellCoord(e),E=this._convertToCellCoord(n),C=this._convertToCellCoord(s),M=x;M<=E;M++)for(var D=b;D<=C;D++){var R=this.d*D+M;if((!y||y(this._convertFromCellCoord(M),this._convertFromCellCoord(D),this._convertFromCellCoord(M+1),this._convertFromCellCoord(D+1)))&&c.call(this,t,e,n,s,R,h,f,y))return}},pn.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},pn.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},pn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,s=0;s<this.cells.length;s++)n+=this.cells[s].length;var c=new Int32Array(e+n+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var h=e,f=0;f<t.length;f++){var y=t[f];c[3+f]=h,c.set(y,h),h+=y.length}return c[3+t.length]=h,c.set(this.keys,h),c[3+t.length+1]=h+=this.keys.length,c.set(this.bboxes,h),h+=this.bboxes.length,c.buffer};const{ImageData:Oa,ImageBitmap:bs}=se,Ra={};function rt(t,e,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Ra[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}rt("Object",Object),La.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},La.deserialize=function(t){return new La(t.buffer)},rt("Grid",La),rt("Color",jt),rt("Error",Error),rt("ResolvedImage",Wn),rt("StylePropertyFunction",gs),rt("StyleExpression",du,{omit:["_evaluator"]}),rt("ZoomDependentExpression",pu),rt("ZoomConstantExpression",za),rt("CompoundExpression",Dn,{omit:["_evaluate"]});for(const t in hi)hi[t]._classRegistryKey||rt(`Expression_${t}`,hi[t]);function Ts(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Od(t){return bs&&t instanceof bs}function Ba(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ts(t)||Od(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof Oa)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const s of t)n.push(Ba(s,e));return n}if(typeof t=="object"){const n=t.constructor,s=n._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");const c=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const h in t){if(!t.hasOwnProperty(h)||Ra[s].omit.indexOf(h)>=0)continue;const f=t[h];c[h]=Ra[s].shallow.indexOf(h)>=0?f:Ba(f,e)}t instanceof Error&&(c.message=t.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(c.$name=s),c}throw new Error("can't serialize object of type "+typeof t)}function mo(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ts(t)||Od(t)||ArrayBuffer.isView(t)||t instanceof Oa)return t;if(Array.isArray(t))return t.map(mo);if(typeof t=="object"){const e=t.$name||"Object",{klass:n}=Ra[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const s=Object.create(n.prototype);for(const c of Object.keys(t)){if(c==="$name")continue;const h=t[c];s[c]=Ra[e].shallow.indexOf(c)>=0?h:mo(h)}return s}throw new Error("can't deserialize object of type "+typeof t)}class d{constructor(){this.first=!0}update(e,n){const s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))}}const r=t=>t>=1536&&t<=1791,l=t=>t>=1872&&t<=1919,p=t=>t>=2208&&t<=2303,g=t=>t>=11904&&t<=12031,v=t=>t>=12032&&t<=12255,w=t=>t>=12272&&t<=12287,T=t=>t>=12288&&t<=12351,I=t=>t>=12352&&t<=12447,A=t=>t>=12448&&t<=12543,z=t=>t>=12544&&t<=12591,L=t=>t>=12704&&t<=12735,F=t=>t>=12736&&t<=12783,$=t=>t>=12784&&t<=12799,N=t=>t>=12800&&t<=13055,G=t=>t>=13056&&t<=13311,ie=t=>t>=13312&&t<=19903,V=t=>t>=19968&&t<=40959,ee=t=>t>=40960&&t<=42127,te=t=>t>=42128&&t<=42191,K=t=>t>=44032&&t<=55215,J=t=>t>=63744&&t<=64255,oe=t=>t>=64336&&t<=65023,ye=t=>t>=65040&&t<=65055,Se=t=>t>=65072&&t<=65103,We=t=>t>=65104&&t<=65135,Ne=t=>t>=65136&&t<=65279,Be=t=>t>=65280&&t<=65519;function ke(t){for(const e of t)if(Pe(e.charCodeAt(0)))return!0;return!1}function be(t){for(const e of t)if(!Oe(e.charCodeAt(0)))return!1;return!0}function Oe(t){return!(r(t)||l(t)||p(t)||oe(t)||Ne(t))}function Pe(t){return!(t!==746&&t!==747&&(t<4352||!(L(t)||z(t)||Se(t)&&!(t>=65097&&t<=65103)||J(t)||G(t)||g(t)||F(t)||!(!T(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||ie(t)||V(t)||N(t)||(e=>e>=12592&&e<=12687)(t)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||K(t)||I(t)||w(t)||(e=>e>=12688&&e<=12703)(t)||v(t)||$(t)||A(t)&&t!==12540||!(!Be(t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!We(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||ye(t)||(e=>e>=19904&&e<=19967)(t)||ee(t)||te(t))))}function ct(t){return!(Pe(t)||function(e){return!!((n=>n>=128&&n<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(n=>n>=8192&&n<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&e!==9251||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||T(e)||A(e)||(n=>n>=57344&&n<=63743)(e)||Se(e)||We(e)||Be(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function _t(t){return t>=1424&&t<=2303||oe(t)||Ne(t)}function kt(t,e){return!(!e&&_t(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(n=>n>=6016&&n<=6143)(t))}function qe(t){for(const e of t)if(_t(e.charCodeAt(0)))return!0;return!1}const dt="deferred",xt="loading",Yt="loaded";let nr=null,vt="unavailable",zt=null;const pr=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(vt="error"),nr&&nr(t)};function Ur(){Tn.fire(new io("pluginStateChange",{pluginStatus:vt,pluginURL:zt}))}const Tn=new oo,Yn=function(){return vt},pi=function(){if(vt!==dt||!zt)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vt=xt,Ur(),zt&&da({url:zt},t=>{t?pr(t):(vt=Yt,Ur())})},Ft={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>vt===Yt||Ft.applyArabicShaping!=null,isLoading:()=>vt===xt,setState(t){vt=t.pluginStatus,zt=t.pluginURL},isParsed:()=>Ft.applyArabicShaping!=null&&Ft.processBidirectionalText!=null&&Ft.processStyledBidirectionalText!=null,getPluginURL:()=>zt};class wt{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new d,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,s){for(const c of n)if(!kt(c.charCodeAt(0),s))return!1;return!0}(e,Ft.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*n}}}class Ot{constructor(e,n){this.property=e,this.value=n,this.expression=function(s,c){if(Bl(s))return new gs(s,c);if(_s(s)){const h=Sd(s,c);if(h.result==="error")throw new Error(h.value.map(f=>`${f.key}: ${f.message}`).join(", "));return h.value}{let h=s;return typeof s=="string"&&c.type==="color"&&(h=jt.parse(s)),{kind:"constant",evaluate:()=>h}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,s){return this.property.possiblyEvaluate(this,e,n,s)}}class Tr{constructor(e){this.property=e,this.value=new Ot(e,void 0)}transitioned(e,n){return new cr(this.property,this.value,n,br({},e.transition,this.transition),e.now)}untransitioned(){return new cr(this.property,this.value,null,{},0)}}class Ln{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Gn(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Tr(this._values[e].property)),this._values[e].value=new Ot(this._values[e].property,n===null?void 0:Gn(n))}getTransition(e){return Gn(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Tr(this._values[e].property)),this._values[e].transition=Gn(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(e[n]=s);const c=this.getTransition(n);c!==void 0&&(e[`${n}-transition`]=c)}return e}transitioned(e,n){const s=new On(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].transitioned(e,n._values[c]);return s}untransitioned(){const e=new On(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class cr{constructor(e,n,s,c,h){const f=c.delay||0,y=c.duration||0;h=h||0,this.property=e,this.value=n,this.begin=h+f,this.end=this.begin+y,e.specification.transition&&(c.delay||c.duration)&&(this.prior=s)}possiblyEvaluate(e,n,s){const c=e.now||0,h=this.value.possiblyEvaluate(e,n,s),f=this.prior;if(f){if(c>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(c<this.begin)return f.possiblyEvaluate(e,n,s);{const y=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(e,n,s),h,ia(y))}}return h}}class On{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,s){const c=new Ro(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].possiblyEvaluate(e,n,s);return c}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Fa{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Gn(this._values[e].value)}setValue(e,n){this._values[e]=new Ot(this._values[e].property,n===null?void 0:Gn(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(e[n]=s)}return e}possiblyEvaluate(e,n,s){const c=new Ro(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].possiblyEvaluate(e,n,s);return c}}class Sn{constructor(e,n,s){this.property=e,this.value=n,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,s,c){return this.property.evaluate(this.value,this.parameters,e,n,s,c)}}class Ro{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class it{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,s){const c=Cl[this.specification.type];return c?c(e,n,s):e}}class pt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,s,c){return new Sn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},s,c)}:e.expression,n)}interpolate(e,n,s){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Sn(this,{kind:"constant",value:void 0},e.parameters);const c=Cl[this.specification.type];return c?new Sn(this,{kind:"constant",value:c(e.value.value,n.value.value,s)},e.parameters):e}evaluate(e,n,s,c,h,f){return e.kind==="constant"?e.value:e.evaluate(n,s,c,h,f)}}class Kr extends pt{possiblyEvaluate(e,n,s,c){if(e.value===void 0)return new Sn(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const h=e.expression.evaluate(n,null,{},s,c),f=e.property.specification.type==="resolvedImage"&&typeof h!="string"?h.name:h,y=this._calculate(f,f,f,n);return new Sn(this,{kind:"constant",value:y},n)}if(e.expression.kind==="camera"){const h=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new Sn(this,{kind:"constant",value:h},n)}return new Sn(this,e.expression,n)}evaluate(e,n,s,c,h,f){if(e.kind==="source"){const y=e.evaluate(n,s,c,h,f);return this._calculate(y,y,y,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},s,c),e.evaluate({zoom:Math.floor(n.zoom)},s,c),e.evaluate({zoom:Math.floor(n.zoom)+1},s,c),n):e.value}_calculate(e,n,s,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:e,to:n,other:s}:{from:s,to:n,other:e}}interpolate(e){return e}}class Bo{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,c){if(e.value!==void 0){if(e.expression.kind==="constant"){const h=e.expression.evaluate(n,null,{},s,c);return this._calculate(h,h,h,n)}return this._calculate(e.expression.evaluate(new wt(Math.floor(n.zoom-1),n)),e.expression.evaluate(new wt(Math.floor(n.zoom),n)),e.expression.evaluate(new wt(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,s,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:s,to:n}}interpolate(e){return e}}class _o{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,c){return!!e.expression.evaluate(n,null,{},s,c)}interpolate(){return!1}}class on{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const s=e[n];s.specification.overridable&&this.overridableProperties.push(n);const c=this.defaultPropertyValues[n]=new Ot(s,void 0),h=this.defaultTransitionablePropertyValues[n]=new Tr(s);this.defaultTransitioningPropertyValues[n]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=c.possiblyEvaluate({})}}}function fv(t,e){return 256*(t=Kt(Math.floor(t),0,255))+Kt(Math.floor(e),0,255)}rt("DataDrivenProperty",pt),rt("DataConstantProperty",it),rt("CrossFadedDataDrivenProperty",Kr),rt("CrossFadedProperty",Bo),rt("ColorRampProperty",_o);const nT={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Cu{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Dr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function vr(t,e=1){let n=0,s=0;return{members:t.map(c=>{const h=nT[c.type].BYTES_PER_ELEMENT,f=n=mv(n,Math.max(e,h)),y=c.components||1;return s=Math.max(s,h),n+=h*y,{name:c.name,type:c.type,components:y,offset:f}}),size:mv(n,Math.max(s,e)),alignment:e}}function mv(t,e){return Math.ceil(t/e)*e}class Hl extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const c=2*e;return this.int16[c+0]=n,this.int16[c+1]=s,e}}Hl.prototype.bytesPerElement=4,rt("StructArrayLayout2i4",Hl);class Xl extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s,c)}emplace(e,n,s,c,h){const f=4*e;return this.int16[f+0]=n,this.int16[f+1]=s,this.int16[f+2]=c,this.int16[f+3]=h,e}}Xl.prototype.bytesPerElement=8,rt("StructArrayLayout4i8",Xl);class dm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,s,c,h,f,y)}emplace(e,n,s,c,h,f,y,x){const b=6*e,E=12*e,C=3*e;return this.int16[b+0]=n,this.int16[b+1]=s,this.uint8[E+4]=c,this.uint8[E+5]=h,this.uint8[E+6]=f,this.uint8[E+7]=y,this.float32[C+2]=x,e}}dm.prototype.bytesPerElement=12,rt("StructArrayLayout2i4ub1f12",dm);class Yl extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,s)}emplace(e,n,s,c){const h=3*e;return this.float32[h+0]=n,this.float32[h+1]=s,this.float32[h+2]=c,e}}Yl.prototype.bytesPerElement=12,rt("StructArrayLayout3f12",Yl);class Ss extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y,x,b,E){const C=this.length;return this.resize(C+1),this.emplace(C,e,n,s,c,h,f,y,x,b,E)}emplace(e,n,s,c,h,f,y,x,b,E,C){const M=10*e;return this.uint16[M+0]=n,this.uint16[M+1]=s,this.uint16[M+2]=c,this.uint16[M+3]=h,this.uint16[M+4]=f,this.uint16[M+5]=y,this.uint16[M+6]=x,this.uint16[M+7]=b,this.uint16[M+8]=E,this.uint16[M+9]=C,e}}Ss.prototype.bytesPerElement=20,rt("StructArrayLayout10ui20",Ss);class Rd extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,s,c,h,f,y,x)}emplace(e,n,s,c,h,f,y,x,b){const E=8*e;return this.uint16[E+0]=n,this.uint16[E+1]=s,this.uint16[E+2]=c,this.uint16[E+3]=h,this.uint16[E+4]=f,this.uint16[E+5]=y,this.uint16[E+6]=x,this.uint16[E+7]=b,e}}Rd.prototype.bytesPerElement=16,rt("StructArrayLayout8ui16",Rd);class pm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j){const W=this.length;return this.resize(W+1),this.emplace(W,e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j)}emplace(e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W){const re=16*e;return this.int16[re+0]=n,this.int16[re+1]=s,this.int16[re+2]=c,this.int16[re+3]=h,this.uint16[re+4]=f,this.uint16[re+5]=y,this.uint16[re+6]=x,this.uint16[re+7]=b,this.int16[re+8]=E,this.int16[re+9]=C,this.int16[re+10]=M,this.int16[re+11]=D,this.int16[re+12]=R,this.int16[re+13]=U,this.int16[re+14]=j,this.int16[re+15]=W,e}}pm.prototype.bytesPerElement=32,rt("StructArrayLayout4i4ui4i4i32",pm);class fm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}fm.prototype.bytesPerElement=4,rt("StructArrayLayout1ul4",fm);class mm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y,x,b,E,C,M,D){const R=this.length;return this.resize(R+1),this.emplace(R,e,n,s,c,h,f,y,x,b,E,C,M,D)}emplace(e,n,s,c,h,f,y,x,b,E,C,M,D,R){const U=20*e,j=10*e;return this.int16[U+0]=n,this.int16[U+1]=s,this.int16[U+2]=c,this.int16[U+3]=h,this.int16[U+4]=f,this.float32[j+3]=y,this.float32[j+4]=x,this.float32[j+5]=b,this.float32[j+6]=E,this.int16[U+14]=C,this.uint32[j+8]=M,this.uint16[U+18]=D,this.uint16[U+19]=R,e}}mm.prototype.bytesPerElement=40,rt("StructArrayLayout5i4f1i1ul2ui40",mm);class Bd extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,s,c,h,f,y)}emplace(e,n,s,c,h,f,y,x){const b=8*e;return this.int16[b+0]=n,this.int16[b+1]=s,this.int16[b+2]=c,this.int16[b+4]=h,this.int16[b+5]=f,this.int16[b+6]=y,this.int16[b+7]=x,e}}Bd.prototype.bytesPerElement=16,rt("StructArrayLayout3i2i2i16",Bd);class _m extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,s,c,h)}emplace(e,n,s,c,h,f){const y=4*e,x=8*e;return this.float32[y+0]=n,this.float32[y+1]=s,this.float32[y+2]=c,this.int16[x+6]=h,this.int16[x+7]=f,e}}_m.prototype.bytesPerElement=16,rt("StructArrayLayout2f1f2i16",_m);class gm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s,c)}emplace(e,n,s,c,h){const f=12*e,y=3*e;return this.uint8[f+0]=n,this.uint8[f+1]=s,this.float32[y+1]=c,this.float32[y+2]=h,e}}gm.prototype.bytesPerElement=12,rt("StructArrayLayout2ub2f12",gm);class fi extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,s)}emplace(e,n,s,c){const h=3*e;return this.uint16[h+0]=n,this.uint16[h+1]=s,this.uint16[h+2]=c,e}}fi.prototype.bytesPerElement=6,rt("StructArrayLayout3ui6",fi);class ym extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W,re,le,de,pe){const fe=this.length;return this.resize(fe+1),this.emplace(fe,e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W,re,le,de,pe)}emplace(e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W,re,le,de,pe,fe){const Ae=30*e,Me=15*e,Xe=60*e;return this.int16[Ae+0]=n,this.int16[Ae+1]=s,this.int16[Ae+2]=c,this.float32[Me+2]=h,this.float32[Me+3]=f,this.uint16[Ae+8]=y,this.uint16[Ae+9]=x,this.uint32[Me+5]=b,this.uint32[Me+6]=E,this.uint32[Me+7]=C,this.uint16[Ae+16]=M,this.uint16[Ae+17]=D,this.uint16[Ae+18]=R,this.float32[Me+10]=U,this.float32[Me+11]=j,this.uint8[Xe+48]=W,this.uint8[Xe+49]=re,this.uint8[Xe+50]=le,this.uint32[Me+13]=de,this.int16[Ae+28]=pe,this.uint8[Xe+58]=fe,e}}ym.prototype.bytesPerElement=60,rt("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",ym);class vm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W,re,le,de,pe,fe,Ae,Me,Xe,Ge,Ie,Ze,Ye,Re){const tt=this.length;return this.resize(tt+1),this.emplace(tt,e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W,re,le,de,pe,fe,Ae,Me,Xe,Ge,Ie,Ze,Ye,Re)}emplace(e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j,W,re,le,de,pe,fe,Ae,Me,Xe,Ge,Ie,Ze,Ye,Re,tt){const ot=38*e,Bt=19*e;return this.int16[ot+0]=n,this.int16[ot+1]=s,this.int16[ot+2]=c,this.float32[Bt+2]=h,this.float32[Bt+3]=f,this.int16[ot+8]=y,this.int16[ot+9]=x,this.int16[ot+10]=b,this.int16[ot+11]=E,this.int16[ot+12]=C,this.int16[ot+13]=M,this.uint16[ot+14]=D,this.uint16[ot+15]=R,this.uint16[ot+16]=U,this.uint16[ot+17]=j,this.uint16[ot+18]=W,this.uint16[ot+19]=re,this.uint16[ot+20]=le,this.uint16[ot+21]=de,this.uint16[ot+22]=pe,this.uint16[ot+23]=fe,this.uint16[ot+24]=Ae,this.uint16[ot+25]=Me,this.uint16[ot+26]=Xe,this.uint16[ot+27]=Ge,this.uint16[ot+28]=Ie,this.uint32[Bt+15]=Ze,this.float32[Bt+16]=Ye,this.float32[Bt+17]=Re,this.float32[Bt+18]=tt,e}}vm.prototype.bytesPerElement=76,rt("StructArrayLayout3i2f6i15ui1ul3f76",vm);class Fd extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Fd.prototype.bytesPerElement=4,rt("StructArrayLayout1f4",Fd);class xm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,s)}emplace(e,n,s,c){const h=3*e;return this.int16[h+0]=n,this.int16[h+1]=s,this.int16[h+2]=c,e}}xm.prototype.bytesPerElement=6,rt("StructArrayLayout3i6",xm);class ku extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,c,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,s,c,h,f,y)}emplace(e,n,s,c,h,f,y,x){const b=7*e;return this.float32[b+0]=n,this.float32[b+1]=s,this.float32[b+2]=c,this.float32[b+3]=h,this.float32[b+4]=f,this.float32[b+5]=y,this.float32[b+6]=x,e}}ku.prototype.bytesPerElement=28,rt("StructArrayLayout7f28",ku);class wm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s,c)}emplace(e,n,s,c,h){const f=6*e;return this.uint32[3*e+0]=n,this.uint16[f+2]=s,this.uint16[f+3]=c,this.uint16[f+4]=h,e}}wm.prototype.bytesPerElement=12,rt("StructArrayLayout1ul3ui12",wm);class Es extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const c=2*e;return this.uint16[c+0]=n,this.uint16[c+1]=s,e}}Es.prototype.bytesPerElement=4,rt("StructArrayLayout2ui4",Es);class Ud extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Ud.prototype.bytesPerElement=2,rt("StructArrayLayout1ui2",Ud);class Nd extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const c=2*e;return this.float32[c+0]=n,this.float32[c+1]=s,e}}Nd.prototype.bytesPerElement=8,rt("StructArrayLayout2f8",Nd);class bm extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s,c)}emplace(e,n,s,c,h){const f=4*e;return this.float32[f+0]=n,this.float32[f+1]=s,this.float32[f+2]=c,this.float32[f+3]=h,e}}bm.prototype.bytesPerElement=16,rt("StructArrayLayout4f16",bm);class _v extends Cu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}_v.prototype.size=40;class Tm extends mm{get(e){return new _v(this,e)}}rt("CollisionBoxArray",Tm);class gv extends Cu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}gv.prototype.size=60;class yv extends ym{get(e){return new gv(this,e)}}rt("PlacedSymbolArray",yv);class vv extends Cu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}vv.prototype.size=76;class xv extends vm{get(e){return new vv(this,e)}}rt("SymbolInstanceArray",xv);class wv extends Fd{getoffsetX(e){return this.float32[1*e+0]}}rt("GlyphOffsetArray",wv);class bv extends xm{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}rt("SymbolLineVertexArray",bv);class Tv extends Cu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Tv.prototype.size=12;class Sv extends wm{get(e){return new Tv(this,e)}}rt("FeatureIndexArray",Sv);class Ev extends Cu{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Ev.prototype.size=4;class Cv extends Es{get(e){return new Ev(this,e)}}rt("FillExtrusionCentroidArray",Cv);const iT=vr([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),oT=vr([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var kv=ds(function(t){t.exports=function(e,n){var s,c,h,f,y,x,b,E;for(c=e.length-(s=3&e.length),h=n,y=3432918353,x=461845907,E=0;E<c;)b=255&e.charCodeAt(E)|(255&e.charCodeAt(++E))<<8|(255&e.charCodeAt(++E))<<16|(255&e.charCodeAt(++E))<<24,++E,h=27492+(65535&(f=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(b=0,s){case 3:b^=(255&e.charCodeAt(E+2))<<16;case 2:b^=(255&e.charCodeAt(E+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&e.charCodeAt(E)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295}return h^=e.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}}),sT=ds(function(t){t.exports=function(e,n){for(var s,c=e.length,h=n^c,f=0;c>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++f;switch(c){case 3:h^=(255&e.charCodeAt(f+2))<<16;case 2:h^=(255&e.charCodeAt(f+1))<<8;case 1:h=1540483477*(65535&(h^=255&e.charCodeAt(f)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}}),Mu=kv,aT=sT;Mu.murmur3=kv,Mu.murmur2=aT;class jd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,s,c){this.ids.push(Mv(e)),this.positions.push(n,s,c)}getPositions(e){const n=Mv(e);let s=0,c=this.ids.length-1;for(;s<c;){const f=s+c>>1;this.ids[f]>=n?c=f:s=f+1}const h=[];for(;this.ids[s]===n;)h.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return h}static serialize(e,n){const s=new Float64Array(e.ids),c=new Uint32Array(e.positions);return Sm(s,c,0,s.length-1),n&&n.push(s.buffer,c.buffer),{ids:s,positions:c}}static deserialize(e){const n=new jd;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Mv(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Mu(String(t))}function Sm(t,e,n,s){for(;n<s;){const c=t[n+s>>1];let h=n-1,f=s+1;for(;;){do h++;while(t[h]<c);do f--;while(t[f]>c);if(h>=f)break;Vd(t,h,f),Vd(e,3*h,3*f),Vd(e,3*h+1,3*f+1),Vd(e,3*h+2,3*f+2)}f-n<s-f?(Sm(t,e,n,f),n=f+1):(Sm(t,e,f+1,s),s=f)}}function Vd(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}rt("FeaturePositionMap",jd);class Fo{constructor(e,n){this.gl=e.gl,this.location=n}}class $d extends Fo{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Iv extends Fo{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Av extends Fo{constructor(e,n){super(e,n),this.current=jt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const lT=new Float32Array(16),cT=new Float32Array(9),uT=new Float32Array(4);function Em(t){return[fv(255*t.r,255*t.g),fv(255*t.b,255*t.a)]}class Iu{constructor(e,n,s){this.value=e,this.uniformNames=n.map(c=>`u_${c}`),this.type=s}setUniform(e,n,s){e.set(s.constantOr(this.value))}getBinding(e,n,s){return this.type==="color"?new Av(e,n):new $d(e,n)}}class Kl{constructor(e,n){this.uniformNames=n.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tl.concat(n.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,n,s,c){const h=c==="u_pattern_to"||c==="u_dash_to"?this.patternTo:c==="u_pattern_from"||c==="u_dash_from"?this.patternFrom:c==="u_pixel_ratio_to"?this.pixelRatioTo:c==="u_pixel_ratio_from"?this.pixelRatioFrom:null;h&&e.set(h)}getBinding(e,n,s){return s==="u_pattern_from"||s==="u_pattern_to"||s==="u_dash_from"||s==="u_dash_to"?new Iv(e,n):new $d(e,n)}}class Uo{constructor(e,n,s,c){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(h=>({name:`a_${h}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new c}populatePaintArray(e,n,s,c,h,f){const y=this.paintVertexArray.length,x=this.expression.evaluate(new wt(0),n,{},h,c,f);this.paintVertexArray.resize(e),this._setPaintValue(y,e,x)}updatePaintArray(e,n,s,c,h){const f=this.expression.evaluate({zoom:0},s,c,void 0,h);this._setPaintValue(e,n,f)}_setPaintValue(e,n,s){if(this.type==="color"){const c=Em(s);for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,c[0],c[1])}else{for(let c=e;c<n;c++)this.paintVertexArray.emplace(c,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gi{constructor(e,n,s,c,h,f){this.expression=e,this.uniformNames=n.map(y=>`u_${y}_t`),this.type=s,this.useIntegerZoom=c,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=n.map(y=>({name:`a_${y}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,n,s,c,h,f){const y=this.expression.evaluate(new wt(this.zoom),n,{},h,c,f),x=this.expression.evaluate(new wt(this.zoom+1),n,{},h,c,f),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,y,x)}updatePaintArray(e,n,s,c,h){const f=this.expression.evaluate({zoom:this.zoom},s,c,void 0,h),y=this.expression.evaluate({zoom:this.zoom+1},s,c,void 0,h);this._setPaintValue(e,n,f,y)}_setPaintValue(e,n,s,c){if(this.type==="color"){const h=Em(s),f=Em(c);for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,h[0],h[1],f[0],f[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,s,c);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const s=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,c=Kt(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(c)}getBinding(e,n,s){return new $d(e,n)}}class Cs{constructor(e,n,s,c,h,f,y){this.expression=e,this.type=s,this.useIntegerZoom=c,this.zoom=h,this.layerId=y,this.paintVertexAttributes=(s==="array"?oT:iT).members;for(let x=0;x<n.length;++x);this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(e,n,s){const c=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(c,e,n.patterns&&n.patterns[this.layerId],s)}updatePaintArray(e,n,s,c,h,f){this._setPaintValues(e,n,s.patterns&&s.patterns[this.layerId],f)}_setPaintValues(e,n,s,c){if(!c||!s)return;const{min:h,mid:f,max:y}=s,x=c[h],b=c[f],E=c[y];if(x&&b&&E)for(let C=e;C<n;C++)this._setPaintValue(this.zoomInPaintVertexArray,C,b,x),this._setPaintValue(this.zoomOutPaintVertexArray,C,b,E)}_setPaintValue(e,n,s,c){e.emplace(n,s.tl[0],s.tl[1],s.br[0],s.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],s.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class No{constructor(e,n,s=()=>!0){this.binders={},this._buffers=[];const c=[];for(const h in e.paint._values){if(!s(h))continue;const f=e.paint.get(h);if(!(f instanceof Sn&&ms(f.property.specification)))continue;const y=dT(h,e.type),x=f.value,b=f.property.specification.type,E=f.property.useIntegerZoom,C=f.property.specification["property-type"],M=C==="cross-faded"||C==="cross-faded-data-driven",D=String(h)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(x.kind!=="constant"||D)if(x.kind==="source"||D||M){const R=zv(h,b,"source");this.binders[h]=M?new Cs(x,y,b,E,n,R,e.id):new Uo(x,y,b,R),c.push(`/a_${h}`)}else{const R=zv(h,b,"composite");this.binders[h]=new Gi(x,y,b,E,n,R),c.push(`/z_${h}`)}else this.binders[h]=M?new Kl(x.value,y):new Iu(x.value,y,b),c.push(`/u_${h}`)}this.cacheKey=c.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof Uo||n instanceof Gi?n.maxValue:0}populatePaintArrays(e,n,s,c,h,f){for(const y in this.binders){const x=this.binders[y];(x instanceof Uo||x instanceof Gi||x instanceof Cs)&&x.populatePaintArray(e,n,s,c,h,f)}}setConstantPatternPositions(e,n){for(const s in this.binders){const c=this.binders[s];c instanceof Kl&&c.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,s,c,h,f){let y=!1;for(const x in e){const b=n.getPositions(x);for(const E of b){const C=s.feature(E.index);for(const M in this.binders){const D=this.binders[M];if((D instanceof Uo||D instanceof Gi||D instanceof Cs)&&D.expression.isStateDependent===!0){const R=c.paint.get(M);D.expression=R.value,D.updatePaintArray(E.start,E.end,C,e[x],h,f),y=!0}}}}return y}defines(){const e=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Iu||s instanceof Kl)&&e.push(...s.uniformNames.map(c=>`#define HAS_UNIFORM_${c}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Uo||s instanceof Gi||s instanceof Cs)for(let c=0;c<s.paintVertexAttributes.length;c++)e.push(s.paintVertexAttributes[c].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Iu||s instanceof Kl||s instanceof Gi)for(const c of s.uniformNames)e.push(c)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const s=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Iu||h instanceof Kl||h instanceof Gi){for(const f of h.uniformNames)if(n[f]){const y=h.getBinding(e,n[f],f);s.push({name:f,property:c,binding:y})}}}return s}setUniforms(e,n,s,c){for(const{name:h,property:f,binding:y}of n)this.binders[f].setUniform(y,c,s.get(f),h)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const s=this.binders[n];if(e&&s instanceof Cs){const c=e.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;c&&this._buffers.push(c)}else(s instanceof Uo||s instanceof Gi)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(e){for(const n in this.binders){const s=this.binders[n];(s instanceof Uo||s instanceof Gi||s instanceof Cs)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof Uo||n instanceof Gi||n instanceof Cs)&&n.destroy()}}}class Ua{constructor(e,n,s=()=>!0){this.programConfigurations={};for(const c of e)this.programConfigurations[c.id]=new No(c,n,s);this.needsUpload=!1,this._featureMap=new jd,this._bufferOffset=0}populatePaintArrays(e,n,s,c,h,f,y){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,n,c,h,f,y);n.id!==void 0&&this._featureMap.add(n.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,s,c,h){for(const f of s)this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(e,this._featureMap,n,f,c,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const hT={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function dT(t,e){return hT[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const pT={"line-pattern":{source:Ss,composite:Ss},"fill-pattern":{source:Ss,composite:Ss},"fill-extrusion-pattern":{source:Ss,composite:Ss},"line-dasharray":{source:Rd,composite:Rd}},fT={color:{source:Nd,composite:bm},number:{source:Fd,composite:Nd}};function zv(t,e,n){const s=pT[t];return s&&s[n]||fT[e][n]}rt("ConstantBinder",Iu),rt("CrossFadedConstantBinder",Kl),rt("SourceExpressionBinder",Uo),rt("CrossFadedCompositeBinder",Cs),rt("CompositeExpressionBinder",Gi),rt("ProgramConfiguration",No,{omit:["_buffers"]}),rt("ProgramConfigurationSet",Ua);const Gd="-transition";class Zi extends oo{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Fa(n.layout)),n.paint)){this._transitionablePaint=new Ln(n.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ro(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,s={}){n!=null&&this._validate(hm,`layers.${this.id}.layout.${e}`,e,n,s)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return ns(e,Gd)?this._transitionablePaint.getTransition(e.slice(0,-Gd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,s={}){if(n!=null&&this._validate(Eu,`layers.${this.id}.paint.${e}`,e,n,s))return!1;if(ns(e,Gd))return this._transitionablePaint.setTransition(e.slice(0,-Gd.length),n||void 0),!1;{const c=this._transitionablePaint._values[e],h=c.property.specification["property-type"]==="cross-faded-data-driven",f=c.value.isDataDriven(),y=c.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const x=this._transitionablePaint._values[e].value;return x.isDataDriven()||f||h||this._handleOverridablePaintPropertyUpdate(e,y,x)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),is(e,(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}_validate(e,n,s,c,h={}){return(!h||h.validate!==!1)&&Ld(this,e.call(xs,{key:n,layerType:this.type,objectKey:s,value:c,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof Sn&&ms(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Gl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const mT=vr([{name:"a_pos",components:2,type:"Int16"}],4),{members:_T}=mT;class Lr{constructor(e=[]){this.segments=e}prepareSegment(e,n,s,c){let h=this.segments[this.segments.length-1];return e>Lr.MAX_VERTEX_ARRAY_LENGTH&&gr(`Max vertices per segment is ${Lr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!h||h.vertexLength+e>Lr.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==c)&&(h={vertexOffset:n.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},c!==void 0&&(h.sortKey=c),this.segments.push(h)),h}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,s,c){return new Lr([{vertexOffset:e,primitiveOffset:n,vertexLength:s,primitiveLength:c,vaos:{},sortKey:0}])}}Lr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,rt("SegmentVector",Lr);var Dt=8192;class Na{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Qt?new Qt(e.lng,e.lat):Qt.convert(e),this}setSouthWest(e){return this._sw=e instanceof Qt?new Qt(e.lng,e.lat):Qt.convert(e),this}extend(e){const n=this._sw,s=this._ne;let c,h;if(e instanceof Qt)c=e,h=e;else{if(!(e instanceof Na))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Na.convert(e)):this.extend(Qt.convert(e)):this;if(c=e._sw,h=e._ne,!c||!h)return this}return n||s?(n.lng=Math.min(c.lng,n.lng),n.lat=Math.min(c.lat,n.lat),s.lng=Math.max(h.lng,s.lng),s.lat=Math.max(h.lat,s.lat)):(this._sw=new Qt(c.lng,c.lat),this._ne=new Qt(h.lng,h.lat)),this}getCenter(){return new Qt((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Qt(this.getWest(),this.getNorth())}getSouthEast(){return new Qt(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:s}=Qt.convert(e);let c=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&c}static convert(e){return!e||e instanceof Na?e:new Na(e)}}const Pv=63710088e-1;class Qt{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Qt(Bi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,s=this.lat*n,c=e.lat*n,h=Math.sin(s)*Math.sin(c)+Math.cos(s)*Math.cos(c)*Math.cos((e.lng-this.lng)*n);return Pv*Math.acos(Math.min(h,1))}toBounds(e=0){const n=360*e/40075017,s=n/Math.cos(Math.PI/180*this.lat);return new Na(new Qt(this.lng-s,this.lat-n),new Qt(this.lng+s,this.lat+n))}static convert(e){if(e instanceof Qt)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Qt(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Qt(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Dv=2*Math.PI*Pv;function Lv(t){return Dv*Math.cos(t*Math.PI/180)}function Jl(t){return(180+t)/360}function Ql(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function qi(t,e){return t/Lv(e)}function jo(t){return 360*t-180}function Mi(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Ov(t,e){return t*Lv(Mi(e))}const go=85.051129;class Zd{constructor(e,n,s=0){this.x=+e,this.y=+n,this.z=+s}static fromLngLat(e,n=0){const s=Qt.convert(e);return new Zd(Jl(s.lng),Ql(s.lat),qi(n,s.lat))}toLngLat(){return new Qt(jo(this.x),Mi(this.y))}toAltitude(){return Ov(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Dv*(e=Mi(this.y),1/Math.cos(e*Math.PI/180));var e}}function Cm(t,e,n,s,c,h,f,y,x){const b=(e+s)/2,E=(n+c)/2,C=new ce(b,E);y(C),function(M,D,R,U,j,W){const re=R-j,le=U-W;return Math.abs((U-D)*re-(R-M)*le)/Math.hypot(re,le)}(C.x,C.y,h.x,h.y,f.x,f.y)>=x?(Cm(t,e,n,b,E,h,C,y,x),Cm(t,b,E,s,c,C,f,y,x)):t.push(f)}function gT(t,e,n){const s=[];let c,h,f;for(const y of t){const{x,y:b}=y;e(y),f?Cm(s,c,h,x,b,f,y,e,n):s.push(y),c=x,h=b,f=y}return s}const km=Math.pow(2,14)-1,Rv=-km-1;function yT(t,e){const n=Math.round(t.x*e),s=Math.round(t.y*e);return t.x=Kt(n,Rv,km),t.y=Kt(s,Rv,km),(n<t.x||n>t.x+1||s<t.y||s>t.y+1)&&gr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Vo(t,e,n){const s=t.loadGeometry(),c=t.extent,h=Dt/c;if(e&&n&&n.projection.isReprojectedInTileSpace){const f=1<<e.z,{scale:y,x,y:b,projection:E}=n,C=M=>{const D=jo((e.x+M.x/c)/f),R=Mi((e.y+M.y/c)/f),U=E.project(D,R);M.x=(U.x*y-x)*c,M.y=(U.y*y-b)*c};for(let M=0;M<s.length;M++)if(t.type!==1)s[M]=gT(s[M],C,1);else{const D=[];for(const R of s[M])R.x<0||R.x>=c||R.y<0||R.y>=c||(C(R),D.push(R));s[M]=D}}for(const f of s)for(const y of f)yT(y,h);return s}function ja(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Vo(t):[]}}function qd(t,e,n,s,c){t.emplaceBack(2*e+(s+1)/2,2*n+(c+1)/2)}class Mm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Hl,this.indexArray=new fi,this.segments=new Lr,this.programConfigurations=new Ua(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,c){const h=this.layers[0],f=[];let y=null;h.type==="circle"&&(y=h.layout.get("circle-sort-key"));for(const{feature:x,id:b,index:E,sourceLayerIndex:C}of e){const M=this.layers[0]._featureFilter.needGeometry,D=ja(x,M);if(!this.layers[0]._featureFilter.filter(new wt(this.zoom),D,s))continue;const R=y?y.evaluate(D,{},s):void 0,U={id:b,properties:x.properties,type:x.type,sourceLayerIndex:C,index:E,geometry:M?D.geometry:Vo(x,s,c),patterns:{},sortKey:R};f.push(U)}y&&f.sort((x,b)=>x.sortKey-b.sortKey);for(const x of f){const{geometry:b,index:E,sourceLayerIndex:C}=x,M=e[E].feature;this.addFeature(x,b,E,n.availableImages,s),n.featureIndex.insert(M,b,E,C,this.index)}}update(e,n,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_T),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,s,c,h){for(const f of n)for(const y of f){const x=y.x,b=y.y;if(x<0||x>=Dt||b<0||b>=Dt)continue;const E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),C=E.vertexLength;qd(this.layoutVertexArray,x,b,-1,-1),qd(this.layoutVertexArray,x,b,1,-1),qd(this.layoutVertexArray,x,b,1,1),qd(this.layoutVertexArray,x,b,-1,1),this.indexArray.emplaceBack(C,C+1,C+2),this.indexArray.emplaceBack(C,C+3,C+2),E.vertexLength+=4,E.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},c,h)}}function Bv(t,e){for(let n=0;n<t.length;n++)if(ec(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(ec(t,e[n]))return!0;return!!Im(t,e)}function vT(t,e,n){return!!ec(t,e)||!!Am(e,t,n)}function Fv(t,e){if(t.length===1)return Nv(e,t[0]);for(let n=0;n<e.length;n++){const s=e[n];for(let c=0;c<s.length;c++)if(ec(t,s[c]))return!0}for(let n=0;n<t.length;n++)if(Nv(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Im(t,e[n]))return!0;return!1}function xT(t,e,n){if(t.length>1){if(Im(t,e))return!0;for(let s=0;s<e.length;s++)if(Am(e[s],t,n))return!0}for(let s=0;s<t.length;s++)if(Am(t[s],e,n))return!0;return!1}function Im(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){const s=t[n],c=t[n+1];for(let h=0;h<e.length-1;h++)if(wT(s,c,e[h],e[h+1]))return!0}return!1}function wT(t,e,n,s){return Zn(t,n,s)!==Zn(e,n,s)&&Zn(t,e,n)!==Zn(t,e,s)}function Am(t,e,n){const s=n*n;if(e.length===1)return t.distSqr(e[0])<s;for(let c=1;c<e.length;c++)if(Uv(t,e[c-1],e[c])<s)return!0;return!1}function Uv(t,e,n){const s=e.distSqr(n);if(s===0)return t.distSqr(e);const c=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;return t.distSqr(c<0?e:c>1?n:n.sub(e)._mult(c)._add(e))}function Nv(t,e){let n,s,c,h=!1;for(let f=0;f<t.length;f++){n=t[f];for(let y=0,x=n.length-1;y<n.length;x=y++)s=n[y],c=n[x],s.y>e.y!=c.y>e.y&&e.x<(c.x-s.x)*(e.y-s.y)/(c.y-s.y)+s.x&&(h=!h)}return h}function ec(t,e){let n=!1;for(let s=0,c=t.length-1;s<t.length;c=s++){const h=t[s],f=t[c];h.y>e.y!=f.y>e.y&&e.x<(f.x-h.x)*(e.y-h.y)/(f.y-h.y)+h.x&&(n=!n)}return n}function jv(t,e,n,s,c){for(const f of t)if(e<=f.x&&n<=f.y&&s>=f.x&&c>=f.y)return!0;const h=[new ce(e,n),new ce(e,c),new ce(s,c),new ce(s,n)];if(t.length>2){for(const f of h)if(ec(t,f))return!0}for(let f=0;f<t.length-1;f++)if(bT(t[f],t[f+1],h))return!0;return!1}function bT(t,e,n){const s=n[0],c=n[2];if(t.x<s.x&&e.x<s.x||t.x>c.x&&e.x>c.x||t.y<s.y&&e.y<s.y||t.y>c.y&&e.y>c.y)return!1;const h=Zn(t,e,n[0]);return h!==Zn(t,e,n[1])||h!==Zn(t,e,n[2])||h!==Zn(t,e,n[3])}function tc(t,e,n){const s=e.paint.get(t).value;return s.kind==="constant"?s.value:n.programConfigurations.get(e.id).getMaxValue(t)}function Wd(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Vv(t,e,n,s,c){if(!e[0]&&!e[1])return t;const h=ce.convert(e)._mult(c);n==="viewport"&&h._rotate(-s);const f=[];for(let y=0;y<t.length;y++)f.push(t[y].sub(h));return f}function $v(t,e,n,s){const c=ce.convert(t)._mult(s);return e==="viewport"&&c._rotate(-n),c}rt("CircleBucket",Mm,{omit:["layers"]});const TT=new on({"circle-sort-key":new pt(Ce.layout_circle["circle-sort-key"])});var ST={paint:new on({"circle-radius":new pt(Ce.paint_circle["circle-radius"]),"circle-color":new pt(Ce.paint_circle["circle-color"]),"circle-blur":new pt(Ce.paint_circle["circle-blur"]),"circle-opacity":new pt(Ce.paint_circle["circle-opacity"]),"circle-translate":new it(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new it(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new it(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new it(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pt(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pt(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pt(Ce.paint_circle["circle-stroke-opacity"])}),layout:TT};class zm{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,s,c){const h=Math.pow(2,s),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(x=>{const b=Hr([],x,e),E=1/b[3]/n*h;return function(C,M,D){return C[0]=M[0]*D[0],C[1]=M[1]*D[1],C[2]=M[2]*D[2],C[3]=M[3]*D[3],C}(b,b,[E,E,c?1/b[3]:E,E])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(x=>{const b=Gr([],dn([],$t([],f[x[0]],f[x[1]]),$t([],f[x[2]],f[x[1]]))),E=-Wr(b,f[x[1]]);return b.concat(E)});return new zm(f,y)}}class Wi{constructor(e,n){this.min=e,this.max=n,this.center=ur([],ut([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],s=Fe(this.min),c=Fe(this.max);for(let h=0;h<n.length;h++)s[h]=n[h]?this.min[h]:this.center[h],c[h]=n[h]?this.center[h]:this.max[h];return c[2]=this.max[2],new Wi(s,c)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let s=!0;for(let c=0;c<e.planes.length;c++){const h=e.planes[c];let f=0;for(let y=0;y<n.length;y++)f+=Wr(h,n[y])+h[3]>=0;if(f===0)return 0;f!==n.length&&(s=!1)}if(s)return 2;for(let c=0;c<3;c++){let h=Number.MAX_VALUE,f=-Number.MAX_VALUE;for(let y=0;y<e.points.length;y++){const x=e.points[y][c]-this.min[c];h=Math.min(h,x),f=Math.max(f,x)}if(f<0||h>this.max[c]-this.min[c])return 0}return 1}}function Gv(t,e,n,s,c,h,f,y,x){if(h&&t.queryGeometry.isAboveHorizon)return!1;h&&(x*=t.pixelToTileUnitsFactor);for(const b of e)for(const E of b){const C=E.add(y),M=c&&n.elevation?n.elevation.exaggeration()*c.getElevationAt(C.x,C.y,!0):0,D=h?C:ET(C,M,s),R=h?t.tilespaceRays.map(j=>kT(j,M)):t.queryGeometry.screenGeometry,U=Hr([],[E.x,E.y,M,1],s);if(!f&&h?x*=U[3]/n.cameraToCenterDistance:f&&!h&&(x*=n.cameraToCenterDistance/U[3]),vT(R,D,x))return!0}return!1}function ET(t,e,n){const s=Hr([],[t.x,t.y,e,1],n);return new ce(s[0]/s[3],s[1]/s[3])}const Zv=bt(0,0,0),CT=bt(0,0,1);function kT(t,e){const n=Ve();return Zv[2]=e,t.intersectsPlane(Zv,CT,n),new ce(n[0],n[1])}class qv extends Mm{}function Pm(t,{width:e,height:n},s,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==e*n*s)throw new RangeError("mismatched image size")}else c=new Uint8Array(e*n*s);return t.width=e,t.height=n,t.data=c,t}function Wv(t,{width:e,height:n},s){if(e===t.width&&n===t.height)return;const c=Pm({},{width:e,height:n},s);Dm(t,c,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},s),t.width=e,t.height=n,t.data=c.data}function Dm(t,e,n,s,c,h){if(c.width===0||c.height===0)return e;if(c.width>t.width||c.height>t.height||n.x>t.width-c.width||n.y>t.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>e.width||c.height>e.height||s.x>e.width-c.width||s.y>e.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const f=t.data,y=e.data;for(let x=0;x<c.height;x++){const b=((n.y+x)*t.width+n.x)*h,E=((s.y+x)*e.width+s.x)*h;for(let C=0;C<c.width*h;C++)y[E+C]=f[b+C]}return e}rt("HeatmapBucket",qv,{omit:["layers"]});class ks{constructor(e,n){Pm(this,e,1,n)}resize(e){Wv(this,e,1)}clone(){return new ks({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,c,h){Dm(e,n,s,c,h,1)}}class mi{constructor(e,n){Pm(this,e,4,n)}resize(e){Wv(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new mi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,c,h){Dm(e,n,s,c,h,4)}}rt("AlphaImage",ks),rt("RGBAImage",mi);var MT={paint:new on({"heatmap-radius":new pt(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pt(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new it(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _o(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new it(Ce.paint_heatmap["heatmap-opacity"])})};function Lm(t){const e={},n=t.resolution||256,s=t.clips?t.clips.length:1,c=t.image||new mi({width:n,height:s}),h=(f,y,x)=>{e[t.evaluationKey]=x;const b=t.expression.evaluate(e);c.data[f+y+0]=Math.floor(255*b.r/b.a),c.data[f+y+1]=Math.floor(255*b.g/b.a),c.data[f+y+2]=Math.floor(255*b.b/b.a),c.data[f+y+3]=Math.floor(255*b.a)};if(t.clips)for(let f=0,y=0;f<s;++f,y+=4*n)for(let x=0,b=0;x<n;x++,b+=4){const E=x/(n-1),{start:C,end:M}=t.clips[f];h(y,b,C*(1-E)+M*E)}else for(let f=0,y=0;f<n;f++,y+=4)h(0,y,f/(n-1));return c}var IT={paint:new on({"hillshade-illumination-direction":new it(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new it(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new it(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new it(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new it(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new it(Ce.paint_hillshade["hillshade-accent-color"])})};const AT=vr([{name:"a_pos",components:2,type:"Int16"}],4),{members:zT}=AT;var Hd=Xd,PT=Xd;function Xd(t,e,n){n=n||2;var s,c,h,f,y,x,b,E=e&&e.length,C=E?e[0]*n:t.length,M=Hv(t,0,C,n,!0),D=[];if(!M||M.next===M.prev)return D;if(E&&(M=function(U,j,W,re){var le,de,pe,fe=[];for(le=0,de=j.length;le<de;le++)(pe=Hv(U,j[le]*re,le<de-1?j[le+1]*re:U.length,re,!1))===pe.next&&(pe.steiner=!0),fe.push(NT(pe));for(fe.sort(BT),le=0;le<fe.length;le++)W=Ms(W=FT(fe[le],W),W.next);return W}(t,e,M,n)),t.length>80*n){s=h=t[0],c=f=t[1];for(var R=n;R<C;R+=n)(y=t[R])<s&&(s=y),(x=t[R+1])<c&&(c=x),y>h&&(h=y),x>f&&(f=x);b=(b=Math.max(h-s,f-c))!==0?1/b:0}return Au(M,D,n,s,c,b),D}function Hv(t,e,n,s,c){var h,f;if(c===Bm(t,e,n,s)>0)for(h=e;h<n;h+=s)f=Kv(h,t[h],t[h+1],f);else for(h=n-s;h>=e;h-=s)f=Kv(h,t[h],t[h+1],f);return f&&Yd(f,f.next)&&(Pu(f),f=f.next),f}function Ms(t,e){if(!t)return t;e||(e=t);var n,s=t;do if(n=!1,s.steiner||!Yd(s,s.next)&&Or(s.prev,s,s.next)!==0)s=s.next;else{if(Pu(s),(s=e=s.prev)===s.next)break;n=!0}while(n||s!==e);return e}function Au(t,e,n,s,c,h,f){if(t){!f&&h&&function(E,C,M,D){var R=E;do R.z===null&&(R.z=Om(R.x,R.y,C,M,D)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==E);R.prevZ.nextZ=null,R.prevZ=null,function(U){var j,W,re,le,de,pe,fe,Ae,Me=1;do{for(W=U,U=null,de=null,pe=0;W;){for(pe++,re=W,fe=0,j=0;j<Me&&(fe++,re=re.nextZ);j++);for(Ae=Me;fe>0||Ae>0&&re;)fe!==0&&(Ae===0||!re||W.z<=re.z)?(le=W,W=W.nextZ,fe--):(le=re,re=re.nextZ,Ae--),de?de.nextZ=le:U=le,le.prevZ=de,de=le;W=re}de.nextZ=null,Me*=2}while(pe>1)}(R)}(t,s,c,h);for(var y,x,b=t;t.prev!==t.next;)if(y=t.prev,x=t.next,h?LT(t,s,c,h):DT(t))e.push(y.i/n),e.push(t.i/n),e.push(x.i/n),Pu(t),t=x.next,b=x.next;else if((t=x)===b){f?f===1?Au(t=OT(Ms(t),e,n),e,n,s,c,h,2):f===2&&RT(t,e,n,s,c,h):Au(Ms(t),e,n,s,c,h,1);break}}}function DT(t){var e=t.prev,n=t,s=t.next;if(Or(e,n,s)>=0)return!1;for(var c=t.next.next;c!==t.prev;){if(rc(e.x,e.y,n.x,n.y,s.x,s.y,c.x,c.y)&&Or(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function LT(t,e,n,s){var c=t.prev,h=t,f=t.next;if(Or(c,h,f)>=0)return!1;for(var y=c.x>h.x?c.x>f.x?c.x:f.x:h.x>f.x?h.x:f.x,x=c.y>h.y?c.y>f.y?c.y:f.y:h.y>f.y?h.y:f.y,b=Om(c.x<h.x?c.x<f.x?c.x:f.x:h.x<f.x?h.x:f.x,c.y<h.y?c.y<f.y?c.y:f.y:h.y<f.y?h.y:f.y,e,n,s),E=Om(y,x,e,n,s),C=t.prevZ,M=t.nextZ;C&&C.z>=b&&M&&M.z<=E;){if(C!==t.prev&&C!==t.next&&rc(c.x,c.y,h.x,h.y,f.x,f.y,C.x,C.y)&&Or(C.prev,C,C.next)>=0||(C=C.prevZ,M!==t.prev&&M!==t.next&&rc(c.x,c.y,h.x,h.y,f.x,f.y,M.x,M.y)&&Or(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;C&&C.z>=b;){if(C!==t.prev&&C!==t.next&&rc(c.x,c.y,h.x,h.y,f.x,f.y,C.x,C.y)&&Or(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;M&&M.z<=E;){if(M!==t.prev&&M!==t.next&&rc(c.x,c.y,h.x,h.y,f.x,f.y,M.x,M.y)&&Or(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function OT(t,e,n){var s=t;do{var c=s.prev,h=s.next.next;!Yd(c,h)&&Xv(c,s,s.next,h)&&zu(c,h)&&zu(h,c)&&(e.push(c.i/n),e.push(s.i/n),e.push(h.i/n),Pu(s),Pu(s.next),s=t=h),s=s.next}while(s!==t);return Ms(s)}function RT(t,e,n,s,c,h){var f=t;do{for(var y=f.next.next;y!==f.prev;){if(f.i!==y.i&&jT(f,y)){var x=Yv(f,y);return f=Ms(f,f.next),x=Ms(x,x.next),Au(f,e,n,s,c,h),void Au(x,e,n,s,c,h)}y=y.next}f=f.next}while(f!==t)}function BT(t,e){return t.x-e.x}function FT(t,e){var n=function(h,f){var y,x=f,b=h.x,E=h.y,C=-1/0;do{if(E<=x.y&&E>=x.next.y&&x.next.y!==x.y){var M=x.x+(E-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(M<=b&&M>C){if(C=M,M===b){if(E===x.y)return x;if(E===x.next.y)return x.next}y=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!y)return null;if(b===C)return y;var D,R=y,U=y.x,j=y.y,W=1/0;x=y;do b>=x.x&&x.x>=U&&b!==x.x&&rc(E<j?b:C,E,U,j,E<j?C:b,E,x.x,x.y)&&(D=Math.abs(E-x.y)/(b-x.x),zu(x,h)&&(D<W||D===W&&(x.x>y.x||x.x===y.x&&UT(y,x)))&&(y=x,W=D)),x=x.next;while(x!==R);return y}(t,e);if(!n)return e;var s=Yv(n,t),c=Ms(n,n.next);return Ms(s,s.next),e===n?c:e}function UT(t,e){return Or(t.prev,t,e.prev)<0&&Or(e.next,t,t.next)<0}function Om(t,e,n,s,c){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*c)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*c)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function NT(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function rc(t,e,n,s,c,h,f,y){return(c-f)*(e-y)-(t-f)*(h-y)>=0&&(t-f)*(s-y)-(n-f)*(e-y)>=0&&(n-f)*(h-y)-(c-f)*(s-y)>=0}function jT(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,s){var c=n;do{if(c.i!==n.i&&c.next.i!==n.i&&c.i!==s.i&&c.next.i!==s.i&&Xv(c,c.next,n,s))return!0;c=c.next}while(c!==n);return!1}(t,e)&&(zu(t,e)&&zu(e,t)&&function(n,s){var c=n,h=!1,f=(n.x+s.x)/2,y=(n.y+s.y)/2;do c.y>y!=c.next.y>y&&c.next.y!==c.y&&f<(c.next.x-c.x)*(y-c.y)/(c.next.y-c.y)+c.x&&(h=!h),c=c.next;while(c!==n);return h}(t,e)&&(Or(t.prev,t,e.prev)||Or(t,e.prev,e))||Yd(t,e)&&Or(t.prev,t,t.next)>0&&Or(e.prev,e,e.next)>0)}function Or(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Yd(t,e){return t.x===e.x&&t.y===e.y}function Xv(t,e,n,s){var c=Jd(Or(t,e,n)),h=Jd(Or(t,e,s)),f=Jd(Or(n,s,t)),y=Jd(Or(n,s,e));return c!==h&&f!==y||!(c!==0||!Kd(t,n,e))||!(h!==0||!Kd(t,s,e))||!(f!==0||!Kd(n,t,s))||!(y!==0||!Kd(n,e,s))}function Kd(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Jd(t){return t>0?1:t<0?-1:0}function zu(t,e){return Or(t.prev,t,t.next)<0?Or(t,e,t.next)>=0&&Or(t,t.prev,e)>=0:Or(t,e,t.prev)<0||Or(t,t.next,e)<0}function Yv(t,e){var n=new Rm(t.i,t.x,t.y),s=new Rm(e.i,e.x,e.y),c=t.next,h=e.prev;return t.next=e,e.prev=t,n.next=c,c.prev=n,s.next=n,n.prev=s,h.next=s,s.prev=h,s}function Kv(t,e,n,s){var c=new Rm(t,e,n);return s?(c.next=s.next,c.prev=s,s.next.prev=c,s.next=c):(c.prev=c,c.next=c),c}function Pu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Rm(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bm(t,e,n,s){for(var c=0,h=e,f=n-s;h<n;h+=s)c+=(t[f]-t[h])*(t[h+1]+t[f+1]),f=h;return c}function VT(t,e,n,s,c){Jv(t,e,n||0,s||t.length-1,c||$T)}function Jv(t,e,n,s,c){for(;s>n;){if(s-n>600){var h=s-n+1,f=e-n+1,y=Math.log(h),x=.5*Math.exp(2*y/3),b=.5*Math.sqrt(y*x*(h-x)/h)*(f-h/2<0?-1:1);Jv(t,e,Math.max(n,Math.floor(e-f*x/h+b)),Math.min(s,Math.floor(e+(h-f)*x/h+b)),c)}var E=t[e],C=n,M=s;for(Du(t,n,e),c(t[s],E)>0&&Du(t,n,s);C<M;){for(Du(t,C,M),C++,M--;c(t[C],E)<0;)C++;for(;c(t[M],E)>0;)M--}c(t[n],E)===0?Du(t,n,M):Du(t,++M,s),M<=e&&(n=M+1),e<=M&&(s=M-1)}}function Du(t,e,n){var s=t[e];t[e]=t[n],t[n]=s}function $T(t,e){return t<e?-1:t>e?1:0}function Fm(t,e){const n=t.length;if(n<=1)return[t];const s=[];let c,h;for(let f=0;f<n;f++){const y=os(t[f]);y!==0&&(t[f].area=Math.abs(y),h===void 0&&(h=y<0),h===y<0?(c&&s.push(c),c=[t[f]]):c.push(t[f]))}if(c&&s.push(c),e>1)for(let f=0;f<s.length;f++)s[f].length<=e||(VT(s[f],e,1,s[f].length-1,GT),s[f]=s[f].slice(0,e));return s}function GT(t,e){return e.area-t.area}function Um(t,e,n){const s=n.patternDependencies;let c=!1;for(const h of e){const f=h.paint.get(`${t}-pattern`);f.isConstant()||(c=!0);const y=f.constantOr(null);y&&(c=!0,s[y.to]=!0,s[y.from]=!0)}return c}function Nm(t,e,n,s,c){const h=c.patternDependencies;for(const f of e){const y=f.paint.get(`${t}-pattern`).value;if(y.kind!=="constant"){let x=y.evaluate({zoom:s-1},n,{},c.availableImages),b=y.evaluate({zoom:s},n,{},c.availableImages),E=y.evaluate({zoom:s+1},n,{},c.availableImages);x=x&&x.name?x.name:x,b=b&&b.name?b.name:b,E=E&&E.name?E.name:E,h[x]=!0,h[b]=!0,h[E]=!0,n.patterns[f.id]={min:x,mid:b,max:E}}}return n}Xd.deviation=function(t,e,n,s){var c=e&&e.length,h=Math.abs(Bm(t,0,c?e[0]*n:t.length,n));if(c)for(var f=0,y=e.length;f<y;f++)h-=Math.abs(Bm(t,e[f]*n,f<y-1?e[f+1]*n:t.length,n));var x=0;for(f=0;f<s.length;f+=3){var b=s[f]*n,E=s[f+1]*n,C=s[f+2]*n;x+=Math.abs((t[b]-t[C])*(t[E+1]-t[b+1])-(t[b]-t[E])*(t[C+1]-t[b+1]))}return h===0&&x===0?0:Math.abs((x-h)/h)},Xd.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},s=0,c=0;c<t.length;c++){for(var h=0;h<t[c].length;h++)for(var f=0;f<e;f++)n.vertices.push(t[c][h][f]);c>0&&n.holes.push(s+=t[c-1].length)}return n},Hd.default=PT;class Qd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Hl,this.indexArray=new fi,this.indexArray2=new Es,this.programConfigurations=new Ua(e.layers,e.zoom),this.segments=new Lr,this.segments2=new Lr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,c){this.hasPattern=Um("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),f=[];for(const{feature:y,id:x,index:b,sourceLayerIndex:E}of e){const C=this.layers[0]._featureFilter.needGeometry,M=ja(y,C);if(!this.layers[0]._featureFilter.filter(new wt(this.zoom),M,s))continue;const D=h?h.evaluate(M,{},s,n.availableImages):void 0,R={id:x,properties:y.properties,type:y.type,sourceLayerIndex:E,index:b,geometry:C?M.geometry:Vo(y,s,c),patterns:{},sortKey:D};f.push(R)}h&&f.sort((y,x)=>y.sortKey-x.sortKey);for(const y of f){const{geometry:x,index:b,sourceLayerIndex:E}=y;if(this.hasPattern){const C=Nm("fill",this.layers,y,this.zoom,n);this.patternFeatures.push(C)}else this.addFeature(y,x,b,s,{},n.availableImages);n.featureIndex.insert(e[b].feature,x,b,E,this.index)}}update(e,n,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,c)}addFeatures(e,n,s,c){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,s,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zT),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,s,c,h,f=[]){for(const y of Fm(n,500)){let x=0;for(const R of y)x+=R.length;const b=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),E=b.vertexLength,C=[],M=[];for(const R of y){if(R.length===0)continue;R!==y[0]&&M.push(C.length/2);const U=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),j=U.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(j+R.length-1,j),C.push(R[0].x),C.push(R[0].y);for(let W=1;W<R.length;W++)this.layoutVertexArray.emplaceBack(R[W].x,R[W].y),this.indexArray2.emplaceBack(j+W-1,j+W),C.push(R[W].x),C.push(R[W].y);U.vertexLength+=R.length,U.primitiveLength+=R.length}const D=Hd(C,M);for(let R=0;R<D.length;R+=3)this.indexArray.emplaceBack(E+D[R],E+D[R+1],E+D[R+2]);b.vertexLength+=x,b.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,h,f,c)}}rt("FillBucket",Qd,{omit:["layers","patternFeatures"]});const ZT=new on({"fill-sort-key":new pt(Ce.layout_fill["fill-sort-key"])});var qT={paint:new on({"fill-antialias":new it(Ce.paint_fill["fill-antialias"]),"fill-opacity":new pt(Ce.paint_fill["fill-opacity"]),"fill-color":new pt(Ce.paint_fill["fill-color"]),"fill-outline-color":new pt(Ce.paint_fill["fill-outline-color"]),"fill-translate":new it(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new it(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Kr(Ce.paint_fill["fill-pattern"])}),layout:ZT};const WT=vr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),HT=vr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:XT}=WT;var Qv=nc;function nc(t,e,n,s,c){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=c,t.readFields(YT,this,e)}function YT(t,e,n){t==1?e.id=n.readVarint():t==2?function(s,c){for(var h=s.readVarint()+s.pos;s.pos<h;){var f=c._keys[s.readVarint()],y=c._values[s.readVarint()];c.properties[f]=y}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function KT(t){for(var e,n,s=0,c=0,h=t.length,f=h-1;c<h;f=c++)s+=((n=t[f]).x-(e=t[c]).x)*(e.y+n.y);return s}nc.types=["Unknown","Point","LineString","Polygon"],nc.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,s=1,c=0,h=0,f=0,y=[];t.pos<n;){if(c<=0){var x=t.readVarint();s=7&x,c=x>>3}if(c--,s===1||s===2)h+=t.readSVarint(),f+=t.readSVarint(),s===1&&(e&&y.push(e),e=[]),e.push(new ce(h,f));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&y.push(e),y},nc.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,s=0,c=0,h=0,f=1/0,y=-1/0,x=1/0,b=-1/0;t.pos<e;){if(s<=0){var E=t.readVarint();n=7&E,s=E>>3}if(s--,n===1||n===2)(c+=t.readSVarint())<f&&(f=c),c>y&&(y=c),(h+=t.readSVarint())<x&&(x=h),h>b&&(b=h);else if(n!==7)throw new Error("unknown command "+n)}return[f,x,y,b]},nc.prototype.toGeoJSON=function(t,e,n){var s,c,h=this.extent*Math.pow(2,n),f=this.extent*t,y=this.extent*e,x=this.loadGeometry(),b=nc.types[this.type];function E(D){for(var R=0;R<D.length;R++){var U=D[R];D[R]=[360*(U.x+f)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+y)/h)*Math.PI/180))-90]}}switch(this.type){case 1:var C=[];for(s=0;s<x.length;s++)C[s]=x[s][0];E(x=C);break;case 2:for(s=0;s<x.length;s++)E(x[s]);break;case 3:for(x=function(D){var R=D.length;if(R<=1)return[D];for(var U,j,W=[],re=0;re<R;re++){var le=KT(D[re]);le!==0&&(j===void 0&&(j=le<0),j===le<0?(U&&W.push(U),U=[D[re]]):U.push(D[re]))}return U&&W.push(U),W}(x),s=0;s<x.length;s++)for(c=0;c<x[s].length;c++)E(x[s][c])}x.length===1?x=x[0]:b="Multi"+b;var M={type:"Feature",geometry:{type:b,coordinates:x},properties:this.properties};return"id"in this&&(M.id=this.id),M};var e0=t0;function t0(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(JT,this,e),this.length=this._features.length}function JT(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(s){for(var c=null,h=s.readVarint()+s.pos;s.pos<h;){var f=s.readVarint()>>3;c=f===1?s.readString():f===2?s.readFloat():f===3?s.readDouble():f===4?s.readVarint64():f===5?s.readVarint():f===6?s.readSVarint():f===7?s.readBoolean():null}return c}(n))}function QT(t,e,n){if(t===3){var s=new e0(n,n.readVarint()+n.pos);s.length&&(e[s.name]=s)}}t0.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Qv(this._pbf,e,this.extent,this._keys,this._values)};var Va={VectorTile:function(t,e){this.layers=t.readFields(QT,{},e)},VectorTileFeature:Qv,VectorTileLayer:e0};const eS=Va.VectorTileFeature.types,tS=Math.pow(2,13);function Lu(t,e,n,s,c,h,f,y){t.emplaceBack((e<<1)+f,(n<<1)+h,(Math.floor(s*tS)<<1)+c,Math.round(y))}class r0{constructor(){this.acc=new ce(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ce(e.x,e.y),this.max=new ce(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);let s=!!this.borders;const c=this.min,h=this.max;e.x<c.x?(c.x=e.x,s=!0):e.x>h.x&&(h.x=e.x,s=!0),e.y<c.y?(c.y=e.y,s=!0):e.y>h.y&&(h.y=e.y,s=!0),((e.x===0||e.x===Dt)&&e.x===n.x)!=((e.y===0||e.y===Dt)&&e.y===n.y)&&this.processBorderOverlap(e,n),s&&this.checkBorderIntersection(e,n)}checkBorderIntersection(e,n){n.x<0!=e.x<0&&this.addBorderIntersection(0,Xt(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Dt!=e.x>Dt&&this.addBorderIntersection(1,Xt(n.y,e.y,(Dt-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Xt(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Dt!=e.y>Dt&&this.addBorderIntersection(3,Xt(n.x,e.x,(Dt-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];n<s[0]&&(s[0]=n),n>s[1]&&(s[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const s=e.x===0?0:1;this.addBorderIntersection(s,n.y),this.addBorderIntersection(s,e.y)}else{const s=e.y===0?2:3;this.addBorderIntersection(s,n.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((n,s)=>n+s.edges,0);return e!==0?this.acc.div(e)._round():new ce(0,0)}span(){return new ce(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class jm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Xl,this.centroidVertexArray=new Cv,this.indexArray=new fi,this.programConfigurations=new Ua(e.layers,e.zoom),this.segments=new Lr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,s,c){this.features=[],this.hasPattern=Um("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(h){const f=Math.exp(Math.PI*(1-h.y/(1<<h.z)*2));return 80150034*f/(f*f+1)/Dt/(1<<h.z)}(s);for(const{feature:h,id:f,index:y,sourceLayerIndex:x}of e){const b=this.layers[0]._featureFilter.needGeometry,E=ja(h,b);if(!this.layers[0]._featureFilter.filter(new wt(this.zoom),E,s))continue;const C={id:f,sourceLayerIndex:x,index:y,geometry:b?E.geometry:Vo(h,s,c),properties:h.properties,type:h.type,patterns:{}},M=this.layoutVertexArray.length;this.hasPattern?this.features.push(Nm("fill-extrusion",this.layers,C,this.zoom,n)):this.addFeature(C,C.geometry,y,s,{},n.availableImages),n.featureIndex.insert(h,C.geometry,y,x,this.index,M)}this.sortBorders()}addFeatures(e,n,s,c){for(const h of this.features){const{geometry:f}=h;this.addFeature(h,f,h.index,n,s,c)}this.sortBorders()}update(e,n,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,XT),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,HT.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,s,c,h,f){const y=this.enableTerrain?new r0:null;for(const b of Fm(n,500)){let E=0,C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(b.length===0||(x=b[0]).every(j=>j.x<=0)||x.every(j=>j.x>=Dt)||x.every(j=>j.y<=0)||x.every(j=>j.y>=Dt))continue;for(let j=0;j<b.length;j++){const W=b[j];if(W.length===0)continue;E+=W.length;let re=0;y&&y.startRing(W[0]);for(let le=0;le<W.length;le++){const de=W[le];if(le>=1){const pe=W[le-1];if(!rS(de,pe)){y&&y.append(de,pe),C.vertexLength+4>Lr.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const fe=de.sub(pe)._perp(),Ae=fe.x/(Math.abs(fe.x)+Math.abs(fe.y)),Me=fe.y>0?1:0,Xe=pe.dist(de);re+Xe>32768&&(re=0),Lu(this.layoutVertexArray,de.x,de.y,Ae,Me,0,0,re),Lu(this.layoutVertexArray,de.x,de.y,Ae,Me,0,1,re),re+=Xe,Lu(this.layoutVertexArray,pe.x,pe.y,Ae,Me,0,0,re),Lu(this.layoutVertexArray,pe.x,pe.y,Ae,Me,0,1,re);const Ge=C.vertexLength;this.indexArray.emplaceBack(Ge,Ge+2,Ge+1),this.indexArray.emplaceBack(Ge+1,Ge+2,Ge+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+E>Lr.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray)),eS[e.type]!=="Polygon")continue;const M=[],D=[],R=C.vertexLength;for(let j=0;j<b.length;j++){const W=b[j];if(W.length!==0){W!==b[0]&&D.push(M.length/2);for(let re=0;re<W.length;re++){const le=W[re];Lu(this.layoutVertexArray,le.x,le.y,0,0,1,1,0),M.push(le.x),M.push(le.y),y&&y.currentPolyCount.top++}}}const U=Hd(M,D);for(let j=0;j<U.length;j+=3)this.indexArray.emplaceBack(R+U[j],R+U[j+2],R+U[j+1]);C.primitiveLength+=U.length/3,C.vertexLength+=E}var x;if(y&&y.polyCount.length>0){if(y.borders){y.vertexArrayOffset=this.centroidVertexArray.length;const b=y.borders,E=this.featuresOnBorder.push(y)-1;for(let C=0;C<4;C++)b[C][0]!==Number.MAX_VALUE&&this.borders[C].push(E)}this.encodeCentroid(y.borders?void 0:y.centroid(),y)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,h,f,c)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,s)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,n,s=!0){let c,h;if(e)if(e.y!==0){const y=n.span()._mult(this.tileToMeter);c=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),h=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else c=Math.ceil(7*(e.x+450)),h=0;else c=0,h=+s;let f=s?this.centroidVertexArray.length:n.vertexArrayOffset;for(const y of n.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let x=0;x<2*y.edges;x++)this.centroidVertexArray.emplace(f++,0,h),this.centroidVertexArray.emplace(f++,c,h);for(let x=0;x<y.top;x++)this.centroidVertexArray.emplace(f++,c,h)}}}function rS(t,e){return t.x===e.x&&(t.x<0||t.x>Dt)||t.y===e.y&&(t.y<0||t.y>Dt)}rt("FillExtrusionBucket",jm,{omit:["layers","features"]}),rt("PartMetadata",r0);var nS={paint:new on({"fill-extrusion-opacity":new it(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pt(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new it(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new it(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Kr(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pt(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pt(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new it(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Ou(t,e){return t.x*e.x+t.y*e.y}function n0(t,e){if(t.length===1){let n=0;const s=e[n++];let c;for(;!c||s.equals(c);)if(c=e[n++],!c)return 1/0;for(;n<e.length;n++){const h=e[n],f=t[0],y=c.sub(s),x=h.sub(s),b=f.sub(s),E=Ou(y,y),C=Ou(y,x),M=Ou(x,x),D=Ou(b,y),R=Ou(b,x),U=E*M-C*C,j=(M*D-C*R)/U,W=(E*R-C*D)/U,re=s.z*(1-j-W)+c.z*j+h.z*W;if(isFinite(re))return re}return 1/0}{let n=1/0;for(const s of e)n=Math.min(n,s.z);return n}}function i0(t){const e=new ce(t[0],t[1]);return e.z=t[2],e}function iS(t,e,n,s,c,h,f,y){const x=f*c.getElevationAt(t,e,!0,!0),b=h[0]!==0,E=b?h[1]===0?f*(h[0]/7-450):f*function(C,M,D){const R=Math.floor(M[0]/8),U=Math.floor(M[1]/8),j=10*(M[0]-8*R),W=10*(M[1]-8*U),re=C.getElevationAt(R,U,!0,!0),le=C.getMeterToDEM(D),de=Math.floor(.5*(j*le-1)),pe=Math.floor(.5*(W*le-1)),fe=C.tileCoordToPixel(R,U),Ae=2*de+1,Me=2*pe+1,Xe=function(tt,ot,Bt,or,Ut){return[tt.getElevationAtPixel(ot,Bt,!0),tt.getElevationAtPixel(ot+Ut,Bt,!0),tt.getElevationAtPixel(ot,Bt+Ut,!0),tt.getElevationAtPixel(ot+or,Bt+Ut,!0)]}(C,fe.x-de,fe.y-pe,Ae,Me),Ge=Math.abs(Xe[0]-Xe[1]),Ie=Math.abs(Xe[2]-Xe[3]),Ze=Math.abs(Xe[0]-Xe[2])+Math.abs(Xe[1]-Xe[3]),Ye=Math.min(.25,.5*le*(Ge+Ie)/Ae),Re=Math.min(.25,.5*le*Ze/Me);return re+Math.max(Ye*j,Re*W)}(c,h,y):x;return{base:x+(n===0)?-1:n,top:b?Math.max(E+s,x+n+2):x+s}}const oS=vr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:sS}=oS,aS=vr([{name:"a_packed",components:3,type:"Float32"}]),{members:lS}=aS,cS=Va.VectorTileFeature.types,uS=Math.cos(Math.PI/180*37.5);class ep{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new dm,this.layoutVertexArray2=new Yl,this.indexArray=new fi,this.programConfigurations=new Ua(e.layers,e.zoom),this.segments=new Lr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,c){this.hasPattern=Um("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),f=[];for(const{feature:E,id:C,index:M,sourceLayerIndex:D}of e){const R=this.layers[0]._featureFilter.needGeometry,U=ja(E,R);if(!this.layers[0]._featureFilter.filter(new wt(this.zoom),U,s))continue;const j=h?h.evaluate(U,{},s):void 0,W={id:C,properties:E.properties,type:E.type,sourceLayerIndex:D,index:M,geometry:R?U.geometry:Vo(E,s,c),patterns:{},sortKey:j};f.push(W)}h&&f.sort((E,C)=>E.sortKey-C.sortKey);const{lineAtlas:y,featureIndex:x}=n,b=this.addConstantDashes(y);for(const E of f){const{geometry:C,index:M,sourceLayerIndex:D}=E;if(b&&this.addFeatureDashes(E,y),this.hasPattern){const R=Nm("line",this.layers,E,this.zoom,n);this.patternFeatures.push(R)}else this.addFeature(E,C,M,s,y.positions,n.availableImages);x.insert(e[M].feature,C,M,D,this.index)}}addConstantDashes(e){let n=!1;for(const s of this.layers){const c=s.paint.get("line-dasharray").value,h=s.layout.get("line-cap").value;if(c.kind!=="constant"||h.kind!=="constant")n=!0;else{const f=h.value,y=c.value;if(!y)continue;e.addDash(y.from,f),e.addDash(y.to,f),y.other&&e.addDash(y.other,f)}}return n}addFeatureDashes(e,n){const s=this.zoom;for(const c of this.layers){const h=c.paint.get("line-dasharray").value,f=c.layout.get("line-cap").value;if(h.kind==="constant"&&f.kind==="constant")continue;let y,x,b,E,C,M;if(h.kind==="constant"){const j=h.value;if(!j)continue;y=j.other||j.to,x=j.to,b=j.from}else y=h.evaluate({zoom:s-1},e),x=h.evaluate({zoom:s},e),b=h.evaluate({zoom:s+1},e);f.kind==="constant"?E=C=M=f.value:(E=f.evaluate({zoom:s-1},e),C=f.evaluate({zoom:s},e),M=f.evaluate({zoom:s+1},e)),n.addDash(y,E),n.addDash(x,C),n.addDash(b,M);const D=n.getKey(y,E),R=n.getKey(x,C),U=n.getKey(b,M);e.patterns[c.id]={min:D,mid:R,max:U}}}update(e,n,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,c)}addFeatures(e,n,s,c){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,s,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,lS)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sS),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,s,c,h,f){const y=this.layers[0].layout,x=y.get("line-join").evaluate(e,{}),b=y.get("line-cap").evaluate(e,{}),E=y.get("line-miter-limit"),C=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of n)this.addLine(M,e,x,b,E,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,h,f,c)}addLine(e,n,s,c,h,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let W=0;W<e.length-1;W++)this.totalDistance+=e[W].dist(e[W+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=cS[n.type]==="Polygon";let x=e.length;for(;x>=2&&e[x-1].equals(e[x-2]);)x--;let b=0;for(;b<x-1&&e[b].equals(e[b+1]);)b++;if(x<(y?3:2))return;s==="bevel"&&(h=1.05);const E=this.overscaling<=16?122880/(512*this.overscaling):0,C=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let M,D,R,U,j;this.e1=this.e2=-1,y&&(M=e[x-2],j=e[b].sub(M)._unit()._perp());for(let W=b;W<x;W++){if(R=W===x-1?y?e[b+1]:void 0:e[W+1],R&&e[W].equals(R))continue;j&&(U=j),M&&(D=M),M=e[W],j=R?R.sub(M)._unit()._perp():U,U=U||j;let re=U.add(j);re.x===0&&re.y===0||re._unit();const le=U.x*j.x+U.y*j.y,de=re.x*j.x+re.y*j.y,pe=de!==0?1/de:1/0,fe=2*Math.sqrt(2-2*de),Ae=de<uS&&D&&R,Me=U.x*j.y-U.y*j.x>0;if(Ae&&W>b){const Ie=M.dist(D);if(Ie>2*E){const Ze=M.sub(M.sub(D)._mult(E/Ie)._round());this.updateDistance(D,Ze),this.addCurrentVertex(Ze,U,0,0,C),D=Ze}}const Xe=D&&R;let Ge=Xe?s:y?"butt":c;if(Xe&&Ge==="round"&&(pe<f?Ge="miter":pe<=2&&(Ge="fakeround")),Ge==="miter"&&pe>h&&(Ge="bevel"),Ge==="bevel"&&(pe>2&&(Ge="flipbevel"),pe<h&&(Ge="miter")),D&&this.updateDistance(D,M),Ge==="miter")re._mult(pe),this.addCurrentVertex(M,re,0,0,C);else if(Ge==="flipbevel"){if(pe>100)re=j.mult(-1);else{const Ie=pe*U.add(j).mag()/U.sub(j).mag();re._perp()._mult(Ie*(Me?-1:1))}this.addCurrentVertex(M,re,0,0,C),this.addCurrentVertex(M,re.mult(-1),0,0,C)}else if(Ge==="bevel"||Ge==="fakeround"){const Ie=-Math.sqrt(pe*pe-1),Ze=Me?Ie:0,Ye=Me?0:Ie;if(D&&this.addCurrentVertex(M,U,Ze,Ye,C),Ge==="fakeround"){const Re=Math.round(180*fe/Math.PI/20);for(let tt=1;tt<Re;tt++){let ot=tt/Re;if(ot!==.5){const or=ot-.5;ot+=ot*or*(ot-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*or*or+(.848013+le*(.215638*le-1.06021)))}const Bt=j.sub(U)._mult(ot)._add(U)._unit()._mult(Me?-1:1);this.addHalfVertex(M,Bt.x,Bt.y,!1,Me,0,C)}}R&&this.addCurrentVertex(M,j,-Ze,-Ye,C)}else if(Ge==="butt")this.addCurrentVertex(M,re,0,0,C);else if(Ge==="square"){const Ie=D?1:-1;D||this.addCurrentVertex(M,re,Ie,Ie,C),this.addCurrentVertex(M,re,0,0,C),D&&this.addCurrentVertex(M,re,Ie,Ie,C)}else Ge==="round"&&(D&&(this.addCurrentVertex(M,U,0,0,C),this.addCurrentVertex(M,U,1,1,C,!0)),R&&(this.addCurrentVertex(M,j,-1,-1,C,!0),this.addCurrentVertex(M,j,0,0,C)));if(Ae&&W<x-1){const Ie=M.dist(R);if(Ie>2*E){const Ze=M.add(R.sub(M)._mult(E/Ie)._round());this.updateDistance(M,Ze),this.addCurrentVertex(Ze,j,0,0,C),M=Ze}}}}addCurrentVertex(e,n,s,c,h,f=!1){const y=n.y*c-n.x,x=-n.y-n.x*c;this.addHalfVertex(e,n.x+n.y*s,n.y-n.x*s,f,!1,s,h),this.addHalfVertex(e,y,x,f,!0,-c,h)}addHalfVertex({x:e,y:n},s,c,h,f,y,x){this.layoutVertexArray.emplaceBack((e<<1)+(h?1:0),(n<<1)+(f?1:0),Math.round(63*s)+128,Math.round(63*c)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const b=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),x.primitiveLength++),f?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}rt("LineBucket",ep,{omit:["layers","patternFeatures"]});const hS=new on({"line-cap":new pt(Ce.layout_line["line-cap"]),"line-join":new pt(Ce.layout_line["line-join"]),"line-miter-limit":new it(Ce.layout_line["line-miter-limit"]),"line-round-limit":new it(Ce.layout_line["line-round-limit"]),"line-sort-key":new pt(Ce.layout_line["line-sort-key"])});var o0={paint:new on({"line-opacity":new pt(Ce.paint_line["line-opacity"]),"line-color":new pt(Ce.paint_line["line-color"]),"line-translate":new it(Ce.paint_line["line-translate"]),"line-translate-anchor":new it(Ce.paint_line["line-translate-anchor"]),"line-width":new pt(Ce.paint_line["line-width"]),"line-gap-width":new pt(Ce.paint_line["line-gap-width"]),"line-offset":new pt(Ce.paint_line["line-offset"]),"line-blur":new pt(Ce.paint_line["line-blur"]),"line-dasharray":new Kr(Ce.paint_line["line-dasharray"]),"line-pattern":new Kr(Ce.paint_line["line-pattern"]),"line-gradient":new _o(Ce.paint_line["line-gradient"])}),layout:hS};const s0=new class extends pt{possiblyEvaluate(t,e){return e=new wt(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,s){return e=br({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,s)}}(o0.paint.properties["line-width"].specification);function a0(t,e){return e>0?e+2*t:t}s0.useIntegerZoom=!0;const dS=vr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),pS=vr([{name:"a_projected_pos",components:3,type:"Float32"}],4);vr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const fS=vr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),mS=vr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const l0=vr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_S=vr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);vr([{name:"triangle",components:3,type:"Uint16"}]),vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),vr([{type:"Float32",name:"offsetX"}]),vr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ln=24;const yo=128;function Vm(t,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new wt(t+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:c}=n;let h=0;for(;h<s.length&&s[h]<=t;)h++;h=Math.max(0,h-1);let f=h;for(;f<s.length&&s[f]<t+1;)f++;f=Math.min(s.length-1,f);const y=s[h],x=s[f];return n.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:x,interpolationType:c}:{kind:"camera",minZoom:y,maxZoom:x,minSize:n.evaluate(new wt(y)),maxSize:n.evaluate(new wt(x)),interpolationType:c}}}function tp(t,{uSize:e,uSizeT:n},{lowerSize:s,upperSize:c}){return t.kind==="source"?s/yo:t.kind==="composite"?Xt(s/yo,c/yo,n):e}function ic(t,e){let n=0,s=0;if(t.kind==="constant")s=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:c,minZoom:h,maxZoom:f}=t,y=c?Kt(bn.interpolationFactor(c,e,h,f),0,1):0;t.kind==="camera"?s=Xt(t.minSize,t.maxSize,y):n=y}return{uSizeT:n,uSize:s}}var gS=Object.freeze({__proto__:null,getSizeData:Vm,evaluateSizeForFeature:tp,evaluateSizeForZoom:ic,SIZE_PACK_FACTOR:yo});function yS(t,e,n){return t.sections.forEach(s=>{s.text=function(c,h,f){const y=h.layout.get("text-transform").evaluate(f,{});return y==="uppercase"?c=c.toLocaleUpperCase():y==="lowercase"&&(c=c.toLocaleLowerCase()),Ft.applyArabicShaping&&(c=Ft.applyArabicShaping(c)),c}(s.text,e,n)}),t}const Ru={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function vS(t){return t==="\uFE36"||t==="\uFE48"||t==="\uFE38"||t==="\uFE44"||t==="\uFE42"||t==="\uFE3E"||t==="\uFE3C"||t==="\uFE3A"||t==="\uFE18"||t==="\uFE40"||t==="\uFE10"||t==="\uFE13"||t==="\uFE14"||t==="\uFF40"||t==="\uFFE3"||t==="\uFE11"||t==="\uFE12"}function xS(t){return t==="\uFE35"||t==="\uFE47"||t==="\uFE37"||t==="\uFE43"||t==="\uFE41"||t==="\uFE3D"||t==="\uFE3B"||t==="\uFE39"||t==="\uFE17"||t==="\uFE3F"}var c0=function(t,e,n,s,c){var h,f,y=8*c-s-1,x=(1<<y)-1,b=x>>1,E=-7,C=n?c-1:0,M=n?-1:1,D=t[e+C];for(C+=M,h=D&(1<<-E)-1,D>>=-E,E+=y;E>0;h=256*h+t[e+C],C+=M,E-=8);for(f=h&(1<<-E)-1,h>>=-E,E+=s;E>0;f=256*f+t[e+C],C+=M,E-=8);if(h===0)h=1-b;else{if(h===x)return f?NaN:1/0*(D?-1:1);f+=Math.pow(2,s),h-=b}return(D?-1:1)*f*Math.pow(2,h-s)},u0=function(t,e,n,s,c,h){var f,y,x,b=8*h-c-1,E=(1<<b)-1,C=E>>1,M=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,D=s?0:h-1,R=s?1:-1,U=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,f=E):(f=Math.floor(Math.log(e)/Math.LN2),e*(x=Math.pow(2,-f))<1&&(f--,x*=2),(e+=f+C>=1?M/x:M*Math.pow(2,1-C))*x>=2&&(f++,x/=2),f+C>=E?(y=0,f=E):f+C>=1?(y=(e*x-1)*Math.pow(2,c),f+=C):(y=e*Math.pow(2,C-1)*Math.pow(2,c),f=0));c>=8;t[n+D]=255&y,D+=R,y/=256,c-=8);for(f=f<<c|y,b+=c;b>0;t[n+D]=255&f,D+=R,f/=256,b-=8);t[n+D-R]|=128*U},Bu=ir;function ir(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ir.Varint=0,ir.Fixed64=1,ir.Bytes=2,ir.Fixed32=5;var $m=4294967296,h0=1/$m,d0=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function $o(t){return t.type===ir.Bytes?t.readVarint()+t.pos:t.pos+1}function oc(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function p0(t,e,n){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(s);for(var c=n.pos-1;c>=t;c--)n.buf[c+s]=n.buf[c]}function wS(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function bS(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function TS(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function SS(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function ES(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function CS(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function kS(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function MS(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function IS(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function rp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function sc(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function f0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function AS(t,e,n){e.glyphs=[],t===1&&n.readMessage(zS,e)}function zS(t,e,n){if(t===3){const{id:s,bitmap:c,width:h,height:f,left:y,top:x,advance:b}=n.readMessage(PS,{});e.glyphs.push({id:s,bitmap:new ks({width:h+6,height:f+6},c),metrics:{width:h,height:f,left:y,top:x,advance:b}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function PS(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}function Gm(t){let e=0,n=0;for(const f of t)e+=f.w*f.h,n=Math.max(n,f.w);t.sort((f,y)=>y.h-f.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let c=0,h=0;for(const f of t)for(let y=s.length-1;y>=0;y--){const x=s[y];if(!(f.w>x.w||f.h>x.h)){if(f.x=x.x,f.y=x.y,h=Math.max(h,f.y+f.h),c=Math.max(c,f.x+f.w),f.w===x.w&&f.h===x.h){const b=s.pop();y<s.length&&(s[y]=b)}else f.h===x.h?(x.x+=f.w,x.w-=f.w):f.w===x.w?(x.y+=f.h,x.h-=f.h):(s.push({x:x.x+f.w,y:x.y,w:x.w-f.w,h:f.h}),x.y+=f.h,x.h-=f.h);break}}return{w:c,h,fill:e/(c*h)||0}}ir.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var s=this.readVarint(),c=s>>3,h=this.pos;this.type=7&s,t(c,e,this),this.pos===h&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=rp(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=f0(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=rp(this.buf,this.pos)+rp(this.buf,this.pos+4)*$m;return this.pos+=8,t},readSFixed64:function(){var t=rp(this.buf,this.pos)+f0(this.buf,this.pos+4)*$m;return this.pos+=8,t},readFloat:function(){var t=c0(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=c0(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,s=this.buf;return e=127&(n=s[this.pos++]),n<128?e:(e|=(127&(n=s[this.pos++]))<<7,n<128?e:(e|=(127&(n=s[this.pos++]))<<14,n<128?e:(e|=(127&(n=s[this.pos++]))<<21,n<128?e:function(c,h,f){var y,x,b=f.buf;if(y=(112&(x=b[f.pos++]))>>4,x<128||(y|=(127&(x=b[f.pos++]))<<3,x<128)||(y|=(127&(x=b[f.pos++]))<<10,x<128)||(y|=(127&(x=b[f.pos++]))<<17,x<128)||(y|=(127&(x=b[f.pos++]))<<24,x<128)||(y|=(1&(x=b[f.pos++]))<<31,x<128))return oc(c,y,h);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&d0?function(n,s,c){return d0.decode(n.subarray(s,c))}(this.buf,e,t):function(n,s,c){for(var h="",f=s;f<c;){var y,x,b,E=n[f],C=null,M=E>239?4:E>223?3:E>191?2:1;if(f+M>c)break;M===1?E<128&&(C=E):M===2?(192&(y=n[f+1]))==128&&(C=(31&E)<<6|63&y)<=127&&(C=null):M===3?(x=n[f+2],(192&(y=n[f+1]))==128&&(192&x)==128&&((C=(15&E)<<12|(63&y)<<6|63&x)<=2047||C>=55296&&C<=57343)&&(C=null)):M===4&&(x=n[f+2],b=n[f+3],(192&(y=n[f+1]))==128&&(192&x)==128&&(192&b)==128&&((C=(15&E)<<18|(63&y)<<12|(63&x)<<6|63&b)<=65535||C>=1114112)&&(C=null)),C===null?(C=65533,M=1):C>65535&&(C-=65536,h+=String.fromCharCode(C>>>10&1023|55296),C=56320|1023&C),h+=String.fromCharCode(C),f+=M}return h}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ir.Bytes)return t.push(this.readVarint(e));var n=$o(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ir.Bytes)return t.push(this.readSVarint());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ir.Bytes)return t.push(this.readBoolean());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ir.Bytes)return t.push(this.readFloat());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ir.Bytes)return t.push(this.readDouble());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ir.Bytes)return t.push(this.readFixed32());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ir.Bytes)return t.push(this.readSFixed32());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ir.Bytes)return t.push(this.readFixed64());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ir.Bytes)return t.push(this.readSFixed64());var e=$o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ir.Varint)for(;this.buf[this.pos++]>127;);else if(e===ir.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ir.Fixed32)this.pos+=4;else{if(e!==ir.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),sc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),sc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),sc(this.buf,-1&t,this.pos),sc(this.buf,Math.floor(t*h0),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),sc(this.buf,-1&t,this.pos),sc(this.buf,Math.floor(t*h0),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var s,c;if(e>=0?(s=e%4294967296|0,c=e/4294967296|0):(c=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,c=c+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(h,f,y){y.buf[y.pos++]=127&h|128,h>>>=7,y.buf[y.pos++]=127&h|128,h>>>=7,y.buf[y.pos++]=127&h|128,h>>>=7,y.buf[y.pos++]=127&h|128,y.buf[y.pos]=127&(h>>>=7)}(s,0,n),function(h,f){var y=(7&h)<<4;f.buf[f.pos++]|=y|((h>>>=3)?128:0),h&&(f.buf[f.pos++]=127&h|((h>>>=7)?128:0),h&&(f.buf[f.pos++]=127&h|((h>>>=7)?128:0),h&&(f.buf[f.pos++]=127&h|((h>>>=7)?128:0),h&&(f.buf[f.pos++]=127&h|((h>>>=7)?128:0),h&&(f.buf[f.pos++]=127&h)))))}(c,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,c,h){for(var f,y,x=0;x<c.length;x++){if((f=c.charCodeAt(x))>55295&&f<57344){if(!y){f>56319||x+1===c.length?(s[h++]=239,s[h++]=191,s[h++]=189):y=f;continue}if(f<56320){s[h++]=239,s[h++]=191,s[h++]=189,y=f;continue}f=y-55296<<10|f-56320|65536,y=null}else y&&(s[h++]=239,s[h++]=191,s[h++]=189,y=null);f<128?s[h++]=f:(f<2048?s[h++]=f>>6|192:(f<65536?s[h++]=f>>12|224:(s[h++]=f>>18|240,s[h++]=f>>12&63|128),s[h++]=f>>6&63|128),s[h++]=63&f|128)}return h}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&p0(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),u0(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),u0(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var s=this.pos-n;s>=128&&p0(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,n){this.writeTag(t,ir.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,wS,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,bS,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ES,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,TS,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,SS,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,CS,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,kS,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,MS,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,IS,e)},writeBytesField:function(t,e){this.writeTag(t,ir.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ir.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ir.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ir.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ir.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ir.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ir.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ir.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ir.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ir.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Zm{constructor(e,{pixelRatio:n,version:s,stretchX:c,stretchY:h,content:f}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=c,this.stretchY=h,this.content=f,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class m0{constructor(e,n){const s={},c={};this.haveRenderCallbacks=[];const h=[];this.addImages(e,s,h),this.addImages(n,c,h);const{w:f,h:y}=Gm(h),x=new mi({width:f||1,height:y||1});for(const b in e){const E=e[b],C=s[b].paddedRect;mi.copy(E.data,x,{x:0,y:0},{x:C.x+1,y:C.y+1},E.data)}for(const b in n){const E=n[b],C=c[b].paddedRect,M=C.x+1,D=C.y+1,R=E.data.width,U=E.data.height;mi.copy(E.data,x,{x:0,y:0},{x:M,y:D},E.data),mi.copy(E.data,x,{x:0,y:U-1},{x:M,y:D-1},{width:R,height:1}),mi.copy(E.data,x,{x:0,y:0},{x:M,y:D+U},{width:R,height:1}),mi.copy(E.data,x,{x:R-1,y:0},{x:M-1,y:D},{width:1,height:U}),mi.copy(E.data,x,{x:0,y:0},{x:M+R,y:D},{width:1,height:U})}this.image=x,this.iconPositions=s,this.patternPositions=c}addImages(e,n,s){for(const c in e){const h=e[c],f={x:0,y:0,w:h.data.width+2,h:h.data.height+2};s.push(f),n[c]=new Zm(f,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(c)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),n)}patchUpdatedImage(e,n,s){if(!e||!n||e.version===n.version)return;e.version=n.version;const[c,h]=e.tl;s.update(n.data,void 0,{x:c,y:h})}}rt("ImagePosition",Zm),rt("ImageAtlas",m0);const _i={horizontal:1,vertical:2,horizontalOnly:3};class Fu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const s=new Fu;return s.scale=e||1,s.fontStack=n,s}static forImage(e){const n=new Fu;return n.imageName=e,n}}class ac{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const s=new ac;for(let c=0;c<e.sections.length;c++){const h=e.sections[c];h.image?s.addImageSection(h):s.addTextSection(h,n)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,s){let c="";for(let h=0;h<n.length;h++){const f=n.charCodeAt(h+1)||null,y=n.charCodeAt(h-1)||null;c+=!s&&(f&&ct(f)&&!Ru[n[h+1]]||y&&ct(y)&&!Ru[n[h-1]])||!Ru[n[h]]?n[h]:Ru[n[h]]}return c}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&np[this.text.charCodeAt(s)];s++)e++;let n=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&np[this.text.charCodeAt(s)];s--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const s=new ac;return s.text=this.text.substring(e,n),s.sectionIndex=this.sectionIndex.slice(e,n),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Fu.forText(e.scale,e.fontStack||n));const s=this.sections.length-1;for(let c=0;c<e.text.length;++c)this.sectionIndex.push(s)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void gr("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Fu.forImage(n)),this.sectionIndex.push(this.sections.length-1)):gr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qm(t,e,n,s,c,h,f,y,x,b,E,C,M,D,R,U){const j=ac.fromFeature(t,c);let W;C===_i.vertical&&j.verticalizePunctuation(M);const{processBidirectionalText:re,processStyledBidirectionalText:le}=Ft;if(re&&j.sections.length===1){W=[];const fe=re(j.toString(),Wm(j,b,h,e,s,D,R));for(const Ae of fe){const Me=new ac;Me.text=Ae,Me.sections=j.sections;for(let Xe=0;Xe<Ae.length;Xe++)Me.sectionIndex.push(0);W.push(Me)}}else if(le){W=[];const fe=le(j.text,j.sectionIndex,Wm(j,b,h,e,s,D,R));for(const Ae of fe){const Me=new ac;Me.text=Ae[0],Me.sectionIndex=Ae[1],Me.sections=j.sections,W.push(Me)}}else W=function(fe,Ae){const Me=[],Xe=fe.text;let Ge=0;for(const Ie of Ae)Me.push(fe.substring(Ge,Ie)),Ge=Ie;return Ge<Xe.length&&Me.push(fe.substring(Ge,Xe.length)),Me}(j,Wm(j,b,h,e,s,D,R));const de=[],pe={positionedLines:de,text:j.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:C,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(fe,Ae,Me,Xe,Ge,Ie,Ze,Ye,Re,tt,ot,Bt){let or=0,Ut=0,Nt=0;const $e=Ye==="right"?1:Ye==="left"?0:.5;let Wt=!1;for(const Ht of Ge){const Rt=Ht.getSections();for(const mr of Rt){if(mr.imageName)continue;const Br=Ae[mr.fontStack];if(Br&&(Wt=Br.ascender!==void 0&&Br.descender!==void 0,!Wt))break}if(!Wt)break}let Vt=0;for(const Ht of Ge){Ht.trim();const Rt=Ht.getMaxScale(),mr=(Rt-1)*ln,Br={positionedGlyphs:[],lineOffset:0};fe.positionedLines[Vt]=Br;const Mr=Br.positionedGlyphs;let Nr=0;if(!Ht.length()){Ut+=Ie,++Vt;continue}let cn=0,Bn=0;for(let fr=0;fr<Ht.length();fr++){const Qr=Ht.getSection(fr),Ai=Ht.getSectionIndex(fr),sn=Ht.getCharCode(fr);let er=Qr.scale,en=null,_r=null,mn=null,Zr=ln,_n=0;const En=!(Re===_i.horizontal||!ot&&!Pe(sn)||ot&&(np[sn]||(Rr=sn,r(Rr)||l(Rr)||p(Rr)||oe(Rr)||Ne(Rr))));if(Qr.imageName){const Cn=Xe[Qr.imageName];if(!Cn)continue;mn=Qr.imageName,fe.iconsInText=fe.iconsInText||!0,_r=Cn.paddedRect;const tn=Cn.displaySize;er=er*ln/Bt,en={width:tn[0],height:tn[1],left:1,top:-3,advance:En?tn[1]:tn[0],localGlyph:!1},_n=Wt?-en.height*er:Rt*ln-17-tn[1]*er,Zr=en.advance;const Xi=(En?tn[0]:tn[1])*er-ln*Rt;Xi>0&&Xi>Nr&&(Nr=Xi)}else{const Cn=Me[Qr.fontStack];if(!Cn)continue;Cn[sn]&&(_r=Cn[sn]);const tn=Ae[Qr.fontStack];if(!tn)continue;const Xi=tn.glyphs[sn];if(!Xi)continue;if(en=Xi.metrics,Zr=sn!==8203?ln:0,Wt){const pc=tn.ascender!==void 0?Math.abs(tn.ascender):0,Zu=tn.descender!==void 0?Math.abs(tn.descender):0,qu=(pc+Zu)*er;cn<qu&&(cn=qu,Bn=(pc-Zu)/2*er),_n=-pc*er}else _n=(Rt-er)*ln-17}En?(fe.verticalizable=!0,Mr.push({glyph:sn,imageName:mn,x:or,y:Ut+_n,vertical:En,scale:er,localGlyph:en.localGlyph,fontStack:Qr.fontStack,sectionIndex:Ai,metrics:en,rect:_r}),or+=Zr*er+tt):(Mr.push({glyph:sn,imageName:mn,x:or,y:Ut+_n,vertical:En,scale:er,localGlyph:en.localGlyph,fontStack:Qr.fontStack,sectionIndex:Ai,metrics:en,rect:_r}),or+=en.advance*er+tt)}Mr.length!==0&&(Nt=Math.max(or-tt,Nt),Wt?x0(Mr,$e,Nr,Bn,Ie*Rt/2):x0(Mr,$e,Nr,0,Ie/2)),or=0;const Fn=Ie*Rt+Nr;Br.lineOffset=Math.max(Nr,mr),Ut+=Fn,++Vt}var Rr;const Sr=Ut,{horizontalAlign:Jr,verticalAlign:fn}=Hm(Ze);(function(Ht,Rt,mr,Br,Mr,Nr){const cn=(Rt-mr)*Mr,Bn=-Nr*Br;for(const Fn of Ht)for(const fr of Fn.positionedGlyphs)fr.x+=cn,fr.y+=Bn})(fe.positionedLines,$e,Jr,fn,Nt,Sr),fe.top+=-fn*Sr,fe.bottom=fe.top+Sr,fe.left+=-Jr*Nt,fe.right=fe.left+Nt,fe.hasBaseline=Wt}(pe,e,n,s,W,f,y,x,C,b,M,U),!function(fe){for(const Ae of fe)if(Ae.positionedGlyphs.length!==0)return!1;return!0}(de)&&pe}const np={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},DS={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function _0(t,e,n,s,c,h){if(e.imageName){const f=s[e.imageName];return f?f.displaySize[0]*e.scale*ln/h+c:0}{const f=n[e.fontStack],y=f&&f.glyphs[t];return y?y.metrics.advance*e.scale+c:0}}function g0(t,e,n,s){const c=Math.pow(t-e,2);return s?t<e?c/2:2*c:c+Math.abs(n)*n}function LS(t,e,n){let s=0;return t===10&&(s-=1e4),n&&(s+=150),t!==40&&t!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function y0(t,e,n,s,c,h){let f=null,y=g0(e,n,c,h);for(const x of s){const b=g0(e-x.x,n,c,h)+x.badness;b<=y&&(f=x,y=b)}return{index:t,x:e,priorBreak:f,badness:y}}function v0(t){return t?v0(t.priorBreak).concat(t.index):[]}function Wm(t,e,n,s,c,h,f){if(h!=="point")return[];if(!t)return[];const y=[],x=function(M,D,R,U,j,W){let re=0;for(let le=0;le<M.length();le++){const de=M.getSection(le);re+=_0(M.getCharCode(le),de,U,j,D,W)}return re/Math.max(1,Math.ceil(re/R))}(t,e,n,s,c,f),b=t.text.indexOf("\u200B")>=0;let E=0;for(let M=0;M<t.length();M++){const D=t.getSection(M),R=t.getCharCode(M);if(np[R]||(E+=_0(R,D,s,c,e,f)),M<t.length()-1){const U=!((C=R)<11904||!(L(C)||z(C)||Se(C)||J(C)||G(C)||g(C)||F(C)||T(C)||ie(C)||V(C)||N(C)||Be(C)||I(C)||w(C)||v(C)||$(C)||A(C)||ye(C)||te(C)||ee(C)));(DS[R]||U||D.imageName)&&y.push(y0(M+1,E,x,y,LS(R,t.getCharCode(M+1),U&&b),!1))}}var C;return v0(y0(t.length(),E,x,y,0,!0))}function Hm(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function x0(t,e,n,s,c){if(!(e||n||s||c))return;const h=t.length-1,f=t[h],y=(f.x+f.metrics.advance*f.scale)*e;for(let x=0;x<=h;x++)t[x].x-=y,t[x].y+=n+s+c}function OS(t,e,n){const{horizontalAlign:s,verticalAlign:c}=Hm(n),h=e[0]-t.displaySize[0]*s,f=e[1]-t.displaySize[1]*c;return{image:t,top:f,bottom:f+t.displaySize[1],left:h,right:h+t.displaySize[0]}}function w0(t,e,n,s,c,h){const f=t.image;let y;if(f.content){const j=f.content,W=f.pixelRatio||1;y=[j[0]/W,j[1]/W,f.displaySize[0]-j[2]/W,f.displaySize[1]-j[3]/W]}const x=e.left*h,b=e.right*h;let E,C,M,D;n==="width"||n==="both"?(D=c[0]+x-s[3],C=c[0]+b+s[1]):(D=c[0]+(x+b-f.displaySize[0])/2,C=D+f.displaySize[0]);const R=e.top*h,U=e.bottom*h;return n==="height"||n==="both"?(E=c[1]+R-s[0],M=c[1]+U+s[2]):(E=c[1]+(R+U-f.displaySize[1])/2,M=E+f.displaySize[1]),{image:f,top:E,right:C,bottom:M,left:D,collisionPadding:y}}class Go extends ce{constructor(e,n,s,c,h){super(e,n),this.angle=c,this.z=s,h!==void 0&&(this.segment=h)}clone(){return new Go(this.x,this.y,this.z,this.angle,this.segment)}}function b0(t,e,n,s,c){if(e.segment===void 0)return!0;let h=e,f=e.segment+1,y=0;for(;y>-n/2;){if(f--,f<0)return!1;y-=t[f].dist(h),h=t[f]}y+=t[f].dist(t[f+1]),f++;const x=[];let b=0;for(;y<n/2;){const E=t[f],C=t[f+1];if(!C)return!1;let M=t[f-1].angleTo(E)-E.angleTo(C);for(M=Math.abs((M+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:y,angleDelta:M}),b+=M;y-x[0].distance>s;)b-=x.shift().angleDelta;if(b>c)return!1;f++,y+=E.dist(C)}return!0}function T0(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function S0(t,e,n){return t?.6*e*n:0}function E0(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function RS(t,e,n,s,c,h){const f=S0(n,c,h),y=E0(n,s)*h;let x=0;const b=T0(t)/2;for(let E=0;E<t.length-1;E++){const C=t[E],M=t[E+1],D=C.dist(M);if(x+D>b){const R=(b-x)/D,U=Xt(C.x,M.x,R),j=Xt(C.y,M.y,R),W=new Go(U,j,0,M.angleTo(C),E);return!f||b0(t,W,y,f,e)?W:void 0}x+=D}}function BS(t,e,n,s,c,h,f,y,x){const b=S0(s,h,f),E=E0(s,c),C=E*f,M=t[0].x===0||t[0].x===x||t[0].y===0||t[0].y===x;return e-C<e/4&&(e=C+e/4),C0(t,M?e/2*y%e:(E/2+2*h)*f*y%e,e,b,n,C,M,!1,x)}function C0(t,e,n,s,c,h,f,y,x){const b=h/2,E=T0(t);let C=0,M=e-n,D=[];for(let R=0;R<t.length-1;R++){const U=t[R],j=t[R+1],W=U.dist(j),re=j.angleTo(U);for(;M+n<C+W;){M+=n;const le=(M-C)/W,de=Xt(U.x,j.x,le),pe=Xt(U.y,j.y,le);if(de>=0&&de<x&&pe>=0&&pe<x&&M-b>=0&&M+b<=E){const fe=new Go(de,pe,0,re,R);fe._round(),s&&!b0(t,fe,h,s,c)||D.push(fe)}}C+=W}return y||D.length||f||(D=C0(t,C/2,n,s,c,h,f,!0,x)),D}function k0(t,e,n,s,c){const h=[];for(let f=0;f<t.length;f++){const y=t[f];let x;for(let b=0;b<y.length-1;b++){let E=y[b],C=y[b+1];E.x<e&&C.x<e||(E.x<e?E=new ce(e,E.y+(e-E.x)/(C.x-E.x)*(C.y-E.y))._round():C.x<e&&(C=new ce(e,E.y+(e-E.x)/(C.x-E.x)*(C.y-E.y))._round()),E.y<n&&C.y<n||(E.y<n?E=new ce(E.x+(n-E.y)/(C.y-E.y)*(C.x-E.x),n)._round():C.y<n&&(C=new ce(E.x+(n-E.y)/(C.y-E.y)*(C.x-E.x),n)._round()),E.x>=s&&C.x>=s||(E.x>=s?E=new ce(s,E.y+(s-E.x)/(C.x-E.x)*(C.y-E.y))._round():C.x>=s&&(C=new ce(s,E.y+(s-E.x)/(C.x-E.x)*(C.y-E.y))._round()),E.y>=c&&C.y>=c||(E.y>=c?E=new ce(E.x+(c-E.y)/(C.y-E.y)*(C.x-E.x),c)._round():C.y>=c&&(C=new ce(E.x+(c-E.y)/(C.y-E.y)*(C.x-E.x),c)._round()),x&&E.equals(x[x.length-1])||(x=[E],h.push(x)),x.push(C)))))}}return h}rt("Anchor",Go);const Uu=1e20;function M0(t,e,n,s,c,h,f,y,x){for(let b=e;b<e+s;b++)I0(t,n*h+b,h,c,f,y,x);for(let b=n;b<n+c;b++)I0(t,b*h+e,1,s,f,y,x)}function I0(t,e,n,s,c,h,f){h[0]=0,f[0]=-Uu,f[1]=Uu,c[0]=t[e];for(let y=1,x=0,b=0;y<s;y++){c[y]=t[e+y*n];const E=y*y;do{const C=h[x];b=(c[y]-c[C]+E-C*C)/(y-C)/2}while(b<=f[x]&&--x>-1);x++,h[x]=y,f[x]=b,f[x+1]=Uu}for(let y=0,x=0;y<s;y++){for(;f[x+1]<y;)x++;const b=h[x],E=y-b;t[e+y*n]=c[b]+E*E}}const Xm={none:0,ideographs:1,all:2};class lc{constructor(e,n,s){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const s=[];for(const c in e)for(const h of e[c])s.push({stack:c,id:h});zo(s,({stack:c,id:h},f)=>{let y=this.entries[c];y||(y=this.entries[c]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=y.glyphs[h];if(x!==void 0)return void f(null,{stack:c,id:h,glyph:x});if(x=this._tinySDF(y,c,h),x)return y.glyphs[h]=x,void f(null,{stack:c,id:h,glyph:x});const b=Math.floor(h/256);if(256*b>65535)return void f(new Error("glyphs > 65535 not supported"));if(y.ranges[b])return void f(null,{stack:c,id:h,glyph:x});let E=y.requests[b];E||(E=y.requests[b]=[],lc.loadGlyphRange(c,b,this.url,this.requestManager,(C,M)=>{if(M){y.ascender=M.ascender,y.descender=M.descender;for(const D in M.glyphs)this._doesCharSupportLocalGlyph(+D)||(y.glyphs[+D]=M.glyphs[+D]);y.ranges[b]=!0}for(const D of E)D(C,M);delete y.requests[b]})),E.push((C,M)=>{C?f(C):M&&f(null,{stack:c,id:h,glyph:M.glyphs[h]||null})})},(c,h)=>{if(c)n(c);else if(h){const f={};for(const{stack:y,id:x,glyph:b}of h)f[y]===void 0&&(f[y]={}),f[y].glyphs===void 0&&(f[y].glyphs={}),f[y].glyphs[x]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics},f[y].ascender=this.entries[y].ascender,f[y].descender=this.entries[y].descender;n(null,f)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Xm.none&&(this.localGlyphMode===Xm.all?!!this.localFontFamily:!!this.localFontFamily&&(V(e)||K(e)||I(e)||A(e))||T(e))}_tinySDF(e,n,s){const c=this.localFontFamily;if(!c||!this._doesCharSupportLocalGlyph(s))return;let h=e.tinySDF;if(!h){let U="400";/bold/i.test(n)?U="900":/medium/i.test(n)?U="500":/light/i.test(n)&&(U="200"),h=e.tinySDF=new lc.TinySDF({fontFamily:c,fontWeight:U,fontSize:48,buffer:6,radius:16}),h.fontWeight=U}if(this.localGlyphs[h.fontWeight][s])return this.localGlyphs[h.fontWeight][s];const f=String.fromCharCode(s),{data:y,width:x,height:b,glyphWidth:E,glyphHeight:C,glyphLeft:M,glyphTop:D,glyphAdvance:R}=h.draw(f);return this.localGlyphs[h.fontWeight][s]={id:s,bitmap:new ks({width:x,height:b},y),metrics:{width:E/2,height:C/2,left:M/2,top:D/2-27,advance:R/2,localGlyph:!0}}}}function A0(t,e,n,s){const c=[],h=t.image,f=h.pixelRatio,y=h.paddedRect.w-2,x=h.paddedRect.h-2,b=t.right-t.left,E=t.bottom-t.top,C=h.stretchX||[[0,y]],M=h.stretchY||[[0,x]],D=(Ie,Ze)=>Ie+Ze[1]-Ze[0],R=C.reduce(D,0),U=M.reduce(D,0),j=y-R,W=x-U;let re=0,le=R,de=0,pe=U,fe=0,Ae=j,Me=0,Xe=W;if(h.content&&s){const Ie=h.content;re=ip(C,0,Ie[0]),de=ip(M,0,Ie[1]),le=ip(C,Ie[0],Ie[2]),pe=ip(M,Ie[1],Ie[3]),fe=Ie[0]-re,Me=Ie[1]-de,Ae=Ie[2]-Ie[0]-le,Xe=Ie[3]-Ie[1]-pe}const Ge=(Ie,Ze,Ye,Re)=>{const tt=op(Ie.stretch-re,le,b,t.left),ot=sp(Ie.fixed-fe,Ae,Ie.stretch,R),Bt=op(Ze.stretch-de,pe,E,t.top),or=sp(Ze.fixed-Me,Xe,Ze.stretch,U),Ut=op(Ye.stretch-re,le,b,t.left),Nt=sp(Ye.fixed-fe,Ae,Ye.stretch,R),$e=op(Re.stretch-de,pe,E,t.top),Wt=sp(Re.fixed-Me,Xe,Re.stretch,U),Vt=new ce(tt,Bt),Rr=new ce(Ut,Bt),Sr=new ce(Ut,$e),Jr=new ce(tt,$e),fn=new ce(ot/f,or/f),Ht=new ce(Nt/f,Wt/f),Rt=e*Math.PI/180;if(Rt){const Mr=Math.sin(Rt),Nr=Math.cos(Rt),cn=[Nr,-Mr,Mr,Nr];Vt._matMult(cn),Rr._matMult(cn),Jr._matMult(cn),Sr._matMult(cn)}const mr=Ie.stretch+Ie.fixed,Br=Ze.stretch+Ze.fixed;return{tl:Vt,tr:Rr,bl:Jr,br:Sr,tex:{x:h.paddedRect.x+1+mr,y:h.paddedRect.y+1+Br,w:Ye.stretch+Ye.fixed-mr,h:Re.stretch+Re.fixed-Br},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fn,pixelOffsetBR:Ht,minFontScaleX:Ae/f/b,minFontScaleY:Xe/f/E,isSDF:n}};if(s&&(h.stretchX||h.stretchY)){const Ie=z0(C,j,R),Ze=z0(M,W,U);for(let Ye=0;Ye<Ie.length-1;Ye++){const Re=Ie[Ye],tt=Ie[Ye+1];for(let ot=0;ot<Ze.length-1;ot++)c.push(Ge(Re,Ze[ot],tt,Ze[ot+1]))}}else c.push(Ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:x+1}));return c}function ip(t,e,n){let s=0;for(const c of t)s+=Math.max(e,Math.min(n,c[1]))-Math.max(e,Math.min(n,c[0]));return s}function z0(t,e,n){const s=[{fixed:-1,stretch:0}];for(const[c,h]of t){const f=s[s.length-1];s.push({fixed:c-f.stretch,stretch:f.stretch}),s.push({fixed:c-f.stretch,stretch:f.stretch+(h-c)})}return s.push({fixed:e+1,stretch:n}),s}function op(t,e,n,s){return t/e*n+s}function sp(t,e,n,s){return t-e*n/s}function FS(t,e,n,s){const c=e+t.positionedLines[s].lineOffset;return s===0?n+c/2:n+(c+(e+t.positionedLines[s-1].lineOffset))/2}lc.loadGlyphRange=function(t,e,n,s,c){const h=256*e,f=h+255,y=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${h}-${f}`),fl.Glyphs);da(y,(x,b)=>{if(x)c(x);else if(b){const E={},C=function(M){return new Bu(M).readFields(AS,{})}(b);for(const M of C.glyphs)E[M.id]=M;c(null,{glyphs:E,ascender:C.ascender,descender:C.descender})}})},lc.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:s=.25,fontFamily:c="sans-serif",fontWeight:h="normal",fontStyle:f="normal"}){this.buffer=e,this.cutoff=s,this.radius=n;const y=this.size=t+4*e,x=this._createCanvas(y),b=this.ctx=x.getContext("2d",{willReadFrequently:!0});b.font=`${f} ${h} ${t}px ${c}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:s,actualBoundingBoxLeft:c,actualBoundingBoxRight:h}=this.ctx.measureText(t),f=Math.floor(n),y=Math.min(this.size-this.buffer,Math.ceil(h-c)),x=Math.min(this.size-this.buffer,Math.ceil(n)+Math.ceil(s)),b=y+2*this.buffer,E=x+2*this.buffer,C=b*E,M=new Uint8ClampedArray(C),D={data:M,width:b,height:E,glyphWidth:y,glyphHeight:x,glyphTop:f,glyphLeft:0,glyphAdvance:e};if(y===0||x===0)return D;const{ctx:R,buffer:U,gridInner:j,gridOuter:W}=this;R.clearRect(U,U,y,x),R.fillText(t,U,U+f+1);const re=R.getImageData(U,U,y,x);W.fill(Uu,0,C),j.fill(0,0,C);for(let le=0;le<x;le++)for(let de=0;de<y;de++){const pe=re.data[4*(le*y+de)+3]/255;if(pe===0)continue;const fe=(le+U)*b+de+U;if(pe===1)W[fe]=0,j[fe]=Uu;else{const Ae=.5-pe;W[fe]=Ae>0?Ae*Ae:0,j[fe]=Ae<0?Ae*Ae:0}}M0(W,0,0,b,E,b,this.f,this.v,this.z),M0(j,U,U,y,x,b,this.f,this.v,this.z);for(let le=0;le<C;le++){const de=Math.sqrt(W[le])-Math.sqrt(j[le]);M[le]=Math.round(255-255*(de/this.radius+this.cutoff))}return D}};class US{constructor(e=[],n=NS){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:s}=this,c=n[e];for(;e>0;){const h=e-1>>1,f=n[h];if(s(c,f)>=0)break;n[e]=f,e=h}n[e]=c}_down(e){const{data:n,compare:s}=this,c=this.length>>1,h=n[e];for(;e<c;){let f=1+(e<<1),y=n[f];const x=f+1;if(x<this.length&&s(n[x],y)<0&&(f=x,y=n[x]),s(y,h)>=0)break;n[e]=y,e=f}n[e]=h}}function NS(t,e){return t<e?-1:t>e?1:0}function jS(t,e=1,n=!1){let s=1/0,c=1/0,h=-1/0,f=-1/0;const y=t[0];for(let D=0;D<y.length;D++){const R=y[D];(!D||R.x<s)&&(s=R.x),(!D||R.y<c)&&(c=R.y),(!D||R.x>h)&&(h=R.x),(!D||R.y>f)&&(f=R.y)}const x=Math.min(h-s,f-c);let b=x/2;const E=new US([],VS);if(x===0)return new ce(s,c);for(let D=s;D<h;D+=x)for(let R=c;R<f;R+=x)E.push(new cc(D+b,R+b,b,t));let C=function(D){let R=0,U=0,j=0;const W=D[0];for(let re=0,le=W.length,de=le-1;re<le;de=re++){const pe=W[re],fe=W[de],Ae=pe.x*fe.y-fe.x*pe.y;U+=(pe.x+fe.x)*Ae,j+=(pe.y+fe.y)*Ae,R+=3*Ae}return new cc(U/R,j/R,0,D)}(t),M=E.length;for(;E.length;){const D=E.pop();(D.d>C.d||!C.d)&&(C=D,n&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,M)),D.max-C.d<=e||(b=D.h/2,E.push(new cc(D.p.x-b,D.p.y-b,b,t)),E.push(new cc(D.p.x+b,D.p.y-b,b,t)),E.push(new cc(D.p.x-b,D.p.y+b,b,t)),E.push(new cc(D.p.x+b,D.p.y+b,b,t)),M+=4)}return n&&(console.log(`num probes: ${M}`),console.log(`best distance: ${C.d}`)),C.p}function VS(t,e){return e.max-t.max}function cc(t,e,n,s){this.p=new ce(t,e),this.h=n,this.d=function(c,h){let f=!1,y=1/0;for(let x=0;x<h.length;x++){const b=h[x];for(let E=0,C=b.length,M=C-1;E<C;M=E++){const D=b[E],R=b[M];D.y>c.y!=R.y>c.y&&c.x<(R.x-D.x)*(c.y-D.y)/(R.y-D.y)+D.x&&(f=!f),y=Math.min(y,Uv(c,D,R))}}return(f?1:-1)*Math.sqrt(y)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const Ym=Number.POSITIVE_INFINITY,$S=Math.sqrt(2);function P0(t,e){return e[1]!==Ym?function(n,s,c){let h=0,f=0;switch(s=Math.abs(s),c=Math.abs(c),n){case"top-right":case"top-left":case"top":f=c-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-c}switch(n){case"top-right":case"bottom-right":case"right":h=-s;break;case"top-left":case"bottom-left":case"left":h=s}return[h,f]}(t,e[0],e[1]):function(n,s){let c=0,h=0;s<0&&(s=0);const f=s/$S;switch(n){case"top-right":case"top-left":h=f-7;break;case"bottom-right":case"bottom-left":h=7-f;break;case"bottom":h=7-s;break;case"top":h=s-7}switch(n){case"top-right":case"bottom-right":c=-f;break;case"top-left":case"bottom-left":c=f;break;case"left":c=s;break;case"right":c=-s}return[c,h]}(t,e[0])}function GS(t,e,n,s,c,h,f,y,x,b){t.createArrays(),t.tilePixelRatio=Dt/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const E=t.layers[0].layout,C=t.layers[0]._unevaluatedLayout._values,M={};if(t.textSizeData.kind==="composite"){const{minZoom:U,maxZoom:j}=t.textSizeData;M.compositeTextSizes=[C["text-size"].possiblyEvaluate(new wt(U),y),C["text-size"].possiblyEvaluate(new wt(j),y)]}if(t.iconSizeData.kind==="composite"){const{minZoom:U,maxZoom:j}=t.iconSizeData;M.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new wt(U),y),C["icon-size"].possiblyEvaluate(new wt(j),y)]}M.layoutTextSize=C["text-size"].possiblyEvaluate(new wt(x+1),y),M.layoutIconSize=C["icon-size"].possiblyEvaluate(new wt(x+1),y),M.textMaxSize=C["text-size"].possiblyEvaluate(new wt(18),y);const D=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",R=E.get("text-size");for(const U of t.features){const j=E.get("text-font").evaluate(U,{},y).join(","),W=R.evaluate(U,{},y),re=M.layoutTextSize.evaluate(U,{},y),le=(M.layoutIconSize.evaluate(U,{},y),{horizontal:{},vertical:void 0}),de=U.text;let pe,fe=[0,0];if(de){const Xe=de.toString(),Ge=E.get("text-letter-spacing").evaluate(U,{},y)*ln,Ie=E.get("text-line-height").evaluate(U,{},y)*ln,Ze=be(Xe)?Ge:0,Ye=E.get("text-anchor").evaluate(U,{},y),Re=E.get("text-variable-anchor");if(!Re){const Nt=E.get("text-radial-offset").evaluate(U,{},y);fe=Nt?P0(Ye,[Nt*ln,Ym]):E.get("text-offset").evaluate(U,{},y).map($e=>$e*ln)}let tt=D?"center":E.get("text-justify").evaluate(U,{},y);const ot=E.get("symbol-placement"),Bt=ot==="point",or=ot==="point"?E.get("text-max-width").evaluate(U,{},y)*ln:0,Ut=Nt=>{t.allowVerticalPlacement&&ke(Xe)&&(le.vertical=qm(de,e,n,c,j,or,Ie,Ye,Nt,Ze,fe,_i.vertical,!0,ot,re,W))};if(!D&&Re){const Nt=tt==="auto"?Re.map(Wt=>Km(Wt)):[tt];let $e=!1;for(let Wt=0;Wt<Nt.length;Wt++){const Vt=Nt[Wt];if(!le.horizontal[Vt])if($e)le.horizontal[Vt]=le.horizontal[0];else{const Rr=qm(de,e,n,c,j,or,Ie,"center",Vt,Ze,fe,_i.horizontal,!1,ot,re,W);Rr&&(le.horizontal[Vt]=Rr,$e=Rr.positionedLines.length===1)}}Ut("left")}else{if(tt==="auto"&&(tt=Km(Ye)),Bt||E.get("text-writing-mode").indexOf("horizontal")>=0||!ke(Xe)){const Nt=qm(de,e,n,c,j,or,Ie,Ye,tt,Ze,fe,_i.horizontal,!1,ot,re,W);Nt&&(le.horizontal[tt]=Nt)}Ut(ot==="point"?"left":tt)}}let Ae=!1;if(U.icon&&U.icon.name){const Xe=s[U.icon.name];Xe&&(pe=OS(c[U.icon.name],E.get("icon-offset").evaluate(U,{},y),E.get("icon-anchor").evaluate(U,{},y)),Ae=Xe.sdf,t.sdfIcons===void 0?t.sdfIcons=Xe.sdf:t.sdfIcons!==Xe.sdf&&gr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xe.pixelRatio!==t.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const Me=L0(le.horizontal)||le.vertical;t.iconsInText||(t.iconsInText=!!Me&&Me.iconsInText),(Me||pe)&&ZS(t,U,le,pe,s,M,re,0,fe,Ae,f,y,b)}h&&t.generateCollisionDebugBuffers(x,t.collisionBoxArray)}function Km(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ZS(t,e,n,s,c,h,f,y,x,b,E,C,M){let D=h.textMaxSize.evaluate(e,{},C);D===void 0&&(D=f);const R=t.layers[0].layout,U=R.get("icon-offset").evaluate(e,{},C),j=L0(n.horizontal)||n.vertical,W=f/24,re=t.tilePixelRatio*D/24,le=t.tilePixelRatio*R.get("symbol-spacing"),de=R.get("text-padding")*t.tilePixelRatio,pe=R.get("icon-padding")*t.tilePixelRatio,fe=Pt(R.get("text-max-angle")),Ae=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",Me=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",Xe=R.get("symbol-placement"),Ge=le/2,Ie=R.get("icon-text-fit");let Ze;s&&Ie!=="none"&&(t.allowVerticalPlacement&&n.vertical&&(Ze=w0(s,n.vertical,Ie,R.get("icon-text-fit-padding"),U,W)),j&&(s=w0(s,j,Ie,R.get("icon-text-fit-padding"),U,W)));const Ye=(Re,tt,ot)=>{if(tt.x<0||tt.x>=Dt||tt.y<0||tt.y>=Dt)return;const{x:Bt,y:or,z:Ut}=M.projectTilePoint(tt.x,tt.y,ot),Nt=new Go(Bt,or,Ut,0,void 0);(function($e,Wt,Vt,Rr,Sr,Jr,fn,Ht,Rt,mr,Br,Mr,Nr,cn,Bn,Fn,fr,Qr,Ai,sn,er,en,_r,mn,Zr){const _n=$e.addToLineVertexArray(Wt,Rr);let En,Cn,tn,Xi,pc,Zu,qu,mx=0,_x=0,gx=0,yx=0,__=-1,g_=-1;const bo={};let vx=Mu(""),y_=0,v_=0;if(Rt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[y_,v_]=Rt.layout.get("text-offset").evaluate(er,{},Zr).map(Qn=>Qn*ln):(y_=Rt.layout.get("text-radial-offset").evaluate(er,{},Zr)*ln,v_=Ym),$e.allowVerticalPlacement&&Sr.vertical){const Qn=Sr.vertical;if(Bn)Zu=Jm(Qn),Ht&&(qu=Jm(Ht));else{const ei=Rt.layout.get("text-rotate").evaluate(er,{},Zr)+90;tn=ap(mr,Vt,Wt,Br,Mr,Nr,Qn,cn,ei,Fn),Ht&&(Xi=ap(mr,Vt,Wt,Br,Mr,Nr,Ht,Qr,ei))}}if(Jr){const Qn=Rt.layout.get("icon-rotate").evaluate(er,{},Zr),ei=Rt.layout.get("icon-text-fit")!=="none",Wu=A0(Jr,Qn,_r,ei),w_=Ht?A0(Ht,Qn,_r,ei):void 0;Cn=ap(mr,Vt,Wt,Br,Mr,Nr,Jr,Qr,Qn),mx=4*Wu.length;const xx=$e.iconSizeData;let qa=null;xx.kind==="source"?(qa=[yo*Rt.layout.get("icon-size").evaluate(er,{},Zr)],qa[0]>Is&&gr(`${$e.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):xx.kind==="composite"&&(qa=[yo*en.compositeIconSizes[0].evaluate(er,{},Zr),yo*en.compositeIconSizes[1].evaluate(er,{},Zr)],(qa[0]>Is||qa[1]>Is)&&gr(`${$e.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),$e.addSymbols($e.icon,Wu,qa,sn,Ai,er,!1,Vt,Wt,_n.lineStartIndex,_n.lineLength,-1,mn,Zr),__=$e.icon.placedSymbolArray.length-1,w_&&(_x=4*w_.length,$e.addSymbols($e.icon,w_,qa,sn,Ai,er,_i.vertical,Vt,Wt,_n.lineStartIndex,_n.lineLength,-1,mn,Zr),g_=$e.icon.placedSymbolArray.length-1)}for(const Qn in Sr.horizontal){const ei=Sr.horizontal[Qn];En||(vx=Mu(ei.text),Bn?pc=Jm(ei):En=ap(mr,Vt,Wt,Br,Mr,Nr,ei,cn,Rt.layout.get("text-rotate").evaluate(er,{},Zr),Fn));const Wu=ei.positionedLines.length===1;if(gx+=D0($e,Vt,Wt,ei,fn,Rt,Bn,er,Fn,_n,Sr.vertical?_i.horizontal:_i.horizontalOnly,Wu?Object.keys(Sr.horizontal):[Qn],bo,__,en,mn,Zr),Wu)break}Sr.vertical&&(yx+=D0($e,Vt,Wt,Sr.vertical,fn,Rt,Bn,er,Fn,_n,_i.vertical,["vertical"],bo,g_,en,mn,Zr));let Ls=-1;const x_=(Qn,ei)=>Qn?Math.max(Qn,ei):ei;Ls=x_(pc,Ls),Ls=x_(Zu,Ls),Ls=x_(qu,Ls);const xE=Ls>-1?1:0;$e.glyphOffsetArray.length>=As.MAX_GLYPHS&&gr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),er.sortKey!==void 0&&$e.addToSortKeyRanges($e.symbolInstances.length,er.sortKey),$e.symbolInstances.emplaceBack(Vt.x,Vt.y,Vt.z,Wt.x,Wt.y,bo.right>=0?bo.right:-1,bo.center>=0?bo.center:-1,bo.left>=0?bo.left:-1,bo.vertical>=0?bo.vertical:-1,__,g_,vx,En!==void 0?En:$e.collisionBoxArray.length,En!==void 0?En+1:$e.collisionBoxArray.length,tn!==void 0?tn:$e.collisionBoxArray.length,tn!==void 0?tn+1:$e.collisionBoxArray.length,Cn!==void 0?Cn:$e.collisionBoxArray.length,Cn!==void 0?Cn+1:$e.collisionBoxArray.length,Xi||$e.collisionBoxArray.length,Xi?Xi+1:$e.collisionBoxArray.length,Br,gx,yx,mx,_x,xE,0,y_,v_,Ls)})(t,tt,Nt,Re,n,s,c,Ze,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,de,Ae,x,0,pe,Me,U,e,h,b,E,C)};if(Xe==="line")for(const Re of k0(e.geometry,0,0,Dt,Dt)){const tt=BS(Re,le,fe,n.vertical||j,s,24,re,t.overscaling,Dt);for(const ot of tt){const Bt=j;Bt&&qS(t,Bt.text,Ge,ot)||Ye(Re,ot,C)}}else if(Xe==="line-center"){for(const Re of e.geometry)if(Re.length>1){const tt=RS(Re,fe,n.vertical||j,s,24,re);tt&&Ye(Re,tt,C)}}else if(e.type==="Polygon")for(const Re of Fm(e.geometry,0)){const tt=jS(Re,16);Ye(Re[0],new Go(tt.x,tt.y,0,0,void 0),C)}else if(e.type==="LineString")for(const Re of e.geometry)Ye(Re,new Go(Re[0].x,Re[0].y,0,0,void 0),C);else if(e.type==="Point")for(const Re of e.geometry)for(const tt of Re)Ye([tt],new Go(tt.x,tt.y,0,0,void 0),C)}const Is=32640;function D0(t,e,n,s,c,h,f,y,x,b,E,C,M,D,R,U,j){const W=function(de,pe,fe,Ae,Me,Xe,Ge,Ie){const Ze=[];if(pe.positionedLines.length===0)return Ze;const Ye=Ae.layout.get("text-rotate").evaluate(Xe,{})*Math.PI/180,Re=function(Ut){const Nt=Ut[0],$e=Ut[1],Wt=Nt*$e;return Wt>0?[Nt,-$e]:Wt<0?[-Nt,$e]:Nt===0?[$e,Nt]:[$e,-Nt]}(fe);let tt=Math.abs(pe.top-pe.bottom);for(const Ut of pe.positionedLines)tt-=Ut.lineOffset;const ot=pe.positionedLines.length,Bt=tt/ot;let or=pe.top-fe[1];for(let Ut=0;Ut<ot;++Ut){const Nt=pe.positionedLines[Ut];or=FS(pe,Bt,or,Ut);for(const $e of Nt.positionedGlyphs){if(!$e.rect)continue;const Wt=$e.rect||{};let Vt=4,Rr=!0,Sr=1,Jr=0;if($e.imageName){const _r=Ge[$e.imageName];if(!_r)continue;if(_r.sdf){gr("SDF images are not supported in formatted text and will be ignored.");continue}Rr=!1,Sr=_r.pixelRatio,Vt=1/Sr}const fn=(Me||Ie)&&$e.vertical,Ht=$e.metrics.advance*$e.scale/2,Rt=$e.metrics,mr=$e.rect;if(mr===null)continue;Ie&&pe.verticalizable&&(Jr=$e.imageName?Ht-$e.metrics.width*$e.scale/2:0);const Br=Me?[$e.x+Ht,$e.y]:[0,0];let Mr=[0,0],Nr=[0,0],cn=!1;Me||(fn?(Nr=[$e.x+Ht+Re[0],$e.y+Re[1]-Jr],cn=!0):Mr=[$e.x+Ht+fe[0],$e.y+fe[1]-Jr]);const Bn=mr.w*$e.scale/(Sr*($e.localGlyph?2:1)),Fn=mr.h*$e.scale/(Sr*($e.localGlyph?2:1));let fr,Qr,Ai,sn;if(fn){const _r=$e.y-or,mn=new ce(-Ht,Ht-_r),Zr=-Math.PI/2,_n=new ce(...Nr);fr=new ce(-Ht+Mr[0],Mr[1]),fr._rotateAround(Zr,mn)._add(_n),fr.x+=-_r+Ht,fr.y-=(Rt.left-Vt)*$e.scale;const En=$e.imageName?Rt.advance*$e.scale:ln*$e.scale,Cn=String.fromCharCode($e.glyph);vS(Cn)?fr.x+=(1-Vt)*$e.scale:xS(Cn)?fr.x+=En-Rt.height*$e.scale+(-Vt-1)*$e.scale:fr.x+=$e.imageName||Rt.width+2*Vt===mr.w&&Rt.height+2*Vt===mr.h?(En-Fn)/2:(En-(Rt.height+2*Vt)*$e.scale)/2,Qr=new ce(fr.x,fr.y-Bn),Ai=new ce(fr.x+Fn,fr.y),sn=new ce(fr.x+Fn,fr.y-Bn)}else{const _r=(Rt.left-Vt)*$e.scale-Ht+Mr[0],mn=(-Rt.top-Vt)*$e.scale+Mr[1],Zr=_r+Bn,_n=mn+Fn;fr=new ce(_r,mn),Qr=new ce(Zr,mn),Ai=new ce(_r,_n),sn=new ce(Zr,_n)}if(Ye){let _r;_r=Me?new ce(0,0):cn?new ce(Re[0],Re[1]):new ce(fe[0],fe[1]),fr._rotateAround(Ye,_r),Qr._rotateAround(Ye,_r),Ai._rotateAround(Ye,_r),sn._rotateAround(Ye,_r)}const er=new ce(0,0),en=new ce(0,0);Ze.push({tl:fr,tr:Qr,bl:Ai,br:sn,tex:Wt,writingMode:pe.writingMode,glyphOffset:Br,sectionIndex:$e.sectionIndex,isSDF:Rr,pixelOffsetTL:er,pixelOffsetBR:en,minFontScaleX:0,minFontScaleY:0})}}return Ze}(0,s,x,h,f,y,c,t.allowVerticalPlacement),re=t.textSizeData;let le=null;re.kind==="source"?(le=[yo*h.layout.get("text-size").evaluate(y,{},j)],le[0]>Is&&gr(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):re.kind==="composite"&&(le=[yo*R.compositeTextSizes[0].evaluate(y,{},j),yo*R.compositeTextSizes[1].evaluate(y,{},j)],(le[0]>Is||le[1]>Is)&&gr(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,W,le,x,f,y,E,e,n,b.lineStartIndex,b.lineLength,D,U,j);for(const de of C)M[de]=t.text.placedSymbolArray.length-1;return 4*W.length}function L0(t){for(const e in t)return t[e];return null}function ap(t,e,n,s,c,h,f,y,x,b){let E=f.top,C=f.bottom,M=f.left,D=f.right;const R=f.collisionPadding;if(R&&(M-=R[0],E-=R[1],D+=R[2],C+=R[3]),x){const U=new ce(M,E),j=new ce(D,E),W=new ce(M,C),re=new ce(D,C),le=Pt(x);let de=new ce(0,0);b&&(de=new ce(b[0],b[1])),U._rotateAround(le,de),j._rotateAround(le,de),W._rotateAround(le,de),re._rotateAround(le,de),M=Math.min(U.x,j.x,W.x,re.x),D=Math.max(U.x,j.x,W.x,re.x),E=Math.min(U.y,j.y,W.y,re.y),C=Math.max(U.y,j.y,W.y,re.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,M,E,D,C,y,s,c,h),t.length-1}function Jm(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function qS(t,e,n,s){const c=t.compareText;if(e in c){const h=c[e];for(let f=h.length-1;f>=0;f--)if(s.dist(h[f])<n)return!0}else c[e]=[];return c[e].push(s),!1}const WS=Va.VectorTileFeature.types,HS=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lp(t,e,n,s,c,h,f,y,x,b,E,C,M,D,R,U){const j=E?Math.min(Is,Math.round(E[0])):0,W=E?Math.min(Is,Math.round(E[1])):0;t.emplaceBack(e,n,Math.round(32*f),Math.round(32*y),x,b,(j<<1)+(C?1:0),W,16*M,16*D,256*R,256*U,s,c,h,0)}function Qm(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function XS(t){for(const e of t.sections)if(qe(e.text))return!0;return!1}class e_{constructor(e){this.layoutVertexArray=new pm,this.indexArray=new fi,this.programConfigurations=e,this.segments=new Lr,this.dynamicLayoutVertexArray=new Yl,this.opacityVertexArray=new fm,this.placedSymbolArray=new yv}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,s,c){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,dS.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,pS.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,HS,!0),this.opacityVertexBuffer.itemSize=1),(s||c)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}rt("SymbolBuffers",e_);class t_{constructor(e,n,s){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new s,this.segments=new Lr,this.collisionVertexArray=new gm,this.collisionVertexArrayExt=new Yl}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,fS.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,mS.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}rt("CollisionBuffers",t_);class As{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(f=>f.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Y([]),this.placementViewportMatrix=Y([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vm(this.zoom,n["text-size"]),this.iconSizeData=Vm(this.zoom,n["icon-size"]);const s=this.layers[0].layout,c=s.get("symbol-sort-key"),h=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&c.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(f=>_i[f]),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.sourceID=e.sourceID}createArrays(){this.text=new e_(new Ua(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new e_(new Ua(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new wv,this.lineVertexArray=new bv,this.symbolInstances=new xv}calculateGlyphDependencies(e,n,s,c,h){for(let f=0;f<e.length;f++)if(n[e.charCodeAt(f)]=!0,c&&h){const y=Ru[e.charAt(f)];y&&(n[y.charCodeAt(0)]=!0)}}populate(e,n,s,c){const h=this.layers[0],f=h.layout,y=f.get("text-font"),x=f.get("text-field"),b=f.get("icon-image"),E=(x.value.kind!=="constant"||x.value.value instanceof Et&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),C=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,M=f.get("symbol-sort-key");if(this.features=[],!E&&!C)return;const D=n.iconDependencies,R=n.glyphDependencies,U=n.availableImages,j=new wt(this.zoom);for(const{feature:W,id:re,index:le,sourceLayerIndex:de}of e){const pe=h._featureFilter.needGeometry,fe=ja(W,pe);if(!h._featureFilter.filter(j,fe,s))continue;let Ae,Me;if(pe||(fe.geometry=Vo(W,s,c)),E){const Ge=h.getValueAndResolveTokens("text-field",fe,s,U),Ie=Et.factory(Ge);XS(Ie)&&(this.hasRTLText=!0),(!this.hasRTLText||Yn()==="unavailable"||this.hasRTLText&&Ft.isParsed())&&(Ae=yS(Ie,h,fe))}if(C){const Ge=h.getValueAndResolveTokens("icon-image",fe,s,U);Me=Ge instanceof Wn?Ge:Wn.fromString(Ge)}if(!Ae&&!Me)continue;const Xe=this.sortFeaturesByKey?M.evaluate(fe,{},s):void 0;if(this.features.push({id:re,text:Ae,icon:Me,index:le,sourceLayerIndex:de,geometry:fe.geometry,properties:W.properties,type:WS[W.type],sortKey:Xe}),Me&&(D[Me.name]=!0),Ae){const Ge=y.evaluate(fe,{},s).join(","),Ie=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_i.vertical)>=0;for(const Ze of Ae.sections)if(Ze.image)D[Ze.image.name]=!0;else{const Ye=ke(Ae.toString()),Re=Ze.fontStack||Ge,tt=R[Re]=R[Re]||{};this.calculateGlyphDependencies(Ze.text,tt,Ie,this.allowVerticalPlacement,Ye)}}}f.get("symbol-placement")==="line"&&(this.features=function(W){const re={},le={},de=[];let pe=0;function fe(Ge){de.push(W[Ge]),pe++}function Ae(Ge,Ie,Ze){const Ye=le[Ge];return delete le[Ge],le[Ie]=Ye,de[Ye].geometry[0].pop(),de[Ye].geometry[0]=de[Ye].geometry[0].concat(Ze[0]),Ye}function Me(Ge,Ie,Ze){const Ye=re[Ie];return delete re[Ie],re[Ge]=Ye,de[Ye].geometry[0].shift(),de[Ye].geometry[0]=Ze[0].concat(de[Ye].geometry[0]),Ye}function Xe(Ge,Ie,Ze){const Ye=Ze?Ie[0][Ie[0].length-1]:Ie[0][0];return`${Ge}:${Ye.x}:${Ye.y}`}for(let Ge=0;Ge<W.length;Ge++){const Ie=W[Ge],Ze=Ie.geometry,Ye=Ie.text?Ie.text.toString():null;if(!Ye){fe(Ge);continue}const Re=Xe(Ye,Ze),tt=Xe(Ye,Ze,!0);if(Re in le&&tt in re&&le[Re]!==re[tt]){const ot=Me(Re,tt,Ze),Bt=Ae(Re,tt,de[ot].geometry);delete re[Re],delete le[tt],le[Xe(Ye,de[Bt].geometry,!0)]=Bt,de[ot].geometry=null}else Re in le?Ae(Re,tt,Ze):tt in re?Me(Re,tt,Ze):(fe(Ge),re[Re]=pe-1,le[tt]=pe-1)}return de.filter(Ge=>Ge.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,re)=>W.sortKey-re.sortKey)}update(e,n,s,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,s,c),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,s,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const s=this.lineVertexArray.length;if(e.segment!==void 0){let c=e.dist(n[e.segment+1]),h=e.dist(n[e.segment]);const f={};for(let y=e.segment+1;y<n.length;y++)f[y]={x:n[y].x,y:n[y].y,tileUnitDistanceFromAnchor:c},y<n.length-1&&(c+=n[y+1].dist(n[y]));for(let y=e.segment||0;y>=0;y--)f[y]={x:n[y].x,y:n[y].y,tileUnitDistanceFromAnchor:h},y>0&&(h+=n[y-1].dist(n[y]));for(let y=0;y<n.length;y++){const x=f[y];this.lineVertexArray.emplaceBack(x.x,x.y,x.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,n,s,c,h,f,y,x,b,E,C,M,D,R){const U=e.indexArray,j=e.layoutVertexArray,W=e.segments.prepareSegment(4*n.length,j,U,this.canOverlap?f.sortKey:void 0),re=this.glyphOffsetArray.length,le=W.vertexLength,de=this.allowVerticalPlacement&&y===_i.vertical?Math.PI/2:0,pe=f.text&&f.text.sections;for(let fe=0;fe<n.length;fe++){const{tl:Ae,tr:Me,bl:Xe,br:Ge,tex:Ie,pixelOffsetTL:Ze,pixelOffsetBR:Ye,minFontScaleX:Re,minFontScaleY:tt,glyphOffset:ot,isSDF:Bt,sectionIndex:or}=n[fe],Ut=W.vertexLength,Nt=ot[1];lp(j,x.x,x.y,x.z,b.x,b.y,Ae.x,Nt+Ae.y,Ie.x,Ie.y,s,Bt,Ze.x,Ze.y,Re,tt),lp(j,x.x,x.y,x.z,b.x,b.y,Me.x,Nt+Me.y,Ie.x+Ie.w,Ie.y,s,Bt,Ye.x,Ze.y,Re,tt),lp(j,x.x,x.y,x.z,b.x,b.y,Xe.x,Nt+Xe.y,Ie.x,Ie.y+Ie.h,s,Bt,Ze.x,Ye.y,Re,tt),lp(j,x.x,x.y,x.z,b.x,b.y,Ge.x,Nt+Ge.y,Ie.x+Ie.w,Ie.y+Ie.h,s,Bt,Ye.x,Ye.y,Re,tt),Qm(e.dynamicLayoutVertexArray,x,de),U.emplaceBack(Ut,Ut+1,Ut+2),U.emplaceBack(Ut+1,Ut+2,Ut+3),W.vertexLength+=4,W.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ot[0]),fe!==n.length-1&&or===n[fe+1].sectionIndex||e.programConfigurations.populatePaintArrays(j.length,f,f.index,{},D,R,pe&&pe[or])}e.placedSymbolArray.emplaceBack(x.x,x.y,x.z,b.x,b.y,re,this.glyphOffsetArray.length-re,le,E,C,b.segment,s?s[0]:0,s?s[1]:0,c[0],c[1],y,0,!1,0,M,0)}_commitLayoutVertex(e,n,s,c,h,f,y){e.emplaceBack(n,s,c,h,f,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,n,s,c,h,f,y){const x=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),b=x.vertexLength,E=y.tileAnchorX,C=y.tileAnchorY;for(let D=0;D<4;D++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,c,h,f,E,C,new ce(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,c,h,f,E,C,new ce(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,c,h,f,E,C,new ce(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,c,h,f,E,C,new ce(e.x1,e.y2)),x.vertexLength+=4;const M=s.indexArray;M.emplaceBack(b,b+1),M.emplaceBack(b+1,b+2),M.emplaceBack(b+2,b+3),M.emplaceBack(b+3,b),x.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,s,c,h,f){for(let y=c;y<h;y++){const x=s.get(y),b=this.getSymbolInstanceTextSize(e,f,n,y);this._addCollisionDebugVertices(x,b,this.textCollisionBox,x.projectedAnchorX,x.projectedAnchorY,x.projectedAnchorZ,f)}}_addIconDebugCollisionBoxes(e,n,s,c,h,f){for(let y=c;y<h;y++){const x=s.get(y),b=this.getSymbolInstanceIconSize(e,n,y);this._addCollisionDebugVertices(x,b,this.iconCollisionBox,x.projectedAnchorX,x.projectedAnchorY,x.projectedAnchorZ,f)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new t_(Bd,l0.members,Es),this.iconCollisionBox=new t_(Bd,l0.members,Es);const s=ic(this.iconSizeData,e),c=ic(this.textSizeData,e);for(let h=0;h<this.symbolInstances.length;h++){const f=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(c,e,n,f.textBoxStartIndex,f.textBoxEndIndex,f),this._addTextDebugCollisionBoxes(c,e,n,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,e,n,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,e,n,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}}getSymbolInstanceTextSize(e,n,s,c){const h=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:c),f=tp(this.textSizeData,e,h)/ln;return this.tilePixelRatio*f}getSymbolInstanceIconSize(e,n,s){const c=this.icon.placedSymbolArray.get(s),h=tp(this.iconSizeData,e,c);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(e,n,s){e.emplaceBack(n,-s,-s),e.emplaceBack(n,s,-s),e.emplaceBack(n,s,s),e.emplaceBack(n,-s,s)}_updateTextDebugCollisionBoxes(e,n,s,c,h,f){for(let y=c;y<h;y++){const x=s.get(y),b=this.getSymbolInstanceTextSize(e,f,n,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,x.padding)}}_updateIconDebugCollisionBoxes(e,n,s,c,h){for(let f=c;f<h;f++){const y=s.get(f),x=this.getSymbolInstanceIconSize(e,n,f);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,x,y.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=ic(this.iconSizeData,e),c=ic(this.textSizeData,e);for(let h=0;h<this.symbolInstances.length;h++){const f=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(c,e,n,f.textBoxStartIndex,f.textBoxEndIndex,f),this._updateTextDebugCollisionBoxes(c,e,n,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,e,n,f.iconBoxStartIndex,f.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(s,e,n,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,s,c,h,f,y,x,b){const E={};for(let C=n;C<s;C++){const M=e.get(C);E.textBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},E.textFeatureIndex=M.featureIndex;break}for(let C=c;C<h;C++){const M=e.get(C);E.verticalTextBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},E.verticalTextFeatureIndex=M.featureIndex;break}for(let C=f;C<y;C++){const M=e.get(C);E.iconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},E.iconFeatureIndex=M.featureIndex;break}for(let C=x;C<b;C++){const M=e.get(C);E.verticalIconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},E.verticalIconFeatureIndex=M.featureIndex;break}return E}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const s=e.placedSymbolArray.get(n),c=s.vertexStartIndex+4*s.numGlyphs;for(let h=s.vertexStartIndex;h<c;h+=4)e.indexArray.emplaceBack(h,h+1,h+2),e.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),s=Math.cos(e),c=[],h=[],f=[];for(let y=0;y<this.symbolInstances.length;++y){f.push(y);const x=this.symbolInstances.get(y);c.push(0|Math.round(n*x.tileAnchorX+s*x.tileAnchorY)),h.push(x.featureIndex)}return f.sort((y,x)=>c[y]-c[x]||h[x]-h[y]),f}addToSortKeyRanges(e,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((c,h,f)=>{c>=0&&f.indexOf(c)===h&&this.addIndicesForPlacedSymbol(this.text,c)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}rt("SymbolBucket",As,{omit:["layers","collisionBoxArray","features","compareText"]}),As.MAX_GLYPHS=65535,As.addDynamicAttributes=Qm;const YS=new on({"symbol-placement":new it(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new it(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new it(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pt(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new it(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new it(Ce.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new it(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new it(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new it(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new pt(Ce.layout_symbol["icon-size"]),"icon-text-fit":new it(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new it(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new pt(Ce.layout_symbol["icon-image"]),"icon-rotate":new pt(Ce.layout_symbol["icon-rotate"]),"icon-padding":new it(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new it(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new pt(Ce.layout_symbol["icon-offset"]),"icon-anchor":new pt(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new it(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new it(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new it(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new pt(Ce.layout_symbol["text-field"]),"text-font":new pt(Ce.layout_symbol["text-font"]),"text-size":new pt(Ce.layout_symbol["text-size"]),"text-max-width":new pt(Ce.layout_symbol["text-max-width"]),"text-line-height":new pt(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new pt(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new pt(Ce.layout_symbol["text-justify"]),"text-radial-offset":new pt(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new it(Ce.layout_symbol["text-variable-anchor"]),"text-anchor":new pt(Ce.layout_symbol["text-anchor"]),"text-max-angle":new it(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new it(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new pt(Ce.layout_symbol["text-rotate"]),"text-padding":new it(Ce.layout_symbol["text-padding"]),"text-keep-upright":new it(Ce.layout_symbol["text-keep-upright"]),"text-transform":new pt(Ce.layout_symbol["text-transform"]),"text-offset":new pt(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new it(Ce.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new it(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new it(Ce.layout_symbol["text-optional"])});var r_={paint:new on({"icon-opacity":new pt(Ce.paint_symbol["icon-opacity"]),"icon-color":new pt(Ce.paint_symbol["icon-color"]),"icon-halo-color":new pt(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new pt(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pt(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new it(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new it(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new pt(Ce.paint_symbol["text-opacity"]),"text-color":new pt(Ce.paint_symbol["text-color"],{runtimeType:Ei,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new pt(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new pt(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new pt(Ce.paint_symbol["text-halo-blur"]),"text-translate":new it(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new it(Ce.paint_symbol["text-translate-anchor"])}),layout:YS};class O0{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ao,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}rt("FormatSectionOverride",O0,{omit:["defaultValue"]});class cp extends Zi{constructor(e){super(e,r_)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const c=[];for(const h of s)c.indexOf(h)<0&&c.push(h);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,s,c){const h=this.layout.get(e).evaluate(n,{},s,c),f=this._unevaluatedLayout._values[e];return f.isDataDriven()||_s(f.value)||!h?h:function(y,x){return x.replace(/{([^{}]+)}/g,(b,E)=>E in y?String(y[E]):"")}(n.properties,h)}createBucket(e){return new As(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of r_.paint.overridableProperties){if(!cp.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),s=new O0(n),c=new du(s,n.property.specification);let h=null;h=n.value.kind==="constant"||n.value.kind==="source"?new za("source",c):new pu("composite",c,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new Sn(n.property,h,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&cp.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const s=e.get("text-field"),c=r_.paint.properties[n];let h=!1;const f=y=>{for(const x of y)if(c.overrides&&c.overrides.hasOverride(x))return void(h=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Et)f(s.value.value.sections);else if(s.value.kind==="source"){const y=b=>{h||(b instanceof co&&Pr(b.value)===lo?f(b.value.sections):b instanceof Ci?f(b.sections):b.eachChild(y))},x=s.value;x._styleExpression&&y(x._styleExpression.expression)}return h}getProgramConfiguration(e){return new No(this,e)}}var KS={paint:new on({"background-color":new it(Ce.paint_background["background-color"]),"background-pattern":new Bo(Ce.paint_background["background-pattern"]),"background-opacity":new it(Ce.paint_background["background-opacity"])})},JS={paint:new on({"raster-opacity":new it(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new it(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new it(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new it(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new it(Ce.paint_raster["raster-saturation"]),"raster-contrast":new it(Ce.paint_raster["raster-contrast"]),"raster-resampling":new it(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new it(Ce.paint_raster["raster-fade-duration"])})};class QS extends Zi{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var eE={paint:new on({"sky-type":new it(Ce.paint_sky["sky-type"]),"sky-atmosphere-sun":new it(Ce.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new it(Ce.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new it(Ce.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new it(Ce.paint_sky["sky-gradient-radius"]),"sky-gradient":new _o(Ce.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new it(Ce.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new it(Ce.paint_sky["sky-atmosphere-color"]),"sky-opacity":new it(Ce.paint_sky["sky-opacity"])})};function n_(t,e,n){const s=bt(0,0,1),c=ai(si());return function(h,f,y){y*=.5;var x=f[0],b=f[1],E=f[2],C=f[3],M=Math.sin(y),D=Math.cos(y);h[0]=x*D-E*M,h[1]=b*D+C*M,h[2]=E*D+x*M,h[3]=C*D-b*M}(c,c,n?-Pt(t)+Math.PI:Pt(t)),ll(c,c,-Pt(e)),gt(s,s,c),Gr(s,s)}const tE={circle:class extends Zi{constructor(t){super(t,ST)}createBucket(t){return new Mm(t)}queryRadius(t){const e=t;return tc("circle-radius",this,e)+tc("circle-stroke-width",this,e)+Wd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,s,c,h,f,y){const x=$v(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,t.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Gv(t,s,h,f,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",x,b)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new No(this,t)}},heatmap:class extends Zi{createBucket(t){return new qv(t)}constructor(t){super(t,MT),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Lm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return tc("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,s,c,h,f,y){const x=this.paint.get("heatmap-radius").evaluate(e,n);return Gv(t,s,h,f,y,!0,!0,new ce(0,0),x)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new No(this,t)}},hillshade:class extends Zi{constructor(t){super(t,IT)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new No(this,t)}},fill:class extends Zi{constructor(t){super(t,qT)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new No(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Qd(t)}queryRadius(){return Wd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,s,c,h){return!t.queryGeometry.isAboveHorizon&&Fv(Vv(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,t.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Zi{constructor(t){super(t,nS)}createBucket(t){return new jm(t)}queryRadius(){return Wd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new No(this,t)}queryIntersectsFeature(t,e,n,s,c,h,f,y,x){const b=$v(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,t.pixelToTileUnitsFactor),E=this.paint.get("fill-extrusion-height").evaluate(e,n),C=this.paint.get("fill-extrusion-base").evaluate(e,n),M=[0,0],D=y&&h.elevation,R=h.elevation?h.elevation.exaggeration():1;if(D){const W=t.tile.getBucket(this).centroidVertexArray,re=x+1;if(re<W.length){const le=W.get(re);M[0]=le.a_centroid_pos0,M[1]=le.a_centroid_pos1}}if(M[0]===0&&M[1]===1)return!1;const U=function(W,re,le,de,pe,fe,Ae,Me,Xe){return fe?function(Ge,Ie,Ze,Ye,Re,tt,ot,Bt,or){const Ut=[],Nt=[],$e=[0,0,0,1];for(const Wt of Ge){const Vt=[],Rr=[];for(const Sr of Wt){const Jr=Sr.x+Ye.x,fn=Sr.y+Ye.y,Ht=iS(Jr,fn,Ie,Ze,tt,ot,Bt,or);$e[0]=Jr,$e[1]=fn,$e[2]=Ht.base,$e[3]=1,Hr($e,$e,Re),$e[3]=Math.max($e[3],1e-5);const Rt=i0([$e[0]/$e[3],$e[1]/$e[3],$e[2]/$e[3]]);$e[0]=Jr,$e[1]=fn,$e[2]=Ht.top,$e[3]=1,Hr($e,$e,Re),$e[3]=Math.max($e[3],1e-5);const mr=i0([$e[0]/$e[3],$e[1]/$e[3],$e[2]/$e[3]]);Vt.push(Rt),Rr.push(mr)}Ut.push(Vt),Nt.push(Rr)}return[Ut,Nt]}(W,re,le,de,pe,fe,Ae,Me,Xe):function(Ge,Ie,Ze,Ye,Re){const tt=[],ot=[],Bt=Re[8]*Ie,or=Re[9]*Ie,Ut=Re[10]*Ie,Nt=Re[11]*Ie,$e=Re[8]*Ze,Wt=Re[9]*Ze,Vt=Re[10]*Ze,Rr=Re[11]*Ze;for(const Sr of Ge){const Jr=[],fn=[];for(const Ht of Sr){const Rt=Ht.x+Ye.x,mr=Ht.y+Ye.y,Br=Re[0]*Rt+Re[4]*mr+Re[12],Mr=Re[1]*Rt+Re[5]*mr+Re[13],Nr=Re[2]*Rt+Re[6]*mr+Re[14],cn=Re[3]*Rt+Re[7]*mr+Re[15],Bn=Br+Bt,Fn=Mr+or,fr=Nr+Ut,Qr=Math.max(cn+Nt,1e-5),Ai=Br+$e,sn=Mr+Wt,er=Nr+Vt,en=Math.max(cn+Rr,1e-5),_r=new ce(Bn/Qr,Fn/Qr);_r.z=fr/Qr,Jr.push(_r);const mn=new ce(Ai/en,sn/en);mn.z=er/en,fn.push(mn)}tt.push(Jr),ot.push(fn)}return[tt,ot]}(W,re,le,de,pe)}(s,C,E,b,f,D?y:null,M,R,h.center.lat),j=t.queryGeometry;return function(W,re,le){let de=1/0;Fv(le,re)&&(de=n0(le,re[0]));for(let pe=0;pe<re.length;pe++){const fe=re[pe],Ae=W[pe];for(let Me=0;Me<fe.length-1;Me++){const Xe=fe[Me],Ge=[Xe,fe[Me+1],Ae[Me+1],Ae[Me],Xe];Bv(le,Ge)&&(de=Math.min(de,n0(le,Ge)))}}return de!==1/0&&de}(U[0],U[1],j.isPointQuery()?j.screenBounds:j.screenGeometry)}},line:class extends Zi{constructor(t){super(t,o0),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ba,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=s0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new ep(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new No(this,t)}queryRadius(t){const e=t,n=a0(tc("line-width",this,e),tc("line-gap-width",this,e)),s=tc("line-offset",this,e);return n/2+Math.abs(s)+Wd(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,s,c,h){if(t.queryGeometry.isAboveHorizon)return!1;const f=Vv(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,t.pixelToTileUnitsFactor),y=t.pixelToTileUnitsFactor/2*a0(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),x=this.paint.get("line-offset").evaluate(e,n);return x&&(s=function(b,E){const C=[],M=new ce(0,0);for(let D=0;D<b.length;D++){const R=b[D],U=[];for(let j=0;j<R.length;j++){const W=R[j-1],re=R[j],le=R[j+1],de=j===0?M:re.sub(W)._unit()._perp(),pe=j===R.length-1?M:le.sub(re)._unit()._perp(),fe=de._add(pe)._unit();fe._mult(1/(fe.x*pe.x+fe.y*pe.y)),U.push(fe._mult(E)._add(re))}C.push(U)}return C}(s,x*t.pixelToTileUnitsFactor)),function(b,E,C){for(let M=0;M<E.length;M++){const D=E[M];if(b.length>=3){for(let R=0;R<D.length;R++)if(ec(b,D[R]))return!0}if(xT(b,D,C))return!0}return!1}(f,s,y)}isTileClipped(){return!0}},symbol:cp,background:class extends Zi{constructor(t){super(t,KS)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Zi{constructor(t){super(t,JS)}getProgramIds(){return["raster"]}},sky:class extends Zi{constructor(t){super(t,eE),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Lm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const n=this.paint.get("sky-type");if(n==="atmosphere"){const s=this.paint.get("sky-atmosphere-sun"),c=!s,h=t.style.light,f=h.properties.get("position");return c&&h.properties.get("anchor")==="viewport"&&gr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),c?n_(f.azimuthal,90-f.polar,e):n_(s[0],90-s[1],e)}if(n==="gradient"){const s=this.paint.get("sky-gradient-center");return n_(s[0],90-s[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}}},{HTMLImageElement:R0,HTMLCanvasElement:B0,HTMLVideoElement:F0,ImageData:U0,ImageBitmap:up}=se;class hp{constructor(e,n,s,c){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(n,c)}update(e,n,s){const{width:c,height:h}=e,{context:f}=this,{gl:y}=f;if(y.bindTexture(y.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!n||n.premultiply!==!1)),s||this.size&&this.size[0]===c&&this.size[1]===h){const{x,y:b}=s||{x:0,y:0};e instanceof R0||e instanceof B0||e instanceof F0||e instanceof U0||up&&e instanceof up?y.texSubImage2D(y.TEXTURE_2D,0,x,b,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,x,b,c,h,y.RGBA,y.UNSIGNED_BYTE,e.data)}else this.size=[c,h],e instanceof R0||e instanceof B0||e instanceof F0||e instanceof U0||up&&e instanceof up?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,c,h,0,this.format,y.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,n){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_2D,this.texture),e!==this.filter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,e),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?e===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,n),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class i_{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new ks({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const s=this.getKey(e,n);return this.positions[s]}trim(){const e=this.width,n=this.height=$n(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,s){const c=[];let h=e.length%2==1?-e[e.length-1]*s:0,f=e[0]*s,y=!0;c.push({left:h,right:f,isDash:y,zeroLength:e[0]===0});let x=e[0];for(let b=1;b<e.length;b++){y=!y;const E=e[b];h=x*s,x+=E,f=x*s,c.push({left:h,right:f,isDash:y,zeroLength:E===0})}return c}addRoundDash(e,n,s){const c=n/2;for(let h=-s;h<=s;h++){const f=this.width*(this.nextRow+s+h);let y=0,x=e[y];for(let b=0;b<this.width;b++){b/x.right>1&&(x=e[++y]);const E=Math.abs(b-x.left),C=Math.abs(b-x.right),M=Math.min(E,C);let D;const R=h/s*(c+1);if(x.isDash){const U=c-Math.abs(R);D=Math.sqrt(M*M+U*U)}else D=c-Math.sqrt(M*M+R*R);this.image.data[f+b]=Math.max(0,Math.min(255,D+128))}}}addRegularDash(e,n){for(let x=e.length-1;x>=0;--x){const b=e[x],E=e[x+1];b.zeroLength?e.splice(x,1):E&&E.isDash===b.isDash&&(E.left=b.left,e.splice(x,1))}const s=e[0],c=e[e.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const h=this.width*this.nextRow;let f=0,y=e[f];for(let x=0;x<this.width;x++){x/y.right>1&&(y=e[++f]);const b=Math.abs(x-y.left),E=Math.abs(x-y.right),C=Math.min(b,E);this.image.data[h+x]=Math.max(0,Math.min(255,(y.isDash?C:-C)+n+128))}}addDash(e,n){const s=this.getKey(e,n);if(this.positions[s])return this.positions[s];const c=n==="round",h=c?7:0,f=2*h+1;if(this.nextRow+f>this.height)return gr("LineAtlas out of space"),null;e.length===0&&e.push(1);let y=0;for(let E=0;E<e.length;E++)e[E]<0&&(gr("Negative value is found in line dasharray, replacing values with 0"),e[E]=0),y+=e[E];if(y!==0){const E=this.width/y,C=this.getDashRanges(e,this.width,E);c?this.addRoundDash(C,E,h):this.addRegularDash(C,n==="square"?.5*E:0)}const x=this.nextRow+h;this.nextRow+=f;const b={tl:[x,h],br:[y,0]};return this.positions[s]=b,b}}rt("LineAtlas",i_);class rE{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const nE=se.performance;function N0(t){const e=t?t.url.toString():void 0;return nE.getEntriesByName(e)}class iE{constructor(){this.tasks={},this.taskQueue=[],rs(["process"],this),this.invoker=new rE(this.process),this.nextId=0}add(e,n){const s=this.nextId++,c=function({type:h,isSymbolTile:f,zoom:y}){return y=y||0,h==="message"?0:h!=="maybePrepare"||f?h!=="parseTile"||f?h==="parseTile"&&f?300-y:h==="maybePrepare"&&f?400-y:500:200-y:100-y}(n);if(c===0){xi();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:n,priority:c,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){xi();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let c=0;c<this.taskQueue.length;c++){const h=this.tasks[this.taskQueue[c]];h.priority<n&&(n=h.priority,e=c)}if(e===null)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}function j0(t,e,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class dp{constructor(e,n,s){this.z=e,this.x=n,this.y=s,this.key=Nu(0,e,e,n,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const s=function(h,f,y){var x=j0(256*h,256*(f=Math.pow(2,y)-f-1),y),b=j0(256*(h+1),256*(f+1),y);return x[0]+","+x[1]+","+b[0]+","+b[1]}(this.x,this.y,this.z),c=function(h,f,y){let x,b="";for(let E=h;E>0;E--)x=1<<E-1,b+=(f&x?1:0)+(y&x?2:0);return b}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",c).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class o_{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Nu(e,n.z,n.z,n.x,n.y)}}class Rn{constructor(e,n,s,c,h){this.overscaledZ=e,this.wrap=n,this.canonical=new dp(s,+c,+h),this.key=n===0&&e===s?this.canonical.key:Nu(n,e,s,c,h)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Rn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Rn(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Nu(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return Nu(this.wrap*+n,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Rn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,c=2*this.canonical.y;return[new Rn(n,this.wrap,n,s,c),new Rn(n,this.wrap,n,s+1,c),new Rn(n,this.wrap,n,s,c+1),new Rn(n,this.wrap,n,s+1,c+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Rn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Rn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new o_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Nu(t,e,n,s,c){const h=1<<Math.min(n,22);let f=h*(c%h)+s%h;return t&&n<22&&(f+=h*h*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*f+n)+(e-n)}rt("CanonicalTileID",dp),rt("OverscaledTileID",Rn,{omit:["projMatrix"]});class uc{constructor(e,n,s){this.func=e,this.mask=n,this.range=s}}uc.ReadOnly=!1,uc.ReadWrite=!0,uc.disabled=new uc(519,uc.ReadOnly,[0,1]);const s_=7680;class a_{constructor(e,n,s,c,h,f){this.test=e,this.ref=n,this.mask=s,this.fail=c,this.depthFail=h,this.pass=f}}a_.disabled=new a_({func:519,mask:0},0,0,s_,s_,s_);class vo{constructor(e,n,s){this.blendFunction=e,this.blendColor=n,this.mask=s}}vo.Replace=[1,0],vo.disabled=new vo(vo.Replace,jt.transparent,[!1,!1,!1,!1]),vo.unblended=new vo(vo.Replace,jt.transparent,[!0,!0,!0,!0]),vo.alphaBlended=new vo([1,771],jt.transparent,[!0,!0,!0,!0]);const l_=1029,c_=2305;class Hi{constructor(e,n,s){this.enable=e,this.mode=n,this.frontFace=s}}Hi.disabled=new Hi(!1,l_,c_),Hi.backCCW=new Hi(!0,l_,c_),Hi.backCW=new Hi(!0,l_,2304),Hi.frontCW=new Hi(!0,1028,2304),Hi.frontCCW=new Hi(!0,1028,c_);class V0{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const s=e[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class $0{constructor(e,n,s,c,h){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=s,e._y=c,this.properties=e.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e}}class oE{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,s){const c=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][c]=this.stateChanges[e][c]||{},br(this.stateChanges[e][c],s),this.deletedStates[e]===null){this.deletedStates[e]={};for(const h in this.state[e])h!==c&&(this.deletedStates[e][h]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][c]===null){this.deletedStates[e][c]={};for(const h in this.state[e][c])s[h]||(this.deletedStates[e][c][h]=null)}else for(const h in s)this.deletedStates[e]&&this.deletedStates[e][c]&&this.deletedStates[e][c][h]===null&&delete this.deletedStates[e][c][h]}removeFeatureState(e,n,s){if(this.deletedStates[e]===null)return;const c=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&n!==void 0)this.deletedStates[e][c]!==null&&(this.deletedStates[e][c]=this.deletedStates[e][c]||{},this.deletedStates[e][c][s]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][c])for(s in this.deletedStates[e][c]={},this.stateChanges[e][c])this.deletedStates[e][c][s]=null;else this.deletedStates[e][c]=null;else this.deletedStates[e]=null}getState(e,n){const s=String(n),c=br({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const h=this.deletedStates[e][n];if(h===null)return{};for(const f in h)delete c[f]}return c}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const s={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const h={};for(const f in this.stateChanges[c])this.state[c][f]||(this.state[c][f]={}),br(this.state[c][f],this.stateChanges[c][f]),h[f]=this.state[c][f];s[c]=h}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const h={};if(this.deletedStates[c]===null)for(const f in this.state[c])h[f]={},this.state[c][f]={};else for(const f in this.deletedStates[c]){if(this.deletedStates[c][f]===null)this.state[c][f]={};else for(const y of Object.keys(this.deletedStates[c][f]))delete this.state[c][f][y];h[f]=this.state[c][f]}s[c]=s[c]||{},br(s[c],h)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(const c in e)e[c].setFeatureState(s,n)}}class G0{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const s=this.toIdx(e,n);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function Z0(t,e,n,s){let c=0,h=Number.MAX_VALUE;for(let f=0;f<3;f++)if(Math.abs(s[f])<1e-15){if(n[f]<t[f]||n[f]>e[f])return null}else{const y=1/s[f];let x=(t[f]-n[f])*y,b=(e[f]-n[f])*y;if(x>b){const E=x;x=b,b=E}if(x>c&&(c=x),b<h&&(h=b),c>h)return null}return c}function q0(t,e,n,s,c,h,f,y,x,b,E){const C=s-t,M=c-e,D=h-n,R=f-t,U=y-e,j=x-n,W=E[1]*j-E[2]*U,re=E[2]*R-E[0]*j,le=E[0]*U-E[1]*R,de=C*W+M*re+D*le;if(Math.abs(de)<1e-15)return null;const pe=1/de,fe=b[0]-t,Ae=b[1]-e,Me=b[2]-n,Xe=(fe*W+Ae*re+Me*le)*pe;if(Xe<0||Xe>1)return null;const Ge=Ae*D-Me*M,Ie=Me*C-fe*D,Ze=fe*M-Ae*C,Ye=(E[0]*Ge+E[1]*Ie+E[2]*Ze)*pe;return Ye<0||Xe+Ye>1?null:(R*Ge+U*Ie+j*Ze)*pe}function W0(t,e,n){return(t-e)/(n-e)}function H0(t,e,n,s,c,h,f,y,x){const b=1<<n,E=h-s,C=f-c,M=(t+1)/b*E+s,D=(e+0)/b*C+c,R=(e+1)/b*C+c;y[0]=(t+0)/b*E+s,y[1]=D,x[0]=M,x[1]=R}class X0{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(h){const f=Math.ceil(Math.log2(h.dim/8)),y=[];let x=Math.ceil(Math.pow(2,f));const b=1/x,E=(D,R,U,j,W)=>{const re=j?1:0,le=(D+1)*U-re,de=R*U,pe=(R+1)*U-re;W[0]=D*U,W[1]=de,W[2]=le,W[3]=pe};let C=new G0(x);const M=[];for(let D=0;D<x*x;D++){E(D%x,Math.floor(D/x),b,!1,M);const R=zs(M[0],M[1],h),U=zs(M[2],M[1],h),j=zs(M[2],M[3],h),W=zs(M[0],M[3],h);C.minimums.push(Math.min(R,U,j,W)),C.maximums.push(Math.max(R,U,j,W)),C.leaves.push(1)}for(y.push(C),x/=2;x>=1;x/=2){const D=y[y.length-1];C=new G0(x);for(let R=0;R<x*x;R++){E(R%x,Math.floor(R/x),2,!0,M);const U=D.getElevation(M[0],M[1]),j=D.getElevation(M[2],M[1]),W=D.getElevation(M[2],M[3]),re=D.getElevation(M[0],M[3]),le=D.isLeaf(M[0],M[1]),de=D.isLeaf(M[2],M[1]),pe=D.isLeaf(M[2],M[3]),fe=D.isLeaf(M[0],M[3]),Ae=Math.min(U.min,j.min,W.min,re.min),Me=Math.max(U.max,j.max,W.max,re.max),Xe=le&&de&&pe&&fe;C.maximums.push(Me),C.minimums.push(Ae),C.leaves.push(Me-Ae<=5&&Xe?1:0)}y.push(C)}return y}(this.dem),s=n.length-1,c=n[s];this._addNode(c.minimums[0],c.maximums[0],c.leaves[0]),this._construct(n,0,0,s,0)}raycastRoot(e,n,s,c,h,f,y=1){return Z0([e,n,-100],[s,c,this.maximums[0]*y],h,f)}raycast(e,n,s,c,h,f,y=1){if(!this.nodeCount)return null;const x=this.raycastRoot(e,n,s,c,h,f,y);if(x==null)return null;const b=[],E=[],C=[],M=[],D=[{idx:0,t:x,nodex:0,nodey:0,depth:0}];for(;D.length>0;){const{idx:R,t:U,nodex:j,nodey:W,depth:re}=D.pop();if(this.leaves[R]){H0(j,W,re,e,n,s,c,C,M);const de=1<<re,pe=(j+0)/de,fe=(j+1)/de,Ae=(W+0)/de,Me=(W+1)/de,Xe=zs(pe,Ae,this.dem)*y,Ge=zs(fe,Ae,this.dem)*y,Ie=zs(fe,Me,this.dem)*y,Ze=zs(pe,Me,this.dem)*y,Ye=q0(C[0],C[1],Xe,M[0],C[1],Ge,M[0],M[1],Ie,h,f),Re=q0(M[0],M[1],Ie,C[0],M[1],Ze,C[0],C[1],Xe,h,f),tt=Math.min(Ye!==null?Ye:Number.MAX_VALUE,Re!==null?Re:Number.MAX_VALUE);if(tt!==Number.MAX_VALUE)return tt;{const ot=wr([],h,f,U);if(Y0(Xe,Ge,Ze,Ie,W0(ot[0],C[0],M[0]),W0(ot[1],C[1],M[1]))>=ot[2])return U}continue}let le=0;for(let de=0;de<this._siblingOffset.length;de++){H0((j<<1)+this._siblingOffset[de][0],(W<<1)+this._siblingOffset[de][1],re+1,e,n,s,c,C,M),C[2]=-100,M[2]=this.maximums[this.childOffsets[R]+de]*y;const pe=Z0(C,M,h,f);if(pe!=null){const fe=pe;b[de]=fe;let Ae=!1;for(let Me=0;Me<le&&!Ae;Me++)fe>=b[E[Me]]&&(E.splice(Me,0,de),Ae=!0);Ae||(E[le]=de),le++}}for(let de=0;de<le;de++){const pe=E[de];D.push({idx:this.childOffsets[R]+pe,t:b[pe],nodex:(j<<1)+this._siblingOffset[pe][0],nodey:(W<<1)+this._siblingOffset[pe][1],depth:re+1})}}return null}_addNode(e,n,s){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,s,c,h){if(e[c].isLeaf(n,s)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const f=c-1,y=e[f];let x,b=0;for(let E=0;E<this._siblingOffset.length;E++){const C=2*n+this._siblingOffset[E][0],M=2*s+this._siblingOffset[E][1],D=y.getElevation(C,M),R=y.isLeaf(C,M),U=this._addNode(D.min,D.max,R);R&&(b|=1<<E),x||(x=U)}for(let E=0;E<this._siblingOffset.length;E++)b&1<<E||this._construct(e,2*n+this._siblingOffset[E][0],2*s+this._siblingOffset[E][1],f,x+E)}}function Y0(t,e,n,s,c,h){return Xt(Xt(t,n,h),Xt(e,s,h),c)}function zs(t,e,n){const s=n.dim,c=Kt(t*s-.5,0,s-1),h=Kt(e*s-.5,0,s-1),f=Math.floor(c),y=Math.floor(h),x=Math.min(f+1,s-1),b=Math.min(y+1,s-1);return Y0(n.get(f,y),n.get(x,y),n.get(f,b),n.get(x,b),c-f,h-y)}const K0={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class pp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,s,c=!1,h=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return gr(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const f=this.dim=n.height-2;if(this.data=new Uint32Array(n.data.buffer),this.encoding=s||"mapbox",this.borderReady=c,!c){for(let y=0;y<f;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(f,y)]=this.data[this._idx(f-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,f)]=this.data[this._idx(y,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)],h&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new X0(this)}get(e,n,s=!1){const c=new Uint8Array(this.data.buffer);s&&(e=Kt(e,-1,this.dim),n=Kt(n,-1,this.dim));const h=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(c[h],c[h+1],c[h+2])}static getUnpackVector(e){return K0[e]}get unpackVector(){return K0[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,s){return(256*e*256+256*n+s)/10-1e4}_unpackTerrarium(e,n,s){return 256*e+n+s/256-32768}static pack(e,n){const s=[0,0,0,0],c=pp.getUnpackVector(n);let h=Math.floor((e+c[3])/c[2]);return s[2]=h%256,h=Math.floor(h/256),s[1]=h%256,h=Math.floor(h/256),s[0]=h,s}getPixels(){return new mi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let c=n*this.dim,h=n*this.dim+this.dim,f=s*this.dim,y=s*this.dim+this.dim;switch(n){case-1:c=h-1;break;case 1:h=c+1}switch(s){case-1:f=y-1;break;case 1:y=f+1}const x=-n*this.dim,b=-s*this.dim;for(let E=f;E<y;E++)for(let C=c;C<h;C++)this.data[this._idx(C,E)]=e.data[this._idx(C+x,E+b)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}rt("DEMData",pp),rt("DemMinMaxQuadTree",X0,{omit:["dem"]});class sE{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,s){const c=e.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const h={value:n,timeout:void 0};if(s!==void 0&&(h.timeout=setTimeout(()=>{this.remove(e,h)},s)),this.data[c].push(h),this.order.push(c),this.order.length>this.max){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const s=e.wrapped().key,c=n===void 0?0:this.data[s].indexOf(n),h=this.data[s][c];return this.data[s].splice(c,1),h.timeout&&clearTimeout(h.timeout),this.data[s].length===0&&delete this.data[s],this.onRemove(h.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const s in this.data)for(const c of this.data[s])e(c.value)||n.push(c);for(const s of n)this.remove(s.value.tileID,s)}}class $a extends oo{constructor(e,n,s){super(),this.id=e,this._onlySymbols=s,n.on("data",c=>{c.dataType==="source"&&c.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&c.dataType==="source"&&c.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new sE(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=null,this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new oE}onAdd(e){this.map=e,this._minTileCacheSize=e?e._minTileCacheSize:null,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const s=this._tiles[n];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return ts(this._tiles).map(e=>e.tileID).sort(J0).map(e=>e.key)}getRenderableIds(e){const n=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&n.push(this._tiles[s]);return e?n.sort((s,c)=>{const h=s.tileID,f=c.tileID,y=new ce(h.canonical.x,h.canonical.y)._rotate(this.transform.angle),x=new ce(f.canonical.x,f.canonical.y)._rotate(this.transform.angle);return h.overscaledZ-f.overscaledZ||x.y-y.y||x.x-y.x}).map(s=>s.tileID.key):n.map(s=>s.tileID).sort(J0).map(s=>s.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const s=this._tiles[e];s&&(s.state!=="loading"&&(s.state=n),this._loadTile(s,this._tileLoaded.bind(this,s,e,n)))}_tileLoaded(e,n,s,c){if(c)if(e.state="errored",c.status!==404)this._source.fire(new _l(c,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const h=this.map.painter.terrain;this.update(this.transform,h.getScaledDemTileSize(),!0),h.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Pn.now(),s==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new io("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let c=0;c<n.length;c++){const h=n[c];if(e.neighboringTiles&&e.neighboringTiles[h]){const f=this.getTileByID(h);s(e,f),s(f,e)}}function s(c,h){if(!c.dem||c.dem.borderReady)return;c.needsHillshadePrepare=!0,c.needsDEMTextureUpload=!0;let f=h.tileID.canonical.x-c.tileID.canonical.x;const y=h.tileID.canonical.y-c.tileID.canonical.y,x=Math.pow(2,c.tileID.canonical.z),b=h.tileID.key;f===0&&y===0||Math.abs(y)>1||(Math.abs(f)>1&&(Math.abs(f+x)===1?f+=x:Math.abs(f-x)===1&&(f-=x)),h.dem&&c.dem&&(c.dem.backfillBorder(h.dem,f,y),c.neighboringTiles&&c.neighboringTiles[b]&&(c.neighboringTiles[b].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,s,c){for(const h in this._tiles){let f=this._tiles[h];if(c[h]||!f.hasData()||f.tileID.overscaledZ<=n||f.tileID.overscaledZ>s)continue;let y=f.tileID;for(;f&&f.tileID.overscaledZ>n+1;){const b=f.tileID.scaledTo(f.tileID.overscaledZ-1);f=this._tiles[b.key],f&&f.hasData()&&(y=b)}let x=y;for(;x.overscaledZ>n;)if(x=x.scaledTo(x.overscaledZ-1),e[x.key]){c[y.key]=y;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=n?s:null}for(let s=e.overscaledZ-1;s>=n;s--){const c=e.scaledTo(s),h=this._getLoadedTile(c);if(h)return h}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const s=Math.ceil(e.width/n)+1,c=Math.ceil(e.height/n)+1,h=Math.floor(s*c*5),f=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,h):h,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const s={};for(const c in this._tiles){const h=this._tiles[c];h.tileID=h.tileID.unwrapTo(h.tileID.wrap+n),s[h.tileID.key]=h}this._tiles=s;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(+c,this._tiles[c])}}update(e,n,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let c;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Rn(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(c=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(c=c.filter(y=>this._source.hasTile(y)))):c=[];const h=this._updateRetainedTiles(c);if(Q0(this._source.type)&&c.length!==0){const y={},x={},b=Object.keys(h);for(const C of b){const M=h[C],D=this._tiles[C];if(!D||D.fadeEndTime&&D.fadeEndTime<=Pn.now())continue;const R=this.findLoadedParent(M,Math.max(M.overscaledZ-$a.maxOverzooming,this._source.minzoom));R&&(this._addTile(R.tileID),y[R.tileID.key]=R.tileID),x[C]=M}const E=c[c.length-1].overscaledZ;for(const C in this._tiles){const M=this._tiles[C];if(h[C]||!M.hasData())continue;let D=M.tileID;for(;D.overscaledZ>E;){D=D.scaledTo(D.overscaledZ-1);const R=this._tiles[D.key];if(R&&R.hasData()&&x[D.key]){h[C]=M.tileID;break}}}for(const C in y)h[C]||(this._coveredTiles[C]=!0,h[C]=y[C])}for(const y in h)this._tiles[y].clearFadeHold();const f=function(y,x){const b=[];for(const E in y)E in x||b.push(E);return b}(this._tiles,h);for(const y of f){const x=this._tiles[y];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const s={},c=e.reduce((b,E)=>Math.min(b,E.overscaledZ),1/0),h=e[0].overscaledZ,f=Math.max(h-$a.maxOverzooming,this._source.minzoom),y=Math.max(h+$a.maxUnderzooming,this._source.minzoom),x={};for(const b of e){const E=this._addTile(b);n[b.key]=b,E.hasData()||c<this._source.maxzoom&&(x[b.key]=b)}this._retainLoadedChildren(x,c,y,n);for(const b of e){let E=this._tiles[b.key];if(E.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const M=b.children(this._source.maxzoom)[0],D=this.getTile(M);if(D&&D.hasData()){n[M.key]=M;continue}}else{const M=b.children(this._source.maxzoom);if(n[M[0].key]&&n[M[1].key]&&n[M[2].key]&&n[M[3].key])continue}let C=E.wasRequested();for(let M=b.overscaledZ-1;M>=f;--M){const D=b.scaledTo(M);if(s[D.key]||(s[D.key]=!0,E=this.getTile(D),!E&&C&&(E=this._addTile(D)),E&&(n[D.key]=D,C=E.wasRequested(),E.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let s,c=this._tiles[e].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){s=this._loadedParentTiles[c.key];break}n.push(c.key);const h=c.scaledTo(c.overscaledZ-1);if(s=this._getLoadedTile(h),s)break;c=h}for(const h of n)this._loadedParentTiles[h]=s}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const s=Boolean(n);if(!s){const c=this.map?this.map.painter:null,h=this._source.type==="raster"||this._source.type==="raster-dem";n=new h_(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,c,h),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,s||this._source.fire(new io("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=n.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(e,n,s){const c=[],h=this.transform;if(!h)return c;for(const f in this._tiles){const y=this._tiles[f];if(s&&y.clearQueryDebugViz(),y.holdingForFade())continue;const x=e.containsTile(y,h,n);x&&c.push(x)}return c}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of n)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(Q0(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=Pn.now())return!0}return!1}setFeatureState(e,n,s){this._state.updateState(e=e||"_geojsonTileLayer",n,s)}removeFeatureState(e,n,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,s)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,s){const c=this._tiles[e];c&&c.setDependencies(n,s)}reloadTilesForDependencies(e,n){for(const s in this._tiles)this._tiles[s].hasDependency(e,n)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,n))}_preloadTiles(e,n){const s=new Map,c=Array.isArray(e)?e:[e],h=this.map.painter.terrain,f=this.usedForTerrain&&h?h.getScaledDemTileSize():this._source.tileSize;for(const b of c){const E=b.coveringTiles({tileSize:f,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of E)s.set(C.key,C);this.usedForTerrain&&b.updateElevation(!1)}const y=Array.from(s.values()),x=this._source.type==="raster"||this._source.type==="raster-dem";zo(y,(b,E)=>{const C=new h_(b,this._source.tileSize*b.overscaleFactor(),this.transform.tileZoom,this.map.painter,x);this._loadTile(C,M=>{this._source.type==="raster-dem"&&C.dem&&this._backfillDEM(C),E(M,C)})},n)}}function J0(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||s-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Q0(t){return t==="raster"||t==="image"||t==="video"}$a.maxOverzooming=10,$a.maxUnderzooming=3;class fp{constructor(e,n,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=s}static create(e,n,s){const c=s||e.findDEMTileFor(n);if(!c||!c.dem)return;const h=c.dem,f=c.tileID,y=1<<n.canonical.z-f.canonical.z;return new fp(c,c.tileSize/Dt/y,[(n.canonical.x/y-f.canonical.x)*h.dim,(n.canonical.y/y-f.canonical.y)*h.dim])}tileCoordToPixel(e,n){const s=n*this._scale+this._offset[1],c=Math.floor(e*this._scale+this._offset[0]),h=Math.floor(s);return new ce(c,h)}getElevationAt(e,n,s,c){const h=e*this._scale+this._offset[0],f=n*this._scale+this._offset[1],y=Math.floor(h),x=Math.floor(f),b=this._dem;return c=!!c,s?Xt(Xt(b.get(y,x,c),b.get(y,x+1,c),f-x),Xt(b.get(y+1,x,c),b.get(y+1,x+1,c),f-x),h-y):b.get(y,x,c)}getElevationAtPixel(e,n,s){return this._dem.get(e,n,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*qi(1,e)*this._dem.stride}}class ex{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new La(Dt,16,0),this.featureIndexArray=new Sv,this.promoteId=n}insert(e,n,s,c,h,f=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,c,h,f);const x=this.grid;for(let b=0;b<n.length;b++){const E=n[b],C=[1/0,1/0,-1/0,-1/0];for(let M=0;M<E.length;M++){const D=E[M];C[0]=Math.min(C[0],D.x),C[1]=Math.min(C[1],D.y),C[2]=Math.max(C[2],D.x),C[3]=Math.max(C[3],D.y)}C[0]<Dt&&C[1]<Dt&&C[2]>=0&&C[3]>=0&&x.insert(y,C[0],C[1],C[2],C[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Va.VectorTile(new Bu(this.rawTileData)).layers,this.sourceLayerCoder=new V0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,s,c){this.loadVTLayers();const h=e.params||{},f=Gl(h.filter),y=e.tileResult,x=e.transform,b=y.bufferedTilespaceBounds,E=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(R,U,j,W)=>jv(y.bufferedTilespaceGeometry,R,U,j,W));E.sort(aE);let C=null;x.elevation&&E.length>0&&(C=fp.create(x.elevation,this.tileID));const M={};let D;for(let R=0;R<E.length;R++){const U=E[R];if(U===D)continue;D=U;const j=this.featureIndexArray.get(U);let W=null;this.loadMatchingFeature(M,j,f,h.layers,h.availableImages,n,s,c,(re,le,de,pe=0)=>(W||(W=Vo(re,this.tileID.canonical,e.tileTransform)),le.queryIntersectsFeature(y,re,de,W,this.z,e.transform,e.pixelPosMatrix,C,pe)))}return M}loadMatchingFeature(e,n,s,c,h,f,y,x,b){const{featureIndex:E,bucketIndex:C,sourceLayerIndex:M,layoutVertexArrayOffset:D}=n,R=this.bucketLayerIDs[C];if(c&&!function(re,le){for(let de=0;de<re.length;de++)if(le.indexOf(re[de])>=0)return!0;return!1}(c,R))return;const U=this.sourceLayerCoder.decode(M),j=this.vtLayers[U].feature(E);if(s.needGeometry){const re=ja(j,!0);if(!s.filter(new wt(this.tileID.overscaledZ),re,this.tileID.canonical))return}else if(!s.filter(new wt(this.tileID.overscaledZ),j))return;const W=this.getId(j,U);for(let re=0;re<R.length;re++){const le=R[re];if(c&&c.indexOf(le)<0)continue;const de=f[le];if(!de)continue;let pe={};W!==void 0&&x&&(pe=x.getState(de.sourceLayer||"_geojsonTileLayer",W));const fe=br({},y[le]);fe.paint=tx(fe.paint,de.paint,j,pe,h),fe.layout=tx(fe.layout,de.layout,j,pe,h);const Ae=!b||b(j,de,pe,D);if(!Ae)continue;const Me=new $0(j,this.z,this.x,this.y,W);Me.layer=fe;let Xe=e[le];Xe===void 0&&(Xe=e[le]=[]),Xe.push({featureIndex:E,feature:Me,intersectionZ:Ae})}}lookupSymbolFeatures(e,n,s,c,h,f,y,x){const b={};this.loadVTLayers();const E=Gl(h);for(const C of e)this.loadMatchingFeature(b,{bucketIndex:s,sourceLayerIndex:c,featureIndex:C,layoutVertexArrayOffset:0},E,f,y,x,n);return b}loadFeature(e){const{featureIndex:n,sourceLayerIndex:s}=e;this.loadVTLayers();const c=this.sourceLayerCoder.decode(s),h=this.vtFeatures[c];if(h[n])return h[n];const f=this.vtLayers[c].feature(n);return h[n]=f,f}hasLayer(e){for(const n of this.bucketLayerIDs)for(const s of n)if(e===s)return!0;return!1}getId(e,n){let s=e.id;return this.promoteId&&(s=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof s=="boolean"&&(s=Number(s))),s}}function tx(t,e,n,s,c){return to(t,(h,f)=>{const y=e instanceof Ro?e.get(f):null;return y&&y.evaluate?y.evaluate(n,s,c):y})}function aE(t,e){return e-t}rt("FeatureIndex",ex,{omit:["rawTileData","sourceLayerCoder"]});var lE=vr([{name:"a_pos",type:"Int16",components:2}]);const Ii=32,xo=33,Ps=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,s=0,c=0,h=0,f=0,y=0;for(1&e?c=h=f=Ii:n=s=y=Ii;(e>>=1)>1;){const b=n+c>>1,E=s+h>>1;1&e?(c=n,h=s,n=f,s=y):(n=c,s=h,c=f,h=y),f=b,y=E}const x=4*t;Ps[x+0]=n,Ps[x+1]=s,Ps[x+2]=c,Ps[x+3]=h}const wo=new Uint16Array(2178),Ds=new Uint8Array(1089),mp=new Uint16Array(1089);function rx(t){return t===0?-.03125:t===32?.03125:0}var u_=vr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const nx={type:2,extent:Dt,loadGeometry:()=>[[new ce(0,0),new ce(8193,0),new ce(8193,8193),new ce(0,8193),new ce(0,0)]]};class h_{constructor(e,n,s,c,h){this.tileID=e,this.uid=la(),this.uses=0,this.tileSize=n,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=h,this.expiredRequestCount=0,this.state="loading",c&&c.transform&&(this.projection=c.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<Pn.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=hc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(c,h){const f={};if(!h)return f;for(const y of c){const x=y.layerIds.map(b=>h.getLayer(b)).filter(Boolean);if(x.length!==0){y.layers=x,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(b=>x.filter(E=>E.id===b)[0]));for(const b of x)f[b.id]=y}}return f}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const h=this.buckets[c];if(h instanceof As){if(this.hasSymbolBuckets=!0,!s)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const h=this.buckets[c];if(h instanceof As&&h.hasRTLText){this.hasRTLText=!0,Ft.isLoading()||Ft.isLoaded()||Yn()!=="deferred"||pi();break}}this.queryPadding=0;for(const c in this.buckets){const h=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(c).queryRadius(h))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Tm}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.globeGridBuffer&&(this.globeGridBuffer.destroy(),this.globeGridBuffer=null),this.globePoleBuffer&&(this.globePoleBuffer.destroy(),this.globePoleBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const c=this.buckets[s];c.uploadPending()&&c.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hp(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hp(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new hp(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,s,c,h,f,y,x){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:c,pixelPosMatrix:y,transform:f,params:h,tileTransform:this.tileTransform},e,n,s):{}}querySourceFeatures(e,n){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const c=s.loadVTLayers(),h=n?n.sourceLayer:"",f=c._geojsonTileLayer||c[h];if(!f)return;const y=Gl(n&&n.filter),{z:x,x:b,y:E}=this.tileID.canonical,C={z:x,x:b,y:E};for(let M=0;M<f.length;M++){const D=f.feature(M);if(y.needGeometry){const j=ja(D,!0);if(!y.filter(new wt(this.tileID.overscaledZ),j,this.tileID.canonical))continue}else if(!y.filter(new wt(this.tileID.overscaledZ),D))continue;const R=s.getId(D,h),U=new $0(D,x,b,E,R);U.tile=C,e.push(U)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const s=ss(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let c=!1;if(this.expirationTime>s)c=!1;else if(n)if(this.expirationTime<n)c=!0;else{const h=this.expirationTime-n;h?this.expirationTime=s+Math.max(h,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const s=this.latestFeatureIndex.loadVTLayers(),c=n.style.listImages();for(const h in this.buckets){if(!n.style.hasLayer(h))continue;const f=this.buckets[h],y=f.layers[0].sourceLayer||"_geojsonTileLayer",x=s[y],b=e[y];if(!x||!b||Object.keys(b).length===0)continue;if(f.update(b,x,c,this.imageAtlas&&this.imageAtlas.patternPositions||{}),f instanceof ep||f instanceof Qd){const C=n.style._getSourceCache(f.layers[0].source);n._terrain&&n._terrain.enabled&&C&&f.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(C.id,this.tileID)}const E=n&&n.style&&n.style.getLayer(h);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(f)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Pn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Pn.now()+e}setDependencies(e,n){const s={};for(const c of n)s[c]=!0;this.dependencies[e]=s}hasDependency(e,n){for(const s of e){const c=this.dependencies[s];if(c){for(const h of n)if(c[h])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const s=Vo(nx,this.tileID.canonical,this.tileTransform)[0],c=new Hl,h=new Ud;for(let f=0;f<s.length;f++){const{x:y,y:x}=s[f];c.emplaceBack(y,x),h.emplaceBack(f)}h.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(h),this._tileDebugBuffer=e.createVertexBuffer(c,u_.members),this._tileDebugSegments=Lr.simpleSegment(0,0,c.length,h.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const s=Vo(nx,this.tileID.canonical,this.tileTransform)[0];let c,h;if(this.isRaster){const f=function(y,x){const b=hc(y,x),E=Math.pow(2,y.z);for(let j=0;j<xo;j++)for(let W=0;W<xo;W++){const re=jo((y.x+(W+rx(W))/Ii)/E),le=Mi((y.y+(j+rx(j))/Ii)/E),de=x.project(re,le),pe=j*xo+W;wo[2*pe+0]=Math.round((de.x*b.scale-b.x)*Dt),wo[2*pe+1]=Math.round((de.y*b.scale-b.y)*Dt)}Ds.fill(0),mp.fill(0);for(let j=2045;j>=0;j--){const W=4*j,re=Ps[W+0],le=Ps[W+1],de=Ps[W+2],pe=Ps[W+3],fe=re+de>>1,Ae=le+pe>>1,Me=fe+Ae-le,Xe=Ae+re-fe,Ge=le*xo+re,Ie=pe*xo+de,Ze=Ae*xo+fe,Ye=Math.hypot((wo[2*Ge+0]+wo[2*Ie+0])/2-wo[2*Ze+0],(wo[2*Ge+1]+wo[2*Ie+1])/2-wo[2*Ze+1])>=16;if(Ds[Ze]=Ds[Ze]||(Ye?1:0),j<1022){const Re=(le+Xe>>1)*xo+(re+Me>>1),tt=(pe+Xe>>1)*xo+(de+Me>>1);Ds[Ze]=Ds[Ze]||Ds[Re]||Ds[tt]}}const C=new Xl,M=new fi;let D=0;function R(j,W){const re=W*xo+j;return mp[re]===0&&(C.emplaceBack(wo[2*re+0],wo[2*re+1],j*Dt/Ii,W*Dt/Ii),mp[re]=++D),mp[re]-1}function U(j,W,re,le,de,pe){const fe=j+re>>1,Ae=W+le>>1;if(Math.abs(j-de)+Math.abs(W-pe)>1&&Ds[Ae*xo+fe])U(de,pe,j,W,fe,Ae),U(re,le,de,pe,fe,Ae);else{const Me=R(j,W),Xe=R(re,le),Ge=R(de,pe);M.emplaceBack(Me,Xe,Ge)}}return U(0,0,Ii,Ii,Ii,0),U(Ii,Ii,0,0,0,Ii),{vertices:C,indices:M}}(this.tileID.canonical,n);c=f.vertices,h=f.indices}else{c=new Xl,h=new fi;for(const{x:y,y:x}of s)c.emplaceBack(y,x,0,0);const f=Hd(c.int16,void 0,4);for(let y=0;y<f.length;y+=3)h.emplaceBack(f[y],f[y+1],f[y+2])}this._tileBoundsBuffer=e.createVertexBuffer(c,u_.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(h),this._tileBoundsSegments=Lr.simpleSegment(0,0,c.length,h.length)}}const cE=vr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),uE=vr([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ix}=cE;function Ga(t,e){const n=t.fovAboveCenter,s=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,c=(t._camera.position[2]*t.worldSize-s)/Math.cos(t._pitch),h=Math.sin(n)*c/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),f=Math.sin(t._pitch)*h+c;return Math.min(1.01*f,c*(1/t._horizonShift))}const d_=Dt/Math.PI/2,Kn=-d_,Jn=d_,hE=[new Wi([Kn,Kn,Kn],[Jn,Jn,Jn]),new Wi([Kn,Kn,Kn],[0,0,Jn]),new Wi([0,Kn,Kn],[Jn,0,Jn]),new Wi([Kn,0,Kn],[0,Jn,Jn]),new Wi([0,0,Kn],[Jn,Jn,Jn])];function _p(t){if(t.z<=1)return hE[t.z+2*t.y+t.x];const[e,n]=ox(t),s=[gp(e[0],e[1]),gp(e[0],n[1]),gp(n[0],e[1]),gp(n[0],n[1])],c=[Jn,Jn,Jn],h=[Kn,Kn,Kn];for(const f of s)c[0]=Math.min(c[0],f[0]),c[1]=Math.min(c[1],f[1]),c[2]=Math.min(c[2],f[2]),h[0]=Math.max(h[0],f[0]),h[1]=Math.max(h[1],f[1]),h[2]=Math.max(h[2],f[2]);return new Wi(c,h)}function ox(t){const e=Math.pow(2,t.z),n=t.x/e,s=(t.x+1)/e,c=(t.y+1)/e;return[[Mi(t.y/e),jo(n)],[Mi(c),jo(s)]]}function p_(t,e,n,s){return n=Pt(n),s||(s=d_),[t*Math.sin(n)*s,-e*s,t*Math.cos(n)*s]}function gp(t,e,n){return p_(Math.cos(Pt(t)),Math.sin(Pt(t)),e,n)}function sx(t){return 16383/Math.max(...$t([],t.max,t.min))}function ax(t){const e=Y(new Float64Array(16)),n=1/sx(t);return ge(e,e,t.min),we(e,e,[n,n,n]),e}function lx(t,e,n){const s=e/(2*Math.PI),c=function(f){const y=Dt/(2*Math.PI);return f/(2*Math.PI)/y}(e);if(!n){const f=Kt(t.center.lat,-85.051129,go);n=[Jl(t.center.lng)*e,Ql(f)*e]}const h=Y(new Float64Array(16));return ge(h,h,[n[0],n[1],-s]),we(h,h,[c,c,c]),He(h,h,Pt(-t._center.lat)),Ee(h,h,Pt(-t._center.lng)),h}class f_{constructor(e){const n=this._createGridIndices();this.gridIndexBuffer=e.createIndexBuffer(n,!0),this.gridSegments=Lr.simpleSegment(0,0,4225,8192);const s=this._createPoleTriangleIndices();this.poleIndexBuffer=e.createIndexBuffer(s,!0),this.poleSegments=Lr.simpleSegment(0,0,66,64);const c=new ku;c.emplaceBack(-1,1,1,0,0,0,0),c.emplaceBack(1,1,1,0,0,1,0),c.emplaceBack(1,-1,1,0,0,1,1),c.emplaceBack(-1,-1,1,0,0,0,1);const h=new fi;h.emplaceBack(0,1,2),h.emplaceBack(2,3,0),this.atmosphereVertexBuffer=e.createVertexBuffer(c,uE.members),this.atmosphereIndexBuffer=e.createIndexBuffer(h),this.atmosphereSegments=Lr.simpleSegment(0,0,4,2)}destroy(){this.poleIndexBuffer.destroy(),this.gridIndexBuffer.destroy(),this.poleSegments.destroy(),this.gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this.wireframeIndexBuffer&&(this.wireframeIndexBuffer.destroy(),this.wireframeSegments.destroy())}static createPoleTriangleVertices(e,n,s){const c=new ku,h=n/Math.PI/2;c.emplaceBack(0,-h,0,0,0,.5,s?0:1);const f=360/e,y=Math.cos(Pt(85)),x=Math.sin(Pt(85));for(let E=0;E<=64;E++){const C=E/64,M=p_(y,x,0*(1-(b=C))+f*b,h);c.emplaceBack(M[0],M[1],M[2],0,0,C,s?0:1)}var b;return c}_createPoleTriangleIndices(){const e=new fi;for(let n=0;n<=64;n++)e.emplaceBack(0,n+1,n+2);return e}static createGridVertices(e){const n=Math.pow(2,e.z),s=(x,b,E)=>x*(1-E)+b*E,[c,h]=ox(e),f=new ku,y=function(x){const b=Y(new Float64Array(16)),E=sx(x);var C,M;return we(b,b,[E,E,E]),ge(b,b,((C=[])[0]=-(M=x.min)[0],C[1]=-M[1],C[2]=-M[2],C)),b}(_p(e));f.reserve(4096);for(let x=0;x<65;x++){const b=s(c[0],h[0],x/64),E=Ql(b),C=E*n-e.y,M=Math.sin(Pt(b)),D=Math.cos(Pt(b));for(let R=0;R<65;R++){const U=R/64,j=s(c[1],h[1],U),W=p_(D,M,j);je(W,W,y);const re=Jl(j);f.emplaceBack(W[0],W[1],W[2],re,E,U,C)}}return f}_createGridIndices(){const e=new fi,n=(s,c)=>{const h=65*c+s;e.emplaceBack(h+1,h,h+65),e.emplaceBack(h+65,h+65+1,h+1)};for(let s=0;s<64;s++)for(let c=0;c<64;c++)n(c,s);return e}getWirefameBuffer(e){if(!this.wireframeSegments){const n=this._createWireframeGrid();this.wireframeIndexBuffer=e.createIndexBuffer(n),this.wireframeSegments=Lr.simpleSegment(0,0,4096,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}_createWireframeGrid(){const e=new Es,n=(s,c)=>{const h=65*c+s;e.emplaceBack(h,h+1),e.emplaceBack(h,h+65),e.emplaceBack(h,h+65+1)};for(let s=0;s<64;s++)for(let c=0;c<64;c++)n(c,s);return e}}function hc(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),s=t.x*n,c=(t.x+1)*n,h=t.y*n,f=(t.y+1)*n,y=jo(s),x=jo(c),b=Mi(h),E=Mi(f),C=e.project(y,b),M=e.project(x,b),D=e.project(x,E),R=e.project(y,E);let U=Math.min(C.x,M.x,D.x,R.x),j=Math.min(C.y,M.y,D.y,R.y),W=Math.max(C.x,M.x,D.x,R.x),re=Math.max(C.y,M.y,D.y,R.y);const le=n/16;function de(fe,Ae,Me,Xe,Ge,Ie){const Ze=(Me+Ge)/2,Ye=(Xe+Ie)/2,Re=e.project(jo(Ze),Mi(Ye)),tt=Math.max(0,U-Re.x,j-Re.y,Re.x-W,Re.y-re);U=Math.min(U,Re.x),W=Math.max(W,Re.x),j=Math.min(j,Re.y),re=Math.max(re,Re.y),tt>le&&(de(fe,Re,Me,Xe,Ze,Ye),de(Re,Ae,Ze,Ye,Ge,Ie))}de(C,M,s,h,c,h),de(M,D,c,h,c,f),de(D,R,c,f,s,f),de(R,C,s,f,s,h),U-=le,j-=le,W+=le,re+=le;const pe=1/Math.max(W-U,re-j);return{scale:pe,x:U*pe,y:j*pe,x2:W*pe,y2:re*pe,projection:e}}class cx{constructor(e){const n={},s=[];for(const y in e){const x=e[y],b=n[y]={};for(const E in x.glyphs){const C=x.glyphs[+E];if(!C||C.bitmap.width===0||C.bitmap.height===0)continue;const M=C.metrics.localGlyph?2:1,D={x:0,y:0,w:C.bitmap.width+2*M,h:C.bitmap.height+2*M};s.push(D),b[E]=D}}const{w:c,h}=Gm(s),f=new ks({width:c||1,height:h||1});for(const y in e){const x=e[y];for(const b in x.glyphs){const E=x.glyphs[+b];if(!E||E.bitmap.width===0||E.bitmap.height===0)continue;const C=n[y][b],M=E.metrics.localGlyph?2:1;ks.copy(E.bitmap,f,{x:0,y:0},{x:C.x+M,y:C.y+M},E.bitmap)}}this.image=f,this.positions=n}}rt("GlyphAtlas",cx);class dE{constructor(e){this.tileID=new Rn(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=hc(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,s,c,h){this.status="parsing",this.data=e,this.collisionBoxArray=new Tm;const f=new V0(Object.keys(e.layers).sort()),y=new ex(this.tileID,this.promoteId);y.bucketLayerIDs=[];const x={},b=new i_(256,256),E={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:s},C=n.familiesBySource[this.source];for(const pe in C){const fe=e.layers[pe];if(!fe)continue;let Ae=!1,Me=!1;for(const Ie of C[pe])Ie[0].type==="symbol"?Ae=!0:Me=!0;if(this.isSymbolTile===!0&&!Ae||this.isSymbolTile===!1&&!Me)continue;fe.version===1&&gr(`Vector tile source "${this.source}" layer "${pe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xe=f.encode(pe),Ge=[];for(let Ie=0;Ie<fe.length;Ie++){const Ze=fe.feature(Ie),Ye=y.getId(Ze,pe);Ge.push({feature:Ze,id:Ye,index:Ie,sourceLayerIndex:Xe})}for(const Ie of C[pe]){const Ze=Ie[0];this.isSymbolTile!==void 0&&Ze.type==="symbol"!==this.isSymbolTile||Ze.minzoom&&this.zoom<Math.floor(Ze.minzoom)||Ze.maxzoom&&this.zoom>=Ze.maxzoom||Ze.visibility!=="none"&&(m_(Ie,this.zoom,s),(x[Ze.id]=Ze.createBucket({index:y.bucketLayerIDs.length,layers:Ie,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xe,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:s})).populate(Ge,E,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(Ie.map(Ye=>Ye.id)))}}let M,D,R,U;b.trim();const j={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},W=to(E.glyphDependencies,pe=>Object.keys(pe).map(Number));Object.keys(W).length?c.send("getGlyphs",{uid:this.uid,stacks:W},(pe,fe)=>{M||(M=pe,D=fe,de.call(this))},void 0,!1,j):D={};const re=Object.keys(E.iconDependencies);re.length?c.send("getImages",{icons:re,source:this.source,tileID:this.tileID,type:"icons"},(pe,fe)=>{M||(M=pe,R=fe,de.call(this))},void 0,!1,j):R={};const le=Object.keys(E.patternDependencies);function de(){if(M)return h(M);if(D&&R&&U){const pe=new cx(D),fe=new m0(R,U);for(const Ae in x){const Me=x[Ae];Me instanceof As?(m_(Me.layers,this.zoom,s),GS(Me,D,pe.positions,R,fe.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection),Me.projection=this.projection.name):Me.hasPattern&&(Me instanceof ep||Me instanceof Qd||Me instanceof jm)&&(m_(Me.layers,this.zoom,s),Me.addFeatures(E,this.tileID.canonical,fe.patternPositions,s))}this.status="done",h(null,{buckets:ts(x).filter(Ae=>!Ae.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pe.image,lineAtlas:b,imageAtlas:fe,glyphMap:this.returnDependencies?D:null,iconMap:this.returnDependencies?R:null,glyphPositions:this.returnDependencies?pe.positions:null})}}le.length?c.send("getImages",{icons:le,source:this.source,tileID:this.tileID,type:"patterns"},(pe,fe)=>{M||(M=pe,U=fe,de.call(this))},void 0,!1,j):U={},de.call(this)}}function m_(t,e,n){const s=new wt(e);for(const c of t)c.recalculate(s,n)}class ux{constructor(e){this.entries={},this.scheduler=e}request(e,n,s,c){const h=this.entries[e]=this.entries[e]||{callbacks:[]};if(h.result){const[f,y]=h.result;return this.scheduler?this.scheduler.add(()=>{c(f,y)},n):c(f,y),()=>{}}return h.callbacks.push(c),h.cancel||(h.cancel=s((f,y)=>{h.result=[f,y];for(const x of h.callbacks)this.scheduler?this.scheduler.add(()=>{x(f,y)},n):x(f,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(f=>f!==c),h.callbacks.length||(h.cancel(),delete this.entries[e]))}}}function hx(t,e,n){const s=JSON.stringify(t.request);return t.data&&(this.deduped.entries[s]={result:[null,t.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},c=>{const h=da(t.request,(f,y,x,b)=>{f?c(f):y&&c(null,{vectorTile:n?void 0:new Va.VectorTile(new Bu(y)),rawData:y,cacheControl:x,expires:b})});return()=>{h.cancel(),c()}},e)}const pE=Y(new Float64Array(16));class Za{constructor(e,n){this._tr=e,this._worldSize=n}createInversionMatrix(){return pE}createTileMatrix(e){let n,s,c;const h=e.canonical,f=Y(new Float64Array(16)),y=this._tr.projection;if(y.isReprojectedInTileSpace){const x=hc(h,y);n=1,s=x.x+e.wrap*x.scale,c=x.y,we(f,f,[n/x.scale,n/x.scale,this._tr.pixelsPerMeter/this._worldSize])}else n=this._worldSize/this._tr.zoomScale(h.z),s=(h.x+Math.pow(2,h.z)*e.wrap)*n,c=h.y*n;return ge(f,f,[s,c,0]),we(f,f,[n/Dt,n/Dt,1]),f}pointCoordinate(e,n,s){const c=this._tr.horizonLineFromTop(!1),h=new ce(e,Math.max(c,n));return this._tr.rayIntersectionCoordinate(this._tr.pointRayIntersection(h,s))}upVector(){return[0,0,1]}upVectorScale(){return 1}}var fE={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],zAxisUnit:"meters",conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&na(this.parallels,this.constants.parallels))return;const t=Math.sin(Pt(this.parallels[0])),e=(t+Math.sin(Pt(this.parallels[1])))/2,n=1+t*(2*e-t),s=Math.sqrt(n)/e;this.constants={n:e,c:n,r0:s,parallels:this.parallels}},project(t,e){this.initializeConstants();const n=Pt(t-this.center[0]),s=Pt(e),{n:c,c:h,r0:f}=this.constants,y=Math.sqrt(h-2*c*Math.sin(s))/c;return{x:y*Math.sin(n*c),y:y*Math.cos(n*c)-f,z:0}},unproject(t,e){this.initializeConstants();const{n,c:s,r0:c}=this.constants,h=c+e;let f=Math.atan2(t,Math.abs(h))*Math.sign(h);h*n<0&&(f-=Math.PI*Math.sign(t)*Math.sign(h));const y=Pt(this.center[0])*n;f=Bi(f,-Math.PI-y,Math.PI-y);const x=zn(f/n)+this.center[0],b=Math.asin(Kt((s-(t*t+h*h)*n*n)/(2*n),-1,1)),E=Kt(zn(b),-85.051129,go);return new Qt(x,E)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)};const ju=1.340264,Vu=-.081106,$u=893e-6,Gu=.003796,yp=Math.sqrt(3)/2;var mE={name:"equalEarth",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const n=Math.asin(yp*Math.sin(e)),s=n*n,c=s*s*s;return{x:.5*(t*Math.cos(n)/(yp*(ju+3*Vu*s+c*(7*$u+9*Gu*s)))/Math.PI+.5),y:1-.5*(n*(ju+Vu*s+c*($u+Gu*s))/Math.PI+1),z:0}},unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,s=n*n,c=s*s*s;for(let b,E,C,M=0;M<12&&(E=n*(ju+Vu*s+c*($u+Gu*s))-e,C=ju+3*Vu*s+c*(7*$u+9*Gu*s),b=E/C,n=Kt(n-b,-Math.PI/3,Math.PI/3),s=n*n,c=s*s*s,!(Math.abs(b)<1e-12));++M);const h=yp*t*(ju+3*Vu*s+c*(7*$u+9*Gu*s))/Math.cos(n),f=Math.asin(Math.sin(n)/yp),y=Kt(180*h/Math.PI,-180,180),x=Kt(180*f/Math.PI,-85.051129,go);return new Qt(y,x)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)},_E={name:"equirectangular",supportsWorldCopies:!0,center:[0,0],range:[3.5,7],zAxisUnit:"meters",wrap:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project:(t,e)=>({x:.5+t/360,y:.5-e/360,z:0}),unproject(t,e){const n=360*(t-.5),s=Kt(360*(.5-e),-85.051129,go);return new Qt(n,s)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)};const dc=Math.PI/2;function vp(t){return Math.tan((dc+t)/2)}var gE={name:"lambertConformalConic",range:[3.5,7],zAxisUnit:"meters",center:[0,30],parallels:[30,30],conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&na(this.parallels,this.constants.parallels))return;const t=Pt(this.parallels[0]),e=Pt(this.parallels[1]),n=Math.cos(t),s=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(vp(e)/vp(t)),c=n*Math.pow(vp(t),s)/s;this.constants={n:s,f:c,parallels:this.parallels}},project(t,e){this.initializeConstants(),e=Pt(e),t=Pt(t-this.center[0]);const n=1e-6,{n:s,f:c}=this.constants;c>0?e<-dc+n&&(e=-dc+n):e>dc-n&&(e=dc-n);const h=c/Math.pow(vp(e),s),f=h*Math.sin(s*t),y=c-h*Math.cos(s*t);return{x:.5*(f/Math.PI+.5),y:1-.5*(y/Math.PI+.5),z:0}},unproject(t,e){this.initializeConstants(),t=(2*t-.5)*Math.PI,e=(2*(1-e)-.5)*Math.PI;const{n,f:s}=this.constants,c=s-e,h=Math.sign(c),f=Math.sign(n)*Math.sqrt(t*t+c*c);let y=Math.atan2(t,Math.abs(c))*h;c*n<0&&(y-=Math.PI*Math.sign(t)*h);const x=Kt(zn(y/n)+this.center[0],-180,180),b=Kt(zn(2*Math.atan(Math.pow(s/f,1/n))-dc),-85.051129,go);return new Qt(x,b)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)},yE={name:"mercator",wrap:!0,requiresDraping:!1,supportsWorldCopies:!0,supportsTerrain:!0,supportsFog:!0,supportsFreeCamera:!0,zAxisUnit:"meters",center:[0,0],project:(t,e)=>({x:Jl(t),y:Ql(e),z:0}),unproject(t,e){const n=jo(t),s=Mi(e);return new Qt(n,s)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)};const dx=Pt(go);var vE={name:"naturalEarth",center:[0,0],range:[3.5,7],isReprojectedInTileSpace:!0,zAxisUnit:"meters",unsupportedLayers:["custom"],project(t,e){const n=(e=Pt(e))*e,s=n*n;return{x:.5*((t=Pt(t))*(.8707-.131979*n+s*(s*(.003971*n-.001529*s)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+n*(.015085+s*(.028874*n-.044475-.005916*s)))/Math.PI+1),z:0}},unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,s=25,c=0,h=n*n;do{h=n*n;const x=h*h;c=(n*(1.007226+h*(.015085+x*(.028874*h-.044475-.005916*x)))-e)/(1.007226+h*(.045255+x*(.259866*h-.311325-.005916*11*x))),n=Kt(n-c,-dx,dx)}while(Math.abs(c)>1e-6&&--s>0);h=n*n;const f=Kt(zn(t/(.8707+h*(h*(h*h*h*(.003971-.001529*h)-.013791)-.131979))),-180,180),y=zn(n);return new Qt(f,y)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)};const px=Pt(go),fx={albers:fE,equalEarth:mE,equirectangular:_E,lambertConformalConic:gE,mercator:yE,naturalEarth:vE,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(t,e){e=Pt(e),t=Pt(t);const n=Math.cos(e),s=2/Math.PI,c=Math.acos(n*Math.cos(t/2)),h=Math.sin(c)/c,f=.5*(t*s+2*n*Math.sin(t/2)/h)||0,y=.5*(e+Math.sin(e)/h)||0;return{x:.5*(f/Math.PI+.5),y:1-.5*(y/Math.PI+1),z:0}},unproject(t,e){let n=t=(2*t-.5)*Math.PI,s=e=(2*(1-e)-1)*Math.PI,c=25;const h=1e-6;let f=0,y=0;do{const x=Math.cos(s),b=Math.sin(s),E=2*b*x,C=b*b,M=x*x,D=Math.cos(n/2),R=Math.sin(n/2),U=2*D*R,j=R*R,W=1-M*D*D,re=W?1/W:0,le=W?Math.acos(x*D)*Math.sqrt(1/W):0,de=.5*(2*le*x*R+2*n/Math.PI)-t,pe=.5*(le*b+s)-e,fe=.5*re*(M*j+le*x*D*C)+1/Math.PI,Ae=re*(U*E/4-le*b*R),Me=.125*re*(E*R-le*b*M*U),Xe=.5*re*(C*D+le*j*x)+.5,Ge=Ae*Me-Xe*fe;f=(pe*Ae-de*Xe)/Ge,y=(de*Me-pe*fe)/Ge,n=Kt(n-f,-Math.PI,Math.PI),s=Kt(s-y,-px,px)}while((Math.abs(f)>h||Math.abs(y)>h)&&--c>0);return new Qt(zn(n),zn(s))},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>qi(1,t)*e,farthestPixelDistance(t){return Ga(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Za(t,e)}};a.ARRAY_TYPE=Te,a.AUTH_ERR_MSG=ve,a.Aabb=Wi,a.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},rs(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=xi()?t:se,this.scheduler=new iE}send(t,e,n,s,c=!1,h){const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=h,this.callbacks[f]=n);const y=wi(this.globalScope)?void 0:[];return this.target.postMessage({id:f,type:t,hasCallback:!!n,targetMapId:s,mustQueue:c,sourceMapId:this.mapId,data:Ba(e,y)},y),{cancel:()=>{n&&delete this.callbacks[f],this.target.postMessage({id:f,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const s=this.cancelCallbacks[n];delete this.cancelCallbacks[n],s&&s.cancel()}else if(e.mustQueue||xi()){const s=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),s&&s.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if(e.type==="<response>"){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(mo(e.error)):n(null,mo(e.data)))}else{const n=wi(this.globalScope)?void 0:[],s=e.hasCallback?(h,f)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:h?Ba(h):null,data:Ba(f,n)},n)}:h=>{},c=mo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,c,s);else if(this.parent.getWorkerSource){const h=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,h[0],c.source)[h[1]](c,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=dp,a.Color=jt,a.ColorMode=vo,a.CullFaceMode=Hi,a.DEMData=pp,a.DataConstantProperty=it,a.DedupedRequest=ux,a.DepthMode=uc,a.EXTENT=Dt,a.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){e==null&&(e=null);const s=this._source();if(!s||t.y<0||t.y>1)return e;const c=s.getSource().maxzoom,h=1<<c,f=Math.floor(t.x),y=t.x-f,x=new Rn(c,f,c,Math.floor(y*h),Math.floor(t.y*h)),b=this.findDEMTileFor(x);if(!b||!b.dem)return e;const E=b.dem,C=1<<b.tileID.canonical.z,M=(y*C-b.tileID.canonical.x)*E.dim,D=(t.y*C-b.tileID.canonical.y)*E.dim,R=Math.floor(M),U=Math.floor(D);return(n?this.exaggeration():1)*Xt(Xt(E.get(R,U),E.get(R,U+1),D-U),Xt(E.get(R+1,U),E.get(R+1,U+1),D-U),M-R)}getAtTileOffset(t,e,n){const s=1<<t.canonical.z;return this.getAtPointOrZero(new Zd(t.wrap+(t.canonical.x+e/Dt)/s,(t.canonical.y+n/Dt)/s))}getAtTileOffsetFunc(t,e){return n=>{const s=this.getAtTileOffset(t,n.x,n.y),c=e.upVector(t.canonical,n.x,n.y);return ur(c,c,s*e.upVectorScale(t.canonical)),c}}getForTilePoints(t,e,n,s){const c=fp.create(this,t,s);return!!c&&(e.forEach(h=>{h[2]=this.exaggeration()*c.getElevationAt(h[0],h[1],n)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,s=e.tileID,c=1<<t.canonical.z-s.canonical.z;let h=t.canonical.x/c-s.canonical.x,f=t.canonical.y/c-s.canonical.y,y=0;for(let x=0;x<t.canonical.z-s.canonical.z&&!n.leaves[y];x++){h*=2,f*=2;const b=2*Math.floor(f)+Math.floor(h);y=n.childOffsets[y]+b,h%=1,f%=1}return{min:this.exaggeration()*n.minimums[y],max:this.exaggeration()*n.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=_l,a.EvaluationParameters=wt,a.Event=io,a.Evented=oo,a.Frustum=zm,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GlobeSharedBuffers=f_,a.GlyphManager=lc,a.ImagePosition=Zm,a.LineAtlas=i_,a.LngLat=Qt,a.LngLatBounds=Na,a.LocalGlyphMode=Xm,a.MAX_MERCATOR_LATITUDE=go,a.MercatorCoordinate=Zd,a.ONE_EM=ln,a.OverscaledTileID=Rn,a.Properties=on,a.RGBAImage=mi,a.Ray=class{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(t,e,n){const s=Wr(e,this.dir);if(Math.abs(s)<1e-6)return!1;const c=((t[0]-this.pos[0])*e[0]+(t[1]-this.pos[1])*e[1]+(t[2]-this.pos[2])*e[2])/s;return n[0]=this.pos[0]+this.dir[0]*c,n[1]=this.pos[1]+this.dir[1]*c,n[2]=this.pos[2]+this.dir[2]*c,!0}closestPointOnSphere(t,e,n){if(function(M,D){var R=M[0],U=M[1],j=M[2],W=D[0],re=D[1],le=D[2];return Math.abs(R-W)<=De*Math.max(1,Math.abs(R),Math.abs(W))&&Math.abs(U-re)<=De*Math.max(1,Math.abs(U),Math.abs(re))&&Math.abs(j-le)<=De*Math.max(1,Math.abs(j),Math.abs(le))}(this.pos,t)||e===0)return n[0]=n[1]=n[2]=0,!1;const[s,c,h]=this.dir,f=this.pos[0]-t[0],y=this.pos[1]-t[1],x=this.pos[2]-t[2],b=s*s+c*c+h*h,E=2*(f*s+y*c+x*h),C=E*E-4*b*(f*f+y*y+x*x-e*e);if(C<0){const M=Math.max(-E/2,0),D=f+s*M,R=y+c*M,U=x+h*M,j=Math.hypot(D,R,U);return n[0]=D*e/j,n[1]=R*e/j,n[2]=U*e/j,!1}{const M=(-E-Math.sqrt(C))/(2*b);if(M<0){const D=Math.hypot(f,y,x);return n[0]=f*e/D,n[1]=y*e/D,n[2]=x*e/D,!1}return n[0]=f+s*M,n[1]=y+c*M,n[2]=x+h*M,!0}}},a.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ue,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!ze(t))return t;const n=lt(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!ze(t))return t;const n=lt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!ze(t))return t;const n=lt(t);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,s){const c=lt(t);return ze(t)?(c.path=`/styles/v1${c.path}/sprite${e}${n}`,this._makeAPIURL(c,this._customAccessToken||s)):(c.path+=`${e}${n}`,ft(c))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!ze(t))return t;const s=lt(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&s.authority!=="raster"&&n===512?"@2x":""}${B.supported?".webp":"$1"}`),s.authority==="raster"?s.path=`/${P.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${P.TILE_URL_VERSION}${s.path}`);const c=this._customAccessToken||function(h){for(const f of h){const y=f.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(s.params)||P.ACCESS_TOKEN;return P.REQUIRE_ACCESS_TOKEN&&c&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,c)}canonicalizeTileURL(t,e){const n=lt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let s="mapbox://";n.path.match(/^\/raster\/v1\//)?s+=`raster/${n.path.replace(`/${P.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${n.path.replace(`/${P.TILE_URL_VERSION}/`,"")}`;let c=n.params;return e&&(c=c.filter(h=>!h.match(/^access_token=/))),c.length&&(s+=`?${c.join("&")}`),s}canonicalizeTileset(t,e){const n=!!e&&ze(e),s=[];for(const c of t.tiles||[])Le(c)?s.push(this.canonicalizeTileURL(c,n)):s.push(c);return s}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=lt(P.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,t.protocol==="http"){const c=t.params.indexOf("secure");c>=0&&t.params.splice(c,1)}if(s.path!=="/"&&(t.path=`${s.path}${t.path}`),!P.REQUIRE_ACCESS_TOKEN)return ft(t);if(e=e||P.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(c=>c.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),ft(t)}},a.ResourceType=fl,a.SegmentVector=Lr,a.SourceCache=$a,a.StencilMode=a_,a.StructArrayLayout1ui2=Ud,a.StructArrayLayout2f1f2i16=_m,a.StructArrayLayout2i4=Hl,a.StructArrayLayout2ui4=Es,a.StructArrayLayout3f12=Yl,a.StructArrayLayout3ui6=fi,a.StructArrayLayout4i8=Xl,a.Texture=hp,a.Tile=h_,a.Transitionable=Ln,a.Uniform1f=$d,a.Uniform1i=class extends Fo{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},a.Uniform2f=class extends Fo{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},a.Uniform3f=class extends Fo{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},a.Uniform4f=Iv,a.UniformColor=Av,a.UniformMatrix2f=class extends Fo{constructor(t,e){super(t,e),this.current=uT}set(t){for(let e=0;e<4;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix2fv(this.location,!1,t);break}}},a.UniformMatrix3f=class extends Fo{constructor(t,e){super(t,e),this.current=cT}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},a.UniformMatrix4f=class extends Fo{constructor(t,e){super(t,e),this.current=lT}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},a.UnwrappedTileID=o_,a.ValidationError=et,a.VectorTileWorkerSource=class extends oo{constructor(t,e,n,s,c){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=c||hx,this.loading={},this.loaded={},this.deduped=new ux(t.scheduler),this.isSpriteLoaded=s,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,s=t&&t.request,c=s&&s.collectResourceTiming,h=this.loading[n]=new dE(t);h.abort=this.loadVectorData(t,(f,y)=>{const x=!this.loading[n];if(delete this.loading[n],x||f||!y)return h.status="done",x||(this.loaded[n]=h),e(f);const b=y.rawData,E={};y.expires&&(E.expires=y.expires),y.cacheControl&&(E.cacheControl=y.cacheControl),h.vectorTile=y.vectorTile||new Va.VectorTile(new Bu(b));const C=()=>{h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,(M,D)=>{if(M||!D)return e(M);const R={};if(c){const U=N0(s);U.length>0&&(R.resourceTiming=JSON.parse(JSON.stringify(U)))}e(null,br({rawTileData:b.slice(0)},D,E,R))})};this.isSpriteLoaded?C():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(C,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):C()}),this.loaded=this.loaded||{},this.loaded[n]=h})}reloadTile(t,e){const n=this.loaded,s=t.uid,c=this;if(n&&n[s]){const h=n[s];h.showCollisionBoxes=t.showCollisionBoxes,h.enableTerrain=!!t.enableTerrain,h.projection=t.projection;const f=(y,x)=>{const b=h.reloadCallback;b&&(delete h.reloadCallback,h.parse(h.vectorTile,c.layerIndex,this.availableImages,c.actor,b)),e(y,x)};h.status==="parsing"?h.reloadCallback=f:h.status==="done"&&(h.vectorTile?h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,f):f())}}abortTile(t,e){const n=t.uid,s=this.loading[n];s&&(s.abort&&s.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,s=t.uid;n&&n[s]&&delete n[s],e()}},a.WritingMode=_i,a.ZoomHistory=d,a.add=ut,a.addDynamicAttributes=Qm,a.adjoint=function(t,e){var n=e[0],s=e[1],c=e[2],h=e[3],f=e[4],y=e[5],x=e[6],b=e[7],E=e[8];return t[0]=f*E-y*b,t[1]=c*b-s*E,t[2]=s*y-c*f,t[3]=y*x-h*E,t[4]=n*E-c*x,t[5]=c*h-n*y,t[6]=h*b-f*x,t[7]=s*x-n*b,t[8]=n*f-s*h,t},a.asyncAll=zo,a.bezier=oa,a.bindAll=rs,a.boundsAttributes=u_,a.bufferConvexPolygon=function(t,e){const n=[];for(let s=0;s<t.length;s++){const c=Bi(s-1,-1,t.length-1),h=Bi(s+1,-1,t.length-1),f=t[s],y=t[h],x=t[c].sub(f).unit(),b=y.sub(f).unit(),E=b.angleWithSep(x.x,x.y),C=x.add(b).unit().mult(-1*e/Math.sin(E/2));n.push(f.add(C))}return n},a.cacheEntryPossiblyAdded=function(t){pl++,pl>Xc&&(t.getActor().send("enforceCacheSizeLimit",Kh),pl=0)},a.calculateGlobeMatrix=lx,a.calculateGlobeMercatorMatrix=function(t){const e=t.worldSize,n=Kt(t.center.lat,-85.051129,go),s=new ce(Jl(t.center.lng)*e,Ql(n)*e),c=qi(1,t.center.lat)*e,h=t.pixelsPerMeter,f=e/(c/t.pixelsPerMeter),y=Y(new Float64Array(16));return ge(y,y,[s.x,s.y,0]),we(y,y,[f,f,h]),y},a.clamp=Kt,a.clearTileCache=function(t){const e=se.caches.delete(rn);t&&e.catch(t).then(()=>t())},a.clipLine=k0,a.clone=function(t){var e=new Te(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.clone$1=Gn,a.collisionCircleLayout=_S,a.config=P,a.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},a.create=function(){var t=new Te(16);return Te!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},a.create$1=ne,a.createExpression=Aa,a.createLayout=vr,a.createStyleLayer=function(t){return t.type==="custom"?new QS(t):new tE[t.type](t)},a.cross=dn,a.degToRad=Pt,a.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.dot=Wr,a.ease=sa,a.easeCubicInOut=ia,a.emitValidationErrors=Ld,a.endsWith=ns,a.enforceCacheSizeLimit=function(t){ua(),bi&&bi.then(e=>{e.keys().then(n=>{for(let s=0;s<n.length-t;s++)e.delete(n[s])})})},a.evaluateSizeForFeature=tp,a.evaluateSizeForZoom=ic,a.evaluateVariableOffset=P0,a.evented=Tn,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.exported=Pn,a.exported$1=B,a.extend=br,a.extend$1=so,a.filterObject=is,a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.fromQuat=function(t,e){var n=e[0],s=e[1],c=e[2],h=e[3],f=n+n,y=s+s,x=c+c,b=n*f,E=s*f,C=s*y,M=c*f,D=c*y,R=c*x,U=h*f,j=h*y,W=h*x;return t[0]=1-C-R,t[1]=E+W,t[2]=M-j,t[3]=0,t[4]=E-W,t[5]=1-b-R,t[6]=D+U,t[7]=0,t[8]=M+j,t[9]=D-U,t[10]=1-b-C,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e){var n=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=n,t[2]=0,t[3]=-n,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return Ao[e]},a.getAABBPointSquareDist=function(t,e,n){let s=0;for(let c=0;c<2;++c){const h=n?n[c]:0;t[c]>h&&(s+=(t[c]-h)*(t[c]-h)),e[c]<h&&(s+=(h-e[c])*(h-e[c]))}return s},a.getAnchorAlignment=Hm,a.getAnchorJustification=Km,a.getBounds=function(t){let e=1/0,n=1/0,s=-1/0,c=-1/0;for(const h of t)e=Math.min(e,h.x),n=Math.min(n,h.y),s=Math.max(s,h.x),c=Math.max(c,h.y);return{min:new ce(e,n),max:new ce(s,c)}},a.getColumn=function(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]},a.getImage=Qh,a.getJSON=function(t,e){return ci(br(t,{type:"json"}),e)},a.getMapSessionAPI=no,a.getPerformanceMeasurement=N0,a.getProjection=function(t){const e=fx[t.name];if(!e)throw new Error(`Invalid projection name: ${t.name}`);return e.conic?function(n,s){if(s.parallels&&Math.abs(s.parallels[0]+s.parallels[1])<.01){let c=function(h){const f=Math.max(.01,Math.cos(Pt(h))),y=1/(2*Math.max(Math.PI*f,1/f));return{wrap:!0,supportsWorldCopies:!0,unsupportedLayers:["custom"],project(x,b){const E=Pt(x)*f,C=Math.sin(Pt(b))/f;return{x:E*y+.5,y:-C*y+.5,z:0}},unproject(x,b){const E=-(b-.5)/y,C=Kt(zn((x-.5)/y)/f,-180,180),M=Math.asin(Kt(E*f,-1,1)),D=Kt(zn(M),-85.051129,go);return new Qt(C,D)}}}(s.parallels[0]);if(s.name==="lambertConformalConic"){const{project:h,unproject:f}=fx.mercator;c={wrap:!0,supportsWorldCopies:!0,project:h,unproject:f}}return br({},n,s,c)}return br({},n,s)}(e,t):e},a.getRTLTextPluginStatus=Yn,a.getReferrer=Kc,a.getTilePoint=function(t,{x:e,y:n},s=0){return new ce(((e-s)*t.scale-t.x)*Dt,(n*t.scale-t.y)*Dt)},a.getTileVec3=function(t,e,n=0){return bt(((e.x-n)*t.scale-t.x)*Dt,(e.y*t.scale-t.y)*Dt,Ov(e.z,e.y))},a.getVideo=function(t,e){const n=se.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let s=0;s<t.length;s++){const c=se.document.createElement("source");Jh(t[s])||(n.crossOrigin="Anonymous"),c.src=t[s],n.appendChild(c)}return{cancel:()=>{}}},a.globeBuffersForTileMesh=function(t,e,n,s){const c=t.context,h=t.transform;let f=e.globeGridBuffer,y=e.globePoleBuffer;if(!f){const x=f_.createGridVertices(n.canonical);f=e.globeGridBuffer=c.createVertexBuffer(x,ix,!1)}if(!y){const x=f_.createPoleTriangleVertices(s,h.tileSize*s,n.canonical.y===0);y=e.globePoleBuffer=c.createVertexBuffer(x,ix,!1)}return[f,y]},a.globeDenormalizeECEF=ax,a.globeMatrixForTile=function(t,e){const n=ax(_p(t)),s=((c=new Float64Array(16))[0]=(h=e)[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],c[9]=h[9],c[10]=h[10],c[11]=h[11],c[12]=h[12],c[13]=h[13],c[14]=h[14],c[15]=h[15],c);var c,h;return Qe(s,s,n),s},a.globePoleMatrixForTile=function(t,e,n){const s=Y(new Float64Array(16)),c=Math.pow(2,t.z),h=(t.x-c/2)/c*Math.PI*2,f=n.point,y=n.worldSize/(n.tileSize*c);return ge(s,s,[f.x,f.y,-n.worldSize/Math.PI/2]),we(s,s,[y,y,y]),He(s,s,Pt(-n._center.lat)),Ee(s,s,Pt(-n._center.lng)),Ee(s,s,h),e&&we(s,s,[1,-1,1]),s},a.globeTileBounds=_p,a.globeToMercatorTransition=function(t){return eo(5,6,t)},a.identity=Y,a.identity$1=ai,a.invert=function(t,e){var n=e[0],s=e[1],c=e[2],h=e[3],f=e[4],y=e[5],x=e[6],b=e[7],E=e[8],C=e[9],M=e[10],D=e[11],R=e[12],U=e[13],j=e[14],W=e[15],re=n*y-s*f,le=n*x-c*f,de=n*b-h*f,pe=s*x-c*y,fe=s*b-h*y,Ae=c*b-h*x,Me=E*U-C*R,Xe=E*j-M*R,Ge=E*W-D*R,Ie=C*j-M*U,Ze=C*W-D*U,Ye=M*W-D*j,Re=re*Ye-le*Ze+de*Ie+pe*Ge-fe*Xe+Ae*Me;return Re?(t[0]=(y*Ye-x*Ze+b*Ie)*(Re=1/Re),t[1]=(c*Ze-s*Ye-h*Ie)*Re,t[2]=(U*Ae-j*fe+W*pe)*Re,t[3]=(M*fe-C*Ae-D*pe)*Re,t[4]=(x*Ge-f*Ye-b*Xe)*Re,t[5]=(n*Ye-c*Ge+h*Xe)*Re,t[6]=(j*de-R*Ae-W*le)*Re,t[7]=(E*Ae-M*de+D*le)*Re,t[8]=(f*Ze-y*Ge+b*Me)*Re,t[9]=(s*Ge-n*Ze-h*Me)*Re,t[10]=(R*fe-U*de+W*re)*Re,t[11]=(C*de-E*fe-D*re)*Re,t[12]=(y*Xe-f*Ie-x*Me)*Re,t[13]=(n*Ie-s*Xe+c*Me)*Re,t[14]=(U*le-R*pe-j*re)*Re,t[15]=(E*pe-C*le+M*re)*Re,t):null},a.isMapAuthenticated=function(t){return Ui.has(t)},a.isMapboxURL=ze,a.latFromMercatorY=Mi,a.len=xn,a.length=nt,a.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},a.loadVectorTile=hx,a.makeRequest=ci,a.mercatorXfromLng=Jl,a.mercatorYfromLat=Ql,a.mercatorZfromAltitude=qi,a.mul=Qe,a.mul$1=zr,a.multiply=function(t,e,n){var s=e[0],c=e[1],h=e[2],f=e[3],y=e[4],x=e[5],b=e[6],E=e[7],C=e[8],M=n[0],D=n[1],R=n[2],U=n[3],j=n[4],W=n[5],re=n[6],le=n[7],de=n[8];return t[0]=M*s+D*f+R*b,t[1]=M*c+D*y+R*E,t[2]=M*h+D*x+R*C,t[3]=U*s+j*f+W*b,t[4]=U*c+j*y+W*E,t[5]=U*h+j*x+W*C,t[6]=re*s+le*f+de*b,t[7]=re*c+le*y+de*E,t[8]=re*h+le*x+de*C,t},a.multiply$1=Q,a.multiply$2=$r,a.nextPowerOfTwo=$n,a.normalize=Gr,a.normalize$1=function(t,e){var n=e[0],s=e[1],c=e[2],h=e[3],f=n*n+s*s+c*c+h*h;return f>0&&(f=1/Math.sqrt(f)),t[0]=n*f,t[1]=s*f,t[2]=c*f,t[3]=h*f,t},a.number=Xt,a.ortho=function(t,e,n,s,c,h,f){var y=1/(e-n),x=1/(s-c),b=1/(h-f);return t[0]=-2*y,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*x,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*b,t[11]=0,t[12]=(e+n)*y,t[13]=(c+s)*x,t[14]=(f+h)*b,t[15]=1,t},a.pbf=Bu,a.perspective=function(t,e,n,s,c){var h,f=1/Math.tan(e/2);return t[0]=f/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,c!=null&&c!==1/0?(t[10]=(c+s)*(h=1/(s-c)),t[14]=2*c*s*h):(t[10]=-1,t[14]=-2*s),t},a.pick=function(t,e){const n={};for(let s=0;s<e.length;s++){const c=e[s];c in t&&(n[c]=t[c])}return n},a.plugin=Ft,a.pointGeometry=ce,a.polygonIntersectsBox=jv,a.polygonIntersectsPolygon=Bv,a.polygonizeBounds=function(t,e,n=0,s=!0){const c=new ce(n,n),h=t.sub(c),f=e.add(c),y=[h,new ce(f.x,h.y),f,new ce(h.x,f.y)];return s&&y.push(h),y},a.posAttributes=lE,a.postMapLoadEvent=rr,a.postTurnstileEvent=lr,a.potpack=Gm,a.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},a.radToDeg=zn,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(t){return t({pluginStatus:vt,pluginURL:zt}),Tn.on("pluginStateChange",t),t},a.removeAuthState=function(t){Ui.delete(t)},a.renderColorRamp=Lm,a.rotateX=He,a.rotateX$1=ll,a.rotateY=Ee,a.rotateZ=function(t,e,n){var s=Math.sin(n),c=Math.cos(n),h=e[0],f=e[1],y=e[2],x=e[3],b=e[4],E=e[5],C=e[6],M=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=h*c+b*s,t[1]=f*c+E*s,t[2]=y*c+C*s,t[3]=x*c+M*s,t[4]=b*c-h*s,t[5]=E*c-f*s,t[6]=C*c-y*s,t[7]=M*c-x*s,t},a.rotateZ$1=function(t,e,n){n*=.5;var s=e[0],c=e[1],h=e[2],f=e[3],y=Math.sin(n),x=Math.cos(n);return t[0]=s*x+c*y,t[1]=c*x-s*y,t[2]=h*x+f*y,t[3]=f*x-h*y,t},a.scale=we,a.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.scale$2=ur,a.scaleAndAdd=wr,a.setCacheLimits=function(t,e){Kh=t,Xc=e},a.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},a.setRTLTextPlugin=function(t,e,n=!1){if(vt===dt||vt===xt||vt===Yt)throw new Error("setRTLTextPlugin cannot be called multiple times.");zt=Pn.resolveURL(t),vt=dt,nr=e,Ur(),n||pi()},a.smoothstep=eo,a.spec=Ce,a.storeAuthState=function(t,e){e?Ui.add(t):Ui.delete(t)},a.sub=$t,a.subtract=st,a.symbolSize=gS,a.tileAABB=function(t,e,n,s,c,h,f,y,x){if(x.name==="globe"){const D=_p(new o_(h,new dp(n,s,c)).canonical).getCorners(),R=Number.MAX_VALUE,U=[-R,-R,-R],j=[R,R,R],W=lx(t,e);for(let re=0;re<D.length;re++)je(D[re],D[re],W),E=j,C=D[re],(b=j)[0]=Math.min(E[0],C[0]),b[1]=Math.min(E[1],C[1]),b[2]=Math.min(E[2],C[2]),ar(U,U,D[re]);return new Wi(j,U)}var b,E,C;const M=hc({z:n,x:s,y:c},x);return new Wi([(h+M.x/M.scale)*e,e*(M.y/M.scale),f],[(h+M.x2/M.scale)*e,e*(M.y2/M.scale),y])},a.tileTransform=hc,a.transformMat3=function(t,e,n){var s=e[0],c=e[1],h=e[2];return t[0]=s*n[0]+c*n[3]+h*n[6],t[1]=s*n[1]+c*n[4]+h*n[7],t[2]=s*n[2]+c*n[5]+h*n[8],t},a.transformMat4=je,a.transformMat4$1=Hr,a.transformQuat=gt,a.translate=ge,a.transpose=function(t,e){if(t===e){var n=e[1],s=e[2],c=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=s,t[7]=c}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.triggerPluginCompletionEvent=pr,a.uniqueId=la,a.validateCustomStyleLayer=function(t){const e=[],n=t.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFog=um,a.validateLight=ws,a.validateStyle=xs,a.values=ts,a.vectorTile=Va,a.version=O,a.warnOnce=gr,a.window=se,a.wrap=Bi}),S(["./shared"],function(a){function O(q){const P=typeof q;if(P==="number"||P==="boolean"||P==="string"||q==null)return JSON.stringify(q);if(Array.isArray(q)){let H="[";for(const ae of q)H+=`${O(ae)},`;return`${H}]`}const B=Object.keys(q).sort();let Z="{";for(let H=0;H<B.length;H++)Z+=`${JSON.stringify(B[H])}:${O(q[B[H]])},`;return`${Z}}`}function X(q){let P="";for(const B of a.refProperties)P+=`/${O(q[B])}`;return P}class xe{constructor(P){this.keyCache={},P&&this.replace(P)}replace(P){this._layerConfigs={},this._layers={},this.update(P,[])}update(P,B){for(const H of P)this._layerConfigs[H.id]=H,(this._layers[H.id]=a.createStyleLayer(H)).compileFilter(),this.keyCache[H.id]&&delete this.keyCache[H.id];for(const H of B)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const Z=function(H,ae){const me={};for(let ue=0;ue<H.length;ue++){const ve=ae&&ae[H[ue].id]||X(H[ue]);ae&&(ae[H[ue].id]=ve);let ze=me[ve];ze||(ze=me[ve]=[]),ze.push(H[ue])}const _e=[];for(const ue in me)_e.push(me[ue]);return _e}(a.values(this._layerConfigs),this.keyCache);for(const H of Z){const ae=H.map(Le=>this._layers[Le.id]),me=ae[0];if(me.visibility==="none")continue;const _e=me.source||"";let ue=this.familiesBySource[_e];ue||(ue=this.familiesBySource[_e]={});const ve=me.sourceLayer||"_geojsonTileLayer";let ze=ue[ve];ze||(ze=ue[ve]=[]),ze.push(ae)}}}const{ImageBitmap:ce}=a.window;class he{loadTile(P,B){const{uid:Z,encoding:H,rawImageData:ae,padding:me,buildQuadTree:_e}=P,ue=ce&&ae instanceof ce?this.getImageData(ae,me):ae;B(null,new a.DEMData(Z,ue,H,me<1,_e))}getImageData(P,B){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(P.width,P.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=P.width,this.offscreenCanvas.height=P.height,this.offscreenCanvasContext.drawImage(P,0,0,P.width,P.height);const Z=this.offscreenCanvasContext.getImageData(-B,-B,P.width+2*B,P.height+2*B);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:Z.width,height:Z.height},Z.data)}}var se=function q(P,B){var Z,H=P&&P.type;if(H==="FeatureCollection")for(Z=0;Z<P.features.length;Z++)q(P.features[Z],B);else if(H==="GeometryCollection")for(Z=0;Z<P.geometries.length;Z++)q(P.geometries[Z],B);else if(H==="Feature")q(P.geometry,B);else if(H==="Polygon")De(P.coordinates,B);else if(H==="MultiPolygon")for(Z=0;Z<P.coordinates.length;Z++)De(P.coordinates[Z],B);return P};function De(q,P){if(q.length!==0){Te(q[0],P);for(var B=1;B<q.length;B++)Te(q[B],!P)}}function Te(q,P){for(var B=0,Z=0,H=0,ae=q.length,me=ae-1;H<ae;me=H++){var _e=(q[H][0]-q[me][0])*(q[me][1]+q[H][1]),ue=B+_e;Z+=Math.abs(B)>=Math.abs(_e)?B-ue+_e:_e-ue+B,B=ue}B+Z>=0!=!!P&&q.reverse()}const ne=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Y{constructor(P){this._feature=P,this.extent=a.EXTENT,this.type=P.type,this.properties=P.tags,"id"in P&&!isNaN(P.id)&&(this.id=parseInt(P.id,10))}loadGeometry(){if(this._feature.type===1){const P=[];for(const B of this._feature.geometry)P.push([new a.pointGeometry(B[0],B[1])]);return P}{const P=[];for(const B of this._feature.geometry){const Z=[];for(const H of B)Z.push(new a.pointGeometry(H[0],H[1]));P.push(Z)}return P}}toGeoJSON(P,B,Z){return ne.call(this,P,B,Z)}}class Q{constructor(P){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=P.length,this._features=P}feature(P){return new Y(this._features[P])}}var ge=a.vectorTile.VectorTileFeature,we=He;function He(q,P){this.options=P||{},this.features=q,this.length=q.length}function Ee(q,P){this.id=typeof q.id=="number"?q.id:void 0,this.type=q.type,this.rawGeometry=q.type===1?[q.geometry]:q.geometry,this.properties=q.tags,this.extent=P||4096}He.prototype.feature=function(q){return new Ee(this.features[q],this.options.extent)},Ee.prototype.loadGeometry=function(){var q=this.rawGeometry;this.geometry=[];for(var P=0;P<q.length;P++){for(var B=q[P],Z=[],H=0;H<B.length;H++)Z.push(new a.pointGeometry(B[H][0],B[H][1]));this.geometry.push(Z)}return this.geometry},Ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var q=this.geometry,P=1/0,B=-1/0,Z=1/0,H=-1/0,ae=0;ae<q.length;ae++)for(var me=q[ae],_e=0;_e<me.length;_e++){var ue=me[_e];P=Math.min(P,ue.x),B=Math.max(B,ue.x),Z=Math.min(Z,ue.y),H=Math.max(H,ue.y)}return[P,Z,B,H]},Ee.prototype.toGeoJSON=ge.prototype.toGeoJSON;var Qe=Fe,Ve=we;function Fe(q){var P=new a.pbf;return function(B,Z){for(var H in B.layers)Z.writeMessage(3,nt,B.layers[H])}(q,P),P.finish()}function nt(q,P){var B;P.writeVarintField(15,q.version||1),P.writeStringField(1,q.name||""),P.writeVarintField(5,q.extent||4096);var Z={keys:[],values:[],keycache:{},valuecache:{}};for(B=0;B<q.length;B++)Z.feature=q.feature(B),P.writeMessage(2,bt,Z);var H=Z.keys;for(B=0;B<H.length;B++)P.writeStringField(3,H[B]);var ae=Z.values;for(B=0;B<ae.length;B++)P.writeMessage(4,ur,ae[B])}function bt(q,P){var B=q.feature;B.id!==void 0&&P.writeVarintField(1,B.id),P.writeMessage(2,ut,q),P.writeVarintField(3,B.type),P.writeMessage(4,ar,B)}function ut(q,P){var B=q.feature,Z=q.keys,H=q.values,ae=q.keycache,me=q.valuecache;for(var _e in B.properties){var ue=B.properties[_e],ve=ae[_e];if(ue!==null){ve===void 0&&(Z.push(_e),ae[_e]=ve=Z.length-1),P.writeVarint(ve);var ze=typeof ue;ze!=="string"&&ze!=="boolean"&&ze!=="number"&&(ue=JSON.stringify(ue));var Le=ze+":"+ue,Ue=me[Le];Ue===void 0&&(H.push(ue),me[Le]=Ue=H.length-1),P.writeVarint(Ue)}}}function st(q,P){return(P<<3)+(7&q)}function $r(q){return q<<1^q>>31}function ar(q,P){for(var B=q.loadGeometry(),Z=q.type,H=0,ae=0,me=B.length,_e=0;_e<me;_e++){var ue=B[_e],ve=1;Z===1&&(ve=ue.length),P.writeVarint(st(1,ve));for(var ze=Z===3?ue.length-1:ue.length,Le=0;Le<ze;Le++){Le===1&&Z!==1&&P.writeVarint(st(2,ze-1));var Ue=ue[Le].x-H,lt=ue[Le].y-ae;P.writeVarint($r(Ue)),P.writeVarint($r(lt)),H+=Ue,ae+=lt}Z===3&&P.writeVarint(st(7,1))}}function ur(q,P){var B=typeof q;B==="string"?P.writeStringField(1,q):B==="boolean"?P.writeBooleanField(7,q):B==="number"&&(q%1!=0?P.writeDoubleField(3,q):q<0?P.writeSVarintField(6,q):P.writeVarintField(5,q))}function wr(q,P,B,Z,H,ae){if(H-Z<=B)return;const me=Z+H>>1;Gr(q,P,me,Z,H,ae%2),wr(q,P,B,Z,me-1,ae+1),wr(q,P,B,me+1,H,ae+1)}function Gr(q,P,B,Z,H,ae){for(;H>Z;){if(H-Z>600){const ve=H-Z+1,ze=B-Z+1,Le=Math.log(ve),Ue=.5*Math.exp(2*Le/3),lt=.5*Math.sqrt(Le*Ue*(ve-Ue)/ve)*(ze-ve/2<0?-1:1);Gr(q,P,B,Math.max(Z,Math.floor(B-ze*Ue/ve+lt)),Math.min(H,Math.floor(B+(ve-ze)*Ue/ve+lt)),ae)}const me=P[2*B+ae];let _e=Z,ue=H;for(Wr(q,P,Z,B),P[2*H+ae]>me&&Wr(q,P,Z,H);_e<ue;){for(Wr(q,P,_e,ue),_e++,ue--;P[2*_e+ae]<me;)_e++;for(;P[2*ue+ae]>me;)ue--}P[2*Z+ae]===me?Wr(q,P,Z,ue):(ue++,Wr(q,P,ue,H)),ue<=B&&(Z=ue+1),B<=ue&&(H=ue-1)}}function Wr(q,P,B,Z){dn(q,B,Z),dn(P,2*B,2*Z),dn(P,2*B+1,2*Z+1)}function dn(q,P,B){const Z=q[P];q[P]=q[B],q[B]=Z}function je(q,P,B,Z){const H=q-B,ae=P-Z;return H*H+ae*ae}Qe.fromVectorTileJs=Fe,Qe.fromGeojsonVt=function(q,P){P=P||{};var B={};for(var Z in q)B[Z]=new we(q[Z].features,P),B[Z].name=Z,B[Z].version=P.version,B[Z].extent=P.extent;return Fe({layers:B})},Qe.GeoJSONWrapper=Ve;const gt=q=>q[0],St=q=>q[1];class $t{constructor(P,B=gt,Z=St,H=64,ae=Float64Array){this.nodeSize=H,this.points=P;const me=P.length<65536?Uint16Array:Uint32Array,_e=this.ids=new me(P.length),ue=this.coords=new ae(2*P.length);for(let ve=0;ve<P.length;ve++)_e[ve]=ve,ue[2*ve]=B(P[ve]),ue[2*ve+1]=Z(P[ve]);wr(_e,ue,H,0,_e.length-1,0)}range(P,B,Z,H){return function(ae,me,_e,ue,ve,ze,Le){const Ue=[0,ae.length-1,0],lt=[];let ft,mt;for(;Ue.length;){const yt=Ue.pop(),At=Ue.pop(),lr=Ue.pop();if(At-lr<=Le){for(let dr=lr;dr<=At;dr++)ft=me[2*dr],mt=me[2*dr+1],ft>=_e&&ft<=ve&&mt>=ue&&mt<=ze&&lt.push(ae[dr]);continue}const hr=Math.floor((lr+At)/2);ft=me[2*hr],mt=me[2*hr+1],ft>=_e&&ft<=ve&&mt>=ue&&mt<=ze&&lt.push(ae[hr]);const rr=(yt+1)%2;(yt===0?_e<=ft:ue<=mt)&&(Ue.push(lr),Ue.push(hr-1),Ue.push(rr)),(yt===0?ve>=ft:ze>=mt)&&(Ue.push(hr+1),Ue.push(At),Ue.push(rr))}return lt}(this.ids,this.coords,P,B,Z,H,this.nodeSize)}within(P,B,Z){return function(H,ae,me,_e,ue,ve){const ze=[0,H.length-1,0],Le=[],Ue=ue*ue;for(;ze.length;){const lt=ze.pop(),ft=ze.pop(),mt=ze.pop();if(ft-mt<=ve){for(let rr=mt;rr<=ft;rr++)je(ae[2*rr],ae[2*rr+1],me,_e)<=Ue&&Le.push(H[rr]);continue}const yt=Math.floor((mt+ft)/2),At=ae[2*yt],lr=ae[2*yt+1];je(At,lr,me,_e)<=Ue&&Le.push(H[yt]);const hr=(lt+1)%2;(lt===0?me-ue<=At:_e-ue<=lr)&&(ze.push(mt),ze.push(yt-1),ze.push(hr)),(lt===0?me+ue>=At:_e+ue>=lr)&&(ze.push(yt+1),ze.push(ft),ze.push(hr))}return Le}(this.ids,this.coords,P,B,Z,this.nodeSize)}}const zr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},xn=Math.fround||(Hr=new Float32Array(1),q=>(Hr[0]=+q,Hr[0]));var Hr;class si{constructor(P){this.options=Ao(Object.create(zr),P),this.trees=new Array(this.options.maxZoom+1)}load(P){const{log:B,minZoom:Z,maxZoom:H,nodeSize:ae}=this.options;B&&console.time("total time");const me=`prepare ${P.length} points`;B&&console.time(me),this.points=P;let _e=[];for(let ue=0;ue<P.length;ue++)P[ue].geometry&&_e.push(ll(P[ue],ue));this.trees[H+1]=new $t(_e,ia,oa,ae,Float32Array),B&&console.timeEnd(me);for(let ue=H;ue>=Z;ue--){const ve=+Date.now();_e=this._cluster(_e,ue),this.trees[ue]=new $t(_e,ia,oa,ae,Float32Array),B&&console.log("z%d: %d clusters in %dms",ue,_e.length,+Date.now()-ve)}return B&&console.timeEnd("total time"),this}getClusters(P,B){let Z=((P[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,P[1]));let ae=P[2]===180?180:((P[2]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,P[3]));if(P[2]-P[0]>=360)Z=-180,ae=180;else if(Z>ae){const ze=this.getClusters([Z,H,180,me],B),Le=this.getClusters([-180,H,ae,me],B);return ze.concat(Le)}const _e=this.trees[this._limitZoom(B)],ue=_e.range(es(Z),Pt(me),es(ae),Pt(H)),ve=[];for(const ze of ue){const Le=_e.points[ze];ve.push(Le.numPoints?na(Le):this.points[Le.index])}return ve}getChildren(P){const B=this._getOriginId(P),Z=this._getOriginZoom(P),H="No cluster with the specified id.",ae=this.trees[Z];if(!ae)throw new Error(H);const me=ae.points[B];if(!me)throw new Error(H);const _e=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),ue=ae.within(me.x,me.y,_e),ve=[];for(const ze of ue){const Le=ae.points[ze];Le.parentId===P&&ve.push(Le.numPoints?na(Le):this.points[Le.index])}if(ve.length===0)throw new Error(H);return ve}getLeaves(P,B,Z){const H=[];return this._appendLeaves(H,P,B=B||10,Z=Z||0,0),H}getTile(P,B,Z){const H=this.trees[this._limitZoom(P)],ae=Math.pow(2,P),{extent:me,radius:_e}=this.options,ue=_e/me,ve=(Z-ue)/ae,ze=(Z+1+ue)/ae,Le={features:[]};return this._addTileFeatures(H.range((B-ue)/ae,ve,(B+1+ue)/ae,ze),H.points,B,Z,ae,Le),B===0&&this._addTileFeatures(H.range(1-ue/ae,ve,1,ze),H.points,ae,Z,ae,Le),B===ae-1&&this._addTileFeatures(H.range(0,ve,ue/ae,ze),H.points,-1,Z,ae,Le),Le.features.length?Le:null}getClusterExpansionZoom(P){let B=this._getOriginZoom(P)-1;for(;B<=this.options.maxZoom;){const Z=this.getChildren(P);if(B++,Z.length!==1)break;P=Z[0].properties.cluster_id}return B}_appendLeaves(P,B,Z,H,ae){const me=this.getChildren(B);for(const _e of me){const ue=_e.properties;if(ue&&ue.cluster?ae+ue.point_count<=H?ae+=ue.point_count:ae=this._appendLeaves(P,ue.cluster_id,Z,H,ae):ae<H?ae++:P.push(_e),P.length===Z)break}return ae}_addTileFeatures(P,B,Z,H,ae,me){for(const _e of P){const ue=B[_e],ve=ue.numPoints;let ze,Le,Ue;if(ve)ze=cl(ue),Le=ue.x,Ue=ue.y;else{const mt=this.points[ue.index];ze=mt.properties,Le=es(mt.geometry.coordinates[0]),Ue=Pt(mt.geometry.coordinates[1])}const lt={type:1,geometry:[[Math.round(this.options.extent*(Le*ae-Z)),Math.round(this.options.extent*(Ue*ae-H))]],tags:ze};let ft;ve?ft=ue.id:this.options.generateId?ft=ue.index:this.points[ue.index].id&&(ft=this.points[ue.index].id),ft!==void 0&&(lt.id=ft),me.features.push(lt)}}_limitZoom(P){return Math.max(this.options.minZoom,Math.min(+P,this.options.maxZoom+1))}_cluster(P,B){const Z=[],{radius:H,extent:ae,reduce:me,minPoints:_e}=this.options,ue=H/(ae*Math.pow(2,B));for(let ve=0;ve<P.length;ve++){const ze=P[ve];if(ze.zoom<=B)continue;ze.zoom=B;const Le=this.trees[B+1],Ue=Le.within(ze.x,ze.y,ue),lt=ze.numPoints||1;let ft=lt;for(const mt of Ue){const yt=Le.points[mt];yt.zoom>B&&(ft+=yt.numPoints||1)}if(ft>lt&&ft>=_e){let mt=ze.x*lt,yt=ze.y*lt,At=me&&lt>1?this._map(ze,!0):null;const lr=(ve<<5)+(B+1)+this.points.length;for(const hr of Ue){const rr=Le.points[hr];if(rr.zoom<=B)continue;rr.zoom=B;const dr=rr.numPoints||1;mt+=rr.x*dr,yt+=rr.y*dr,rr.parentId=lr,me&&(At||(At=this._map(ze,!0)),me(At,this._map(rr)))}ze.parentId=lr,Z.push(ai(mt/ft,yt/ft,lr,ft,At))}else if(Z.push(ze),ft>1)for(const mt of Ue){const yt=Le.points[mt];yt.zoom<=B||(yt.zoom=B,Z.push(yt))}}return Z}_getOriginId(P){return P-this.points.length>>5}_getOriginZoom(P){return(P-this.points.length)%32}_map(P,B){if(P.numPoints)return B?Ao({},P.properties):P.properties;const Z=this.points[P.index].properties,H=this.options.map(Z);return B&&H===Z?Ao({},H):H}}function ai(q,P,B,Z,H){return{x:xn(q),y:xn(P),zoom:1/0,id:B,parentId:-1,numPoints:Z,properties:H}}function ll(q,P){const[B,Z]=q.geometry.coordinates;return{x:xn(es(B)),y:xn(Pt(Z)),zoom:1/0,index:P,parentId:-1}}function na(q){return{type:"Feature",id:q.id,properties:cl(q),geometry:{type:"Point",coordinates:[(P=q.x,360*(P-.5)),zn(q.y)]}};var P}function cl(q){const P=q.numPoints,B=P>=1e4?`${Math.round(P/1e3)}k`:P>=1e3?Math.round(P/100)/10+"k":P;return Ao(Ao({},q.properties),{cluster:!0,cluster_id:q.id,point_count:P,point_count_abbreviated:B})}function es(q){return q/360+.5}function Pt(q){const P=Math.sin(q*Math.PI/180),B=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return B<0?0:B>1?1:B}function zn(q){const P=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(P))/Math.PI-90}function Ao(q,P){for(const B in P)q[B]=P[B];return q}function ia(q){return q.x}function oa(q){return q.y}function sa(q,P,B,Z){for(var H,ae=Z,me=B-P>>1,_e=B-P,ue=q[P],ve=q[P+1],ze=q[B],Le=q[B+1],Ue=P+3;Ue<B;Ue+=3){var lt=Kt(q[Ue],q[Ue+1],ue,ve,ze,Le);if(lt>ae)H=Ue,ae=lt;else if(lt===ae){var ft=Math.abs(Ue-me);ft<_e&&(H=Ue,_e=ft)}}ae>Z&&(H-P>3&&sa(q,P,H,Z),q[H+2]=ae,B-H>3&&sa(q,H,B,Z))}function Kt(q,P,B,Z,H,ae){var me=H-B,_e=ae-Z;if(me!==0||_e!==0){var ue=((q-B)*me+(P-Z)*_e)/(me*me+_e*_e);ue>1?(B=H,Z=ae):ue>0&&(B+=me*ue,Z+=_e*ue)}return(me=q-B)*me+(_e=P-Z)*_e}function eo(q,P,B,Z){var H={id:q===void 0?null:q,type:P,geometry:B,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ae){var me=ae.geometry,_e=ae.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")Bi(ae,me);else if(_e==="Polygon"||_e==="MultiLineString")for(var ue=0;ue<me.length;ue++)Bi(ae,me[ue]);else if(_e==="MultiPolygon")for(ue=0;ue<me.length;ue++)for(var ve=0;ve<me[ue].length;ve++)Bi(ae,me[ue][ve])}(H),H}function Bi(q,P){for(var B=0;B<P.length;B+=3)q.minX=Math.min(q.minX,P[B]),q.minY=Math.min(q.minY,P[B+1]),q.maxX=Math.max(q.maxX,P[B]),q.maxY=Math.max(q.maxY,P[B+1])}function zo(q,P,B,Z){if(P.geometry){var H=P.geometry.coordinates,ae=P.geometry.type,me=Math.pow(B.tolerance/((1<<B.maxZoom)*B.extent),2),_e=[],ue=P.id;if(B.promoteId?ue=P.properties[B.promoteId]:B.generateId&&(ue=Z||0),ae==="Point")ts(H,_e);else if(ae==="MultiPoint")for(var ve=0;ve<H.length;ve++)ts(H[ve],_e);else if(ae==="LineString")br(H,_e,me,!1);else if(ae==="MultiLineString"){if(B.lineMetrics){for(ve=0;ve<H.length;ve++)br(H[ve],_e=[],me,!1),q.push(eo(ue,"LineString",_e,P.properties));return}aa(H,_e,me,!1)}else if(ae==="Polygon")aa(H,_e,me,!0);else{if(ae!=="MultiPolygon"){if(ae==="GeometryCollection"){for(ve=0;ve<P.geometry.geometries.length;ve++)zo(q,{id:ue,geometry:P.geometry.geometries[ve],properties:P.properties},B,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ve=0;ve<H.length;ve++){var ze=[];aa(H[ve],ze,me,!0),_e.push(ze)}}q.push(eo(ue,ae,_e,P.properties))}}function ts(q,P){P.push(la(q[0])),P.push(ca(q[1])),P.push(0)}function br(q,P,B,Z){for(var H,ae,me=0,_e=0;_e<q.length;_e++){var ue=la(q[_e][0]),ve=ca(q[_e][1]);P.push(ue),P.push(ve),P.push(0),_e>0&&(me+=Z?(H*ve-ue*ae)/2:Math.sqrt(Math.pow(ue-H,2)+Math.pow(ve-ae,2))),H=ue,ae=ve}var ze=P.length-3;P[2]=1,sa(P,0,ze,B),P[ze+2]=1,P.size=Math.abs(me),P.start=0,P.end=P.size}function aa(q,P,B,Z){for(var H=0;H<q.length;H++){var ae=[];br(q[H],ae,B,Z),P.push(ae)}}function la(q){return q/360+.5}function ca(q){var P=Math.sin(q*Math.PI/180),B=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return B<0?0:B>1?1:B}function $n(q,P,B,Z,H,ae,me,_e){if(Z/=P,ae>=(B/=P)&&me<Z)return q;if(me<B||ae>=Z)return null;for(var ue=[],ve=0;ve<q.length;ve++){var ze=q[ve],Le=ze.geometry,Ue=ze.type,lt=H===0?ze.minX:ze.minY,ft=H===0?ze.maxX:ze.maxY;if(lt>=B&&ft<Z)ue.push(ze);else if(!(ft<B||lt>=Z)){var mt=[];if(Ue==="Point"||Ue==="MultiPoint")ul(Le,mt,B,Z,H);else if(Ue==="LineString")rs(Le,mt,B,Z,H,!1,_e.lineMetrics);else if(Ue==="MultiLineString")to(Le,mt,B,Z,H,!1);else if(Ue==="Polygon")to(Le,mt,B,Z,H,!0);else if(Ue==="MultiPolygon")for(var yt=0;yt<Le.length;yt++){var At=[];to(Le[yt],At,B,Z,H,!0),At.length&&mt.push(At)}if(mt.length){if(_e.lineMetrics&&Ue==="LineString"){for(yt=0;yt<mt.length;yt++)ue.push(eo(ze.id,Ue,mt[yt],ze.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(mt.length===1?(Ue="LineString",mt=mt[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=mt.length===3?"Point":"MultiPoint"),ue.push(eo(ze.id,Ue,mt,ze.tags))}}}return ue.length?ue:null}function ul(q,P,B,Z,H){for(var ae=0;ae<q.length;ae+=3){var me=q[ae+H];me>=B&&me<=Z&&(P.push(q[ae]),P.push(q[ae+1]),P.push(q[ae+2]))}}function rs(q,P,B,Z,H,ae,me){for(var _e,ue,ve=ns(q),ze=H===0?Gn:hl,Le=q.start,Ue=0;Ue<q.length-3;Ue+=3){var lt=q[Ue],ft=q[Ue+1],mt=q[Ue+2],yt=q[Ue+3],At=q[Ue+4],lr=H===0?lt:ft,hr=H===0?yt:At,rr=!1;me&&(_e=Math.sqrt(Math.pow(lt-yt,2)+Math.pow(ft-At,2))),lr<B?hr>B&&(ue=ze(ve,lt,ft,yt,At,B),me&&(ve.start=Le+_e*ue)):lr>Z?hr<Z&&(ue=ze(ve,lt,ft,yt,At,Z),me&&(ve.start=Le+_e*ue)):is(ve,lt,ft,mt),hr<B&&lr>=B&&(ue=ze(ve,lt,ft,yt,At,B),rr=!0),hr>Z&&lr<=Z&&(ue=ze(ve,lt,ft,yt,At,Z),rr=!0),!ae&&rr&&(me&&(ve.end=Le+_e*ue),P.push(ve),ve=ns(q)),me&&(Le+=_e)}var dr=q.length-3;lt=q[dr],ft=q[dr+1],mt=q[dr+2],(lr=H===0?lt:ft)>=B&&lr<=Z&&is(ve,lt,ft,mt),dr=ve.length-3,ae&&dr>=3&&(ve[dr]!==ve[0]||ve[dr+1]!==ve[1])&&is(ve,ve[0],ve[1],ve[2]),ve.length&&P.push(ve)}function ns(q){var P=[];return P.size=q.size,P.start=q.start,P.end=q.end,P}function to(q,P,B,Z,H,ae){for(var me=0;me<q.length;me++)rs(q[me],P,B,Z,H,ae,!1)}function is(q,P,B,Z){q.push(P),q.push(B),q.push(Z)}function Gn(q,P,B,Z,H,ae){var me=(ae-P)/(Z-P);return q.push(ae),q.push(B+(H-B)*me),q.push(1),me}function hl(q,P,B,Z,H,ae){var me=(ae-B)/(H-B);return q.push(P+(Z-P)*me),q.push(ae),q.push(1),me}function gr(q,P){for(var B=[],Z=0;Z<q.length;Z++){var H,ae=q[Z],me=ae.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")H=Zn(ae.geometry,P);else if(me==="MultiLineString"||me==="Polygon"){H=[];for(var _e=0;_e<ae.geometry.length;_e++)H.push(Zn(ae.geometry[_e],P))}else if(me==="MultiPolygon")for(H=[],_e=0;_e<ae.geometry.length;_e++){for(var ue=[],ve=0;ve<ae.geometry[_e].length;ve++)ue.push(Zn(ae.geometry[_e][ve],P));H.push(ue)}B.push(eo(ae.id,me,H,ae.tags))}return B}function Zn(q,P){var B=[];B.size=q.size,q.start!==void 0&&(B.start=q.start,B.end=q.end);for(var Z=0;Z<q.length;Z+=3)B.push(q[Z]+P,q[Z+1],q[Z+2]);return B}function os(q,P){if(q.transformed)return q;var B,Z,H,ae=1<<q.z,me=q.x,_e=q.y;for(B=0;B<q.features.length;B++){var ue=q.features[B],ve=ue.geometry,ze=ue.type;if(ue.geometry=[],ze===1)for(Z=0;Z<ve.length;Z+=2)ue.geometry.push(xi(ve[Z],ve[Z+1],P,ae,me,_e));else for(Z=0;Z<ve.length;Z++){var Le=[];for(H=0;H<ve[Z].length;H+=2)Le.push(xi(ve[Z][H],ve[Z][H+1],P,ae,me,_e));ue.geometry.push(Le)}}return q.transformed=!0,q}function xi(q,P,B,Z,H,ae){return[Math.round(B*(q*Z-H)),Math.round(B*(P*Z-ae))]}function ss(q,P,B,Z,H){for(var ae=P===H.maxZoom?0:H.tolerance/((1<<P)*H.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:B,y:Z,z:P,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},_e=0;_e<q.length;_e++){me.numFeatures++,Po(me,q[_e],ae,H);var ue=q[_e].minX,ve=q[_e].minY,ze=q[_e].maxX,Le=q[_e].maxY;ue<me.minX&&(me.minX=ue),ve<me.minY&&(me.minY=ve),ze>me.maxX&&(me.maxX=ze),Le>me.maxY&&(me.maxY=Le)}return me}function Po(q,P,B,Z){var H=P.geometry,ae=P.type,me=[];if(ae==="Point"||ae==="MultiPoint")for(var _e=0;_e<H.length;_e+=3)me.push(H[_e]),me.push(H[_e+1]),q.numPoints++,q.numSimplified++;else if(ae==="LineString")Fi(me,H,q,B,!1,!1);else if(ae==="MultiLineString"||ae==="Polygon")for(_e=0;_e<H.length;_e++)Fi(me,H[_e],q,B,ae==="Polygon",_e===0);else if(ae==="MultiPolygon")for(var ue=0;ue<H.length;ue++){var ve=H[ue];for(_e=0;_e<ve.length;_e++)Fi(me,ve[_e],q,B,!0,_e===0)}if(me.length){var ze=P.tags||null;if(ae==="LineString"&&Z.lineMetrics){for(var Le in ze={},P.tags)ze[Le]=P.tags[Le];ze.mapbox_clip_start=H.start/H.size,ze.mapbox_clip_end=H.end/H.size}var Ue={geometry:me,type:ae==="Polygon"||ae==="MultiPolygon"?3:ae==="LineString"||ae==="MultiLineString"?2:1,tags:ze};P.id!==null&&(Ue.id=P.id),q.features.push(Ue)}}function Fi(q,P,B,Z,H,ae){var me=Z*Z;if(Z>0&&P.size<(H?me:Z))B.numPoints+=P.length/3;else{for(var _e=[],ue=0;ue<P.length;ue+=3)(Z===0||P[ue+2]>me)&&(B.numSimplified++,_e.push(P[ue]),_e.push(P[ue+1])),B.numPoints++;H&&function(ve,ze){for(var Le=0,Ue=0,lt=ve.length,ft=lt-2;Ue<lt;ft=Ue,Ue+=2)Le+=(ve[Ue]-ve[ft])*(ve[Ue+1]+ve[ft+1]);if(Le>0===ze)for(Ue=0,lt=ve.length;Ue<lt/2;Ue+=2){var mt=ve[Ue],yt=ve[Ue+1];ve[Ue]=ve[lt-2-Ue],ve[Ue+1]=ve[lt-1-Ue],ve[lt-2-Ue]=mt,ve[lt-1-Ue]=yt}}(_e,ae),q.push(_e)}}function li(q,P){var B=(P=this.options=function(H,ae){for(var me in ae)H[me]=ae[me];return H}(Object.create(this.options),P)).debug;if(B&&console.time("preprocess data"),P.maxZoom<0||P.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(P.promoteId&&P.generateId)throw new Error("promoteId and generateId cannot be used together.");var Z=function(H,ae){var me=[];if(H.type==="FeatureCollection")for(var _e=0;_e<H.features.length;_e++)zo(me,H.features[_e],ae,_e);else zo(me,H.type==="Feature"?H:{geometry:H},ae);return me}(q,P);this.tiles={},this.tileCoords=[],B&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",P.indexMaxZoom,P.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Z=function(H,ae){var me=ae.buffer/ae.extent,_e=H,ue=$n(H,1,-1-me,me,0,-1,2,ae),ve=$n(H,1,1-me,2+me,0,-1,2,ae);return(ue||ve)&&(_e=$n(H,1,-me,1+me,0,-1,2,ae)||[],ue&&(_e=gr(ue,1).concat(_e)),ve&&(_e=_e.concat(gr(ve,-1)))),_e}(Z,P)).length&&this.splitTile(Z,0,0,0),B&&(Z.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ro(q,P,B){return 32*((1<<q)*B+P)+q}function wi(q,P){const B=q.tileID.canonical;if(!this._geoJSONIndex)return P(null,null);const Z=this._geoJSONIndex.getTile(B.z,B.x,B.y);if(!Z)return P(null,null);const H=new Q(Z.features);let ae=Qe(H);ae.byteOffset===0&&ae.byteLength===ae.buffer.byteLength||(ae=new Uint8Array(ae)),P(null,{vectorTile:H,rawData:ae.buffer})}li.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},li.prototype.splitTile=function(q,P,B,Z,H,ae,me){for(var _e=[q,P,B,Z],ue=this.options,ve=ue.debug;_e.length;){Z=_e.pop(),B=_e.pop(),P=_e.pop(),q=_e.pop();var ze=1<<P,Le=ro(P,B,Z),Ue=this.tiles[Le];if(!Ue&&(ve>1&&console.time("creation"),Ue=this.tiles[Le]=ss(q,P,B,Z,ue),this.tileCoords.push({z:P,x:B,y:Z}),ve)){ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",P,B,Z,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var lt="z"+P;this.stats[lt]=(this.stats[lt]||0)+1,this.total++}if(Ue.source=q,H){if(P===ue.maxZoom||P===H)continue;var ft=1<<H-P;if(B!==Math.floor(ae/ft)||Z!==Math.floor(me/ft))continue}else if(P===ue.indexMaxZoom||Ue.numPoints<=ue.indexMaxPoints)continue;if(Ue.source=null,q.length!==0){ve>1&&console.time("clipping");var mt,yt,At,lr,hr,rr,dr=.5*ue.buffer/ue.extent,no=.5-dr,Ui=.5+dr,rn=1+dr;mt=yt=At=lr=null,hr=$n(q,ze,B-dr,B+Ui,0,Ue.minX,Ue.maxX,ue),rr=$n(q,ze,B+no,B+rn,0,Ue.minX,Ue.maxX,ue),q=null,hr&&(mt=$n(hr,ze,Z-dr,Z+Ui,1,Ue.minY,Ue.maxY,ue),yt=$n(hr,ze,Z+no,Z+rn,1,Ue.minY,Ue.maxY,ue),hr=null),rr&&(At=$n(rr,ze,Z-dr,Z+Ui,1,Ue.minY,Ue.maxY,ue),lr=$n(rr,ze,Z+no,Z+rn,1,Ue.minY,Ue.maxY,ue),rr=null),ve>1&&console.timeEnd("clipping"),_e.push(mt||[],P+1,2*B,2*Z),_e.push(yt||[],P+1,2*B,2*Z+1),_e.push(At||[],P+1,2*B+1,2*Z),_e.push(lr||[],P+1,2*B+1,2*Z+1)}}},li.prototype.getTile=function(q,P,B){var Z=this.options,H=Z.extent,ae=Z.debug;if(q<0||q>24)return null;var me=1<<q,_e=ro(q,P=(P%me+me)%me,B);if(this.tiles[_e])return os(this.tiles[_e],H);ae>1&&console.log("drilling down to z%d-%d-%d",q,P,B);for(var ue,ve=q,ze=P,Le=B;!ue&&ve>0;)ve--,ze=Math.floor(ze/2),Le=Math.floor(Le/2),ue=this.tiles[ro(ve,ze,Le)];return ue&&ue.source?(ae>1&&console.log("found parent tile z%d-%d-%d",ve,ze,Le),ae>1&&console.time("drilling down"),this.splitTile(ue.source,ve,ze,Le,q,P,B),ae>1&&console.timeEnd("drilling down"),this.tiles[_e]?os(this.tiles[_e],H):null):null};class as extends a.VectorTileWorkerSource{constructor(P,B,Z,H,ae){super(P,B,Z,H,wi),ae&&(this.loadGeoJSON=ae)}loadData(P,B){const Z=P&&P.request,H=Z&&Z.collectResourceTiming;this.loadGeoJSON(P,(ae,me)=>{if(ae||!me)return B(ae);if(typeof me!="object")return B(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));{se(me,!0);try{if(P.filter){const ue=a.createExpression(P.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ue.result==="error")throw new Error(ue.value.map(ze=>`${ze.key}: ${ze.message}`).join(", "));const ve=me.features.filter(ze=>ue.value.evaluate({zoom:0},ze));me={type:"FeatureCollection",features:ve}}this._geoJSONIndex=P.cluster?new si(function({superclusterOptions:ue,clusterProperties:ve}){if(!ve||!ue)return ue;const ze={},Le={},Ue={accumulated:null,zoom:0},lt={properties:null},ft=Object.keys(ve);for(const mt of ft){const[yt,At]=ve[mt],lr=a.createExpression(At),hr=a.createExpression(typeof yt=="string"?[yt,["accumulated"],["get",mt]]:yt);ze[mt]=lr.value,Le[mt]=hr.value}return ue.map=mt=>{lt.properties=mt;const yt={};for(const At of ft)yt[At]=ze[At].evaluate(Ue,lt);return yt},ue.reduce=(mt,yt)=>{lt.properties=yt;for(const At of ft)Ue.accumulated=mt[At],mt[At]=Le[At].evaluate(Ue,lt)},ue}(P)).load(me.features):function(ue,ve){return new li(ue,ve)}(me,P.geojsonVtOptions)}catch(ue){return B(ue)}this.loaded={};const _e={};if(H){const ue=a.getPerformanceMeasurement(Z);ue&&(_e.resourceTiming={},_e.resourceTiming[P.source]=JSON.parse(JSON.stringify(ue)))}B(null,_e)}})}reloadTile(P,B){const Z=this.loaded;return Z&&Z[P.uid]?super.reloadTile(P,B):this.loadTile(P,B)}loadGeoJSON(P,B){if(P.request)a.getJSON(P.request,B);else{if(typeof P.data!="string")return B(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));try{return B(null,JSON.parse(P.data))}catch{return B(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(P,B){try{B(null,this._geoJSONIndex.getClusterExpansionZoom(P.clusterId))}catch(Z){B(Z)}}getClusterChildren(P,B){try{B(null,this._geoJSONIndex.getChildren(P.clusterId))}catch(Z){B(Z)}}getClusterLeaves(P,B){try{B(null,this._geoJSONIndex.getLeaves(P.clusterId,P.limit,P.offset))}catch(Z){B(Z)}}}class Pn{constructor(P){this.self=P,this.actor=new a.Actor(P,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:as},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(B,Z)=>{if(this.workerSourceTypes[B])throw new Error(`Worker source with name "${B}" already registered.`);this.workerSourceTypes[B]=Z},this.self.registerRTLTextPlugin=B=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=B.applyArabicShaping,a.plugin.processBidirectionalText=B.processBidirectionalText,a.plugin.processStyledBidirectionalText=B.processStyledBidirectionalText}}clearCaches(P,B,Z){delete this.layerIndexes[P],delete this.availableImages[P],delete this.workerSources[P],delete this.demWorkerSources[P],Z()}checkIfReady(P,B,Z){Z()}setReferrer(P,B){this.referrer=B}spriteLoaded(P,B){this.isSpriteLoaded[P]=B;for(const Z in this.workerSources[P]){const H=this.workerSources[P][Z];for(const ae in H)H[ae]instanceof a.VectorTileWorkerSource&&(H[ae].isSpriteLoaded=B,H[ae].fire(new a.Event("isSpriteLoaded")))}}setImages(P,B,Z){this.availableImages[P]=B;for(const H in this.workerSources[P]){const ae=this.workerSources[P][H];for(const me in ae)ae[me].availableImages=B}Z()}enableTerrain(P,B,Z){this.terrain=B,Z()}setProjection(P,B){this.projections[P]=a.getProjection(B)}setLayers(P,B,Z){this.getLayerIndex(P).replace(B),Z()}updateLayers(P,B,Z){this.getLayerIndex(P).update(B.layers,B.removedIds),Z()}loadTile(P,B,Z){const H=this.enableTerrain?a.extend({enableTerrain:this.terrain},B):B;H.projection=this.projections[P]||this.defaultProjection,this.getWorkerSource(P,B.type,B.source).loadTile(H,Z)}loadDEMTile(P,B,Z){const H=this.enableTerrain?a.extend({buildQuadTree:this.terrain},B):B;this.getDEMWorkerSource(P,B.source).loadTile(H,Z)}reloadTile(P,B,Z){const H=this.enableTerrain?a.extend({enableTerrain:this.terrain},B):B;H.projection=this.projections[P]||this.defaultProjection,this.getWorkerSource(P,B.type,B.source).reloadTile(H,Z)}abortTile(P,B,Z){this.getWorkerSource(P,B.type,B.source).abortTile(B,Z)}removeTile(P,B,Z){this.getWorkerSource(P,B.type,B.source).removeTile(B,Z)}removeSource(P,B,Z){if(!this.workerSources[P]||!this.workerSources[P][B.type]||!this.workerSources[P][B.type][B.source])return;const H=this.workerSources[P][B.type][B.source];delete this.workerSources[P][B.type][B.source],H.removeSource!==void 0?H.removeSource(B,Z):Z()}loadWorkerSource(P,B,Z){try{this.self.importScripts(B.url),Z()}catch(H){Z(H.toString())}}syncRTLPluginState(P,B,Z){try{a.plugin.setState(B);const H=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&H!=null){this.self.importScripts(H);const ae=a.plugin.isParsed();Z(ae?void 0:new Error(`RTL Text Plugin failed to import scripts from ${H}`),ae)}}catch(H){Z(H.toString())}}getAvailableImages(P){let B=this.availableImages[P];return B||(B=[]),B}getLayerIndex(P){let B=this.layerIndexes[P];return B||(B=this.layerIndexes[P]=new xe),B}getWorkerSource(P,B,Z){return this.workerSources[P]||(this.workerSources[P]={}),this.workerSources[P][B]||(this.workerSources[P][B]={}),this.workerSources[P][B][Z]||(this.workerSources[P][B][Z]=new this.workerSourceTypes[B]({send:(H,ae,me,_e,ue,ve)=>{this.actor.send(H,ae,me,P,ue,ve)},scheduler:this.actor.scheduler},this.getLayerIndex(P),this.getAvailableImages(P),this.isSpriteLoaded[P])),this.workerSources[P][B][Z]}getDEMWorkerSource(P,B){return this.demWorkerSources[P]||(this.demWorkerSources[P]={}),this.demWorkerSources[P][B]||(this.demWorkerSources[P][B]=new he),this.demWorkerSources[P][B]}enforceCacheSizeLimit(P,B){a.enforceCacheSizeLimit(B)}getWorkerPerformanceMetrics(P,B,Z){Z(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Pn(self)),Pn}),S(["./shared"],function(a){var O=X;function X(d){return!function(r){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,g,v=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(v);try{g=new Worker(w),p=!0}catch{p=!1}return g&&g.terminate(),URL.revokeObjectURL(w),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var g=p.getContext("2d");if(!g)return!1;var v=g.getImageData(0,0,1,1);return v&&v.width===p.width}()?(xe[l=r&&r.failIfMajorPerformanceCaveat]===void 0&&(xe[l]=function(p){var g,v=function(w){var T=document.createElement("canvas"),I=Object.create(X.webGLContextAttributes);return I.failIfMajorPerformanceCaveat=w,T.getContext("webgl",I)||T.getContext("experimental-webgl",I)}(p);if(!v)return!1;try{g=v.createShader(v.VERTEX_SHADER)}catch{return!1}return!(!g||v.isContextLost())&&(v.shaderSource(g,"void main() {}"),v.compileShader(g),v.getShaderParameter(g,v.COMPILE_STATUS)===!0)}(l)),xe[l]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var l}(d)}var xe={};function ce(d,r){var l=r[0],p=r[1],g=r[2],v=r[3],w=l*v-g*p;return w?(d[0]=v*(w=1/w),d[1]=-p*w,d[2]=-g*w,d[3]=l*w,d):null}function he(d,r){if(Array.isArray(d)){if(!Array.isArray(r)||d.length!==r.length)return!1;for(let l=0;l<d.length;l++)if(!he(d[l],r[l]))return!1;return!0}if(typeof d=="object"&&d!==null&&r!==null){if(typeof r!="object"||Object.keys(d).length!==Object.keys(r).length)return!1;for(const l in d)if(!he(d[l],r[l]))return!1;return!0}return d===r}X.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const se={create:function(d,r,l){const p=a.window.document.createElement(d);return r!==void 0&&(p.className=r),l&&l.appendChild(p),p},createSVG:function(d,r,l){const p=a.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const g of Object.keys(r))p.setAttributeNS(null,g,r[g]);return l&&l.appendChild(p),p}},De=a.window.document&&a.window.document.documentElement.style,Te=De&&De.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ne;se.disableDrag=function(){De&&Te&&(ne=De[Te],De[Te]="none")},se.enableDrag=function(){De&&Te&&(De[Te]=ne)};const Y=function(d){d.preventDefault(),d.stopPropagation(),a.window.removeEventListener("click",Y,!0)};function Q(d,r,l){const p=d.offsetWidth===r.width?1:d.offsetWidth/r.width;return new a.pointGeometry((l.clientX-r.left)*p,(l.clientY-r.top)*p)}function ge(d){const{userImage:r}=d;return!!(r&&r.render&&r.render())&&(d.data.replace(new Uint8Array(r.data.buffer)),!0)}se.suppressClick=function(){a.window.addEventListener("click",Y,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",Y,!0)},0)},se.mousePos=function(d,r){const l=d.getBoundingClientRect();return Q(d,l,r)},se.touchPos=function(d,r){const l=d.getBoundingClientRect(),p=[];for(let g=0;g<r.length;g++)p.push(Q(d,l,r[g]));return p},se.mouseButton=function(d){return a.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button};class we extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:l,callback:p}of this.requestors)this._notify(l,p);this.requestors=[]}}getImage(r){return this.images[r]}addImage(r,l){this._validate(r,l)&&(this.images[r]=l)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const g of r){if(g[0]<p||g[1]<g[0]||l<g[1])return!1;p=g[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l){l.version=this.images[r].version+1,this.images[r]=l,this.updatedImages[r]=!0}removeImage(r){const l=this.images[r];delete this.images[r],delete this.patterns[r],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,l){let p=!0;if(!this.isLoaded())for(const g of r)this.images[g]||(p=!1);this.isLoaded()||p?this._notify(r,l):this.requestors.push({ids:r,callback:l})}_notify(r,l){const p={};for(const g of r){this.images[g]||this.fire(new a.Event("styleimagemissing",{id:g}));const v=this.images[g];v?p[g]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:Boolean(v.userImage&&v.userImage.render)}:a.warnOnce(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,p)}getPixelSize(){const{width:r,height:l}=this.atlasImage;return{width:r,height:l}}getPattern(r){const l=this.patterns[r],p=this.getImage(r);if(!p)return null;if(l&&l.position.version===p.version)return l.position;if(l)l.position.version=p.version;else{const g={w:p.data.width+2,h:p.data.height+2,x:0,y:0},v=new a.ImagePosition(g,p);this.patterns[r]={bin:g,position:v}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const l=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(r,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const v in this.patterns)r.push(this.patterns[v].bin);const{w:l,h:p}=a.potpack(r),g=this.atlasImage;g.resize({width:l||1,height:p||1});for(const v in this.patterns){const{bin:w}=this.patterns[v],T=w.x+1,I=w.y+1,A=this.images[v].data,z=A.width,L=A.height;a.RGBAImage.copy(A,g,{x:0,y:0},{x:T,y:I},{width:z,height:L}),a.RGBAImage.copy(A,g,{x:0,y:L-1},{x:T,y:I-1},{width:z,height:1}),a.RGBAImage.copy(A,g,{x:0,y:0},{x:T,y:I+L},{width:z,height:1}),a.RGBAImage.copy(A,g,{x:z-1,y:0},{x:T-1,y:I},{width:1,height:L}),a.RGBAImage.copy(A,g,{x:0,y:0},{x:T+z,y:I},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const l of r){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const p=this.images[l];ge(p)&&this.updateImage(l,p)}}}const He=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(d,r){return function([l,p,g]){const v=a.degToRad(p+90),w=a.degToRad(g);return{x:l*Math.cos(v)*Math.sin(w),y:l*Math.sin(v)*Math.sin(w),z:l*Math.cos(w),azimuthal:p,polar:g}}(d.expression.evaluate(r))}interpolate(d,r,l){return{x:a.number(d.x,r.x,l),y:a.number(d.y,r.y,l),z:a.number(d.z,r.z,l),azimuthal:a.number(d.azimuthal,r.azimuthal,l),polar:a.number(d.polar,r.polar,l)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Ee="-transition";class Qe extends a.Evented{constructor(r){super(),this._transitionable=new a.Transitionable(He),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l={}){if(!this._validate(a.validateLight,r,l))for(const p in r){const g=r[p];a.endsWith(p,Ee)?this._transitionable.setTransition(p.slice(0,-Ee.length),g):this._transitionable.setValue(p,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&a.emitValidationErrors(this,r.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Ve=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),Fe="-transition";class nt extends a.Evented{constructor(r,l){super(),this._transitionable=new a.Transitionable(Ve),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(r){for(const l in r){const p=r[l];a.endsWith(l,Fe)?this._transitionable.setTransition(l.slice(0,-Fe.length),p):this._transitionable.setValue(l,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function bt(d,r,l,p){const g=a.smoothstep(45,65,l),[v,w]=ut(d,p),T=a.length(r);let I=1-Math.min(1,Math.exp((T-v)/(w-v)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*g*d.alpha}function ut(d,r){const l=.5/Math.tan(.5*r);return[d.range[0]+l,d.range[1]+l]}const st=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"])}),$r="-transition";class ar extends a.Evented{constructor(r,l){super(),this._transitionable=new a.Transitionable(st),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=l}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l={}){if(!this._validate(a.validateFog,r,l))for(const p in r){const g=r[p];a.endsWith(p,$r)?this._transitionable.setTransition(p.slice(0,-$r.length),g):this._transitionable.setValue(p,g)}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return a.smoothstep(45,65,r)*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,g,v){const w=a.MercatorCoordinate.fromLngLat(g),T=v.elevation?v.elevation.getAtPointOrZero(w):0,I=[w.x,w.y,T];return a.transformMat4(I,I,v.mercatorFogMatrix),bt(p,I,v.pitch,v._fov)}(this.state,r,l):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?ut(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&a.emitValidationErrors(this,r.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class ur{constructor(r,l){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const p=this.workerPool.acquire(this.id);for(let g=0;g<p.length;g++){const v=new ur.Actor(p[g],l,this.id);v.name=`Worker ${g}`,this.actors.push(v)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,l,p){a.asyncAll(this.actors,(g,v)=>{g.send(r,l,v)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function wr(d,r,l){return r*(a.EXTENT/(d.tileSize*Math.pow(2,l-d.tileID.overscaledZ)))}ur.Actor=a.Actor;class Gr{constructor(r,l,p){this.context=r;const g=r.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class dn{constructor(r,l,p,g){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=g,this.context=r;const v=r.gl;this.buffer=v.createBuffer(),r.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const g=l.attributes[this.attributes[p].name];g!==void 0&&r.enableVertexAttribArray(g)}}setVertexAttribPointers(r,l,p){for(let g=0;g<this.attributes.length;g++){const v=this.attributes[g],w=l.attributes[v.name];w!==void 0&&r.vertexAttribPointer(w,v.components,r[Wr[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class je{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class gt extends je{getDefault(){return a.Color.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class St extends je{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class $t extends je{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class zr extends je{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class xn extends je{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Hr extends je{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class si extends je{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class ai extends je{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class ll extends je{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class na extends je{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class cl extends je{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class es extends je{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Pt extends je{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class zn extends je{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ao extends je{getDefault(){return a.Color.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ia extends je{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class oa extends je{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class sa extends je{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Kt extends je{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class eo extends je{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Bi extends je{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class zo extends je{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ts extends je{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class br extends je{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class aa extends je{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class la extends je{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class ca extends je{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class $n extends je{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class ul extends je{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class rs extends je{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class ns extends je{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class to extends je{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class is extends to{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Gn extends to{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class hl extends Gn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class gr{constructor(r,l,p,g){this.context=r,this.width=l,this.height=p;const v=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new is(r,v),g&&(this.depthAttachment=new Gn(r,v))}destroy(){const r=this.context.gl,l=this.colorAttachment.get();if(l&&r.deleteTexture(l),this.depthAttachment){const p=this.depthAttachment.get();p&&r.deleteRenderbuffer(p)}r.deleteFramebuffer(this.framebuffer)}}class Zn{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new gt(this),this.clearDepth=new St(this),this.clearStencil=new $t(this),this.colorMask=new zr(this),this.depthMask=new xn(this),this.stencilMask=new Hr(this),this.stencilFunc=new si(this),this.stencilOp=new ai(this),this.stencilTest=new ll(this),this.depthRange=new na(this),this.depthTest=new cl(this),this.depthFunc=new es(this),this.blend=new Pt(this),this.blendFunc=new zn(this),this.blendColor=new Ao(this),this.blendEquation=new ia(this),this.cullFace=new oa(this),this.cullFaceSide=new sa(this),this.frontFace=new Kt(this),this.program=new eo(this),this.activeTexture=new Bi(this),this.viewport=new zo(this),this.bindFramebuffer=new ts(this),this.bindRenderbuffer=new br(this),this.bindTexture=new aa(this),this.bindVertexBuffer=new la(this),this.bindElementBuffer=new ca(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $n(this),this.pixelStoreUnpack=new ul(this),this.pixelStoreUnpackPremultiplyAlpha=new rs(this),this.pixelStoreUnpackFlipY=new ns(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l){return new Gr(this,r,l)}createVertexBuffer(r,l,p){return new dn(this,r,l,p)}createRenderbuffer(r,l,p){const g=this.gl,v=g.createRenderbuffer();return this.bindRenderbuffer.set(v),g.renderbufferStorage(g.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),v}createFramebuffer(r,l,p){return new gr(this,r,l,p)}clear({color:r,depth:l,stencil:p}){const g=this.gl;let v=0;r&&(v|=g.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(v|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(v|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),g.clear(v)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){he(r.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class os{constructor(r,l,p,g){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(v=>g.pointCoordinate3D(v)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(r,l){let p,g;if(r instanceof a.pointGeometry||typeof r[0]=="number"){const v=a.pointGeometry.convert(r);p=[a.pointGeometry.convert(r)],g=l.isPointAboveHorizon(v)}else{const v=a.pointGeometry.convert(r[0]),w=a.pointGeometry.convert(r[1]);p=[v,w],g=a.polygonizeBounds(v,w).every(T=>l.isPointAboveHorizon(T))}return new os(p,l.getCameraPoint(),g,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],g=a.polygonizeBounds(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?g.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?g[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(g[3]=this.cameraPoint)),a.bufferConvexPolygon(g,r)}containsTile(r,l,p){const g=r.queryPadding+1,v=r.tileID.wrap,w=p?this._bufferedCameraMercator(g,l).map(N=>a.getTilePoint(r.tileTransform,N,v)):this._bufferedScreenMercator(g,l).map(N=>a.getTilePoint(r.tileTransform,N,v)),T=this.screenGeometryMercator.map(N=>a.getTileVec3(r.tileTransform,N,v)),I=T.map(N=>new a.pointGeometry(N[0],N[1])),A=l.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),z=a.getTileVec3(r.tileTransform,A,v),L=T.map(N=>{const G=a.sub(N,N,z);return a.normalize(G,G),new a.Ray(z,G)}),F=wr(r,1,l.zoom);if(a.polygonIntersectsBox(w,0,0,a.EXTENT,a.EXTENT))return{queryGeometry:this,tilespaceGeometry:I,tilespaceRays:L,bufferedTilespaceGeometry:w,bufferedTilespaceBounds:($=a.getBounds(w),$.min.x=a.clamp($.min.x,0,a.EXTENT),$.min.y=a.clamp($.min.y,0,a.EXTENT),$.max.x=a.clamp($.max.x,0,a.EXTENT),$.max.y=a.clamp($.max.y,0,a.EXTENT),$),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:F};var $}_bufferedScreenMercator(r,l){const p=xi(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{const g=this.bufferedScreenGeometry(r).map(v=>l.pointCoordinate3D(v));return this._screenRaycastCache[p]=g,g}}_bufferedCameraMercator(r,l){const p=xi(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{const g=this.bufferedCameraGeometry(r).map(v=>l.pointCoordinate3D(v));return this._cameraRaycastCache[p]=g,g}}}function xi(d){return 100*d|0}function ss(d,r,l){const p=function(g,v){if(g)return l(g);if(v){const w=a.pick(a.extend(v,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);v.vector_layers&&(w.vectorLayers=v.vector_layers,w.vectorLayerIds=w.vectorLayers.map(T=>T.id)),w.tiles=r.canonicalizeTileset(w,d.url),l(null,w)}};return d.url?a.getJSON(r.transformRequest(r.normalizeSourceURL(d.url),a.ResourceType.Source),p):a.exported.frame(()=>p(null,d))}class Po{constructor(r,l,p){this.bounds=a.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),p=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*l),g=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*l),v=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*l),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*l);return r.x>=p&&r.x<v&&r.y>=g&&r.y<w}}class Fi extends a.Evented{constructor(r,l,p,g){super(),this.id=r,this.dispatcher=p,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},l),a.extend(this,a.pick(l,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ss(this._options,this.map._requestManager,(r,l)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new a.ErrorEvent(r)):l&&(a.extend(this,l),l.bounds&&(this.tileBounds=new Po(l.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(l.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=a.exported.devicePixelRatio>=2,g=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=a.getImage(this.map._requestManager.transformRequest(g,a.ResourceType.Tile),(v,w,T,I)=>{if(delete r.request,r.aborted)r.state="unloaded",l(null);else if(v)r.state="errored",l(v);else if(w){this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:T,expires:I});const A=this.map.painter.context,z=A.gl;r.texture=this.map.painter.getTileTexture(w.width),r.texture?r.texture.update(w,{useMipmap:!0}):(r.texture=new a.Texture(A,w,z.RGBA,{useMipmap:!0}),r.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE),A.extTextureFilterAnisotropic&&z.texParameterf(z.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax)),r.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),l(null)}})}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l()}unloadTile(r,l){r.texture&&this.map.painter.saveTileTexture(r.texture),l()}hasTransition(){return!1}}let li;function ro(d,r,l,p,g,v,w,T){const I=[d,l,g,r,p,v,1,1,1],A=[w,T,1],z=a.adjoint([],I),[L,F,$]=a.transformMat3(A,A,a.transpose(z,z));return a.multiply(I,[L,0,0,0,F,0,0,0,$],I)}class wi extends a.Evented{constructor(r,l,p,g){super(),this.id=r,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=l}load(r,l){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(p,g)=>{this._loaded=!0,p?this.fire(new a.ErrorEvent(p)):g&&(this.image=a.exported.getImageData(g),this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),l&&l(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}setCoordinates(r){this.coordinates=r,delete this._boundsArray;const l=r.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let g=1/0,v=1/0,w=-1/0,T=-1/0;for(const L of p)g=Math.min(g,L.x),v=Math.min(v,L.y),w=Math.max(w,L.x),T=Math.max(T,L.y);const I=Math.max(w-g,T-v),A=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),z=Math.pow(2,A);return new a.CanonicalTileID(A,Math.floor((g+w)/2*z),Math.floor((v+T)/2*z))}(l),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const r=a.tileTransform(this.tileID,this.map.transform.projection),[l,p,g,v]=this.coordinates.map(w=>{const T=r.projection.project(w[0],w[1]);return a.getTilePoint(r,T)._round()});return this.perspectiveTransform=function(w,T,I,A,z,L,F,$,N,G){const ie=ro(0,0,w,0,0,T,w,T),V=ro(I,A,z,L,F,$,N,G);return a.multiply(V,a.adjoint(ie,ie),V),[V[6]/V[8]*w/a.EXTENT,V[7]/V[8]*T/a.EXTENT]}(this.width,this.height,l.x,l.y,p.x,p.y,v.x,v.y,g.x,g.y),this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(l.x,l.y,0,0),this._boundsArray.emplaceBack(p.x,p.y,a.EXTENT,0),this._boundsArray.emplaceBack(v.x,v.y,0,a.EXTENT),this._boundsArray.emplaceBack(g.x,g.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,l=r.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(r,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}loadTile(r,l){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},l(null)):(r.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const as={vector:class extends a.Evented{constructor(d,r,l,p){if(super(),this.id=d,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(r,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ss(this._options,this.map._requestManager,(d,r)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new a.ErrorEvent(d)):r&&(a.extend(this,r),r.bounds&&(this.tileBounds=new Po(r.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(r.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d();const r=this.map.style._getSourceCaches(this.id);for(const l of r)l.clearTiles();this.load()}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(d,r){const l=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,a.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=r:d.request=d.actor.send("reloadTile",p,g.bind(this));else if(d.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",p,g.bind(this),void 0,!0);else{const v=a.loadVectorTile.call({deduped:this._deduped},p,(w,T)=>{w||!T?g.call(this,w):(p.data={cacheControl:T.cacheControl,expires:T.expires,rawData:T.rawData.slice(0)},d.actor&&d.actor.send("loadTile",p,g.bind(this),void 0,!0))},!0);d.request={cancel:v}}function g(v,w){return delete d.request,d.aborted?r(null):v&&v.status!==404?r(v):(w&&w.resourceTiming&&(d.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&d.setExpiryData(w),d.loadVectorData(w,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Fi,"raster-dem":class extends Fi{constructor(d,r,l,p){super(d,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(d,r){const l=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(g,v){g&&(d.state="errored",r(g)),v&&(d.dem=v,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",r(null))}d.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),function(g,v,w,T){if(delete d.request,d.aborted)d.state="unloaded",r(null);else if(g)d.state="errored",r(g);else if(v){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:w,expires:T});const I=a.window.ImageBitmap&&v instanceof a.window.ImageBitmap&&(li==null&&(li=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),li),A=1-(v.width-a.prevPowerOfTwo(v.width))/2;A<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const z=I?v:a.exported.getImageData(v,A),L={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:z,encoding:this.encoding,padding:A};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",L,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const r=d.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,g=r.x===0?d.wrap-1:d.wrap,v=(r.x+1+l)%l,w=r.x+1===l?d.wrap+1:d.wrap,T={};return T[new a.OverscaledTileID(d.overscaledZ,g,r.z,p,r.y).key]={backfilled:!1},T[new a.OverscaledTileID(d.overscaledZ,w,r.z,v,r.y).key]={backfilled:!1},r.y>0&&(T[new a.OverscaledTileID(d.overscaledZ,g,r.z,p,r.y-1).key]={backfilled:!1},T[new a.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},T[new a.OverscaledTileID(d.overscaledZ,w,r.z,v,r.y-1).key]={backfilled:!1}),r.y+1<l&&(T[new a.OverscaledTileID(d.overscaledZ,g,r.z,p,r.y+1).key]={backfilled:!1},T[new a.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},T[new a.OverscaledTileID(d.overscaledZ,w,r.z,v,r.y+1).key]={backfilled:!1}),T}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends a.Evented{constructor(d,r,l,p){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=a.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const g=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*g,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*g,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:a.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*g,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},r),this}getClusterChildren(d,r){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},r),this}getClusterLeaves(d,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:r,offset:l},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=a.extend({},this.workerOptions),r=this._data;typeof r=="string"?(d.request=this.map._requestManager.transformRequest(a.exported.resolveURL(r),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(l,p)=>{if(this._loaded=!0,this._pendingLoad=null,l)this.fire(new a.ErrorEvent(l));else{const g={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(g.resourceTiming=p.resourceTiming[this.id]),this.fire(new a.Event("data",g)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,r){const l=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(l,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,g)=>(delete d.request,d.unloadVectorData(),d.aborted?r(null):p?r(p):(d.loadVectorData(g,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends wi{constructor(d,r,l,p){super(d,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const r of d.urls)this.urls.push(this.map._requestManager.transformRequest(r,a.ResourceType.Source).url);a.getVideo(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new a.ErrorEvent(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const r=this.video.seekable;d<r.start(0)||d>r.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,r=d.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(d,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2));for(const l in this.tiles){const p=this.tiles[l];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:wi,canvas:class extends wi{constructor(d,r,l,p){super(d,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(r,this.canvas,l.RGBA,{premultiply:!0});for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}}},Pn=function(d,r,l,p){const g=new as[r.type](d,r,l,p);if(g.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${g.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],g),g};function q(d,r){const l=a.identity([]);return a.scale(l,l,[.5*d.width,.5*-d.height,1]),a.translate(l,l,[1,-1,0]),a.multiply$1(l,l,d.calculateProjMatrix(r.toUnwrapped()))}function P(d,r,l,p,g,v,w,T=!1){const I=d.tilesIn(p,w,T);I.sort(Z);const A=[];for(const L of I)A.push({wrappedTileID:L.tile.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(r,l,d._state,L,g,v,q(d.transform,L.tile.tileID),T)});const z=function(L){const F={},$={};for(const N of L){const G=N.queryResults,ie=N.wrappedTileID,V=$[ie]=$[ie]||{};for(const ee in G){const te=G[ee],K=V[ee]=V[ee]||{},J=F[ee]=F[ee]||[];for(const oe of te)K[oe.featureIndex]||(K[oe.featureIndex]=!0,J.push(oe))}}return F}(A);for(const L in z)z[L].forEach(F=>{const $=F.feature,N=d.getFeatureState($.layer["source-layer"],$.id);$.source=$.layer.source,$.layer["source-layer"]&&($.sourceLayer=$.layer["source-layer"]),$.state=N});return z}function B(d,r){const l=d.getRenderableIds().map(v=>d.getTileByID(v)),p=[],g={};for(let v=0;v<l.length;v++){const w=l[v],T=w.tileID.canonical.key;g[T]||(g[T]=!0,w.querySourceFeatures(p,r))}return p}function Z(d,r){const l=d.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function H(){return mo.workerClass!=null?new mo.workerClass:new a.window.Worker(mo.workerUrl)}const ae="mapboxgl_preloaded_worker_pool";class me{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<me.workerCount;)this.workers.push(new H);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ae]}numActive(){return Object.keys(this.active).length}}let _e;function ue(){return _e||(_e=new me),_e}function ve(d,r){const l={};for(const p in d)p!=="ref"&&(l[p]=d[p]);return a.refProperties.forEach(p=>{p in r&&(l[p]=r[p])}),l}function ze(d){d=d.slice();const r=Object.create(null);for(let l=0;l<d.length;l++)r[d[l].id]=d[l];for(let l=0;l<d.length;l++)"ref"in d[l]&&(d[l]=ve(d[l],r[d[l].ref]));return d}me.workerCount=2;const Le={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ue(d,r,l){l.push({command:Le.addSource,args:[d,r[d]]})}function lt(d,r,l){r.push({command:Le.removeSource,args:[d]}),l[d]=!0}function ft(d,r,l,p){lt(d,l,p),Ue(d,r,l)}function mt(d,r,l){let p;for(p in d[l])if(d[l].hasOwnProperty(p)&&p!=="data"&&!he(d[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!he(d[l][p],r[l][p]))return!1;return!0}function yt(d,r,l,p,g,v){let w;for(w in r=r||{},d=d||{})d.hasOwnProperty(w)&&(he(d[w],r[w])||l.push({command:v,args:[p,w,r[w],g]}));for(w in r)r.hasOwnProperty(w)&&!d.hasOwnProperty(w)&&(he(d[w],r[w])||l.push({command:v,args:[p,w,r[w],g]}))}function At(d){return d.id}function lr(d,r){return d[r.id]=r,d}class hr{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=a.clamp(r,0,1);let l=1,p=this._distances[l];const g=r*this.paddedLength+this.padding;for(;p<g&&l<this._distances.length;)p=this._distances[++l];const v=l-1,w=this._distances[v],T=p-w,I=T>0?(g-w)/T:0;return this.points[v].mult(1-I).add(this.points[l].mult(I))}}class rr{constructor(r,l,p){const g=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let w=0;w<this.xCellCount*this.yCellCount;w++)g.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,g,v){this._forEachCell(l,p,g,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(v)}insertCircle(r,l,p,g){this._forEachCell(l-g,p-g,l+g,p+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(g)}_insertBoxCell(r,l,p,g,v,w){this.boxCells[v].push(w)}_insertCircleCell(r,l,p,g,v,w){this.circleCells[v].push(w)}_query(r,l,p,g,v,w){if(p<0||r>this.width||g<0||l>this.height)return!v&&[];const T=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=g){if(v)return!0;for(let I=0;I<this.boxKeys.length;I++)T.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const A=this.circles[3*I],z=this.circles[3*I+1],L=this.circles[3*I+2];T.push({key:this.circleKeys[I],x1:A-L,y1:z-L,x2:A+L,y2:z+L})}return w?T.filter(w):T}return this._forEachCell(r,l,p,g,this._queryCell,T,{hitTest:v,seenUids:{box:{},circle:{}}},w),v?T.length>0:T}_queryCircle(r,l,p,g,v){const w=r-p,T=r+p,I=l-p,A=l+p;if(T<0||w>this.width||A<0||I>this.height)return!g&&[];const z=[];return this._forEachCell(w,I,T,A,this._queryCellCircle,z,{hitTest:g,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},v),g?z.length>0:z}query(r,l,p,g,v){return this._query(r,l,p,g,!1,v)}hitTest(r,l,p,g,v){return this._query(r,l,p,g,!0,v)}hitTestCircle(r,l,p,g){return this._queryCircle(r,l,p,!0,g)}_queryCell(r,l,p,g,v,w,T,I){const A=T.seenUids,z=this.boxCells[v];if(z!==null){const F=this.bboxes;for(const $ of z)if(!A.box[$]){A.box[$]=!0;const N=4*$;if(r<=F[N+2]&&l<=F[N+3]&&p>=F[N+0]&&g>=F[N+1]&&(!I||I(this.boxKeys[$]))){if(T.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[$],x1:F[N],y1:F[N+1],x2:F[N+2],y2:F[N+3]})}}}const L=this.circleCells[v];if(L!==null){const F=this.circles;for(const $ of L)if(!A.circle[$]){A.circle[$]=!0;const N=3*$;if(this._circleAndRectCollide(F[N],F[N+1],F[N+2],r,l,p,g)&&(!I||I(this.circleKeys[$]))){if(T.hitTest)return w.push(!0),!0;{const G=F[N],ie=F[N+1],V=F[N+2];w.push({key:this.circleKeys[$],x1:G-V,y1:ie-V,x2:G+V,y2:ie+V})}}}}}_queryCellCircle(r,l,p,g,v,w,T,I){const A=T.circle,z=T.seenUids,L=this.boxCells[v];if(L!==null){const $=this.bboxes;for(const N of L)if(!z.box[N]){z.box[N]=!0;const G=4*N;if(this._circleAndRectCollide(A.x,A.y,A.radius,$[G+0],$[G+1],$[G+2],$[G+3])&&(!I||I(this.boxKeys[N])))return w.push(!0),!0}}const F=this.circleCells[v];if(F!==null){const $=this.circles;for(const N of F)if(!z.circle[N]){z.circle[N]=!0;const G=3*N;if(this._circlesCollide($[G],$[G+1],$[G+2],A.x,A.y,A.radius)&&(!I||I(this.circleKeys[N])))return w.push(!0),!0}}}_forEachCell(r,l,p,g,v,w,T,I){const A=this._convertToXCellCoord(r),z=this._convertToYCellCoord(l),L=this._convertToXCellCoord(p),F=this._convertToYCellCoord(g);for(let $=A;$<=L;$++)for(let N=z;N<=F;N++)if(v.call(this,r,l,p,g,this.xCellCount*N+$,w,T,I))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,g,v,w){const T=g-r,I=v-l,A=p+w;return A*A>T*T+I*I}_circleAndRectCollide(r,l,p,g,v,w,T){const I=(w-g)/2,A=Math.abs(r-(g+I));if(A>I+p)return!1;const z=(T-v)/2,L=Math.abs(l-(v+z));if(L>z+p)return!1;if(A<=I||L<=z)return!0;const F=A-I,$=L-z;return F*F+$*$<=p*p}}const dr=Math.tan(85*Math.PI/180);function no(d,r,l,p,g,v){let w=a.create();if(l){if(g.projection.name==="globe")w=a.calculateGlobeMatrix(g,g.worldSize/g._projectionScaler,[0,0]),a.multiply$1(w,w,a.globeDenormalizeECEF(a.globeTileBounds(r)));else{const T=ce([],v);w[0]=T[0],w[1]=T[1],w[4]=T[2],w[5]=T[3]}p||a.rotateZ(w,w,g.angle)}else a.multiply$1(w,g.labelPlaneMatrix,d);return w}function Ui(d,r,l,p,g,v){if(l){if(g.projection.name==="globe"){const w=no(d,r,l,p,g,v);return a.invert(w,w),a.multiply$1(w,d,w),w}{const w=a.clone(d),T=a.identity([]);return T[0]=v[0],T[1]=v[1],T[4]=v[2],T[5]=v[3],a.multiply$1(w,w,T),p||a.rotateZ(w,w,-g.angle),w}}return g.glCoordMatrix}function rn(d,r,l=0){const p=[d.x,d.y,l,1];l?a.transformMat4$1(p,p,r):da(p,p,r);const g=p[3];return{point:new a.pointGeometry(p[0]/g,p[1]/g),signedDistanceFromCamera:g}}function bi(d,r){return Math.min(.5+d/r*.5,1.5)}function dl(d,r){const l=d[0]/d[3],p=d[1]/d[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function Kh(d,r,l,p,g,v,w,T,I,A){const z=l.transform,L=p?d.textSizeData:d.iconSizeData,F=a.evaluateSizeForZoom(L,l.transform.zoom),$=[256/l.width*2+1,256/l.height*2+1],N=p?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;N.clear();const G=d.lineVertexArray,ie=p?d.text.placedSymbolArray:d.icon.placedSymbolArray,V=l.transform.width/l.transform.height;let ee=!1;for(let te=0;te<ie.length;te++){const K=ie.get(te);if(K.writingMode!==a.WritingMode.vertical||ee||te!==0&&ie.get(te-1).writingMode===a.WritingMode.horizontal||(ee=!0),K.hidden||K.writingMode===a.WritingMode.vertical&&!ee){ci(K.numGlyphs,N);continue}ee=!1;const J=new a.pointGeometry(K.tileAnchorX,K.tileAnchorY),oe=I?I(J):[0,0,0],ye=z.projection.projectTilePoint(J.x,J.y,A.canonical),Se=[ye.x+oe[0],ye.y+oe[1],ye.z+oe[2]],We=[...Se,1];if(a.transformMat4$1(We,We,r),!dl(We,$)){ci(K.numGlyphs,N);continue}const Ne=bi(l.transform.cameraToCenterDistance,We[3]),Be=a.evaluateSizeForFeature(L,F,K),ke=w?Be/Ne:Be*Ne,be=rn(new a.pointGeometry(Se[0],Se[1]),g,Se[2]);if(be.signedDistanceFromCamera<=0){ci(K.numGlyphs,N);continue}let Oe={};const Pe=w?null:I,ct=Yc(K,ke,!1,T,r,g,v,d.glyphOffsetArray,G,N,be.point,J,Oe,V,Pe,z.projection,A);ee=ct.useVertical,Pe&&ct.needsFlipping&&(Oe={}),(ct.notEnoughRoom||ee||ct.needsFlipping&&Yc(K,ke,!0,T,r,g,v,d.glyphOffsetArray,G,N,be.point,J,Oe,V,Pe,z.projection,A).notEnoughRoom)&&ci(K.numGlyphs,N)}p?d.text.dynamicLayoutVertexBuffer.updateData(N):d.icon.dynamicLayoutVertexBuffer.updateData(N)}function Xc(d,r,l,p,g,v,w,T,I,A,z,L,F,$,N){const G=T.glyphStartIndex+T.numGlyphs,ie=T.lineStartIndex,V=T.lineStartIndex+T.lineLength,ee=r.getoffsetX(T.glyphStartIndex),te=r.getoffsetX(G-1),K=ha(d*ee,l,p,g,v,w,T.segment,ie,V,I,A,z,L,F,!0,$,N);if(!K)return null;const J=ha(d*te,l,p,g,v,w,T.segment,ie,V,I,A,z,L,F,!0,$,N);return J?{first:K,last:J}:null}function ua(d,r,l,p){return d.writingMode===a.WritingMode.horizontal&&Math.abs(l.y-r.y)>Math.abs(l.x-r.x)*p?{useVertical:!0}:d.writingMode===a.WritingMode.vertical?r.y<l.y?{needsFlipping:!0}:null:d.flipState!==0&&function(g,v,w){const T=(v.x-g.x)*w;return T===0||Math.abs((v.y-g.y)/T)>dr}(r,l,p)?d.flipState===1?{needsFlipping:!0}:null:r.x>l.x?{needsFlipping:!0}:null}function Yc(d,r,l,p,g,v,w,T,I,A,z,L,F,$,N,G,ie){const V=r/24,ee=d.lineOffsetX*V,te=d.lineOffsetY*V;let K;if(d.numGlyphs>1){const J=d.glyphStartIndex+d.numGlyphs,oe=d.lineStartIndex,ye=d.lineStartIndex+d.lineLength,Se=Xc(V,T,ee,te,l,z,L,d,I,v,F,N,!1,G,ie);if(!Se)return{notEnoughRoom:!0};const We=rn(Se.first.point,w).point,Ne=rn(Se.last.point,w).point;if(p&&!l){const Be=ua(d,We,Ne,$);if(d.flipState=Be&&Be.needsFlipping?1:2,Be)return Be}K=[Se.first];for(let Be=d.glyphStartIndex+1;Be<J-1;Be++)K.push(ha(V*T.getoffsetX(Be),ee,te,l,z,L,d.segment,oe,ye,I,v,F,N,!1,!1,G,ie));K.push(Se.last)}else{if(p&&!l){const oe=rn(L,g).point,ye=d.lineStartIndex+d.segment+1,Se=new a.pointGeometry(I.getx(ye),I.gety(ye)),We=rn(Se,g),Ne=ua(d,oe,We.signedDistanceFromCamera>0?We.point:fl(L,Se,oe,1,g,void 0,G,ie.canonical),$);if(d.flipState=Ne&&Ne.needsFlipping?1:2,Ne)return Ne}const J=ha(V*T.getoffsetX(d.glyphStartIndex),ee,te,l,z,L,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,I,v,F,N,!1,!1,G,ie);if(!J)return{notEnoughRoom:!0};K=[J]}for(const J of K)a.addDynamicAttributes(A,J.point,J.angle);return{}}function pl(d,r,l,p,g){const v=p.projectTilePoint(d.x,d.y,r);if(!g)return rn(v,l,v.z);const w=g(d);return rn(new a.pointGeometry(v.x+w[0],v.y+w[1]),l,v.z+w[2])}function fl(d,r,l,p,g,v,w,T){const I=pl(d.add(d.sub(r)._unit()),T,g,w,v).point,A=l.sub(I);return l.add(A._mult(p/A.mag()))}function ha(d,r,l,p,g,v,w,T,I,A,z,L,F,$,N,G,ie){const V=p?d-r:d+r;let ee=V>0?1:-1,te=0;p&&(ee*=-1,te=Math.PI),ee<0&&(te+=Math.PI);let K=ee>0?T+w:T+w+1,J=g,oe=g,ye=0,Se=0;const We=Math.abs(V),Ne=[],Be=[];let ke=v;const be=()=>{const qe=K-ee;return ye===0?v:new a.pointGeometry(A.getx(qe),A.gety(qe))},Oe=()=>fl(be(),ke,oe,We-ye+1,z,F,G,ie.canonical);for(;ye+Se<=We;){if(K+=ee,K<T||K>=I)return null;if(oe=J,Ne.push(J),$&&Be.push(ke||be()),J=L[K],J===void 0){ke=new a.pointGeometry(A.getx(K),A.gety(K));const qe=pl(ke,ie.canonical,z,G,F);J=qe.signedDistanceFromCamera>0?L[K]=qe.point:Oe()}else ke=null;ye+=Se,Se=oe.dist(J)}N&&F&&(ke=ke||new a.pointGeometry(A.getx(K),A.gety(K)),L[K]=J=L[K]===void 0?J:Oe(),Se=oe.dist(J));const Pe=(We-ye)/Se,ct=J.sub(oe),_t=ct.mult(Pe)._add(oe);l&&_t._add(ct._unit()._perp()._mult(l*ee));const kt=te+Math.atan2(J.y-oe.y,J.x-oe.x);return Ne.push(_t),$&&(ke=ke||new a.pointGeometry(A.getx(K),A.gety(K)),Be.push(function(qe,dt,xt){const Yt=1-xt;return new a.pointGeometry(qe.x*Yt+dt.x*xt,qe.y*Yt+dt.y*xt)}(Be.length>0?Be[Be.length-1]:ke,ke,Pe))),{point:_t,angle:kt,path:Ne,tilePath:Be}}const Kc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ci(d,r){for(let l=0;l<d;l++){const p=r.length;r.resize(p+4),r.float32.set(Kc,3*p)}}function da(d,r,l){const p=r[0],g=r[1];return d[0]=l[0]*p+l[4]*g+l[12],d[1]=l[1]*p+l[5]*g+l[13],d[3]=l[3]*p+l[7]*g+l[15],d}const Ti=100;class Jf{constructor(r,l,p=new rr(r.width+200,r.height+200,25),g=new rr(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=g,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Ti,this.screenBottomBoundary=r.height+Ti,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,g,v,w,T){let I=l.projectedAnchorX,A=l.projectedAnchorY,z=l.projectedAnchorZ;const L=l.elevation,F=l.tileID;if(L&&F){const K=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),J=K.upVector(F.canonical,l.tileAnchorX,l.tileAnchorY),oe=K.upVectorScale(F.canonical);I+=J[0]*L*oe,A+=J[1]*L*oe,z+=J[2]*L*oe}const $=this.projectAndGetPerspectiveRatio(w,I,A,z,l.tileID),N=v*$.perspectiveRatio,G=(l.x1*r+p.x-l.padding)*N+$.point.x,ie=(l.y1*r+p.y-l.padding)*N+$.point.y,V=(l.x2*r+p.x+l.padding)*N+$.point.x,ee=(l.y2*r+p.y+l.padding)*N+$.point.y,te=$.perspectiveRatio<=.55||$.aboveHorizon;return!this.isInsideGrid(G,ie,V,ee)||!g&&this.grid.hitTest(G,ie,V,ee,T)||te?{box:[],offscreen:!1}:{box:[G,ie,V,ee],offscreen:this.isOffscreen(G,ie,V,ee)}}placeCollisionCircles(r,l,p,g,v,w,T,I,A,z,L,F,$,N){const G=[],ie=this.transform.elevation,V=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),ee=ie?ie.getAtTileOffsetFunc(N,V):Pe=>[0,0,0],te=new a.pointGeometry(l.tileAnchorX,l.tileAnchorY),K=this.transform.projection.projectTilePoint(l.tileAnchorX,l.tileAnchorY,N.canonical),J=ee(te),oe=[K.x+J[0],K.y+J[1],K.z+J[2]],ye=this.projectAndGetPerspectiveRatio(w,oe[0],oe[1],oe[2],N),{perspectiveRatio:Se}=ye,We=(z?v/Se:v*Se)/a.ONE_EM,Ne=rn(new a.pointGeometry(oe[0],oe[1]),T,oe[2]).point,Be=ye.signedDistanceFromCamera>0?Xc(We,g,l.lineOffsetX*We,l.lineOffsetY*We,!1,Ne,te,l,p,T,{},ie&&!z?ee:null,z&&!!ie,this.transform.projection,N):null;let ke=!1,be=!1,Oe=!0;if(Be&&!ye.aboveHorizon){const Pe=.5*F*Se+$,ct=new a.pointGeometry(-100,-100),_t=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),kt=new hr,qe=Be.first,dt=Be.last;let xt=[];for(let vt=qe.path.length-1;vt>=1;vt--)xt.push(qe.path[vt]);for(let vt=1;vt<dt.path.length;vt++)xt.push(dt.path[vt]);const Yt=2.5*Pe;if(I){const vt=xt.map(ie?(zt,pr)=>{const Ur=ee(pr<qe.path.length-1?qe.tilePath[qe.path.length-1-pr]:dt.tilePath[pr-qe.path.length+2]);return rn(zt,I,Ur[2])}:zt=>rn(zt,I));xt=vt.some(zt=>zt.signedDistanceFromCamera<=0)?[]:vt.map(zt=>zt.point)}let nr=[];if(xt.length>0){const vt=xt[0].clone(),zt=xt[0].clone();for(let pr=1;pr<xt.length;pr++)vt.x=Math.min(vt.x,xt[pr].x),vt.y=Math.min(vt.y,xt[pr].y),zt.x=Math.max(zt.x,xt[pr].x),zt.y=Math.max(zt.y,xt[pr].y);nr=vt.x>=ct.x&&zt.x<=_t.x&&vt.y>=ct.y&&zt.y<=_t.y?[xt]:zt.x<ct.x||vt.x>_t.x||zt.y<ct.y||vt.y>_t.y?[]:a.clipLine([xt],ct.x,ct.y,_t.x,_t.y)}for(const vt of nr){kt.reset(vt,.25*Pe);let zt=0;zt=kt.length<=.5*Pe?1:Math.ceil(kt.paddedLength/Yt)+1;for(let pr=0;pr<zt;pr++){const Ur=pr/Math.max(zt-1,1),Tn=kt.lerp(Ur),Yn=Tn.x+Ti,pi=Tn.y+Ti;G.push(Yn,pi,Pe,0);const Ft=Yn-Pe,wt=pi-Pe,Ot=Yn+Pe,Tr=pi+Pe;if(Oe=Oe&&this.isOffscreen(Ft,wt,Ot,Tr),be=be||this.isInsideGrid(Ft,wt,Ot,Tr),!r&&this.grid.hitTestCircle(Yn,pi,Pe,L)&&(ke=!0,!A))return{circles:[],offscreen:!1,collisionDetected:ke}}}}return{circles:!A&&ke||!be?[]:G,offscreen:Oe,collisionDetected:ke}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,g=1/0,v=-1/0,w=-1/0;for(const z of r){const L=new a.pointGeometry(z.x+Ti,z.y+Ti);p=Math.min(p,L.x),g=Math.min(g,L.y),v=Math.max(v,L.x),w=Math.max(w,L.y),l.push(L)}const T=this.grid.query(p,g,v,w).concat(this.ignoredGrid.query(p,g,v,w)),I={},A={};for(const z of T){const L=z.key;if(I[L.bucketInstanceId]===void 0&&(I[L.bucketInstanceId]={}),I[L.bucketInstanceId][L.featureIndex])continue;const F=[new a.pointGeometry(z.x1,z.y1),new a.pointGeometry(z.x2,z.y1),new a.pointGeometry(z.x2,z.y2),new a.pointGeometry(z.x1,z.y2)];a.polygonIntersectsPolygon(l,F)&&(I[L.bucketInstanceId][L.featureIndex]=!0,A[L.bucketInstanceId]===void 0&&(A[L.bucketInstanceId]=[]),A[L.bucketInstanceId].push(L.featureIndex))}return A}insertCollisionBox(r,l,p,g,v){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:v},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,g,v){const w=l?this.ignoredGrid:this.grid,T={bucketInstanceId:p,featureIndex:g,collisionGroupID:v};for(let I=0;I<r.length;I+=4)w.insertCircle(T,r[I],r[I+1],r[I+2])}projectAndGetPerspectiveRatio(r,l,p,g,v){const w=[l,p,g||0,1];let T=!1;if(g||this.transform.pitch>0){a.transformMat4$1(w,w,r);let I=!1;this.fogState&&v&&(I=function(A,z,L,F,$,N){const G=N.calculateFogTileMatrix($),ie=[z,L,F];return a.transformMat4(ie,ie,G),bt(A,ie,N.pitch,N._fov)}(this.fogState,l,p,g||0,v.toUnwrapped(),this.transform)>.9),T=w[2]>w[3]||I}else da(w,w,r);return{point:new a.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+Ti,(-w[1]/w[3]+1)/2*this.transform.height+Ti),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/w[3]*.5,1.5),signedDistanceFromCamera:w[3],aboveHorizon:T}}isOffscreen(r,l,p,g){return p<Ti||r>=this.screenRightBoundary||g<Ti||l>this.screenBottomBoundary}isInsideGrid(r,l,p,g){return p>=0&&r<this.gridRightBoundary&&g>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=a.identity([]);return a.translate(r,r,[-100,-100,0]),r}}class Jh{constructor(r,l,p,g){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):g&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ls{constructor(r,l,p,g,v,w=!1){this.text=new Jh(r?r.text:null,l,p,v),this.icon=new Jh(r?r.icon:null,l,g,v),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cs{constructor(r,l,p,g=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=g}}class pa{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Qh{constructor(r,l,p,g,v){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=g,this.tileID=v}}class ed{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function ml(d,r,l,p,g){const{horizontalAlign:v,verticalAlign:w}=a.getAnchorAlignment(d),T=-(v-.5)*r,I=-(w-.5)*l,A=a.evaluateVariableOffset(d,p);return new a.pointGeometry(T+A[0]*g,I+A[1]*g)}function io(d,r,l,p,g){const v=new a.pointGeometry(d,r);return l&&v._rotate(p?g:-g),v}class _l{constructor(r,l,p,g,v){this.transform=r.clone(),this.collisionIndex=new Jf(this.transform,v),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ed(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,g){const v=p.getBucket(l),w=p.latestFeatureIndex;if(!v||!w||l.id!==v.layerIds[0])return;const T=v.layers[0].layout,I=p.collisionBoxArray,A=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),z=p.tileSize/a.EXTENT,L=p.tileID.toUnwrapped(),F=this.transform.calculateProjMatrix(L),$=T.get("text-pitch-alignment")==="map",N=T.get("text-rotation-alignment")==="map";l.compileFilter();const G=l.dynamicFilter(),ie=l.dynamicFilterNeedsFeature(),V=this.transform.calculatePixelsToTileUnitsMatrix(p),ee=no(F,p.tileID.canonical,$,N,this.transform,V);let te=null;if($){const oe=Ui(F,p.tileID.canonical,$,N,this.transform,V);te=a.multiply$1([],this.transform.labelPlaneMatrix,oe)}let K=null;G&&p.latestFeatureIndex&&(K={unwrappedTileID:L,dynamicFilter:G,dynamicFilterNeedsFeature:ie,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[v.bucketInstanceId]=new Qh(v.bucketInstanceId,w,v.sourceLayerIndex,v.index,p.tileID);const J={bucket:v,layout:T,posMatrix:F,textLabelPlaneMatrix:ee,labelToScreenMatrix:te,clippingData:K,scale:A,textPixelRatio:z,holdingForFade:p.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(v.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(g)for(const oe of v.sortKeyRanges){const{sortKey:ye,symbolInstanceStart:Se,symbolInstanceEnd:We}=oe;r.push({sortKey:ye,symbolInstanceStart:Se,symbolInstanceEnd:We,parameters:J})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:J})}attemptAnchorPlacement(r,l,p,g,v,w,T,I,A,z,L,F,$,N,G,ie,V,ee){const te=[F.textOffset0,F.textOffset1],K=ml(r,p,g,te,v),J=this.collisionIndex.placeCollisionBox(v,l,io(K.x,K.y,w,T,this.transform.angle),L,I,A,z.predicate);if((!ie||this.collisionIndex.placeCollisionBox(N.getSymbolInstanceIconSize(ee,this.transform.zoom,$),ie,io(K.x,K.y,w,T,this.transform.angle),L,I,A,z.predicate).box.length!==0)&&J.box.length>0){let oe;return this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(oe=this.prevPlacement.variableOffsets[F.crossTileID].anchor),this.variableOffsets[F.crossTileID]={textOffset:te,width:p,height:g,anchor:r,textScale:v,prevAnchor:oe},this.markUsedJustification(N,r,F,G),N.allowVerticalPlacement&&(this.markUsedOrientation(N,G,F),this.placedOrientations[F.crossTileID]=G),{shift:K,placedGlyphBoxes:J}}}placeLayerBucketPart(r,l,p,g){const{bucket:v,layout:w,posMatrix:T,textLabelPlaneMatrix:I,labelToScreenMatrix:A,clippingData:z,textPixelRatio:L,holdingForFade:F,collisionBoxArray:$,partiallyEvaluatedTextSize:N,partiallyEvaluatedIconSize:G,collisionGroup:ie}=r.parameters,V=w.get("text-optional"),ee=w.get("icon-optional"),te=w.get("text-allow-overlap"),K=w.get("icon-allow-overlap"),J=w.get("text-rotation-alignment")==="map",oe=w.get("text-pitch-alignment")==="map",ye=w.get("icon-text-fit")!=="none",Se=w.get("symbol-z-order")==="viewport-y",We=te&&(K||!v.hasIconData()||ee),Ne=K&&(te||!v.hasTextData()||V);!v.collisionArrays&&$&&v.deserializeCollisionBoxes($),p&&g&&v.updateCollisionDebugBuffers(this.transform.zoom,$);const Be=(ke,be,Oe)=>{if(z){const Ft={zoom:this.transform.zoom,pitch:this.transform.pitch};let wt=null;if(z.dynamicFilterNeedsFeature){const Ot=this.retainedQueryData[v.bucketInstanceId];wt=z.featureIndex.loadFeature({featureIndex:ke.featureIndex,bucketIndex:Ot.bucketIndex,sourceLayerIndex:Ot.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,z.dynamicFilter)(Ft,wt,this.retainedQueryData[v.bucketInstanceId].tileID.canonical,new a.pointGeometry(ke.tileAnchorX,ke.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[ke.crossTileID]=new cs(!1,!1,!1,!0),void(l[ke.crossTileID]=!0)}if(l[ke.crossTileID])return;if(F)return void(this.placements[ke.crossTileID]=new cs(!1,!1,!1));let Pe=!1,ct=!1,_t=!0,kt=null,qe={box:null,offscreen:null},dt={box:null,offscreen:null},xt=null,Yt=null,nr=null,vt=0,zt=0,pr=0;Oe.textFeatureIndex?vt=Oe.textFeatureIndex:ke.useRuntimeCollisionCircles&&(vt=ke.featureIndex),Oe.verticalTextFeatureIndex&&(zt=Oe.verticalTextFeatureIndex);const Ur=Ft=>{Ft.tileID=this.retainedQueryData[v.bucketInstanceId].tileID,(this.transform.elevation||Ft.elevation)&&(Ft.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[v.bucketInstanceId].tileID,Ft.tileAnchorX,Ft.tileAnchorY):0)},Tn=Oe.textBox;if(Tn){Ur(Tn);const Ft=Ot=>{let Tr=a.WritingMode.horizontal;if(v.allowVerticalPlacement&&!Ot&&this.prevPlacement){const Ln=this.prevPlacement.placedOrientations[ke.crossTileID];Ln&&(this.placedOrientations[ke.crossTileID]=Ln,Tr=Ln,this.markUsedOrientation(v,Tr,ke))}return Tr},wt=(Ot,Tr)=>{if(v.allowVerticalPlacement&&ke.numVerticalGlyphVertices>0&&Oe.verticalTextBox){for(const Ln of v.writingModes)if(Ln===a.WritingMode.vertical?(qe=Tr(),dt=qe):qe=Ot(),qe&&qe.box&&qe.box.length)break}else qe=Ot()};if(w.get("text-variable-anchor")){let Ot=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ke.crossTileID]){const cr=this.prevPlacement.variableOffsets[ke.crossTileID];Ot.indexOf(cr.anchor)>0&&(Ot=Ot.filter(On=>On!==cr.anchor),Ot.unshift(cr.anchor))}const Tr=(cr,On,Fa)=>{const Sn=v.getSymbolInstanceTextSize(N,ke,this.transform.zoom,be),Ro=(cr.x2-cr.x1)*Sn+2*cr.padding,it=(cr.y2-cr.y1)*Sn+2*cr.padding,pt=ye&&!K?On:null;pt&&Ur(pt);let Kr={box:[],offscreen:!1};const Bo=te?2*Ot.length:Ot.length;for(let _o=0;_o<Bo;++_o){const on=this.attemptAnchorPlacement(Ot[_o%Ot.length],cr,Ro,it,Sn,J,oe,L,T,ie,_o>=Ot.length,ke,be,v,Fa,pt,N,G);if(on&&(Kr=on.placedGlyphBoxes,Kr&&Kr.box&&Kr.box.length)){Pe=!0,kt=on.shift;break}}return Kr};wt(()=>Tr(Tn,Oe.iconBox,a.WritingMode.horizontal),()=>{const cr=Oe.verticalTextBox;return cr&&Ur(cr),v.allowVerticalPlacement&&!(qe&&qe.box&&qe.box.length)&&ke.numVerticalGlyphVertices>0&&cr?Tr(cr,Oe.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),qe&&(Pe=qe.box,_t=qe.offscreen);const Ln=Ft(qe&&qe.box);if(!Pe&&this.prevPlacement){const cr=this.prevPlacement.variableOffsets[ke.crossTileID];cr&&(this.variableOffsets[ke.crossTileID]=cr,this.markUsedJustification(v,cr.anchor,ke,Ln))}}else{const Ot=(Tr,Ln)=>{const cr=v.getSymbolInstanceTextSize(N,ke,this.transform.zoom,be),On=this.collisionIndex.placeCollisionBox(cr,Tr,new a.pointGeometry(0,0),te,L,T,ie.predicate);return On&&On.box&&On.box.length&&(this.markUsedOrientation(v,Ln,ke),this.placedOrientations[ke.crossTileID]=Ln),On};wt(()=>Ot(Tn,a.WritingMode.horizontal),()=>{const Tr=Oe.verticalTextBox;return v.allowVerticalPlacement&&ke.numVerticalGlyphVertices>0&&Tr?(Ur(Tr),Ot(Tr,a.WritingMode.vertical)):{box:null,offscreen:null}}),Ft(qe&&qe.box&&qe.box.length)}}if(xt=qe,Pe=xt&&xt.box&&xt.box.length>0,_t=xt&&xt.offscreen,ke.useRuntimeCollisionCircles){const Ft=v.text.placedSymbolArray.get(ke.centerJustifiedTextSymbolIndex>=0?ke.centerJustifiedTextSymbolIndex:ke.verticalPlacedTextSymbolIndex),wt=a.evaluateSizeForFeature(v.textSizeData,N,Ft),Ot=w.get("text-padding");Yt=this.collisionIndex.placeCollisionCircles(te,Ft,v.lineVertexArray,v.glyphOffsetArray,wt,T,I,A,p,oe,ie.predicate,ke.collisionCircleDiameter*wt/a.ONE_EM,Ot,this.retainedQueryData[v.bucketInstanceId].tileID),Pe=te||Yt.circles.length>0&&!Yt.collisionDetected,_t=_t&&Yt.offscreen}if(Oe.iconFeatureIndex&&(pr=Oe.iconFeatureIndex),Oe.iconBox){const Ft=wt=>{Ur(wt);const Ot=ye&&kt?io(kt.x,kt.y,J,oe,this.transform.angle):new a.pointGeometry(0,0),Tr=v.getSymbolInstanceIconSize(G,this.transform.zoom,be);return this.collisionIndex.placeCollisionBox(Tr,wt,Ot,K,L,T,ie.predicate)};dt&&dt.box&&dt.box.length&&Oe.verticalIconBox?(nr=Ft(Oe.verticalIconBox),ct=nr.box.length>0):(nr=Ft(Oe.iconBox),ct=nr.box.length>0),_t=_t&&nr.offscreen}const Yn=V||ke.numHorizontalGlyphVertices===0&&ke.numVerticalGlyphVertices===0,pi=ee||ke.numIconVertices===0;if(Yn||pi?pi?Yn||(ct=ct&&Pe):Pe=ct&&Pe:ct=Pe=ct&&Pe,Pe&&xt&&xt.box&&this.collisionIndex.insertCollisionBox(xt.box,w.get("text-ignore-placement"),v.bucketInstanceId,dt&&dt.box&&zt?zt:vt,ie.ID),ct&&nr&&this.collisionIndex.insertCollisionBox(nr.box,w.get("icon-ignore-placement"),v.bucketInstanceId,pr,ie.ID),Yt&&(Pe&&this.collisionIndex.insertCollisionCircles(Yt.circles,w.get("text-ignore-placement"),v.bucketInstanceId,vt,ie.ID),p)){const Ft=v.bucketInstanceId;let wt=this.collisionCircleArrays[Ft];wt===void 0&&(wt=this.collisionCircleArrays[Ft]=new pa);for(let Ot=0;Ot<Yt.circles.length;Ot+=4)wt.circles.push(Yt.circles[Ot+0]),wt.circles.push(Yt.circles[Ot+1]),wt.circles.push(Yt.circles[Ot+2]),wt.circles.push(Yt.collisionDetected?1:0)}this.placements[ke.crossTileID]=new cs(Pe||We,ct||Ne,_t||v.justReloaded),l[ke.crossTileID]=!0};if(Se){const ke=v.getSortedSymbolIndexes(this.transform.angle);for(let be=ke.length-1;be>=0;--be){const Oe=ke[be];Be(v.symbolInstances.get(Oe),Oe,v.collisionArrays[Oe])}}else for(let ke=r.symbolInstanceStart;ke<r.symbolInstanceEnd;ke++)Be(v.symbolInstances.get(ke),ke,v.collisionArrays[ke]);if(p&&v.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[v.bucketInstanceId];a.invert(ke.invProjMatrix,T),ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(r,l,p,g){let v;v=g===a.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(l)];const w=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const T of w)T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=v>=0&&T!==v?0:p.crossTileID)}markUsedOrientation(r,l,p){const g=l===a.WritingMode.horizontal||l===a.WritingMode.horizontalOnly?l:0,v=l===a.WritingMode.vertical?l:0,w=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const T of w)r.text.placedSymbolArray.get(T).placedOrientation=g;p.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const g=l?l.symbolFadeChange(r):1,v=l?l.opacities:{},w=l?l.variableOffsets:{},T=l?l.placedOrientations:{};for(const I in this.placements){const A=this.placements[I],z=v[I];z?(this.opacities[I]=new ls(z,g,A.text,A.icon,null,A.clipped),p=p||A.text!==z.text.placed||A.icon!==z.icon.placed):(this.opacities[I]=new ls(null,g,A.text,A.icon,A.skipFade,A.clipped),p=p||A.text||A.icon)}for(const I in v){const A=v[I];if(!this.opacities[I]){const z=new ls(A,g,!1,!1);z.isHidden()||(this.opacities[I]=z,p=p||A.text.placed||A.icon.placed)}}for(const I in w)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=w[I]);for(const I in T)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=T[I]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l){const p={};for(const g of l){const v=g.getBucket(r);v&&g.latestFeatureIndex&&r.id===v.layerIds[0]&&this.updateBucketOpacities(v,p,g.collisionBoxArray)}}updateBucketOpacities(r,l,p){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const g=r.layers[0].layout,v=!!r.layers[0].dynamicFilter(),w=new ls(null,0,!1,!1,!0),T=g.get("text-allow-overlap"),I=g.get("icon-allow-overlap"),A=g.get("text-variable-anchor"),z=g.get("text-rotation-alignment")==="map",L=g.get("text-pitch-alignment")==="map",F=g.get("icon-text-fit")!=="none",$=new ls(null,0,T&&(I||!r.hasIconData()||g.get("icon-optional")),I&&(T||!r.hasTextData()||g.get("text-optional")),!0);!r.collisionArrays&&p&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(p);const N=(ie,V,ee)=>{for(let te=0;te<V/4;te++)ie.opacityVertexArray.emplaceBack(ee)};let G=0;for(let ie=0;ie<r.symbolInstances.length;ie++){const V=r.symbolInstances.get(ie),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:te,crossTileID:K}=V;let J=this.opacities[K];l[K]?J=w:J||(J=$,this.opacities[K]=J),l[K]=!0;const oe=ee>0||te>0,ye=V.numIconVertices>0,Se=this.placedOrientations[V.crossTileID],We=Se===a.WritingMode.vertical,Ne=Se===a.WritingMode.horizontal||Se===a.WritingMode.horizontalOnly;if(!oe&&!ye||J.isHidden()||G++,oe){const Be=gl(J.text);N(r.text,ee,We?ao:Be),N(r.text,te,Ne?ao:Be);const ke=J.text.isHidden();[V.rightJustifiedTextSymbolIndex,V.centerJustifiedTextSymbolIndex,V.leftJustifiedTextSymbolIndex].forEach(Pe=>{Pe>=0&&(r.text.placedSymbolArray.get(Pe).hidden=ke||We?1:0)}),V.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(V.verticalPlacedTextSymbolIndex).hidden=ke||Ne?1:0);const be=this.variableOffsets[V.crossTileID];be&&this.markUsedJustification(r,be.anchor,V,Se);const Oe=this.placedOrientations[V.crossTileID];Oe&&(this.markUsedJustification(r,"left",V,Oe),this.markUsedOrientation(r,Oe,V))}if(ye){const Be=gl(J.icon);V.placedIconSymbolIndex>=0&&(N(r.icon,V.numIconVertices,We?ao:Be),r.icon.placedSymbolArray.get(V.placedIconSymbolIndex).hidden=J.icon.isHidden()),V.verticalPlacedIconSymbolIndex>=0&&(N(r.icon,V.numVerticalIconVertices,Ne?ao:Be),r.icon.placedSymbolArray.get(V.verticalPlacedIconSymbolIndex).hidden=J.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Be=r.collisionArrays[ie];if(Be){let ke=new a.pointGeometry(0,0),be=!0;if(Be.textBox||Be.verticalTextBox){if(A){const Pe=this.variableOffsets[K];Pe?(ke=ml(Pe.anchor,Pe.width,Pe.height,Pe.textOffset,Pe.textScale),z&&ke._rotate(L?this.transform.angle:-this.transform.angle)):be=!1}v&&(be=!J.clipped),Be.textBox&&oo(r.textCollisionBox.collisionVertexArray,J.text.placed,!be||We,ke.x,ke.y),Be.verticalTextBox&&oo(r.textCollisionBox.collisionVertexArray,J.text.placed,!be||Ne,ke.x,ke.y)}const Oe=be&&Boolean(!Ne&&Be.verticalIconBox);Be.iconBox&&oo(r.iconCollisionBox.collisionVertexArray,J.icon.placed,Oe,F?ke.x:0,F?ke.y:0),Be.verticalIconBox&&oo(r.iconCollisionBox.collisionVertexArray,J.icon.placed,!Oe,F?ke.x:0,F?ke.y:0)}}}if(r.fullyClipped=G===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const ie=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=ie.invProjMatrix,r.placementViewportMatrix=ie.viewportMatrix,r.collisionCircleArray=ie.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function oo(d,r,l,p,g){d.emplaceBack(r?1:0,l?1:0,p||0,g||0),d.emplaceBack(r?1:0,l?1:0,p||0,g||0),d.emplaceBack(r?1:0,l?1:0,p||0,g||0),d.emplaceBack(r?1:0,l?1:0,p||0,g||0)}const Ce=Math.pow(2,25),et=Math.pow(2,24),td=Math.pow(2,17),so=Math.pow(2,16),kr=Math.pow(2,9),Ni=Math.pow(2,8),Si=Math.pow(2,1);function gl(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const r=d.placed?1:0,l=Math.floor(127*d.opacity);return l*Ce+r*et+l*td+r*so+l*kr+r*Ni+l*Si+r}const ao=0;class Ke{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,l,p,g,v){const w=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(w,g,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((T,I)=>T.sortKey-I.sortKey));this._currentPartIndex<w.length;){const T=w[this._currentPartIndex];if(l.placeLayerBucketPart(T,this._seenCrossTileIDs,p,T.symbolInstanceStart===0),this._currentPartIndex++,v())return!0}return!1}}class Lt{constructor(r,l,p,g,v,w,T,I){this.placement=new _l(r,v,w,T,I),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p){const g=a.exported.now(),v=()=>{const w=a.exported.now()-g;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=l[r[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=T)&&(!w.maxzoom||w.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Ke(w)),this._inProgressLayer.continuePlacement(p[w.source],this.placement,this._showCollisionBoxes,w,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Mt=512/a.EXTENT/2;class Ei{constructor(r,l,p){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let g=0;g<l.length;g++){const v=l.get(g),w=v.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:v.crossTileID,coord:this.getScaledCoordinates(v,r)})}}getScaledCoordinates(r,l){const p=Mt/Math.pow(2,l.canonical.z-this.tileID.canonical.z);return{x:Math.floor((l.canonical.x*a.EXTENT+r.tileAnchorX)*p),y:Math.floor((l.canonical.y*a.EXTENT+r.tileAnchorY)*p)}}findMatches(r,l,p){const g=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let v=0;v<r.length;v++){const w=r.get(v);if(w.crossTileID)continue;const T=this.indexedSymbolInstances[w.key];if(!T)continue;const I=this.getScaledCoordinates(w,l);for(const A of T)if(Math.abs(A.coord.x-I.x)<=g&&Math.abs(A.coord.y-I.y)<=g&&!p[A.crossTileID]){p[A.crossTileID]=!0,w.crossTileID=A.crossTileID;break}}}}class us{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class It{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const g=this.indexes[p],v={};for(const w in g){const T=g[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+l),v[T.tileID.key]=T}this.indexes[p]=v}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let v=0;v<l.symbolInstances.length;v++)l.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const g=this.usedCrossTileIDs[r.overscaledZ];for(const v in this.indexes){const w=this.indexes[v];if(Number(v)>r.overscaledZ)for(const T in w){const I=w[T];I.tileID.isChildOf(r)&&I.findMatches(l.symbolInstances,r,g)}else{const T=w[r.scaledTo(Number(v)).key];T&&T.findMatches(l.symbolInstances,r,g)}}for(let v=0;v<l.symbolInstances.length;v++){const w=l.symbolInstances.get(v);w.crossTileID||(w.crossTileID=p.generate(),g[w.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Ei(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p in l.indexedSymbolInstances)for(const g of l.indexedSymbolInstances[p])delete this.usedCrossTileIDs[r][g.crossTileID]}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const g=this.indexes[p];for(const v in g)r[g[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,g[v]),delete g[v],l=!0)}return l}}class fa{constructor(){this.layerIndexes={},this.crossTileIDs=new us,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,g){let v=this.layerIndexes[r.id];v===void 0&&(v=this.layerIndexes[r.id]=new It);let w=!1;const T={};g.name!=="globe"&&v.handleWrapJump(p);for(const I of l){const A=I.getBucket(r);A&&r.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(I.tileID,A,this.crossTileIDs)&&(w=!0),T[A.bucketInstanceId]=!0)}return v.removeStaleBuckets(T)&&(w=!0),w}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const lo=(d,r)=>a.emitValidationErrors(d,r&&r.filter(l=>l.identifier!=="source.canvas")),ma=a.pick(Le,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),qn=a.pick(Le,["setCenter","setZoom","setBearing","setPitch"]),yr=function(){const d={},r=a.spec.$version;for(const l in a.spec.$root){const p=a.spec.$root[l];if(p.required){let g=null;g=l==="version"?r:p.type==="array"?[]:{},g!=null&&(d[l]=g)}}return d}(),Qf={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class wn extends a.Evented{constructor(r,l={}){super(),this.map=r,this.dispatcher=new ur(ue(),this),this.imageManager=new we,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(r._requestManager,l.localFontFamily?a.LocalGlyphMode.all:l.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,l.localFontFamily||l.localIdeographFontFamily),this.lineAtlas=new a.LineAtlas(256,512),this.crossTileSymbolIndex=new fa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const p=this;this._rtlTextPluginCallback=wn.registerForPluginStateChange(g=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(v,w)=>{if(a.triggerPluginCompletionEvent(v),w&&w.every(T=>T))for(const T in p._sourceCaches){const I=p._sourceCaches[T],A=I.getSource().type;A!=="vector"&&A!=="geojson"||I.reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.getSource(g.sourceId);if(v&&v.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===v.id&&this._validateLayer(T)}})}loadURL(r,l={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!a.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,l.accessToken);const g=this.map._requestManager.transformRequest(r,a.ResourceType.Style);this._request=a.getJSON(g,(v,w)=>{this._request=null,v?this.fire(new a.ErrorEvent(v)):w&&this._load(w,p)})}loadJSON(r,l={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(yr,!1)}_updateLayerCount(r,l){const p=l?1:-1;r.is3D()&&(this._num3DLayers+=p),r.type==="circle"&&(this._numCircleLayers+=p),r.type==="symbol"&&(this._numSymbolLayers+=p)}_load(r,l){if(l&&lo(this,a.validateStyle(r)))return;this._loaded=!0,this.stylesheet=r,this.updateProjection();for(const g in r.sources)this.addSource(g,r.sources[g],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const p=ze(this.stylesheet.layers);this._order=p.map(g=>g.id),this._layers={},this._serializedLayers={};for(let g of p)g=a.createStyleLayer(g),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize(),this._updateLayerCount(g,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const r=this.map.transform.projection,l=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0)),p=this.map.transform.projection;if(this._loaded&&(p.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null)),this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),l){if(p.isReprojectedInTileSpace||r.isReprojectedInTileSpace){this.map.painter.clearBackgroundTiles();for(const g in this._sourceCaches)this._sourceCaches[g].clearTiles()}else this._forceSymbolLayerUpdate();this.map._update(!0)}}_loadSprite(r){this._spriteRequest=function(l,p,g){let v,w,T;const I=a.exported.devicePixelRatio>1?"@2x":"";let A=a.getJSON(p.transformRequest(p.normalizeSpriteURL(l,I,".json"),a.ResourceType.SpriteJSON),(F,$)=>{A=null,T||(T=F,v=$,L())}),z=a.getImage(p.transformRequest(p.normalizeSpriteURL(l,I,".png"),a.ResourceType.SpriteImage),(F,$)=>{z=null,T||(T=F,w=$,L())});function L(){if(T)g(T);else if(v&&w){const F=a.exported.getImageData(w),$={};for(const N in v){const{width:G,height:ie,x:V,y:ee,sdf:te,pixelRatio:K,stretchX:J,stretchY:oe,content:ye}=v[N],Se=new a.RGBAImage({width:G,height:ie});a.RGBAImage.copy(F,Se,{x:V,y:ee},{x:0,y:0},{width:G,height:ie}),$[N]={data:Se,pixelRatio:K,sdf:te,stretchX:J,stretchY:oe,content:ye}}g(null,$)}}return{cancel(){A&&(A.cancel(),A=null),z&&(z.cancel(),z=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new a.ErrorEvent(l));else if(p)for(const g in p)this.imageManager.addImage(g,p[g]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const l=[];for(const p of r){const g=this._layers[p];g.type!=="custom"&&l.push(g.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&Qf[r.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const l=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(g.length||v.length)&&this._updateWorkerLayers(g,v);for(const w in this._updatedSources){const T=this._updatedSources[w];T==="reload"?this._reloadSource(w):T==="clear"&&this._clearSource(w)}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const p={};for(const g in this._sourceCaches){const v=this._sourceCaches[g];p[g]=v.used,v.used=!1}for(const g of this._order){const v=this._layers[g];if(v.recalculate(r,this._availableImages),!v.isHidden(r.zoom)){const T=this._getLayerSourceCache(v);T&&(T.used=!0)}const w=this.map.painter;if(w){const T=v.getProgramIds();if(!T)continue;const I=v.getProgramConfiguration(r.zoom);for(const A of T)w.useProgram(A,I)}}for(const g in p){const v=this._sourceCaches[g];p[g]!==v.used&&v.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),lo(this,a.validateStyle(r)))return!1;(r=a.clone$1(r)).layers=ze(r.layers);const l=function(g,v){if(!g)return[{command:Le.setStyle,args:[v]}];let w=[];try{if(!he(g.version,v.version))return[{command:Le.setStyle,args:[v]}];he(g.center,v.center)||w.push({command:Le.setCenter,args:[v.center]}),he(g.zoom,v.zoom)||w.push({command:Le.setZoom,args:[v.zoom]}),he(g.bearing,v.bearing)||w.push({command:Le.setBearing,args:[v.bearing]}),he(g.pitch,v.pitch)||w.push({command:Le.setPitch,args:[v.pitch]}),he(g.sprite,v.sprite)||w.push({command:Le.setSprite,args:[v.sprite]}),he(g.glyphs,v.glyphs)||w.push({command:Le.setGlyphs,args:[v.glyphs]}),he(g.transition,v.transition)||w.push({command:Le.setTransition,args:[v.transition]}),he(g.light,v.light)||w.push({command:Le.setLight,args:[v.light]}),he(g.fog,v.fog)||w.push({command:Le.setFog,args:[v.fog]}),he(g.projection,v.projection)||w.push({command:Le.setProjection,args:[v.projection]});const T={},I=[];(function(L,F,$,N){let G;for(G in F=F||{},L=L||{})L.hasOwnProperty(G)&&(F.hasOwnProperty(G)||lt(G,$,N));for(G in F)F.hasOwnProperty(G)&&(L.hasOwnProperty(G)?he(L[G],F[G])||(L[G].type==="geojson"&&F[G].type==="geojson"&&mt(L,F,G)?$.push({command:Le.setGeoJSONSourceData,args:[G,F[G].data]}):ft(G,F,$,N)):Ue(G,F,$))})(g.sources,v.sources,I,T);const A=[];g.layers&&g.layers.forEach(L=>{T[L.source]?w.push({command:Le.removeLayer,args:[L.id]}):A.push(L)});let z=g.terrain;z&&T[z.source]&&(w.push({command:Le.setTerrain,args:[void 0]}),z=void 0),w=w.concat(I),he(z,v.terrain)||w.push({command:Le.setTerrain,args:[v.terrain]}),function(L,F,$){F=F||[];const N=(L=L||[]).map(At),G=F.map(At),ie=L.reduce(lr,{}),V=F.reduce(lr,{}),ee=N.slice(),te=Object.create(null);let K,J,oe,ye,Se,We,Ne;for(K=0,J=0;K<N.length;K++)oe=N[K],V.hasOwnProperty(oe)?J++:($.push({command:Le.removeLayer,args:[oe]}),ee.splice(ee.indexOf(oe,J),1));for(K=0,J=0;K<G.length;K++)oe=G[G.length-1-K],ee[ee.length-1-K]!==oe&&(ie.hasOwnProperty(oe)?($.push({command:Le.removeLayer,args:[oe]}),ee.splice(ee.lastIndexOf(oe,ee.length-J),1)):J++,We=ee[ee.length-K],$.push({command:Le.addLayer,args:[V[oe],We]}),ee.splice(ee.length-K,0,oe),te[oe]=!0);for(K=0;K<G.length;K++)if(oe=G[K],ye=ie[oe],Se=V[oe],!te[oe]&&!he(ye,Se))if(he(ye.source,Se.source)&&he(ye["source-layer"],Se["source-layer"])&&he(ye.type,Se.type)){for(Ne in yt(ye.layout,Se.layout,$,oe,null,Le.setLayoutProperty),yt(ye.paint,Se.paint,$,oe,null,Le.setPaintProperty),he(ye.filter,Se.filter)||$.push({command:Le.setFilter,args:[oe,Se.filter]}),he(ye.minzoom,Se.minzoom)&&he(ye.maxzoom,Se.maxzoom)||$.push({command:Le.setLayerZoomRange,args:[oe,Se.minzoom,Se.maxzoom]}),ye)ye.hasOwnProperty(Ne)&&Ne!=="layout"&&Ne!=="paint"&&Ne!=="filter"&&Ne!=="metadata"&&Ne!=="minzoom"&&Ne!=="maxzoom"&&(Ne.indexOf("paint.")===0?yt(ye[Ne],Se[Ne],$,oe,Ne.slice(6),Le.setPaintProperty):he(ye[Ne],Se[Ne])||$.push({command:Le.setLayerProperty,args:[oe,Ne,Se[Ne]]}));for(Ne in Se)Se.hasOwnProperty(Ne)&&!ye.hasOwnProperty(Ne)&&Ne!=="layout"&&Ne!=="paint"&&Ne!=="filter"&&Ne!=="metadata"&&Ne!=="minzoom"&&Ne!=="maxzoom"&&(Ne.indexOf("paint.")===0?yt(ye[Ne],Se[Ne],$,oe,Ne.slice(6),Le.setPaintProperty):he(ye[Ne],Se[Ne])||$.push({command:Le.setLayerProperty,args:[oe,Ne,Se[Ne]]}))}else $.push({command:Le.removeLayer,args:[oe]}),We=ee[ee.lastIndexOf(oe)+1],$.push({command:Le.addLayer,args:[Se,We]})}(A,v.layers,w)}catch(T){console.warn("Unable to compute style diff:",T),w=[{command:Le.setStyle,args:[v]}]}return w}(this.serialize(),r).filter(g=>!(g.command in qn));if(l.length===0)return!1;const p=l.filter(g=>!(g.command in ma));if(p.length>0)throw new Error(`Unimplemented: ${p.map(g=>g.command).join(", ")}.`);return l.forEach(g=>{g.command!=="setTransition"&&this[g.command].apply(this,g.args)}),this.stylesheet=r,this.updateProjection(),!0}addImage(r,l){if(this.getImage(r))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(r,l),this._afterImageUpdated(r)}updateImage(r,l){this.imageManager.updateImage(r,l)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,l,p={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(a.validateStyle.source,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const g=Pn(r,l,this.dispatcher,this);g.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:g.serialize(),sourceId:r}));const v=w=>{const T=(w?"symbol:":"other:")+r,I=this._sourceCaches[T]=new a.SourceCache(T,g,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[r]=I,I.style=this,I.onAdd(this.map)};v(!1),l.type!=="vector"&&l.type!=="geojson"||v(!0),g.onAdd&&g.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const l=this.getSource(r);if(l===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===r)return this.fire(new a.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${g}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new a.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(r);for(const g of p)delete this._sourceCaches[g.id],delete this._updatedSources[g.id],g.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:g.getSource().id})),g.setEventedParent(null),g.clearTiles();delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getSource(r).setData(l),this._changed=!0}getSource(r){const l=this._getSourceCache(r);return l&&l.getSource()}addLayer(r,l,p={}){this._checkLoaded();const g=r.id;if(this.getLayer(g))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${g}" already exists on this map`)));let v;if(r.type==="custom"){if(lo(this,a.validateCustomStyleLayer(r)))return;v=a.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(g,r.source),r=a.clone$1(r),r=a.extend(r,{source:g})),this._validate(a.validateStyle.layer,`layers.${g}`,r,{arrayIndex:-1},p))return;v=a.createStyleLayer(r),this._validateLayer(v),v.setEventedParent(this,{layer:{id:g}}),this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0)}const w=l?this._order.indexOf(l):this._order.length;if(l&&w===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`)));this._order.splice(w,0,g),this._layerOrderChanged=!0,this._layers[g]=v;const T=this._getLayerSourceCache(v);if(this._removedLayers[g]&&v.source&&T&&v.type!=="custom"){const I=this._removedLayers[g];delete this._removedLayers[g],I.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",T.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,l){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===l)return;const p=this._order.indexOf(r);this._order.splice(p,1);const g=l?this._order.indexOf(l):this._order.length;l&&g===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`))):(this._order.splice(g,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const l=this._layers[r];if(!l)return void this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));l.setEventedParent(null),this._updateLayerCount(l,!1);const p=this._order.indexOf(r);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=l,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],l.onRemove&&l.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const g=this.getLayer(r);g?g.minzoom===l&&g.maxzoom===p||(l!=null&&(g.minzoom=l),p!=null&&(g.maxzoom=p),this._updateLayer(g)):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,l,p={}){this._checkLoaded();const g=this.getLayer(r);if(g){if(!he(g.filter,l))return l==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(a.validateStyle.filter,`layers.${g.id}.filter`,l,{layerType:g.type},p)||(g.filter=a.clone$1(l),this._updateLayer(g)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){return a.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,l,p,g={}){this._checkLoaded();const v=this.getLayer(r);v?he(v.getLayoutProperty(l),p)||(v.setLayoutProperty(l,p,g),this._updateLayer(v)):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,l){const p=this.getLayer(r);if(p)return p.getLayoutProperty(l);this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,l,p,g={}){this._checkLoaded();const v=this.getLayer(r);v?he(v.getPaintProperty(l),p)||(v.setPaintProperty(l,p,g)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,l){return this.getLayer(r).getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const p=r.source,g=r.sourceLayer,v=this.getSource(p);if(v===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const w=v.type;if(w==="geojson"&&g)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!g)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const T=this._getSourceCaches(p);for(const I of T)I.setFeatureState(g,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const p=r.source,g=this.getSource(p);if(g===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const v=g.type,w=v==="vector"?r.sourceLayer:void 0;if(v==="vector"&&!w)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const T=this._getSourceCaches(p);for(const I of T)I.removeFeatureState(w,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.source,p=r.sourceLayer,g=this.getSource(l);if(g!==void 0){if(g.type!=="vector"||p)return r.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(l)[0].getFeatureState(p,r.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const l=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&l&&l.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",l.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=w=>this._layers[w].type==="fill-extrusion",p={},g=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(l(T)){p[T]=w;for(const I of r){const A=I[T];if(A)for(const z of A)g.push(z)}}}g.sort((w,T)=>T.intersectionZ-w.intersectionZ);const v=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(l(T))for(let I=g.length-1;I>=0;I--){const A=g[I].feature;if(p[A.layer.id]<w)break;v.push(A),g.pop()}else for(const I of r){const A=I[T];if(A)for(const z of A)v.push(z.feature)}}return v}queryRenderedFeatures(r,l,p){l&&l.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);const g={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const I of l.layers){const A=this._layers[I];if(!A)return this.fire(new a.ErrorEvent(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];g[A.source]=!0}}const v=[];l.availableImages=this._availableImages;const w=l&&l.layers?l.layers.some(I=>{const A=this.getLayer(I);return A&&A.is3D()}):this.has3DLayers(),T=os.createFromScreenPoints(r,p);for(const I in this._sourceCaches){const A=this._sourceCaches[I].getSource().id;l.layers&&!g[A]||v.push(P(this._sourceCaches[I],this._layers,this._serializedLayers,T,l,p,w,!!this.map._showQueryGeometry))}return this.placement&&v.push(function(I,A,z,L,F,$,N){const G={},ie=$.queryRenderedSymbols(L),V=[];for(const ee of Object.keys(ie).map(Number))V.push(N[ee]);V.sort(Z);for(const ee of V){const te=ee.featureIndex.lookupSymbolFeatures(ie[ee.bucketInstanceId],A,ee.bucketIndex,ee.sourceLayerIndex,F.filter,F.layers,F.availableImages,I);for(const K in te){const J=G[K]=G[K]||[],oe=te[K];oe.sort((ye,Se)=>{const We=ee.featureSortOrder;if(We){const Ne=We.indexOf(ye.featureIndex);return We.indexOf(Se.featureIndex)-Ne}return Se.featureIndex-ye.featureIndex});for(const ye of oe)J.push(ye)}}for(const ee in G)G[ee].forEach(te=>{const K=te.feature,J=z(I[ee]).getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=J});return G}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),T.screenGeometry,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(r,l){l&&l.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);const p=this._getSourceCaches(r);let g=[];for(const v of p)g=g.concat(B(v,l));return g}addSourceType(r,l,p){return wn.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(wn.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(r,l={}){this._checkLoaded();const p=this.light.getLight();let g=!1;for(const w in r)if(!he(r[w],p[w])){g=!0;break}if(!g)return;const v={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,l),this.light.updateTransitions(v)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,l=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(l===1){if(typeof r.source=="object"){const p="terrain-dem-src";this.addSource(p,r.source),r=a.clone$1(r),r=a.extend(r,{source:p})}if(this._validate(a.validateStyle.terrain,"terrain",r))return}if(!this.terrain||this.terrain&&l!==this.terrain.drapeRenderMode)this._createTerrain(r,l);else{const p=this.terrain,g=p.get();for(const v in r)if(!he(r[v],g[v])){p.set(r),this.stylesheet.terrain=r;const w={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};p.updateTransitions(w);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new ar(r,this.map.transform);this.stylesheet.fog=r;const p={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog,p=l.get();for(const g in r)if(!he(r[g],p[g])){l.set(r),this.stylesheet.fog=r;const v={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};l.updateTransitions(v);break}}else this._createFog(r);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(p=>this.isLayerDraped(this._layers[p])),l=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new nt(r,l);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const g={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};p.updateTransitions(g)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,g,v={}){return(!v||v.validate!==!1)&&lo(this,r.call(a.validateStyle,a.extend({key:l,style:this.serialize(),value:p,styleSpec:a.spec},g)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const l=this._getSourceCaches(r);for(const p of l)p.clearTiles()}_reloadSource(r){const l=this._getSourceCaches(r);for(const p of l)p.resume(),p.reload()}_updateSources(r){for(const l in this._sourceCaches)this._sourceCaches[l].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,g,v=!1){let w=!1,T=!1;const I={};for(const A of this._order){const z=this._layers[A];if(z.type!=="symbol")continue;if(!I[z.source]){const F=this._getLayerSourceCache(z);if(!F)continue;I[z.source]=F.getRenderableIds(!0).map($=>F.getTileByID($)).sort(($,N)=>N.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(N.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(z,I[z.source],r.center.lng,r.projection);w=w||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),v=v||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(v||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),r.zoom))&&(this.pauseablePlacement=new Lt(r,this._order,v,l,p,g,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),T=!0),w&&this.pauseablePlacement.placement.setStale()),T||w)for(const A of this._order){const z=this._layers[A];z.type==="symbol"&&this.placement.updateLayerOpacities(z,I[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,l,p){this.imageManager.getImages(l.icons,p),this._updateTilesForChangedImages();const g=v=>{v&&v.setDependencies(l.tileID.key,l.type,l.icons)};g(this._otherSourceCaches[l.source]),g(this._symbolSourceCaches[l.source])}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,p)}getResource(r,l,p){return a.makeRequest(l,p)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}wn.getSourceType=function(d){return as[d]},wn.setSourceType=function(d,r){as[d]=r},wn.registerForPluginStateChange=a.registerForPluginStateChange;var yl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,hs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let ds={},ps={};ds=Et("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),ps=Et(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const jt=Et(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
return mix(globe,mercator,t);
#else
return globe;
#endif
}
#ifdef PROJECTION_GLOBE_VIEW
mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),vl=yl;var Jc={background:Et(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Et(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Et(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Et("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Et(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Et(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Et("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Et("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Et("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Et(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Et(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Et(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Et(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Et(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Et(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Et(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Et(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Et(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Et(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Et(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Et(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Et(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Et(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Et(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Et(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Et(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,hs),skyboxGradient:Et(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,hs),skyboxCapture:Et(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Et(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;const float wireframeOffset=1e3;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:Et(`uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)
discard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}")};function Et(d,r,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,v=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w=d.match(g),T=r.match(g),I=yl.match(g);let A=T?T.concat(w):w;l||(ds.staticUniforms&&(A=ds.staticUniforms.concat(A)),ps.staticUniforms&&(A=ps.staticUniforms.concat(A))),A&&(A=A.concat(I));const z={};return{fragmentSource:d=d.replace(p,(L,F,$,N,G)=>(z[G]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${G}
varying ${$} ${N} ${G};
#else
uniform ${$} ${N} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${$} ${N} ${G} = u_${G};
#endif
`)),vertexSource:r=r.replace(p,(L,F,$,N,G)=>{const ie=N==="float"?"vec2":"vec4",V=G.match(/color/)?"color":ie;return z[G]?F==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${$} ${ie} a_${G};
varying ${$} ${N} ${G};
#else
uniform ${$} ${N} u_${G};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${$} ${N} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${V}(a_${G}, u_${G}_t);
#else
    ${$} ${N} ${G} = u_${G};
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${$} ${ie} a_${G};
#else
uniform ${$} ${N} u_${G};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${$} ${N} ${G} = a_${G};
#else
    ${$} ${N} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${$} ${N} ${G} = unpack_mix_${V}(a_${G}, u_${G}_t);
#else
    ${$} ${N} ${G} = u_${G};
#endif
`}),staticAttributes:v,staticUniforms:A}}class Wn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,l,p,g,v,w,T,I){this.context=r;let A=this.boundPaintVertexBuffers.length!==g.length;for(let z=0;!A&&z<g.length;z++)this.boundPaintVertexBuffers[z]!==g[z]&&(A=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===l&&this.boundLayoutVertexBuffer===p&&!A&&this.boundIndexBuffer===v&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===I?(r.bindVertexArrayOES.set(this.vao),T&&T.bind(),v&&v.dynamicDraw&&v.bind(),I&&I.bind()):this.freshBind(l,p,g,v,w,T,I)}freshBind(r,l,p,g,v,w,T){let I;const A=r.numAttributes,z=this.context,L=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=g,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=T;else{I=z.currentNumAttributes||0;for(let F=A;F<I;F++)L.disableVertexAttribArray(F)}l.enableAttributes(L,r);for(const F of p)F.enableAttributes(L,r);w&&w.enableAttributes(L,r),T&&T.enableAttributes(L,r),l.bind(),l.setVertexAttribPointers(L,r,v);for(const F of p)F.bind(),F.setVertexAttribPointers(L,r,v);w&&(w.bind(),w.setVertexAttribPointers(L,r,v)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers(L,r,v)),z.currentNumAttributes=A}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function rd(d,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new a.MercatorCoordinate(0,p/l).toLngLat().lat,new a.MercatorCoordinate(0,(p+1)/l).toLngLat().lat]}function xl(d,r,l,p,g,v,w){const T=d.context,I=T.gl,A=l.fbo;if(!A)return;d.prepareDrawTile(r);const z=d.useProgram("hillshade");T.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,A.colorAttachment.get());const L=((G,ie,V,ee)=>{const te=V.paint.get("hillshade-shadow-color"),K=V.paint.get("hillshade-highlight-color"),J=V.paint.get("hillshade-accent-color");let oe=V.paint.get("hillshade-illumination-direction")*(Math.PI/180);V.paint.get("hillshade-illumination-anchor")==="viewport"&&(oe-=G.transform.angle);const ye=!G.options.moving;return{u_matrix:ee||G.transform.calculateProjMatrix(ie.tileID.toUnwrapped(),ye),u_image:0,u_latrange:rd(0,ie.tileID),u_light:[V.paint.get("hillshade-exaggeration"),oe],u_shadow:te,u_highlight:K,u_accent:J}})(d,l,p,d.terrain?r.projMatrix:null);d.prepareDrawProgram(T,z,r.toUnwrapped());const{tileBoundsBuffer:F,tileBoundsIndexBuffer:$,tileBoundsSegments:N}=d.getTileBoundsBuffers(l);z.draw(T,I.TRIANGLES,g,v,w,a.CullFaceMode.disabled,L,p.id,F,$,N)}function Pr(d,r,l){if(!r.needsDEMTextureUpload)return;const p=d.context,g=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||d.getTileTexture(l.stride);const v=l.getPixels();r.demTexture?r.demTexture.update(v,{premultiply:!1}):r.demTexture=new a.Texture(p,v,g.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function _a(d,r,l,p,g,v){const w=d.context,T=w.gl;if(!r.dem)return;const I=r.dem;if(w.activeTexture.set(T.TEXTURE1),Pr(d,r,I),!r.demTexture)return;r.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);const A=I.dim;w.activeTexture.set(T.TEXTURE0);let z=r.fbo;if(!z){const N=new a.Texture(w,{width:A,height:A,data:null},T.RGBA);N.bind(T.LINEAR,T.CLAMP_TO_EDGE),z=r.fbo=w.createFramebuffer(A,A,!0),z.colorAttachment.set(N.texture)}w.bindFramebuffer.set(z.framebuffer),w.viewport.set([0,0,A,A]);const{tileBoundsBuffer:L,tileBoundsIndexBuffer:F,tileBoundsSegments:$}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(w,T.TRIANGLES,p,g,v,a.CullFaceMode.disabled,((N,G)=>{const ie=G.stride,V=a.create();return a.ortho(V,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(V,V,[0,-a.EXTENT,0]),{u_matrix:V,u_image:1,u_dimension:[ie,ie],u_zoom:N.overscaledZ,u_unpack:G.unpackVector}})(r.tileID,I),l.id,L,F,$),r.needsHillshadePrepare=!1}const co=(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image0:new a.Uniform1i(d,r.u_image0),u_skirt_height:new a.Uniform1f(d,r.u_skirt_height)}),Xr=(d,r)=>({u_matrix:d,u_image0:0,u_skirt_height:r}),wl=(d,r,l,p,g)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:r,u_merc_matrix:l,u_zoom_transition:p,u_merc_center:g,u_image0:0});function Hn(d,r){return d!=null&&r!=null&&!(!d.hasData()||!r.hasData())&&d.demTexture!=null&&r.demTexture!=null&&d.tileID.key!==r.tileID.key}const Ci=new class{constructor(){this.operations={}}newMorphing(d,r,l,p,g){if(d in this.operations){const v=this.operations[d];v.to.tileID.key!==l.tileID.key&&(v.queued=l)}else this.operations[d]={startTime:p,phase:0,duration:g,from:r,to:l,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const r=this.operations[d];return{from:r.from,to:r.to,phase:r.phase}}update(d){for(const r in this.operations){const l=this.operations[r];for(l.phase=(d-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,d)){delete this.operations[r];break}}}_nextOp(d,r){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=r,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},Do={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function em(d,r){const l=1<<d.z;return!r&&(d.x===0||d.x===l-1)||d.y===0||d.y===l-1}const ki=d=>({u_matrix:d});function nd(d,r,l,p,g){if(g>0){const v=a.exported.now(),w=(v-d.timeAdded)/g,T=r?(v-r.timeAdded)/g:-1,I=l.getSource(),A=p.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),z=!r||Math.abs(r.tileID.overscaledZ-A)>Math.abs(d.tileID.overscaledZ-A),L=z&&d.refreshedUponExpiration?1:a.clamp(z?w:1-T,0,1);return d.refreshedUponExpiration&&w>=1&&(d.refreshedUponExpiration=!1),r?{opacity:1,mix:1-L}:{opacity:L,mix:0}}return{opacity:1,mix:0}}class id extends a.SourceCache{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new ur(ue(),null),g=Pn("mock-dem",l,p,r.style);super("mock-dem",g,!1),g.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class Dn extends a.SourceCache{constructor(r){const l=Pn("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new ur(ue(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const g=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,w)=>{if(v[w.key]="",!this._tiles[w.key]){const T=new a.Tile(w,this._source.tileSize*w.overscaleFactor(),r.tileZoom);T.state="loaded",this._tiles[w.key]=T}return v},{});for(const v in this._tiles)v in g||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ga extends a.OverscaledTileID{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class uo extends a.Elevation{constructor(r,l){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,g,v]=function(I){const A=new a.StructArrayLayout4i8,z=new a.StructArrayLayout3ui6,L=131;A.reserve(17161),z.reserve(33800);const F=a.EXTENT/128,$=a.EXTENT+F/2,N=$+F;for(let ie=-F;ie<N;ie+=F)for(let V=-F;V<N;V+=F){const ee=V<0||V>$||ie<0||ie>$?24575:0,te=a.clamp(Math.round(V),0,a.EXTENT),K=a.clamp(Math.round(ie),0,a.EXTENT);A.emplaceBack(te+ee,K,te,K)}const G=(ie,V)=>{const ee=V*L+ie;z.emplaceBack(ee+1,ee,ee+L),z.emplaceBack(ee+L,ee+L+1,ee+1)};for(let ie=1;ie<129;ie++)for(let V=1;V<129;V++)G(V,ie);return[0,129].forEach(ie=>{for(let V=0;V<130;V++)G(V,ie),G(ie,V)}),[A,z,32768]}(),w=r.context;this.gridBuffer=w.createVertexBuffer(p,a.boundsAttributes.members),this.gridIndexBuffer=w.createIndexBuffer(g),this.gridSegments=a.SegmentVector.simpleSegment(0,0,p.length,g.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,p.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Dn(l.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,0,a.EXTENT,0,a.EXTENT,0,1);const T=w.gl;this._overlapStencilMode=new a.StencilMode({func:T.GEQUAL,mask:255},0,255,T.KEEP,T.KEEP,T.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new id(l.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency()}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const g=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(g.get("source")),this._exaggeration=g.get("exaggeration");const v=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const w=this.getScaledDemTileSize();this.sourceCache.update(l,w,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,v(),this._initializing=!0),v(),l.updateElevation(!p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const g=this.proxyCoords=l.getIds().map(I=>{const A=l.getTileByID(I).tileID;return A.projMatrix=p.calculateProjMatrix(A.toUnwrapped()),A});(function(I,A){const z=A.transform.pointCoordinate(A.transform.getCameraPoint()),L=new a.pointGeometry(z.x,z.y);I.sort((F,$)=>{if($.overscaledZ-F.overscaledZ)return $.overscaledZ-F.overscaledZ;const N=new a.pointGeometry(F.canonical.x+(1<<F.canonical.z)*F.wrap,F.canonical.y),G=new a.pointGeometry($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),ie=L.mult(1<<F.canonical.z);return ie.x-=.5,ie.y-=.5,ie.distSqr(N)-ie.distSqr(G)})})(g,this.painter),this._previousZoom=p.zoom;const v=this.proxyToSource||{};this.proxyToSource={},g.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const w=this._style._sourceCaches;for(const I in w){const A=w[I];if(!A.used||(A!==this.sourceCache&&this.resetTileLookupCache(A.id),this._setupProxiedCoordsForOrtho(A,r[I],v),A.usedForTerrain))continue;const z=r[I];A.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[l.id]=g.map(I=>new ga(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(g),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const T={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const A=this.terrainTileForTile[I.key];if(!A)continue;const z=A.tileID.key;z in T||(this._visibleDemTiles.push(A),T[z]=z)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const g=this.terrainTileForTile[p],v=g.dem;!v||g.demTexture&&!g.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),Pr(this.painter,g,v))}}_prepareDemTileUniforms(r,l,p,g){if(!l||l.demTexture==null)return!1;const v=r.tileID.canonical,w=Math.pow(2,l.tileID.canonical.z-v.z),T=g||"";return p[`u_dem_tl${T}`]=[v.x*w%1,v.y*w%1],p[`u_dem_scale${T}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,l=r.gl;if(!this._emptyDepthBufferTexture){const p={width:1,height:1,data:new Uint8Array([255,255,255,255])};this._emptyDepthBufferTexture=new a.Texture(r,p,l.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const l=this._visibleDemTiles.reduce((p,g)=>{if(!g.dem)return p;const v=g.dem.tree.minimums[0];return v>0&&r++,p+v},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),g={width:1,height:1,data:new Uint8Array(a.DEMData.pack(p,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(g,{premultiply:!1}):v=this._emptyDEMTexture=new a.Texture(r,g,l.RGBA,{premultiply:!1}),v}setupElevationDraw(r,l,p){const g=this.painter.context,v=g.gl,w=(T=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(T),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var T;w.u_dem_size=this.sourceCache.getSource().tileSize,w.u_exaggeration=this.exaggeration();const I=this.painter.transform,A=I.projection.createTileTransform(I,I.worldSize),z=r.tileID.canonical;w.u_tile_tl_up=A.upVector(z,0,0),w.u_tile_tr_up=A.upVector(z,a.EXTENT,0),w.u_tile_br_up=A.upVector(z,a.EXTENT,a.EXTENT),w.u_tile_bl_up=A.upVector(z,0,a.EXTENT),w.u_tile_up_scale=A.upVectorScale(z);let L=null,F=null,$=1;if(p&&p.morphing&&this._useVertexMorphing){const N=p.morphing.srcDemTile,G=p.morphing.dstDemTile;$=p.morphing.phase,N&&G&&(this._prepareDemTileUniforms(r,N,w,"_prev")&&(F=N),this._prepareDemTileUniforms(r,G,w)&&(L=G))}if(F&&L?(g.activeTexture.set(v.TEXTURE2),L.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),g.activeTexture.set(v.TEXTURE4),F.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),w.u_dem_lerp=$):(L=this.terrainTileForTile[r.tileID.key],g.activeTexture.set(v.TEXTURE2),(this._prepareDemTileUniforms(r,L,w)?L.demTexture:this.emptyDEMTexture).bind(v.NEAREST,v.CLAMP_TO_EDGE)),g.activeTexture.set(v.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),w.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]):(this.emptyDepthBufferTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),w.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&L){const N=(1<<L.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=N}p&&p.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(g,w)}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),this.renderingToTexture=!1,function(g,v,w,T,I){if(g.transform.projection.name==="globe")(function(A,z,L,F,$){const N=A.context,G=N.gl;let ie,V;const ee=A.options.showTerrainWireframe?2:0,te=(Be,ke)=>{if(V===Be)return;const be=[];ke&&be.push(Do[ee]),be.push(Do[Be]),be.push("PROJECTION_GLOBE_VIEW"),ie=A.useProgram("globeRaster",null,be),V=Be},K=A.colorModeForRenderPass(),J=new a.DepthMode(G.LEQUAL,a.DepthMode.ReadWrite,A.depthRangeFor3D);Ci.update($);const oe=A.transform,ye=a.calculateGlobeMatrix(oe,oe.worldSize),Se=a.calculateGlobeMercatorMatrix(oe),We=[a.mercatorXfromLng(oe.center.lng),a.mercatorYfromLat(oe.center.lat)],Ne=A.globeSharedBuffers;(ee?[!1,!0]:[!1]).forEach(Be=>{V=-1;const ke=Be?G.LINES:G.TRIANGLES;for(const be of F){const Oe=L.getTile(be),Pe=Math.pow(2,be.canonical.z),[ct,_t]=a.globeBuffersForTileMesh(A,Oe,be,Pe),kt=a.StencilMode.disabled,qe=z.prevTerrainTileForTile[be.key],dt=z.terrainTileForTile[be.key];Hn(qe,dt)&&Ci.newMorphing(be.key,qe,dt,$,250),N.activeTexture.set(G.TEXTURE0),Oe.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const xt=Ci.getMorphValuesForProxy(be.key),Yt=xt?1:0,nr={};xt&&a.extend$1(nr,{morphing:{srcDemTile:xt.from,dstDemTile:xt.to,phase:a.easeCubicInOut(xt.phase)}});const vt=a.globeMatrixForTile(be.canonical,ye),zt=wl(oe.projMatrix,vt,Se,a.globeToMercatorTransition(oe.zoom),We);if(te(Yt,Be),z.setupElevationDraw(Oe,ie,nr),A.prepareDrawProgram(N,ie,be.toUnwrapped()),Ne){const[pr,Ur]=Be?Ne.getWirefameBuffer(A.context):[Ne.gridIndexBuffer,Ne.gridSegments];ie.draw(N,ke,J,kt,K,a.CullFaceMode.backCCW,zt,"globe_raster",ct,pr,Ur)}if(!Be){const pr=[be.canonical.y===0?a.globePoleMatrixForTile(be.canonical,!1,oe):null,be.canonical.y===Pe-1?a.globePoleMatrixForTile(be.canonical,!0,oe):null];for(const Ur of pr){if(!Ur)continue;const Tn=wl(oe.projMatrix,Ur,Ur,0,We);Ne&&ie.draw(N,ke,J,kt,K,a.CullFaceMode.disabled,Tn,"globe_pole_raster",_t,Ne.poleIndexBuffer,Ne.poleSegments)}}}})})(g,v,w,T,I);else{const A=g.context,z=A.gl;let L,F;const $=g.options.showTerrainWireframe?2:0,N=(te,K)=>{if(F===te)return;const J=[Do[te]];K&&J.push(Do[$]),L=g.useProgram("terrainRaster",null,J),F=te},G=g.colorModeForRenderPass(),ie=new a.DepthMode(z.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);Ci.update(I);const V=g.transform,ee=6*Math.pow(1.5,22-V.zoom)*v.exaggeration();($?[!1,!0]:[!1]).forEach(te=>{F=-1;const K=te?z.LINES:z.TRIANGLES,[J,oe]=te?v.getWirefameBuffer():[v.gridIndexBuffer,v.gridSegments];for(const ye of T){const Se=w.getTile(ye),We=a.StencilMode.disabled,Ne=v.prevTerrainTileForTile[ye.key],Be=v.terrainTileForTile[ye.key];Hn(Ne,Be)&&Ci.newMorphing(ye.key,Ne,Be,I,250),A.activeTexture.set(z.TEXTURE0),Se.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const ke=Ci.getMorphValuesForProxy(ye.key),be=ke?1:0;let Oe;ke&&(Oe={morphing:{srcDemTile:ke.from,dstDemTile:ke.to,phase:a.easeCubicInOut(ke.phase)}});const Pe=Xr(ye.projMatrix,em(ye.canonical,V.renderWorldCopies)?ee/10:ee);N(be,te),v.setupElevationDraw(Se,L,Oe),g.prepareDrawProgram(A,L,ye.toUnwrapped()),L.draw(A,K,ie,We,G,a.CullFaceMode.backCCW,Pe,"terrain_raster",v.gridBuffer,J,oe)}})}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,g=this.proxySourceCache,v=this.proxiedCoords[g.id],w=this._drapedRenderBatches.shift(),T=[],I=l.style.order;let A=0;for(const z of v){const L=g.getTileByID(z.proxyTileKey),F=g.proxyCachedFBO[z.key]?g.proxyCachedFBO[z.key][r]:void 0,$=F!==void 0?g.renderCache[F]:this.pool[A++],N=F!==void 0;if(L.texture=$.tex,N&&!$.dirty){T.push(L.tileID);continue}let G;p.bindFramebuffer.set($.fb.framebuffer),this.renderedToTile=!1,$.dirty&&(p.clear({color:a.Color.transparent,stencil:0}),$.dirty=!1);for(let ie=w.start;ie<=w.end;++ie){const V=l.style._layers[I[ie]];if(V.isHidden(l.transform.zoom))continue;const ee=l.style._getLayerSourceCache(V),te=ee?this.proxyToSource[z.key][ee.id]:[z];if(!te)continue;const K=te;p.viewport.set([0,0,$.fb.width,$.fb.height]),G!==(ee?ee.id:null)&&(this._setupStencil($,te,V,ee),G=ee?ee.id:null),l.renderLayer(l,ee,V,K)}this.renderedToTile?($.dirty=!0,T.push(L.tileID)):N||--A,A===5&&(A=0,this.renderToBackBuffer(T))}return this.renderToBackBuffer(T),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),w.end+1}postRender(){}renderCacheEfficiency(r){const l=r.order.length;if(l===0)return{efficiency:100};let p,g=0,v=0,w=!1;for(let T=0;T<l;++T){const I=r._layers[r.order[T]];this._style.isLayerDraped(I)?(w&&++g,++v):w||(w=!0,p=I.id)}return v===0?{efficiency:100}:{efficiency:100*(1-g/v),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const g=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const w=v.tileID,T=Math.pow(2,w.overscaledZ),{x:I,y:A}=w.canonical,z=I/T,L=(I+1)/T,F=A/T,$=(A+1)/T;return{minx:z,miny:F,maxx:L,maxy:$,t:v.dem.tree.raycastRoot(z,F,L,$,r,l,p),tile:v}});g.sort((v,w)=>(v.t!==null?v.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const v of g){if(v.t==null)return null;const w=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,r,l,p);if(w!=null)return w}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const g=new a.Texture(r,{width:p[0],height:p[1],data:null},l.RGBA);g.bind(l.LINEAR,l.CLAMP_TO_EDGE);const v=r.createFramebuffer(p[0],p[1],!1);return v.colorAttachment.set(g.texture),v.depthAttachment=new hl(r,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:v,tex:g,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._layers[r],p=l.isHidden(this.painter.transform.zoom),g=l.getCrossfadeParameters(),v=!!g&&g.t!==1,w=l.hasTransition();return l.type!=="custom"&&!p&&(v||w)})}_clearRasterFadeFromRenderCache(){let r=!1;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l]._source instanceof Fi){r=!0;break}if(r)for(let l=0;l<this._style.order.length;++l){const p=this._style._layers[this._style.order[l]],g=p.isHidden(this.painter.transform.zoom),v=this._style._getLayerSourceCache(p);if(p.type!=="raster"||g||!v)continue;const w=p.paint.get("raster-fade-duration");for(const T of this.proxyCoords){const I=this.proxyToSource[T.key][v.id];if(I)for(const A of I){const z=nd(v.getTile(A),v.findLoadedParent(A,0),v,this.painter.transform,w);(z.opacity!==1||z.mix!==0)&&this._clearRenderCacheForTile(v.id,A)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const p=[];let g,v=0,w=this._style._layers[r[v]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++v<l;)w=this._style._layers[r[v]];for(;v<l;++v){const T=this._style._layers[r[v]];T.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(T)?g===void 0&&(g=v):g!==void 0&&(p.push({start:g,end:v-1}),g=void 0))}g!==void 0&&p.push({start:g,end:v-1}),this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const w=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let T=0;T<w.length;++T){const I=Object.values(w[T]);l.renderCachePool.push(...I)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,g=this._tilesDirty;for(let w=p.length-1;w>=0;w--){const T=p[w];if(l.getTileByID(T.key),l.proxyCachedFBO[T.key]!==void 0){const I=r[T.key],A=this.proxyToSource[T.key];let z=0;for(const L in A){const F=A[L],$=I[L];if(!$||$.length!==F.length||F.some((N,G)=>N!==$[G]||g[L]&&g[L].hasOwnProperty(N.key))){z=-1;break}++z}for(const L in l.proxyCachedFBO[T.key])l.renderCache[l.proxyCachedFBO[T.key][L]].dirty=z<0||z!==Object.values(I).length}}const v=[...this._drapedRenderBatches];v.sort((w,T)=>T.end-T.start-(w.end-w.start));for(const w of v)for(const T of p){if(l.proxyCachedFBO[T.key])continue;let I=l.renderCachePool.pop();I===void 0&&l.renderCache.length<50&&(I=l.renderCache.length,l.renderCache.push(this._createFBO())),I!==void 0&&(l.proxyCachedFBO[T.key]={},l.proxyCachedFBO[T.key][w.start]=I,l.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,g){if(!g||!this._sourceTilesOverlap[g.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,w=v.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let T;if(p.isTileClipped())T=l.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);T=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+T>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=T,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(r,l){const p=this.painter,g=this.painter.context,v=g.gl;p._tileClippingMaskIDs={},g.setColorMode(a.ColorMode.disabled),g.setDepthMode(a.DepthMode.disabled);const w=p.useProgram("clippingMask");for(const T of r){const I=p._tileClippingMaskIDs[T.key]=--l;w.draw(g,v.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:v.ALWAYS,mask:0},I,255,v.KEEP,v.KEEP,v.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,ki(T.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];a.transformMat4$1(p,p,l.pixelMatrixInverse),a.scale$1(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const g=l._camera.position,v=a.mercatorZfromAltitude(1,l.center.lat),w=[g[0],g[1],g[2]/v,0],T=a.subtract([],p.slice(0,3),w);a.normalize(T,T);const I=this.raycast(w,T,this._exaggeration);return I!==null&&I?(a.scaleAndAdd(w,w,T,I),w[3]=w[2],w[2]*=v,w):null}drawDepth(){const r=this.painter,l=r.context,p=this.proxySourceCache,g=Math.ceil(r.width),v=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===g&&this._depthFBO.height===v||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const w=l.gl,T=l.createFramebuffer(g,v,!0);l.activeTexture.set(w.TEXTURE0);const I=new a.Texture(l,{width:g,height:v,data:null},w.RGBA);I.bind(w.NEAREST,w.CLAMP_TO_EDGE),T.colorAttachment.set(I.texture);const A=l.createRenderbuffer(l.gl.DEPTH_COMPONENT16,g,v);T.depthAttachment.set(A),this._depthFBO=T,this._depthTexture=I}l.bindFramebuffer.set(this._depthFBO.framebuffer),l.viewport.set([0,0,g,v]),function(w,T,I,A){if(w.transform.projection.name==="globe")return;const z=w.context,L=z.gl;z.clear({depth:1});const F=w.useProgram("terrainDepth"),$=new a.DepthMode(L.LESS,a.DepthMode.ReadWrite,w.depthRangeFor3D);for(const N of A){const G=I.getTile(N),ie=Xr(N.projMatrix,0);T.setupElevationDraw(G,F),F.draw(z,L.TRIANGLES,$,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ie,"terrain_depth",T.gridBuffer,T.gridIndexBuffer,T.gridNoSkirtSegments)}}(r,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof wi)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const g=this.proxiedCoords[r.id]=[],v=this.proxyCoords;for(let T=0;T<v.length;T++){const I=v[T],A=this._findTileCoveringTileID(I,r);if(A){const z=this._createProxiedId(I,A,p[I.key]&&p[I.key][r.id]);g.push(z),this.proxyToSource[I.key][r.id]=[z]}}let w=!1;for(let T=0;T<l.length;T++){const I=r.getTile(l[T]);if(!I||!I.hasData())continue;const A=this._findTileCoveringTileID(I.tileID,this.proxySourceCache);if(A&&A.tileID.canonical.z!==I.tileID.canonical.z){const z=this.proxyToSource[A.tileID.key][r.id],L=this._createProxiedId(A.tileID,I,p[A.tileID.key]&&p[A.tileID.key][r.id]);z?z.splice(z.length-1,0,L):this.proxyToSource[A.tileID.key][r.id]=[L],g.push(L),w=!0}}this._sourceTilesOverlap[r.id]=w}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const g=this.proxiedCoords[r.id]=[],v=this.proxyCoords,w=r.getSource(),T=new a.pointGeometry(w.tileID.x,w.tileID.y)._div(1<<w.tileID.z),I=w.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((z,L)=>(z.min.x=Math.min(z.min.x,L.x-T.x),z.min.y=Math.min(z.min.y,L.y-T.y),z.max.x=Math.max(z.max.x,L.x-T.x),z.max.y=Math.max(z.max.y,L.y-T.y),z),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),A=(z,L)=>{const F=z.wrap+z.canonical.x/(1<<z.canonical.z),$=z.canonical.y/(1<<z.canonical.z),N=a.EXTENT/(1<<z.canonical.z),G=L.wrap+L.canonical.x/(1<<L.canonical.z),ie=L.canonical.y/(1<<L.canonical.z);return F+N<G+I.min.x||F>G+I.max.x||$+N<ie+I.min.y||$>ie+I.max.y};for(let z=0;z<v.length;z++){const L=v[z];for(let F=0;F<l.length;F++){const $=r.getTile(l[F]);if(!$||!$.hasData()||A(L,$.tileID))continue;const N=this._createProxiedId(L,$,p[L.key]&&p[L.key][r.id]),G=this.proxyToSource[L.key][r.id];G?G.push(N):this.proxyToSource[L.key][r.id]=[N],g.push(N)}}}_createProxiedId(r,l,p){let g=this.orthoMatrix;if(p){const v=p.find(w=>w.key===l.tileID.key);if(v)return v}if(l.tileID.key!==r.key){const v=r.canonical.z-l.tileID.canonical.z;let w,T,I;g=a.create();const A=l.tileID.wrap-r.wrap<<r.overscaledZ;v>0?(w=a.EXTENT>>v,T=w*((l.tileID.canonical.x<<v)-r.canonical.x+A),I=w*((l.tileID.canonical.y<<v)-r.canonical.y)):(w=a.EXTENT<<-v,T=a.EXTENT*(l.tileID.canonical.x-(r.canonical.x+A<<-v)),I=a.EXTENT*(l.tileID.canonical.y-(r.canonical.y<<-v))),a.ortho(g,0,w,0,w,0,1),a.translate(g,g,[T,I,0])}return new ga(l.tileID,r.key,g)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const g=this._findCoveringTileCache[l.id],v=g[r.key];if(p=v?l.getTileByID(v):null,p&&p.hasData()||v===null)return p;let w=p?p.tileID:r,T=w.overscaledZ;const I=l.getSource().minzoom,A=[];if(!v){const L=l.getSource().maxzoom;if(r.canonical.z>=L){const F=r.canonical.z-L;l.getSource().reparseOverscaled?(T=Math.max(r.canonical.z+2,l.transform.tileZoom),w=new a.OverscaledTileID(T,r.wrap,L,r.canonical.x>>F,r.canonical.y>>F)):F!==0&&(T=L,w=new a.OverscaledTileID(T,r.wrap,L,r.canonical.x>>F,r.canonical.y>>F))}w.key!==r.key&&(A.push(w.key),p=l.getTile(w))}const z=L=>{A.forEach(F=>{g[F]=L}),A.length=0};for(T-=1;T>=I&&(!p||!p.hasData());T--){p&&z(p.tileID.key);const L=w.calculateScaledKey(T);if(p=l.getTileByID(L),p&&p.hasData())break;const F=g[L];if(F===null)break;F===void 0?A.push(L):p=l.getTileByID(F)}return z(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(r){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(l){let p,g,v;const w=new a.StructArrayLayout2ui4,T=131;for(g=1;g<129;g++){for(p=1;p<129;p++)v=g*T+p,w.emplaceBack(v,v+1),w.emplaceBack(v,v+T),w.emplaceBack(v+1,v+T),g===128&&w.emplaceBack(v+T,v+T+1);w.emplaceBack(v+1,v+1+T)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function bl(d){const r=[];for(let l=0;l<d.length;l++){if(d[l]===null)continue;const p=d[l].split(" ");r.push(p.pop())}return r}class ya{static cacheKey(r,l,p){let g=`${r}${p?p.cacheKey:""}`;for(const v of l)g+=`/${v}`;return g}constructor(r,l,p,g,v,w){const T=r.gl;this.program=T.createProgram();const I=bl(p.staticAttributes),A=g?g.getBinderAttributes():[],z=I.concat(A),L=p.staticUniforms?bl(p.staticUniforms):[],F=g?g.getBinderUniforms():[],$=L.concat(F),N=[];for(const J of $)N.indexOf(J)<0&&N.push(J);let G=g?g.defines():[];G=G.concat(w.map(J=>`#define ${J}`));const ie=G.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,vl,jt.fragmentSource,ps.fragmentSource,p.fragmentSource).join(`
`),V=G.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,vl,jt.vertexSource,ps.vertexSource,ds.vertexSource,p.vertexSource).join(`
`),ee=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);T.shaderSource(ee,ie),T.compileShader(ee),T.attachShader(this.program,ee);const te=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);T.shaderSource(te,V),T.compileShader(te),T.attachShader(this.program,te),this.attributes={};const K={};this.numAttributes=z.length;for(let J=0;J<this.numAttributes;J++)z[J]&&(T.bindAttribLocation(this.program,J,z[J]),this.attributes[z[J]]=J);T.linkProgram(this.program),T.deleteShader(te),T.deleteShader(ee);for(let J=0;J<N.length;J++){const oe=N[J];if(oe&&!K[oe]){const ye=T.getUniformLocation(this.program,oe);ye&&(K[oe]=ye)}}this.fixedUniforms=v(r,K),this.binderUniforms=g?g.getUniforms(r,K):[],w.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((J,oe)=>({u_dem:new a.Uniform1i(J,oe.u_dem),u_dem_prev:new a.Uniform1i(J,oe.u_dem_prev),u_dem_unpack:new a.Uniform4f(J,oe.u_dem_unpack),u_dem_tl:new a.Uniform2f(J,oe.u_dem_tl),u_dem_scale:new a.Uniform1f(J,oe.u_dem_scale),u_dem_tl_prev:new a.Uniform2f(J,oe.u_dem_tl_prev),u_dem_scale_prev:new a.Uniform1f(J,oe.u_dem_scale_prev),u_dem_size:new a.Uniform1f(J,oe.u_dem_size),u_dem_lerp:new a.Uniform1f(J,oe.u_dem_lerp),u_exaggeration:new a.Uniform1f(J,oe.u_exaggeration),u_depth:new a.Uniform1i(J,oe.u_depth),u_depth_size_inv:new a.Uniform2f(J,oe.u_depth_size_inv),u_meter_to_dem:new a.Uniform1f(J,oe.u_meter_to_dem),u_label_plane_matrix_inv:new a.UniformMatrix4f(J,oe.u_label_plane_matrix_inv),u_tile_tl_up:new a.Uniform3f(J,oe.u_tile_tl_up),u_tile_tr_up:new a.Uniform3f(J,oe.u_tile_tr_up),u_tile_br_up:new a.Uniform3f(J,oe.u_tile_br_up),u_tile_bl_up:new a.Uniform3f(J,oe.u_tile_bl_up),u_tile_up_scale:new a.Uniform1f(J,oe.u_tile_up_scale)}))(r,K)),w.indexOf("FOG")!==-1&&(this.fogUniforms=((J,oe)=>({u_fog_matrix:new a.UniformMatrix4f(J,oe.u_fog_matrix),u_fog_range:new a.Uniform2f(J,oe.u_fog_range),u_fog_color:new a.Uniform4f(J,oe.u_fog_color),u_fog_horizon_blend:new a.Uniform1f(J,oe.u_fog_horizon_blend),u_fog_temporal_offset:new a.Uniform1f(J,oe.u_fog_temporal_offset)}))(r,K))}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in l)p[g].set(l[g])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in l)p[g].location&&p[g].set(l[g])}}draw(r,l,p,g,v,w,T,I,A,z,L,F,$,N,G,ie){const V=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(p),r.setStencilMode(g),r.setColorMode(v),r.setCullFace(w);for(const te of Object.keys(this.fixedUniforms))this.fixedUniforms[te].set(T[te]);N&&N.setUniforms(r,this.binderUniforms,F,{zoom:$});const ee={[V.LINES]:2,[V.TRIANGLES]:3,[V.LINE_STRIP]:1}[l];for(const te of L.get()){const K=te.vaos||(te.vaos={});(K[I]||(K[I]=new Wn)).bind(r,this,A,N?N.getPaintVertexBuffers():[],z,te.vertexOffset,G,ie),V.drawElements(l,te.primitiveLength*ee,V.UNSIGNED_SHORT,te.primitiveOffset*ee*2)}}}function od(d,r,l){const p=1/wr(l,1,r.transform.tileZoom),g=Math.pow(2,l.tileID.overscaledZ),v=l.tileSize*Math.pow(2,r.transform.tileZoom)/g,w=v*(l.tileID.canonical.x+l.tileID.wrap*g),T=v*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[p,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const sd=(d,r,l,p)=>{const g=r.style.light,v=g.properties.get("position"),w=[v.x,v.y,v.z],T=a.create$1();g.properties.get("anchor")==="viewport"&&(a.fromRotation(T,-r.transform.angle),a.transformMat3(w,w,T));const I=g.properties.get("color");return{u_matrix:d,u_lightpos:w,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+l,u_opacity:p}},Qc=(d,r,l,p,g,v,w)=>a.extend(sd(d,r,l,p),od(v,r,w),{u_height_factor:-Math.pow(2,g.overscaledZ)/w.tileSize/8}),ad=d=>({u_matrix:d}),eu=(d,r,l,p)=>a.extend(ad(d),od(l,r,p)),tm=(d,r)=>({u_matrix:d,u_world:r}),ld=(d,r,l,p,g)=>a.extend(eu(d,r,l,p),{u_world:g}),rm=(d,r,l,p)=>{const g=d.transform;let v;return v=p.paint.get("circle-pitch-alignment")==="map"?g.calculatePixelsToTileUnitsMatrix(l):new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]),{u_camera_to_center_distance:g.cameraToCenterDistance,u_matrix:d.translatePosMatrix(r.projMatrix,l,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:v}},tu=d=>{const r=[];return d.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},cd=(d,r,l)=>{const p=a.EXTENT/l.tileSize;return{u_matrix:d,u_camera_to_center_distance:r.cameraToCenterDistance,u_extrude_scale:[r.pixelsToGLUnits[0]/p,r.pixelsToGLUnits[1]/p]}},ru=(d,r,l=1)=>({u_matrix:d,u_color:r,u_overlay:0,u_overlay_scale:l}),ud=(d,r,l,p)=>({u_matrix:d,u_extrude_scale:wr(r,1,l),u_intensity:p}),hd=(d,r,l,p,g,v)=>{const w=d.transform,T=w.calculatePixelsToTileUnitsMatrix(r),I={u_matrix:va(d,r,l,g),u_pixels_to_tile_units:T,u_device_pixel_ratio:a.exported.devicePixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(xa(l)){const A=fs(r,d.transform);I.u_texsize=r.lineAtlasTexture.size,I.u_scale=[A,p.fromScale,p.toScale],I.u_mix=p.t}return I},Lo=(d,r,l,p,g)=>{const v=d.transform,w=fs(r,v);return{u_matrix:va(d,r,l,g),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:a.exported.devicePixelRatio,u_image:0,u_scale:[w,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function fs(d,r){return 1/wr(d,1,r.tileZoom)}function va(d,r,l,p){return d.translatePosMatrix(p||r.tileID.projMatrix,r,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}function xa(d){const r=d.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Tl=(d,r,l,p,g,v)=>{return{u_matrix:d,u_tl_parent:r,u_scale_parent:l,u_fade_t:p.mix,u_opacity:p.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(T=g.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(w=g.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Sl(g.paint.get("raster-hue-rotate")),u_perspective_transform:v};var w,T};function Sl(d){d*=Math.PI/180;const r=Math.sin(d),l=Math.cos(d);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const El=(d,r,l,p,g,v,w,T,I,A,z,L,F,$)=>{const N=g.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:N.cameraToCenterDistance,u_pitch:N.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:N.width/N.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:w,u_coord_matrix:T,u_is_text:+I,u_pitch_with_map:+p,u_texsize:A,u_tile_id:z,u_zoom_transition:L,u_inv_rot_matrix:F,u_merc_center:$,u_texture:0}},wa=(d,r,l,p,g,v,w,T,I,A,z,L,F,$,N)=>{const{cameraToCenterDistance:G,_pitch:ie}=g.transform;return a.extend(El(d,r,l,p,g,v,w,T,I,A,L,F,$,N),{u_gamma_scale:p?G*Math.cos(g.terrain?0:ie):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+z})},ba=(d,r,l,p,g,v,w,T,I,A,z,L,F,$)=>a.extend(wa(d,r,l,p,g,v,w,T,!0,I,!0,z,L,F,$),{u_texsize_icon:A,u_texture_icon:1}),Xt=(d,r,l)=>({u_matrix:d,u_opacity:r,u_color:l}),Cl=(d,r,l,p,g,v)=>a.extend(function(w,T,I,A){const z=I.imageManager.getPattern(w.from.toString()),L=I.imageManager.getPattern(w.to.toString()),{width:F,height:$}=I.imageManager.getPixelSize(),N=Math.pow(2,A.tileID.overscaledZ),G=A.tileSize*Math.pow(2,I.transform.tileZoom)/N,ie=G*(A.tileID.canonical.x+A.tileID.wrap*N),V=G*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[F,$],u_mix:T.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/wr(A,1,I.transform.tileZoom),u_pixel_coord_upper:[ie>>16,V>>16],u_pixel_coord_lower:[65535&ie,65535&V]}}(p,v,l,g),{u_matrix:d,u_opacity:r}),dd={fillExtrusion:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_lightpos:new a.Uniform3f(d,r.u_lightpos),u_lightintensity:new a.Uniform1f(d,r.u_lightintensity),u_lightcolor:new a.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,r.u_vertical_gradient),u_opacity:new a.Uniform1f(d,r.u_opacity)}),fillExtrusionPattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_lightpos:new a.Uniform3f(d,r.u_lightpos),u_lightintensity:new a.Uniform1f(d,r.u_lightintensity),u_lightcolor:new a.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,r.u_vertical_gradient),u_height_factor:new a.Uniform1f(d,r.u_height_factor),u_image:new a.Uniform1i(d,r.u_image),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade),u_opacity:new a.Uniform1f(d,r.u_opacity)}),fill:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),fillPattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image:new a.Uniform1i(d,r.u_image),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade)}),fillOutline:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_world:new a.Uniform2f(d,r.u_world)}),fillOutlinePattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_world:new a.Uniform2f(d,r.u_world),u_image:new a.Uniform1i(d,r.u_image),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade)}),circle:(d,r)=>({u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_extrude_scale:new a.UniformMatrix2f(d,r.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),collisionBox:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(d,r.u_extrude_scale)}),collisionCircle:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_inv_matrix:new a.UniformMatrix4f(d,r.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(d,r.u_viewport_size)}),debug:(d,r)=>({u_color:new a.UniformColor(d,r.u_color),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_overlay:new a.Uniform1i(d,r.u_overlay),u_overlay_scale:new a.Uniform1f(d,r.u_overlay_scale)}),clippingMask:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),heatmap:(d,r)=>({u_extrude_scale:new a.Uniform1f(d,r.u_extrude_scale),u_intensity:new a.Uniform1f(d,r.u_intensity),u_matrix:new a.UniformMatrix4f(d,r.u_matrix)}),heatmapTexture:(d,r)=>({u_image:new a.Uniform1i(d,r.u_image),u_color_ramp:new a.Uniform1i(d,r.u_color_ramp),u_opacity:new a.Uniform1f(d,r.u_opacity)}),hillshade:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image:new a.Uniform1i(d,r.u_image),u_latrange:new a.Uniform2f(d,r.u_latrange),u_light:new a.Uniform2f(d,r.u_light),u_shadow:new a.UniformColor(d,r.u_shadow),u_highlight:new a.UniformColor(d,r.u_highlight),u_accent:new a.UniformColor(d,r.u_accent)}),hillshadePrepare:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_image:new a.Uniform1i(d,r.u_image),u_dimension:new a.Uniform2f(d,r.u_dimension),u_zoom:new a.Uniform1f(d,r.u_zoom),u_unpack:new a.Uniform4f(d,r.u_unpack)}),line:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_pixels_to_tile_units:new a.UniformMatrix2f(d,r.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(d,r.u_units_to_pixels),u_dash_image:new a.Uniform1i(d,r.u_dash_image),u_gradient_image:new a.Uniform1i(d,r.u_gradient_image),u_image_height:new a.Uniform1f(d,r.u_image_height),u_texsize:new a.Uniform2f(d,r.u_texsize),u_scale:new a.Uniform3f(d,r.u_scale),u_mix:new a.Uniform1f(d,r.u_mix),u_alpha_discard_threshold:new a.Uniform1f(d,r.u_alpha_discard_threshold)}),linePattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_texsize:new a.Uniform2f(d,r.u_texsize),u_pixels_to_tile_units:new a.UniformMatrix2f(d,r.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_image:new a.Uniform1i(d,r.u_image),u_units_to_pixels:new a.Uniform2f(d,r.u_units_to_pixels),u_scale:new a.Uniform3f(d,r.u_scale),u_fade:new a.Uniform1f(d,r.u_fade),u_alpha_discard_threshold:new a.Uniform1f(d,r.u_alpha_discard_threshold)}),raster:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_tl_parent:new a.Uniform2f(d,r.u_tl_parent),u_scale_parent:new a.Uniform1f(d,r.u_scale_parent),u_fade_t:new a.Uniform1f(d,r.u_fade_t),u_opacity:new a.Uniform1f(d,r.u_opacity),u_image0:new a.Uniform1i(d,r.u_image0),u_image1:new a.Uniform1i(d,r.u_image1),u_brightness_low:new a.Uniform1f(d,r.u_brightness_low),u_brightness_high:new a.Uniform1f(d,r.u_brightness_high),u_saturation_factor:new a.Uniform1f(d,r.u_saturation_factor),u_contrast_factor:new a.Uniform1f(d,r.u_contrast_factor),u_spin_weights:new a.Uniform3f(d,r.u_spin_weights),u_perspective_transform:new a.Uniform2f(d,r.u_perspective_transform)}),symbolIcon:(d,r)=>({u_is_size_zoom_constant:new a.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,r.u_size_t),u_size:new a.Uniform1f(d,r.u_size),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,r.u_pitch),u_rotate_symbol:new a.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,r.u_fade_change),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new a.Uniform1i(d,r.u_is_text),u_pitch_with_map:new a.Uniform1i(d,r.u_pitch_with_map),u_texsize:new a.Uniform2f(d,r.u_texsize),u_tile_id:new a.Uniform3f(d,r.u_tile_id),u_zoom_transition:new a.Uniform1f(d,r.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,r.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,r.u_merc_center),u_texture:new a.Uniform1i(d,r.u_texture)}),symbolSDF:(d,r)=>({u_is_size_zoom_constant:new a.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,r.u_size_t),u_size:new a.Uniform1f(d,r.u_size),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,r.u_pitch),u_rotate_symbol:new a.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,r.u_fade_change),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new a.Uniform1i(d,r.u_is_text),u_pitch_with_map:new a.Uniform1i(d,r.u_pitch_with_map),u_texsize:new a.Uniform2f(d,r.u_texsize),u_texture:new a.Uniform1i(d,r.u_texture),u_gamma_scale:new a.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_tile_id:new a.Uniform3f(d,r.u_tile_id),u_zoom_transition:new a.Uniform1f(d,r.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,r.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,r.u_merc_center),u_is_halo:new a.Uniform1i(d,r.u_is_halo)}),symbolTextAndIcon:(d,r)=>({u_is_size_zoom_constant:new a.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,r.u_size_t),u_size:new a.Uniform1f(d,r.u_size),u_camera_to_center_distance:new a.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,r.u_pitch),u_rotate_symbol:new a.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,r.u_fade_change),u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new a.Uniform1i(d,r.u_is_text),u_pitch_with_map:new a.Uniform1i(d,r.u_pitch_with_map),u_texsize:new a.Uniform2f(d,r.u_texsize),u_texsize_icon:new a.Uniform2f(d,r.u_texsize_icon),u_texture:new a.Uniform1i(d,r.u_texture),u_texture_icon:new a.Uniform1i(d,r.u_texture_icon),u_gamma_scale:new a.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,r.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(d,r.u_is_halo)}),background:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_opacity:new a.Uniform1f(d,r.u_opacity),u_color:new a.UniformColor(d,r.u_color)}),backgroundPattern:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_opacity:new a.Uniform1f(d,r.u_opacity),u_image:new a.Uniform1i(d,r.u_image),u_pattern_tl_a:new a.Uniform2f(d,r.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(d,r.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(d,r.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(d,r.u_pattern_br_b),u_texsize:new a.Uniform2f(d,r.u_texsize),u_mix:new a.Uniform1f(d,r.u_mix),u_pattern_size_a:new a.Uniform2f(d,r.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(d,r.u_pattern_size_b),u_scale_a:new a.Uniform1f(d,r.u_scale_a),u_scale_b:new a.Uniform1f(d,r.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,r.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(d,r.u_tile_units_to_pixels)}),terrainRaster:co,terrainDepth:co,skybox:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_sun_direction:new a.Uniform3f(d,r.u_sun_direction),u_cubemap:new a.Uniform1i(d,r.u_cubemap),u_opacity:new a.Uniform1f(d,r.u_opacity),u_temporal_offset:new a.Uniform1f(d,r.u_temporal_offset)}),skyboxGradient:(d,r)=>({u_matrix:new a.UniformMatrix4f(d,r.u_matrix),u_color_ramp:new a.Uniform1i(d,r.u_color_ramp),u_center_direction:new a.Uniform3f(d,r.u_center_direction),u_radius:new a.Uniform1f(d,r.u_radius),u_opacity:new a.Uniform1f(d,r.u_opacity),u_temporal_offset:new a.Uniform1f(d,r.u_temporal_offset)}),skyboxCapture:(d,r)=>({u_matrix_3f:new a.UniformMatrix3f(d,r.u_matrix_3f),u_sun_direction:new a.Uniform3f(d,r.u_sun_direction),u_sun_intensity:new a.Uniform1f(d,r.u_sun_intensity),u_color_tint_r:new a.Uniform4f(d,r.u_color_tint_r),u_color_tint_m:new a.Uniform4f(d,r.u_color_tint_m),u_luminance:new a.Uniform1f(d,r.u_luminance)}),globeRaster:(d,r)=>({u_proj_matrix:new a.UniformMatrix4f(d,r.u_proj_matrix),u_globe_matrix:new a.UniformMatrix4f(d,r.u_globe_matrix),u_merc_matrix:new a.UniformMatrix4f(d,r.u_merc_matrix),u_zoom_transition:new a.Uniform1f(d,r.u_zoom_transition),u_merc_center:new a.Uniform2f(d,r.u_merc_center),u_image0:new a.Uniform1i(d,r.u_image0)}),globeAtmosphere:(d,r)=>({u_center:new a.Uniform2f(d,r.u_center),u_radius:new a.Uniform1f(d,r.u_radius),u_screen_size:new a.Uniform2f(d,r.u_screen_size),u_pixel_ratio:new a.Uniform1f(d,r.u_pixel_ratio),u_opacity:new a.Uniform1f(d,r.u_opacity),u_fadeout_range:new a.Uniform1f(d,r.u_fadeout_range),u_start_color:new a.Uniform3f(d,r.u_start_color),u_end_color:new a.Uniform3f(d,r.u_end_color)})};let Ta;function nu(d,r,l,p,g,v,w){const T=d.context,I=T.gl,A=d.useProgram("collisionBox"),z=[];let L=0,F=0;for(let te=0;te<p.length;te++){const K=p[te],J=r.getTile(K),oe=J.getBucket(l);if(!oe)continue;let ye=K.projMatrix;g[0]===0&&g[1]===0||(ye=d.translatePosMatrix(K.projMatrix,J,g,v));const Se=w?oe.textCollisionBox:oe.iconCollisionBox,We=oe.collisionCircleArray;if(We.length>0){const Ne=a.create(),Be=ye;a.mul(Ne,oe.placementInvProjMatrix,d.transform.glCoordMatrix),a.mul(Ne,Ne,oe.placementViewportMatrix),z.push({circleArray:We,circleOffset:F,transform:Be,invTransform:Ne}),L+=We.length/4,F=L}Se&&(d.terrain&&d.terrain.setupElevationDraw(J,A),A.draw(T,I.LINES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,cd(ye,d.transform,J),l.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,null,d.transform.zoom,null,Se.collisionVertexBuffer,Se.collisionVertexBufferExt))}if(!w||!z.length)return;const $=d.useProgram("collisionCircle"),N=new a.StructArrayLayout2f1f2i16;N.resize(4*L),N._trim();let G=0;for(const te of z)for(let K=0;K<te.circleArray.length/4;K++){const J=4*K,oe=te.circleArray[J+0],ye=te.circleArray[J+1],Se=te.circleArray[J+2],We=te.circleArray[J+3];N.emplace(G++,oe,ye,Se,We,0),N.emplace(G++,oe,ye,Se,We,1),N.emplace(G++,oe,ye,Se,We,2),N.emplace(G++,oe,ye,Se,We,3)}(!Ta||Ta.length<2*L)&&(Ta=function(te){const K=2*te,J=new a.StructArrayLayout3ui6;J.resize(K),J._trim();for(let oe=0;oe<K;oe++){const ye=6*oe;J.uint16[ye+0]=4*oe+0,J.uint16[ye+1]=4*oe+1,J.uint16[ye+2]=4*oe+2,J.uint16[ye+3]=4*oe+2,J.uint16[ye+4]=4*oe+3,J.uint16[ye+5]=4*oe+0}return J}(L));const ie=T.createIndexBuffer(Ta,!0),V=T.createVertexBuffer(N,a.collisionCircleLayout.members,!0);for(const te of z){const K={u_matrix:te.transform,u_inv_matrix:te.invTransform,u_camera_to_center_distance:(ee=d.transform).cameraToCenterDistance,u_viewport_size:[ee.width,ee.height]};$.draw(T,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,K,l.id,V,ie,a.SegmentVector.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,d.transform.zoom,null,null,null)}var ee;V.destroy(),ie.destroy()}const kl=a.identity(new Float32Array(16));function pd(d,r,l,p,g,v){const{horizontalAlign:w,verticalAlign:T}=a.getAnchorAlignment(d),I=-(w-.5)*r,A=-(T-.5)*l,z=a.evaluateVariableOffset(d,p);return new a.pointGeometry((I/g+z[0])*v,(A/g+z[1])*v)}function nm(d,r,l,p,g,v,w,T,I,A,z,L){const F=d.text.placedSymbolArray,$=d.text.dynamicLayoutVertexArray,N=d.icon.dynamicLayoutVertexArray,G={},ie=T.projMatrix,V=v.elevation,ee=V?V.getAtTileOffsetFunc(T,L):te=>[0,0,0];$.clear();for(let te=0;te<F.length;te++){const K=F.get(te),J=d.allowVerticalPlacement&&!K.placedOrientation,oe=K.hidden||!K.crossTileID||J?null:p[K.crossTileID];if(oe){const ye=new a.pointGeometry(K.tileAnchorX,K.tileAnchorY),Se=ee(ye),We=rn(ye,l?ie:w,Se[2]),Ne=bi(v.cameraToCenterDistance,We.signedDistanceFromCamera);let Be=g.evaluateSizeForFeature(d.textSizeData,A,K)*Ne/a.ONE_EM;l&&(Be*=d.tilePixelRatio/I);const{width:ke,height:be,anchor:Oe,textOffset:Pe,textScale:ct}=oe,_t=pd(Oe,ke,be,Pe,ct,Be),kt=l?rn(ye.add(_t),w,Se[2]).point:We.point.add(r?_t.rotate(-v.angle):_t),qe=d.allowVerticalPlacement&&K.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let dt=0;dt<K.numGlyphs;dt++)a.addDynamicAttributes($,kt,qe);z&&K.associatedIconIndex>=0&&(G[K.associatedIconIndex]={shiftedAnchor:kt,angle:qe})}else ci(K.numGlyphs,$)}if(z){N.clear();const te=d.icon.placedSymbolArray;for(let K=0;K<te.length;K++){const J=te.get(K);if(J.hidden)ci(J.numGlyphs,N);else{const oe=G[K];if(oe)for(let ye=0;ye<J.numGlyphs;ye++)a.addDynamicAttributes(N,oe.shiftedAnchor,oe.angle);else ci(J.numGlyphs,N)}}d.icon.dynamicLayoutVertexBuffer.updateData(N)}d.text.dynamicLayoutVertexBuffer.updateData($)}function im(d,r,l){return l.iconsInText&&r?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function Ml(d,r,l,p,g,v,w,T,I,A,z,L){const F=d.context,$=F.gl,N=d.transform,G=N.projection.createTileTransform(N,N.worldSize),ie=T==="map",V=I==="map",ee=ie&&l.layout.get("symbol-placement")!=="point",te=ie&&!V&&!ee,K=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let J=!1;const oe=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),ye=[a.mercatorXfromLng(N.center.lng),a.mercatorYfromLat(N.center.lat)],Se=l.layout.get("text-variable-anchor"),We=N.projection.name==="globe",Ne=We?a.globeToMercatorTransition(N.zoom):0,Be=[],ke=[];d.terrain&&V&&ke.push("PITCH_WITH_MAP_TERRAIN"),We&&ke.push("PROJECTION_GLOBE_VIEW"),ee&&ke.push("PROJECTED_POS_ON_VIEWPORT");for(const be of p){const Oe=r.getTile(be),Pe=Oe.getBucket(l);if(!Pe||Pe.projection!==N.projection.name)continue;const ct=g?Pe.text:Pe.icon;if(!ct||Pe.fullyClipped||!ct.segments.get().length)continue;const _t=ct.programConfigurations.get(l.id),kt=g||Pe.sdfIcons,qe=g?Pe.textSizeData:Pe.iconSizeData,dt=V||N.pitch!==0,xt=d.useProgram(im(kt,g,Pe),_t,ke),Yt=a.evaluateSizeForZoom(qe,N.zoom),nr=[be.canonical.x,be.canonical.y,1<<be.canonical.z];let vt,zt,pr,Ur,Tn=[0,0],Yn=null;if(g){if(zt=Oe.glyphAtlasTexture,pr=$.LINEAR,vt=Oe.glyphAtlasTexture.size,Pe.iconsInText){Tn=Oe.imageAtlasTexture.size,Yn=Oe.imageAtlasTexture;const Kr=qe.kind==="composite"||qe.kind==="camera";Ur=dt||d.options.rotating||d.options.zooming||Kr?$.LINEAR:$.NEAREST}}else{const Kr=l.layout.get("icon-size").constantOr(0)!==1||Pe.iconsNeedLinear;zt=Oe.imageAtlasTexture,pr=kt||d.options.rotating||d.options.zooming||Kr||dt?$.LINEAR:$.NEAREST,vt=Oe.imageAtlasTexture.size}const pi=d.transform.calculatePixelsToTileUnitsMatrix(Oe),Ft=no(be.projMatrix,Oe.tileID.canonical,V,ie,d.transform,pi),wt=d.terrain&&V&&ee?a.invert(new Float32Array(16),Ft):kl,Ot=Ui(be.projMatrix,Oe.tileID.canonical,V,ie,d.transform,pi),Tr=Se&&Pe.hasTextData(),Ln=l.layout.get("icon-text-fit")!=="none"&&Tr&&Pe.hasIconData();if(ee){const Kr=N.elevation,Bo=Kr?Kr.getAtTileOffsetFunc(be,G):_o=>[0,0,0];Kh(Pe,be.projMatrix,d,g,Ft,Ot,V,A,Bo,be)}const cr=d.translatePosMatrix(be.projMatrix,Oe,v,w),On=ee||g&&Se||Ln?kl:Ft,Fa=d.translatePosMatrix(Ot,Oe,v,w,!0),Sn=kt&&l.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ro;const it=G.createInversionMatrix(be.toUnwrapped());Ro=kt?Pe.iconsInText?ba(qe.kind,Yt,te,V,d,cr,On,Fa,vt,Tn,nr,Ne,it,ye):wa(qe.kind,Yt,te,V,d,cr,On,Fa,g,vt,!0,nr,Ne,it,ye):El(qe.kind,Yt,te,V,d,cr,On,Fa,g,vt,nr,Ne,it,ye);const pt={program:xt,buffers:ct,uniformValues:Ro,atlasTexture:zt,atlasTextureIcon:Yn,atlasInterpolation:pr,atlasInterpolationIcon:Ur,isSDF:kt,hasHalo:Sn,tile:Oe,labelPlaneMatrixInv:wt};if(K&&Pe.canOverlap){J=!0;const Kr=ct.segments.get();for(const Bo of Kr)Be.push({segments:new a.SegmentVector([Bo]),sortKey:Bo.sortKey,state:pt})}else Be.push({segments:ct.segments,sortKey:0,state:pt})}J&&Be.sort((be,Oe)=>be.sortKey-Oe.sortKey);for(const be of Be){const Oe=be.state;if(d.terrain&&d.terrain.setupElevationDraw(Oe.tile,Oe.program,{useDepthForOcclusion:!We,labelPlaneMatrixInv:Oe.labelPlaneMatrixInv}),F.activeTexture.set($.TEXTURE0),Oe.atlasTexture.bind(Oe.atlasInterpolation,$.CLAMP_TO_EDGE),Oe.atlasTextureIcon&&(F.activeTexture.set($.TEXTURE1),Oe.atlasTextureIcon&&Oe.atlasTextureIcon.bind(Oe.atlasInterpolationIcon,$.CLAMP_TO_EDGE)),Oe.isSDF){const Pe=Oe.uniformValues;Oe.hasHalo&&(Pe.u_is_halo=1,Il(Oe.buffers,be.segments,l,d,Oe.program,oe,z,L,Pe)),Pe.u_is_halo=0}Il(Oe.buffers,be.segments,l,d,Oe.program,oe,z,L,Oe.uniformValues)}}function Il(d,r,l,p,g,v,w,T,I){const A=p.context;g.draw(A,A.gl.TRIANGLES,v,w,T,a.CullFaceMode.disabled,I,l.id,d.layoutVertexBuffer,d.indexBuffer,r,l.paint,p.transform.zoom,d.programConfigurations.get(l.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Al(d,r,l,p,g,v,w){const T=d.context.gl,I=l.paint.get("fill-pattern"),A=I&&I.constantOr(1),z=l.getCrossfadeParameters();let L,F,$,N,G;w?(F=A&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=T.LINES):(F=A?"fillPattern":"fill",L=T.TRIANGLES);for(const ie of p){const V=r.getTile(ie);if(A&&!V.patternsLoaded())continue;const ee=V.getBucket(l);if(!ee)continue;d.prepareDrawTile(ie);const te=ee.programConfigurations.get(l.id),K=d.useProgram(F,te);A&&(d.context.activeTexture.set(T.TEXTURE0),V.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),te.updatePaintBuffers(z));const J=I.constantOr(null);if(J&&V.imageAtlas){const ye=V.imageAtlas,Se=ye.patternPositions[J.to.toString()],We=ye.patternPositions[J.from.toString()];Se&&We&&te.setConstantPatternPositions(Se,We)}const oe=d.translatePosMatrix(ie.projMatrix,V,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(w){N=ee.indexBuffer2,G=ee.segments2;const ye=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[T.drawingBufferWidth,T.drawingBufferHeight];$=F==="fillOutlinePattern"&&A?ld(oe,d,z,V,ye):tm(oe,ye)}else N=ee.indexBuffer,G=ee.segments,$=A?eu(oe,d,z,V):ad(oe);d.prepareDrawProgram(d.context,K,ie.toUnwrapped()),K.draw(d.context,L,g,d.stencilModeForClipping(ie),v,a.CullFaceMode.disabled,$,l.id,ee.layoutVertexBuffer,N,G,l.paint,d.transform.zoom,te)}}function Sa(d,r,l,p,g,v,w){const T=d.context,I=T.gl,A=l.paint.get("fill-extrusion-pattern"),z=A.constantOr(1),L=l.getCrossfadeParameters(),F=l.paint.get("fill-extrusion-opacity");for(const $ of p){const N=r.getTile($),G=N.getBucket(l);if(!G)continue;const ie=G.programConfigurations.get(l.id),V=d.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ie);if(d.terrain){const oe=d.terrain;if(!G.enableTerrain)continue;if(oe.setupElevationDraw(N,V,{useMeterToDem:!0}),fd(T,r,$,G,l,oe),!G.centroidVertexBuffer){const ye=V.attributes.a_centroid_pos;ye!==void 0&&I.vertexAttrib2f(ye,0,0)}}z&&(d.context.activeTexture.set(I.TEXTURE0),N.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ie.updatePaintBuffers(L));const ee=A.constantOr(null);if(ee&&N.imageAtlas){const oe=N.imageAtlas,ye=oe.patternPositions[ee.to.toString()],Se=oe.patternPositions[ee.from.toString()];ye&&Se&&ie.setConstantPatternPositions(ye,Se)}const te=d.translatePosMatrix($.projMatrix,N,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),K=l.paint.get("fill-extrusion-vertical-gradient"),J=z?Qc(te,d,K,F,$,L,N):sd(te,d,K,F);d.prepareDrawProgram(T,V,$.toUnwrapped()),V.draw(T,T.gl.TRIANGLES,g,v,w,a.CullFaceMode.backCCW,J,l.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,l.paint,d.transform.zoom,ie,d.terrain?G.centroidVertexBuffer:null)}}function fd(d,r,l,p,g,v){const w=[V=>{let ee=V.canonical.x-1,te=V.wrap;return ee<0&&(ee=(1<<V.canonical.z)-1,te--),new a.OverscaledTileID(V.overscaledZ,te,V.canonical.z,ee,V.canonical.y)},V=>{let ee=V.canonical.x+1,te=V.wrap;return ee===1<<V.canonical.z&&(ee=0,te++),new a.OverscaledTileID(V.overscaledZ,te,V.canonical.z,ee,V.canonical.y)},V=>new a.OverscaledTileID(V.overscaledZ,V.wrap,V.canonical.z,V.canonical.x,(V.canonical.y===0?1<<V.canonical.z:V.canonical.y)-1),V=>new a.OverscaledTileID(V.overscaledZ,V.wrap,V.canonical.z,V.canonical.x,V.canonical.y===(1<<V.canonical.z)-1?0:V.canonical.y+1)],T=V=>{const ee=r.getSource().maxzoom,te=ye=>{const Se=r.getTileByID(ye);if(Se&&Se.hasData())return Se.getBucket(g)};let K,J,oe;return(V.overscaledZ===V.canonical.z||V.overscaledZ>=ee)&&(K=te(V.key)),V.overscaledZ>=ee&&(J=te(V.calculateScaledKey(V.overscaledZ+1))),V.overscaledZ>ee&&(oe=te(V.calculateScaledKey(V.overscaledZ-1))),K||J||oe},I=[0,0,0],A=(V,ee)=>(I[0]=Math.min(V.min.y,ee.min.y),I[1]=Math.max(V.max.y,ee.max.y),I[2]=a.EXTENT-ee.min.x>V.max.x?ee.min.x-a.EXTENT:V.max.x,I),z=(V,ee)=>(I[0]=Math.min(V.min.x,ee.min.x),I[1]=Math.max(V.max.x,ee.max.x),I[2]=a.EXTENT-ee.min.y>V.max.y?ee.min.y-a.EXTENT:V.max.y,I),L=[(V,ee)=>A(V,ee),(V,ee)=>A(ee,V),(V,ee)=>z(V,ee),(V,ee)=>z(ee,V)],F=new a.pointGeometry(0,0);let $,N,G;const ie=(V,ee,te,K,J)=>{const oe=[[K?te:V,K?V:te,0],[K?te:ee,K?ee:te,0]],ye=J<0?a.EXTENT+J:J,Se=[K?ye:(V+ee)/2,K?(V+ee)/2:ye,0];return te===0&&J<0||te!==0&&J>0?v.getForTilePoints(G,[Se],!0,N):oe.push(Se),v.getForTilePoints(l,oe,!0,$),Math.max(oe[0][2],oe[1][2],Se[2])/v.exaggeration()};for(let V=0;V<4;V++){const ee=p.borders[V];if(ee.length===0&&(p.borderDone[V]=!0),p.borderDone[V])continue;const te=G=w[V](l),K=T(te);if(!K||!K.enableTerrain||(N=v.findDEMTileFor(te),!N||!N.dem))continue;if(!$){const Se=v.findDEMTileFor(l);if(!Se||!Se.dem)return;$=Se}const J=(V<2?1:5)-V,oe=K.borders[J];let ye=0;for(let Se=0;Se<ee.length;Se++){const We=p.featuresOnBorder[ee[Se]],Ne=We.borders[V];let Be;for(;ye<oe.length&&(Be=K.featuresOnBorder[oe[ye]],!(Be.borders[J][1]>Ne[0]+3));)K.borderDone[J]||K.encodeCentroid(void 0,Be,!1),ye++;if(Be&&ye<oe.length){const ke=ye;let be=0;for(;!(Be.borders[J][0]>Ne[1]-3)&&(be++,++ye!==oe.length);)Be=K.featuresOnBorder[oe[ye]];if(Be=K.featuresOnBorder[oe[ke]],We.intersectsCount()>1||Be.intersectsCount()>1||be!==1){be!==1&&(ye=ke),p.encodeCentroid(void 0,We,!1),K.borderDone[J]||K.encodeCentroid(void 0,Be,!1);continue}const Oe=L[V](We,Be),Pe=V%2?a.EXTENT-1:0;F.x=ie(Oe[0],Math.min(a.EXTENT-1,Oe[1]),Pe,V<2,Oe[2]),F.y=0,p.encodeCentroid(F,We,!1),K.borderDone[J]||K.encodeCentroid(F,Be,!1)}else p.encodeCentroid(void 0,We,!1)}p.borderDone[V]=p.needsCentroidUpdate=!0,K.borderDone[J]||(K.borderDone[J]=K.needsCentroidUpdate=!0)}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(d)}const md=new a.Color(1,0,0,1),om=new a.Color(0,1,0,1),Ea=new a.Color(0,0,1,1),Ca=new a.Color(1,0,1,1),_d=new a.Color(0,1,1,1);function bn(d,r,l,p){Oo(d,0,r+l/2,d.transform.width,l,p)}function zl(d,r,l,p){Oo(d,r-l/2,0,l,d.transform.height,p)}function Oo(d,r,l,p,g,v){const w=d.context,T=w.gl;T.enable(T.SCISSOR_TEST),T.scissor(r*a.exported.devicePixelRatio,l*a.exported.devicePixelRatio,p*a.exported.devicePixelRatio,g*a.exported.devicePixelRatio),w.clear({color:v}),T.disable(T.SCISSOR_TEST)}function Pl(d,r,l){const p=d.context,g=p.gl,v=l.projMatrix,w=d.useProgram("debug"),T=r.getTileByID(l.key);d.terrain&&d.terrain.setupElevationDraw(T,w);const I=a.DepthMode.disabled,A=a.StencilMode.disabled,z=d.colorModeForRenderPass(),L="$debug";p.activeTexture.set(g.TEXTURE0),d.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),T._makeDebugTileBoundsBuffers(d.context,d.transform.projection);const F=T._tileDebugBuffer||d.debugBuffer,$=T._tileDebugIndexBuffer||d.debugIndexBuffer,N=T._tileDebugSegments||d.debugSegments;w.draw(p,g.LINE_STRIP,I,A,z,a.CullFaceMode.disabled,ru(v,a.Color.red),L,F,$,N);const G=T.latestRawTileData,ie=Math.floor((G&&G.byteLength||0)/1024),V=r.getTile(l).tileSize,ee=512/Math.min(V,512)*(l.overscaledZ/d.transform.zoom)*.5;let te=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(te+=` => ${l.overscaledZ}`),function(K,J){K.initDebugOverlayCanvas();const oe=K.debugOverlayCanvas,ye=K.context.gl,Se=K.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,oe.width,oe.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(J,5,5),Se.strokeText(J,5,5),K.debugOverlayTexture.update(oe),K.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(d,`${te} ${ie}kb`),w.draw(p,g.TRIANGLES,I,A,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,ru(v,a.Color.transparent,ee),L,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}const iu=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ou}=iu;function ui(d,r,l,p){d.emplaceBack(r,l,p)}class Dl{constructor(r){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,ui(this.vertexArray,-1,-1,1),ui(this.vertexArray,1,-1,1),ui(this.vertexArray,-1,1,1),ui(this.vertexArray,1,1,1),ui(this.vertexArray,-1,-1,-1),ui(this.vertexArray,1,-1,-1),ui(this.vertexArray,-1,1,-1),ui(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,ou),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function ho(d,r,l,p,g,v){const w=d.gl,T=r.paint.get("sky-atmosphere-color"),I=r.paint.get("sky-atmosphere-halo-color"),A=r.paint.get("sky-atmosphere-sun-intensity"),z=((L,F,$,N,G)=>({u_matrix_3f:L,u_sun_direction:F,u_sun_intensity:$,u_color_tint_r:[N.r,N.g,N.b,N.a],u_color_tint_m:[G.r,G.g,G.b,G.a],u_luminance:5e-5}))(a.fromMat4([],p),g,A,T,I);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+v,r.skyboxTexture,0),l.draw(d,w.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,z,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const ka={symbol:function(d,r,l,p,g){if(d.renderPass!=="translucent")return;const v=a.StencilMode.disabled,w=d.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(T,I,A,z,L,F,$){const N=I.transform,G=L==="map",ie=F==="map",V=N.projection.createTileTransform(N,N.worldSize);for(const ee of T){const te=z.getTile(ee),K=te.getBucket(A);if(!K||K.projection!==N.projection.name||!K.text||!K.text.segments.get().length)continue;const J=a.evaluateSizeForZoom(K.textSizeData,N.zoom),oe=I.transform.calculatePixelsToTileUnitsMatrix(te),ye=no(ee.projMatrix,te.tileID.canonical,ie,G,I.transform,oe),Se=A.layout.get("icon-text-fit")!=="none"&&K.hasIconData();if(J){const We=Math.pow(2,N.zoom-te.tileID.overscaledZ);nm(K,G,ie,$,a.symbolSize,N,ye,ee,We,J,Se,V)}}}(p,d,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),g),l.paint.get("icon-opacity").constantOr(1)!==0&&Ml(d,r,l,p,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),v,w),l.paint.get("text-opacity").constantOr(1)!==0&&Ml(d,r,l,p,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),v,w),r.map.showCollisionBoxes&&(nu(d,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),nu(d,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(d,r,l,p){if(d.renderPass!=="translucent")return;const g=l.paint.get("circle-opacity"),v=l.paint.get("circle-stroke-width"),w=l.paint.get("circle-stroke-opacity"),T=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(g.constantOr(1)===0&&(v.constantOr(1)===0||w.constantOr(1)===0))return;const I=d.context,A=I.gl,z=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),L=a.StencilMode.disabled,F=d.colorModeForRenderPass(),$=[];for(let G=0;G<p.length;G++){const ie=p[G],V=r.getTile(ie),ee=V.getBucket(l);if(!ee)continue;const te=ee.programConfigurations.get(l.id),K=tu(l),J={programConfiguration:te,program:d.useProgram("circle",te,K),layoutVertexBuffer:ee.layoutVertexBuffer,indexBuffer:ee.indexBuffer,uniformValues:rm(d,ie,V,l),tile:V};if(T){const oe=ee.segments.get();for(const ye of oe)$.push({segments:new a.SegmentVector([ye]),sortKey:ye.sortKey,state:J})}else $.push({segments:ee.segments,sortKey:0,state:J})}T&&$.sort((G,ie)=>G.sortKey-ie.sortKey);const N={useDepthForOcclusion:d.transform.projection.name!=="globe"};for(const G of $){const{programConfiguration:ie,program:V,layoutVertexBuffer:ee,indexBuffer:te,uniformValues:K,tile:J}=G.state,oe=G.segments;d.terrain&&d.terrain.setupElevationDraw(J,V,N),d.prepareDrawProgram(I,V,J.tileID.toUnwrapped()),V.draw(I,A.TRIANGLES,z,L,F,a.CullFaceMode.disabled,K,l.id,ee,te,oe,l.paint,d.transform.zoom,ie)}},heatmap:function(d,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const g=d.context,v=g.gl,w=a.StencilMode.disabled,T=new a.ColorMode([v.ONE,v.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(I,A,z){const L=I.gl;I.activeTexture.set(L.TEXTURE1),I.viewport.set([0,0,A.width/4,A.height/4]);let F=z.heatmapFbo;if(F)L.bindTexture(L.TEXTURE_2D,F.colorAttachment.get()),I.bindFramebuffer.set(F.framebuffer);else{const $=L.createTexture();L.bindTexture(L.TEXTURE_2D,$),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR),F=z.heatmapFbo=I.createFramebuffer(A.width/4,A.height/4,!1),function(N,G,ie,V){const ee=N.gl;ee.texImage2D(ee.TEXTURE_2D,0,ee.RGBA,G.width/4,G.height/4,0,ee.RGBA,N.extRenderToTextureHalfFloat?N.extTextureHalfFloat.HALF_FLOAT_OES:ee.UNSIGNED_BYTE,null),V.colorAttachment.set(ie)}(I,A,$,F)}})(g,d,l),g.clear({color:a.Color.transparent});for(let I=0;I<p.length;I++){const A=p[I];if(r.hasRenderableParent(A))continue;const z=r.getTile(A),L=z.getBucket(l);if(!L)continue;const F=L.programConfigurations.get(l.id),$=d.useProgram("heatmap",F),{zoom:N}=d.transform;d.terrain&&d.terrain.setupElevationDraw(z,$),d.prepareDrawProgram(g,$,A.toUnwrapped()),$.draw(g,v.TRIANGLES,a.DepthMode.disabled,w,T,a.CullFaceMode.disabled,ud(A.projMatrix,z,N,l.paint.get("heatmap-intensity")),l.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,l.paint,d.transform.zoom,F)}g.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(g,v){const w=g.context,T=w.gl,I=v.heatmapFbo;if(!I)return;w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,I.colorAttachment.get()),w.activeTexture.set(T.TEXTURE1);let A=v.colorRampTexture;A||(A=v.colorRampTexture=new a.Texture(w,v.colorRamp,T.RGBA)),A.bind(T.LINEAR,T.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(w,T.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,((z,L,F,$)=>({u_image:0,u_color_ramp:1,u_opacity:L.paint.get("heatmap-opacity")}))(0,v),v.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,v.paint,g.transform.zoom)}(d,l))},line:function(d,r,l,p){if(d.renderPass!=="translucent")return;const g=l.paint.get("line-opacity"),v=l.paint.get("line-width");if(g.constantOr(1)===0||v.constantOr(1)===0)return;const w=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),T=d.colorModeForRenderPass(),I=l.paint.get("line-dasharray"),A=I.constantOr(1),z=l.layout.get("line-cap"),L=l.paint.get("line-pattern"),F=L.constantOr(1),$=l.paint.get("line-gradient"),N=l.getCrossfadeParameters(),G=F?"linePattern":"line",ie=d.context,V=ie.gl,ee=(K=>{const J=[];xa(K)&&J.push("RENDER_LINE_DASH"),K.paint.get("line-gradient")&&J.push("RENDER_LINE_GRADIENT");const oe=K.paint.get("line-pattern").constantOr(1),ye=K.paint.get("line-opacity").constantOr(1)!==1;return!oe&&ye&&J.push("RENDER_LINE_ALPHA_DISCARD"),J})(l);let te=ee.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(te=!1);for(const K of p){const J=r.getTile(K);if(F&&!J.patternsLoaded())continue;const oe=J.getBucket(l);if(!oe)continue;d.prepareDrawTile(K);const ye=oe.programConfigurations.get(l.id),Se=d.useProgram(G,ye,ee),We=L.constantOr(null);if(We&&J.imageAtlas){const Pe=J.imageAtlas,ct=Pe.patternPositions[We.to.toString()],_t=Pe.patternPositions[We.from.toString()];ct&&_t&&ye.setConstantPatternPositions(ct,_t)}const Ne=I.constantOr(null),Be=z.constantOr(null);if(!F&&Ne&&Be&&J.lineAtlas){const Pe=J.lineAtlas,ct=Pe.getDash(Ne.to,Be),_t=Pe.getDash(Ne.from,Be);ct&&_t&&ye.setConstantPatternPositions(ct,_t)}const ke=d.terrain?K.projMatrix:null,be=F?Lo(d,J,l,N,ke):hd(d,J,l,N,ke,oe.lineClipsArray.length);if($){const Pe=oe.gradients[l.id];let ct=Pe.texture;if(l.gradientVersion!==Pe.version){let _t=256;if(l.stepInterpolant){const kt=r.getSource().maxzoom,qe=K.canonical.z===kt?Math.ceil(1<<d.transform.maxZoom-K.canonical.z):1;_t=a.clamp(a.nextPowerOfTwo(oe.maxLineLength/a.EXTENT*1024*qe),256,ie.maxTextureSize)}Pe.gradient=a.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:_t,image:Pe.gradient||void 0,clips:oe.lineClipsArray}),Pe.texture?Pe.texture.update(Pe.gradient):Pe.texture=new a.Texture(ie,Pe.gradient,V.RGBA),Pe.version=l.gradientVersion,ct=Pe.texture}ie.activeTexture.set(V.TEXTURE1),ct.bind(l.stepInterpolant?V.NEAREST:V.LINEAR,V.CLAMP_TO_EDGE)}A&&(ie.activeTexture.set(V.TEXTURE0),J.lineAtlasTexture.bind(V.LINEAR,V.REPEAT),ye.updatePaintBuffers(N)),F&&(ie.activeTexture.set(V.TEXTURE0),J.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),ye.updatePaintBuffers(N)),d.prepareDrawProgram(ie,Se,K.toUnwrapped());const Oe=Pe=>{Se.draw(ie,V.TRIANGLES,w,Pe,T,a.CullFaceMode.disabled,be,l.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,l.paint,d.transform.zoom,ye,oe.layoutVertexBuffer2)};if(te){const Pe=d.stencilModeForClipping(K).ref;Pe===0&&d.terrain&&ie.clear({stencil:0});const ct={func:V.EQUAL,mask:255};be.u_alpha_discard_threshold=.8,Oe(new a.StencilMode(ct,Pe,255,V.KEEP,V.KEEP,V.INVERT)),be.u_alpha_discard_threshold=0,Oe(new a.StencilMode(ct,Pe,255,V.KEEP,V.KEEP,V.KEEP))}else Oe(d.stencilModeForClipping(K))}te&&(d.resetStencilClippingMasks(),d.terrain&&ie.clear({stencil:0}))},fill:function(d,r,l,p){const g=l.paint.get("fill-color"),v=l.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const w=d.colorModeForRenderPass(),T=l.paint.get("fill-pattern"),I=d.opaquePassEnabledForLayer()&&!T.constantOr(1)&&g.constantOr(a.Color.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===I){const A=d.depthModeForSublayer(1,d.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Al(d,r,l,p,A,w,!1)}if(d.renderPass==="translucent"&&l.paint.get("fill-antialias")){const A=d.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Al(d,r,l,p,A,w,!0)}},"fill-extrusion":function(d,r,l,p){const g=l.paint.get("fill-extrusion-opacity");if(g!==0&&d.renderPass==="translucent"){const v=new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D);if(g!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Sa(d,r,l,p,v,a.StencilMode.disabled,a.ColorMode.disabled),Sa(d,r,l,p,v,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const w=d.colorModeForRenderPass();Sa(d,r,l,p,v,a.StencilMode.disabled,w)}}},hillshade:function(d,r,l,p){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const g=d.context,v=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),w=d.colorModeForRenderPass(),T=d.terrain&&d.terrain.renderingToTexture,[I,A]=d.renderPass!=="translucent"||T?[{},p]:d.stencilConfigForOverlap(p);for(const z of A){const L=r.getTile(z);if(L.needsHillshadePrepare&&d.renderPass==="offscreen")_a(d,L,l,v,a.StencilMode.disabled,w);else if(d.renderPass==="translucent"){const F=T&&d.terrain?d.terrain.stencilModeForRTTOverlap(z):I[z.overscaledZ];xl(d,z,L,l,v,F,w)}}g.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,r,l,p,g,v){if(d.renderPass!=="translucent"||l.paint.get("raster-opacity")===0||!p.length)return;const w=d.context,T=w.gl,I=r.getSource(),A=d.useProgram("raster"),z=d.colorModeForRenderPass(),L=d.terrain&&d.terrain.renderingToTexture,[F,$]=I instanceof wi||L?[{},p]:d.stencilConfigForOverlap(p),N=$[$.length-1].overscaledZ,G=!d.options.moving;for(const ie of $){const V=L?a.DepthMode.disabled:d.depthModeForSublayer(ie.overscaledZ-N,l.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,T.LESS),ee=ie.toUnwrapped(),te=r.getTile(ie);if(L&&(!te||!te.hasData()))continue;const K=L?ie.projMatrix:d.transform.calculateProjMatrix(ee,G),J=d.terrain&&L?d.terrain.stencilModeForRTTOverlap(ie):F[ie.overscaledZ],oe=v?0:l.paint.get("raster-fade-duration");te.registerFadeDuration(oe);const ye=r.findLoadedParent(ie,0),Se=nd(te,ye,r,d.transform,oe);let We,Ne;d.terrain&&d.terrain.prepareDrawTile(ie);const Be=l.paint.get("raster-resampling")==="nearest"?T.NEAREST:T.LINEAR;w.activeTexture.set(T.TEXTURE0),te.texture.bind(Be,T.CLAMP_TO_EDGE),w.activeTexture.set(T.TEXTURE1),ye?(ye.texture.bind(Be,T.CLAMP_TO_EDGE),We=Math.pow(2,ye.tileID.overscaledZ-te.tileID.overscaledZ),Ne=[te.tileID.canonical.x*We%1,te.tileID.canonical.y*We%1]):te.texture.bind(Be,T.CLAMP_TO_EDGE);const ke=Tl(K,Ne||[0,0],We||1,Se,l,I instanceof wi?I.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(w,A,ee),I instanceof wi)A.draw(w,T.TRIANGLES,V,a.StencilMode.disabled,z,a.CullFaceMode.disabled,ke,l.id,I.boundsBuffer,d.quadTriangleIndexBuffer,I.boundsSegments);else{const{tileBoundsBuffer:be,tileBoundsIndexBuffer:Oe,tileBoundsSegments:Pe}=d.getTileBoundsBuffers(te);A.draw(w,T.TRIANGLES,V,J,z,a.CullFaceMode.disabled,ke,l.id,be,Oe,Pe)}}d.resetStencilClippingMasks()},background:function(d,r,l,p){const g=l.paint.get("background-color"),v=l.paint.get("background-opacity");if(v===0)return;const w=d.context,T=w.gl,I=d.transform,A=I.tileSize,z=l.paint.get("background-pattern");if(d.isPatternMissing(z))return;const L=!z&&g.a===1&&v===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==L)return;const F=a.StencilMode.disabled,$=d.depthModeForSublayer(0,L==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),N=d.colorModeForRenderPass(),G=d.useProgram(z?"backgroundPattern":"background");let ie,V=p;V||(ie=d.getBackgroundTiles(),V=Object.values(ie).map(te=>te.tileID)),z&&(w.activeTexture.set(T.TEXTURE0),d.imageManager.bind(d.context));const ee=l.getCrossfadeParameters();for(const te of V){const K=te.toUnwrapped(),J=p?te.projMatrix:d.transform.calculateProjMatrix(K);d.prepareDrawTile(te);const oe=r?r.getTile(te):ie?ie[te.key]:new a.Tile(te,A,I.zoom,d),ye=z?Cl(J,v,d,z,{tileID:te,tileSize:A},ee):Xt(J,v,g);d.prepareDrawProgram(w,G,K);const{tileBoundsBuffer:Se,tileBoundsIndexBuffer:We,tileBoundsSegments:Ne}=d.getTileBoundsBuffers(oe);G.draw(w,T.TRIANGLES,$,F,N,a.CullFaceMode.disabled,ye,l.id,Se,We,Ne)}},sky:function(d,r,l){const p=d.transform,g=p.projection.name==="mercator"||p.projection.name==="globe"?1:a.smoothstep(7,8,p.zoom),v=l.paint.get("sky-opacity")*g;if(v===0)return;const w=d.context,T=l.paint.get("sky-type"),I=new a.DepthMode(w.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),A=d.frameCounter/1e3%1;T==="atmosphere"?d.renderPass==="offscreen"?l.needsSkyboxCapture(d)&&(function(z,L,F,$){const N=z.context,G=N.gl;let ie=L.skyboxFbo;if(!ie){ie=L.skyboxFbo=N.createFramebuffer(32,32,!1),L.skyboxGeometry=new Dl(N),L.skyboxTexture=N.gl.createTexture(),G.bindTexture(G.TEXTURE_CUBE_MAP,L.skyboxTexture),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR);for(let K=0;K<6;++K)G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+K,0,G.RGBA,32,32,0,G.RGBA,G.UNSIGNED_BYTE,null)}N.bindFramebuffer.set(ie.framebuffer),N.viewport.set([0,0,32,32]);const V=L.getCenter(z,!0),ee=z.useProgram("skyboxCapture"),te=new Float64Array(16);a.identity(te),a.rotateY(te,te,.5*-Math.PI),ho(N,L,ee,te,V,0),a.identity(te),a.rotateY(te,te,.5*Math.PI),ho(N,L,ee,te,V,1),a.identity(te),a.rotateX(te,te,.5*-Math.PI),ho(N,L,ee,te,V,2),a.identity(te),a.rotateX(te,te,.5*Math.PI),ho(N,L,ee,te,V,3),a.identity(te),ho(N,L,ee,te,V,4),a.identity(te),a.rotateY(te,te,Math.PI),ho(N,L,ee,te,V,5),N.viewport.set([0,0,z.width,z.height])}(d,l),l.markSkyboxValid(d)):d.renderPass==="sky"&&function(z,L,F,$,N){const G=z.context,ie=G.gl,V=z.transform,ee=z.useProgram("skybox");G.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_CUBE_MAP,L.skyboxTexture);const te=((K,J,oe,ye,Se)=>({u_matrix:K,u_sun_direction:J,u_cubemap:0,u_opacity:ye,u_temporal_offset:Se}))(V.skyboxMatrix,L.getCenter(z,!1),0,$,N);z.prepareDrawProgram(G,ee),ee.draw(G,ie.TRIANGLES,F,a.StencilMode.disabled,z.colorModeForRenderPass(),a.CullFaceMode.backCW,te,"skybox",L.skyboxGeometry.vertexBuffer,L.skyboxGeometry.indexBuffer,L.skyboxGeometry.segment)}(d,l,I,v,A):T==="gradient"&&d.renderPass==="sky"&&function(z,L,F,$,N){const G=z.context,ie=G.gl,V=z.transform,ee=z.useProgram("skyboxGradient");L.skyboxGeometry||(L.skyboxGeometry=new Dl(G)),G.activeTexture.set(ie.TEXTURE0);let te=L.colorRampTexture;te||(te=L.colorRampTexture=new a.Texture(G,L.colorRamp,ie.RGBA)),te.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const K=((J,oe,ye,Se,We)=>({u_matrix:J,u_color_ramp:0,u_center_direction:oe,u_radius:a.degToRad(ye),u_opacity:Se,u_temporal_offset:We}))(V.skyboxMatrix,L.getCenter(z,!1),L.paint.get("sky-gradient-radius"),$,N);z.prepareDrawProgram(G,ee),ee.draw(G,ie.TRIANGLES,F,a.StencilMode.disabled,z.colorModeForRenderPass(),a.CullFaceMode.backCW,K,"skyboxGradient",L.skyboxGeometry.vertexBuffer,L.skyboxGeometry.indexBuffer,L.skyboxGeometry.segment)}(d,l,I,v,A)},debug:function(d,r,l){for(let p=0;p<l.length;p++)Pl(d,r,l[p])},custom:function(d,r,l){const p=d.context,g=l.implementation;if(d.transform.projection.unsupportedLayers&&d.transform.projection.unsupportedLayers.includes("custom"))a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(d.renderPass==="offscreen"){const v=g.prerender;v&&(d.setCustomLayerDefaults(),p.setColorMode(d.colorModeForRenderPass()),v.call(g,p.gl,d.transform.customLayerMatrix()),p.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),p.setColorMode(d.colorModeForRenderPass()),p.setStencilMode(a.StencilMode.disabled);const v=g.renderingMode==="3d"?new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,a.DepthMode.ReadOnly);p.setDepthMode(v),g.render(p.gl,d.transform.customLayerMatrix()),p.setDirty(),d.setBaseState(),p.bindFramebuffer.set(null)}}};class gd{constructor(r,l){this.context=new Zn(r),this.transform=l,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fa,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new uo(this,r));const g=this._terrain;this.transform.elevation=p?g:null,g.update(r,this.transform,l)}_updateFog(r){const l=r.fog;if(!l||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,g]=l.getFovAdjustedRange(this.transform._fov);if(p>g)return void(this.transform.fogCullDistSq=null);const v=p+.78*(g-p);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,l){if(this.width=r*a.exported.devicePixelRatio,this.height=l*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const r=this.context,l=new a.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(a.EXTENT,0),l.emplaceBack(0,a.EXTENT),l.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(l,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const p=new a.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(a.EXTENT,0),p.emplaceBack(0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=r.createVertexBuffer(p,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const g=new a.StructArrayLayout2i4;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(-1,1),g.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(g,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const v=new a.StructArrayLayout4i8;v.emplaceBack(0,0,0,0),v.emplaceBack(a.EXTENT,0,a.EXTENT,0),v.emplaceBack(0,a.EXTENT,0,a.EXTENT),v.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(v,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const w=new a.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(w);const T=new a.StructArrayLayout1ui2;for(const A of[0,1,3,2,0])T.emplaceBack(A);this.debugIndexBuffer=r.createIndexBuffer(T),this.emptyTexture=new a.Texture(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA),this.identityMat=a.create();const I=this.context.gl;this.stencilClearMode=new a.StencilMode({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(a.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,l=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,l.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,ki(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let T=!1;for(const I of p)if(this._tileClippingMaskIDs[I.key]===void 0){T=!0;break}if(!T)return}this.currentStencilSource=l.id;const g=this.context,v=g.gl;this.nextStencilID+p.length>256&&this.clearStencil(),g.setColorMode(a.ColorMode.disabled),g.setDepthMode(a.DepthMode.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of p){const I=l.getTile(T),A=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:L,tileBoundsSegments:F}=this.getTileBoundsBuffers(I);w.draw(g,v.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:v.ALWAYS,mask:0},A,255,v.KEEP,v.KEEP,v.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,ki(T.projMatrix),"$clipping",z,L,F)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new a.StencilMode({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new a.StencilMode({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((w,T)=>T.overscaledZ-w.overscaledZ),g=p[p.length-1].overscaledZ,v=p[0].overscaledZ-g+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const w={};for(let T=0;T<v;T++)w[T+g]=new a.StencilMode({func:l.GEQUAL,mask:255},T+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=v,[w,p]}return[{[g]:a.StencilMode.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;if(this._showOverdrawInspector){const l=1/8;return new a.ColorMode([r.CONSTANT_COLOR,r.ONE],new a.Color(l,l,l,0),[!0,!0,!0,!0])}return this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(r,l,p){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new a.DepthMode(p||this.context.gl.LEQUAL,l,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,l){this.style=r,this.options=l,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const p=this.style.order,g=this.style._sourceCaches;for(const A in g){const z=g[A];z.used&&z.prepare(this.context)}const v={},w={},T={};for(const A in g){const z=g[A];v[A]=z.getVisibleCoordinates(),w[A]=v[A].slice().reverse(),T[A]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<p.length;A++)if(this.style._layers[p[A]].is3D()){this.opaquePassCutoff=A;break}if(this.terrain&&(this.terrain.updateTileBinding(T),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const A of p){const z=this.style._layers[A],L=r._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const F=L?w[L.id]:void 0;(z.type==="custom"||z.isSky()||F&&F.length)&&this.renderLayer(this,L,z,F)}this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let I=a.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(I=this.style.fog.properties.get("color")),this.context.clear({color:l.showOverdrawInspector?a.Color.black:I,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[p[this.currentLayer]],z=r._getLayerSourceCache(A);if(A.isSky())continue;const L=z?w[z.id]:void 0;this._renderTileClippingMasks(A,z,L),this.renderLayer(this,z,A,L)}if(this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const A=this.style._layers[p[this.currentLayer]],z=r._getLayerSourceCache(A);A.isSky()&&this.renderLayer(this,z,A,z?w[z.id]:void 0)}for(this.transform.projection.name==="globe"&&function(A){const z=A.context,L=z.gl,F=A.transform,$=new a.DepthMode(L.LEQUAL,a.DepthMode.ReadOnly,[0,1]),N=A.useProgram("globeAtmosphere"),G=F._camera.getWorldToCamera(F.worldSize,1),ie=F._camera.getCameraToClipPerspective(F._fov,F.width/F.height,F._nearZ,F._farZ),V=a.mul([],G,a.calculateGlobeMatrix(F,F.worldSize)),ee=a.mul([],F.labelPlaneMatrix,ie),te=a.transformMat4([],[0,0,0],V),K=a.add([],te,[F.worldSize/Math.PI/2,0,0]),J=a.transformMat4([],te,ee),oe=a.transformMat4([],K,ee),ye=a.length(a.sub([],oe,J)),Se=1-a.globeToMercatorTransition(F.zoom),We={u_center:J,u_radius:ye,u_screen_size:[F.width,F.height],u_pixel_ratio:a.exported.devicePixelRatio,u_opacity:Se,u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};A.prepareDrawProgram(z,N);const Ne=A.globeSharedBuffers;Ne&&N.draw(z,L.TRIANGLES,$,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,We,"skybox",Ne.atmosphereVertexBuffer,Ne.atmosphereIndexBuffer,Ne.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const A=this.style._layers[p[this.currentLayer]],z=r._getLayerSourceCache(A);if(A.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(A)){if(A.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const L=z?(A.type==="symbol"?T:w)[z.id]:void 0;this._renderTileClippingMasks(A,z,z?v[z.id]:void 0),this.renderLayer(this,z,A,L),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let A=null;a.values(this.style._layers).forEach(z=>{const L=r._getLayerSourceCache(z);L&&!z.isHidden(this.transform.zoom)&&(!A||A.getSource().maxzoom<L.getSource().maxzoom)&&(A=L)}),A&&this.options.showTileBoundaries&&ka.debug(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const z=A.transform.padding;bn(A,A.transform.height-(z.top||0),3,md),bn(A,z.bottom||0,3,om),zl(A,z.left||0,3,Ea),zl(A,A.transform.width-(z.right||0),3,Ca);const L=A.transform.centerPoint;(function(F,$,N,G){Oo(F,$-1,N-10,2,20,G),Oo(F,$-10,N-1,20,2,G)})(A,L.x,A.transform.height-L.y,_d)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(r,l,p,g){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||g&&g.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)||ka[p.type](r,l,p,g,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:l.createQueryEXT()}),p.calls++,l.beginQueryEXT(l.TIME_ELAPSED_EXT,p.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}queryGpuTimers(r){const l={};for(const p in r){const g=r[p],v=this.context.extTimerQuery,w=v.getQueryObjectEXT(g.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(g.query),l[p]=w}return l}translatePosMatrix(r,l,p,g,v){if(!p[0]&&!p[1])return r;const w=v?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(w){const A=Math.sin(w),z=Math.cos(w);p=[p[0]*z-p[1]*A,p[0]*A+p[1]*z]}const T=[v?p[0]:wr(l,p[0],this.transform.zoom),v?p[1]:wr(l,p[1],this.transform.zoom),0],I=new Float32Array(16);return a.translate(I,r,T),I}saveTileTexture(r){const l=this._tileTextures[r.size[0]];l?l.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const l=this.imageManager.getPattern(r.from.toString()),p=this.imageManager.getPattern(r.to.toString());return!l||!p}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,l=this.style&&this.style.fog,p=[];return this.terrain&&!this.terrain.renderingToTexture&&p.push("TERRAIN"),l&&!r&&l.getOpacity(this.transform.pitch)!==0&&p.push("FOG"),r&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}useProgram(r,l,p){this.cache=this.cache||{};const g=p||[],v=this.currentGlobalDefines().concat(g),w=ya.cacheKey(r,v,l);return this.cache[w]||(this.cache[w]=new ya(this.context,r,Jc[r],l,dd[r],v)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(r){this.terrain&&this.terrain.prepareDrawTile(r)}prepareDrawProgram(r,l,p){if(this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const v=g.getOpacity(this.transform.pitch);v!==0&&l.setFogUniformValues(r,((w,T,I,A)=>{const z=T.properties.get("color"),L=w.frameCounter/1e3%1,F=[z.r/z.a,z.g/z.a,z.b/z.a,A];return{u_fog_matrix:I?w.transform.calculateFogTileMatrix(I):w.identityMat,u_fog_range:T.getFovAdjustedRange(w.transform._fov),u_fog_color:F,u_fog_horizon_blend:T.properties.get("horizon-blend"),u_fog_temporal_offset:L}})(this,g,p,v))}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const g of p)l[g.key]=r[g.key]||new a.Tile(g,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}}class Ll{constructor(r=0,l=0,p=0,g=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=g}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=a.number(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=a.number(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=a.number(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=a.number(r.right,l.right,p)),this}getCenter(r,l){const p=a.clamp((this.left+r-this.right)/2,0,r),g=a.clamp((this.top+l-this.bottom)/2,0,l);return new a.pointGeometry(p,g)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Ll(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function po(d,r){const l=a.getColumn(d,3);a.fromQuat(d,r),a.setColumn(d,3,l)}function yd(d,r){a.setColumn(d,3,[r[0],r[1],r[2],1])}function su(d,r){const l=a.identity$1([]);return a.rotateZ$1(l,l,-r),a.rotateX$1(l,l,-d),l}function au(d,r){const l=[d[0],d[1],0],p=[r[0],r[1],0];if(a.length(l)>=1e-15){const w=a.normalize([],l);a.scale$2(p,w,a.dot(p,w)),r[0]=p[0],r[1]=p[1]}const g=a.cross([],r,d);if(a.len(g)<1e-15)return null;const v=Math.atan2(-g[1],g[0]);return su(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),v)}class vd{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){this._position=this._renderWorldCopies?function(l){if(!l)return;const p=Array.isArray(l)?new a.MercatorCoordinate(l[0],l[1],l[2]):l;return p.x=a.wrap(p.x,0,1),p}(r):r}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(r)):0,g=this.position,v=a.MercatorCoordinate.fromLngLat(r,p),w=[v.x-g.x,v.y-g.y,v.z-g.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=au(w,l)}setPitchBearing(r,l){this.orientation=su(a.degToRad(r),a.degToRad(-l))}}class lu{constructor(r,l){this._transform=a.identity([]),this._orientation=a.identity$1([]),l&&(this._orientation=l,po(this._transform,this._orientation)),r&&yd(this._transform,r)}get mercatorPosition(){const r=this.position;return new a.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=a.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){yd(this._transform,r)}get orientation(){return this._orientation}set orientation(r){this._orientation=r,po(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=su(r,l),po(this._transform,this._orientation)}forward(){const r=a.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=a.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=a.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return a.invert(p,this.getWorldToCamera(r,l)),p}getWorldToCameraPosition(r,l,p){const g=this.position;a.scale$2(g,g,-r);const v=new Float64Array(16);return a.fromScaling(v,[p,p,p]),a.translate(v,v,g),v[10]*=l,v}getWorldToCamera(r,l){const p=new Float64Array(16),g=new Float64Array(4),v=this.position;return a.conjugate(g,this._orientation),a.scale$2(v,v,-r),a.fromQuat(p,g),a.translate(p,p,v),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,g){const v=new Float64Array(16);return a.perspective(v,r,l,p,g),v}getDistanceToElevation(r){const l=r===0?0:a.mercatorZfromAltitude(r,this.position[1]),p=this.forward();return(l-this.position[2])/p[2]}clone(){return new lu([...this.position],[...this.orientation])}}function xd(d,r){const l=Rl(d),p=function(v,w,T,I,A){const z=new a.LngLat(T.lng-180*hi,T.lat),L=new a.LngLat(T.lng+180*hi,T.lat),F=v.project(z.lng,z.lat),$=v.project(L.lng,L.lat),N=-Math.atan2($.y-F.y,$.x-F.x),G=a.MercatorCoordinate.fromLngLat(T);G.y=a.clamp(G.y,-.999975,.999975);const ie=G.toLngLat(),V=v.project(ie.lng,ie.lat),ee=a.MercatorCoordinate.fromLngLat(ie);ee.x+=hi;const te=ee.toLngLat(),K=v.project(te.lng,te.lat),J=uu(K.x-V.x,K.y-V.y,N),oe=a.MercatorCoordinate.fromLngLat(ie);oe.y+=hi;const ye=oe.toLngLat(),Se=v.project(ye.lng,ye.lat),We=uu(Se.x-V.x,Se.y-V.y,N),Ne=Math.abs(J.x)/Math.abs(We.y),Be=a.identity([]);a.rotateZ(Be,Be,-N*(1-(A?0:I)));const ke=a.identity([]);return a.scale(ke,ke,[1,1-(1-Ne)*I,1]),ke[4]=-We.x/We.y*I,a.rotateZ(ke,ke,N),a.multiply$1(ke,Be,ke),ke}(d.projection,0,d.center,l,r),g=Ol(d);return a.scale(p,p,[g,g,1]),p}function Ol(d){const r=d.projection,l=Rl(d),p=cu(r,d.center),g=cu(r,a.LngLat.convert(r.center));return Math.pow(2,p*l+(1-l)*g)}function Rl(d){const r=d.projection.range;if(!r)return 0;const l=Math.max(d.width,d.height),p=Math.log(l/1024)/Math.LN2;return a.smoothstep(r[0]+p,r[1]+p,d.zoom)}const hi=1/4e4;function cu(d,r){const l=a.clamp(r.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),p=new a.LngLat(r.lng-180*hi,l),g=new a.LngLat(r.lng+180*hi,l),v=d.project(p.lng,l),w=d.project(g.lng,l),T=a.MercatorCoordinate.fromLngLat(p),I=a.MercatorCoordinate.fromLngLat(g),A=w.x-v.x,z=w.y-v.y,L=I.x-T.x,F=I.y-T.y,$=Math.sqrt((L*L+F*F)/(A*A+z*z));return Math.log($)/Math.LN2}function uu(d,r,l){const p=Math.cos(l),g=Math.sin(l);return{x:d*p-r*g,y:d*g+r*p}}class Ma{constructor(r,l,p,g,v){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p==null?0:p,this._maxPitch=g==null?60:g,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ll,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new lu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const r=new Ma(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.setProjection(this.getProjection()),r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r.tileSize=this.tileSize,r.setMaxBounds(this.getMaxBounds()),r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._cameraZoom=this._cameraZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,r?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(r){this._terrainEnabled()&&this._cameraZoom==null&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),r&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(r){r==null&&(r={name:"mercator"}),this.projectionOptions=r;const l=this.projection?this.getProjection():void 0;return this.projection=a.getProjection(r),!he(l,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;var p;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=(p=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(g,v,w){var T=v[0],I=v[1],A=v[2],z=v[3],L=Math.sin(w),F=Math.cos(w);g[0]=T*F+A*L,g[1]=I*F+z*L,g[2]=T*-L+A*F,g[3]=I*-L+z*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=a.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return r===-1?(this._cameraZoom=null,!1):(this._centerAltitude=r,!0)}_updateCameraOnTerrain(){this._cameraZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize)}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let g=0,v=0;for(let w=0;w<l.length;w++){const T=new a.pointGeometry(l[w][0]*this.width,p+l[w][1]*(this.height-p)),I=r.pointCoordinate(T);if(!I)continue;const A=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);g+=I[3]*A,v+=A}return v===0?NaN:g/v}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._cameraZoom==null||!this._elevation)return;const r=this._cameraZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,g=this._mercatorZfromZoom(r),v=this._mercatorZfromZoom(this._maxZoom),w=Math.max(g-p,v);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const g=a.length(a.sub([],this._camera.position,p));return a.clamp(this._zoomFromMercatorZ(g),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!a.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];a.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new vd;return l.position=new a.MercatorCoordinate(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!a.length$1(r))return!1;a.normalize$1(r,r);const l=a.transformQuat([],[0,0,-1],r),p=a.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const g=au(l,p);return!!g&&(this._camera.orientation=g,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,g=this.cameraToCenterDistance;r[2]=a.clamp(r[2],g/p,g/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new a.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new a.pointGeometry(0,0)),g=this.pointCoordinate(new a.pointGeometry(this.width,0)),v=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new a.pointGeometry(0,this.height)),T=Math.floor(Math.min(p.x,g.x,v.x,w.x)),I=Math.floor(Math.max(p.x,g.x,v.x,w.x)),A=1;for(let z=T-A;z<=I+A;z++)z!==0&&l.push(new a.UnwrappedTileID(z,r))}return l}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,g=this.elevation&&!r.isTerrainDEM,v=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const w=this.locationCoordinate(this.center),T=1<<l,I=[T*w.x,T*w.y,0],A=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,this.projection.name!=="globe"),z=this.pointCoordinate(this.getCameraPoint()),L=T*a.mercatorZfromAltitude(1,this.center.lat),F=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),$=[T*z.x,T*z.y,F],N=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),G=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?l:0,ie=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,V=r.isTerrainDEM?-ie:this._elevation?this._elevation.getMinElevationBelowMSL():0,ee=this.projection.isReprojectedInTileSpace?Ol(this):1,te=be=>{const Oe=1/4e4,Pe=new a.MercatorCoordinate(be.x+Oe,be.y,be.z),ct=new a.MercatorCoordinate(be.x,be.y+Oe,be.z),_t=be.toLngLat(),kt=Pe.toLngLat(),qe=ct.toLngLat(),dt=this.locationCoordinate(_t),xt=this.locationCoordinate(kt),Yt=this.locationCoordinate(qe),nr=Math.hypot(xt.x-dt.x,xt.y-dt.y),vt=Math.hypot(Yt.x-dt.x,Yt.y-dt.y);return Math.sqrt(nr*vt)*ee/Oe},K=be=>{const Oe=ie,Pe=V;return{aabb:a.tileAABB(this,T,0,0,0,be,Pe,Oe,this.projection),zoom:0,x:0,y:0,minZ:Pe,maxZ:Oe,wrap:be,fullyVisible:!1}},J=[];let oe=[];const ye=l,Se=r.reparseOverscaled?p:l,We=be=>be*be,Ne=We((F-this._centerAltitude)*L),Be=be=>{if(!this._elevation||!be.tileID||!v)return;const Oe=this._elevation.getMinMaxForTile(be.tileID),Pe=be.aabb;Oe?(Pe.min[2]=Oe.min,Pe.max[2]=Oe.max,Pe.center[2]=(Pe.min[2]+Pe.max[2])/2):(be.shouldSplit=ke(be),be.shouldSplit||(Pe.min[2]=Pe.max[2]=Pe.center[2]=this._centerAltitude))},ke=be=>{if(be.zoom<G)return!0;if(be.zoom===ye)return!1;if(be.shouldSplit!=null)return be.shouldSplit;const Oe=be.aabb.distanceX($),Pe=be.aabb.distanceY($);let ct=Ne;g&&(ct=We(be.aabb.distanceZ($)*L));let _t=1;if(this.projection.isReprojectedInTileSpace&&p<=5){const qe=Math.pow(2,be.zoom),dt=te(new a.MercatorCoordinate((be.x+.5)/qe,(be.y+.5)/qe));_t=dt>.85?1:dt}const kt=Oe*Oe+Pe*Pe+ct;return kt<We((1<<ye-be.zoom)*N*_t*((qe,dt)=>{if(dt*We(.707)<qe)return 1;const xt=Math.sqrt(dt/qe);return xt/(1.4144271570014144+(Math.pow(1.1,xt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ct,Ne),kt))};if(this.renderWorldCopies)for(let be=1;be<=3;be++)J.push(K(-be)),J.push(K(be));for(J.push(K(0));J.length>0;){const be=J.pop(),Oe=be.x,Pe=be.y;let ct=be.fullyVisible;if(!ct){const _t=be.aabb.intersects(A);if(_t===0)continue;ct=_t===2}if(be.zoom!==ye&&ke(be))for(let _t=0;_t<4;_t++){const kt=(Oe<<1)+_t%2,qe=(Pe<<1)+(_t>>1),dt={aabb:v?be.aabb.quadrant(_t):a.tileAABB(this,T,be.zoom+1,kt,qe,be.wrap,be.minZ,be.maxZ,this.projection),zoom:be.zoom+1,x:kt,y:qe,wrap:be.wrap,fullyVisible:ct,tileID:void 0,shouldSplit:void 0,minZ:be.minZ,maxZ:be.maxZ};g&&(dt.tileID=new a.OverscaledTileID(be.zoom+1===ye?Se:be.zoom+1,be.wrap,be.zoom+1,kt,qe),Be(dt)),J.push(dt)}else{const _t=be.zoom===ye?Se:be.zoom;if(r.minzoom&&r.minzoom>_t)continue;const kt=I[0]-(.5+Oe+(be.wrap<<be.zoom))*(1<<l-be.zoom),qe=I[1]-.5-Pe,dt=be.tileID?be.tileID:new a.OverscaledTileID(_t,be.wrap,be.zoom,Oe,Pe);oe.push({tileID:dt,distanceSq:kt*kt+qe*qe})}}if(this.fogCullDistSq){const be=this.fogCullDistSq,Oe=this.horizonLineFromTop();oe=oe.filter(Pe=>{const ct=[0,0,0,1],_t=[a.EXTENT,a.EXTENT,0,1],kt=this.calculateFogTileMatrix(Pe.tileID.toUnwrapped());a.transformMat4$1(ct,ct,kt),a.transformMat4$1(_t,_t,kt);const qe=a.getAABBPointSquareDist(ct,_t);if(qe===0)return!0;let dt=!1;const xt=this._elevation;if(xt&&qe>be&&Oe!==0){const Yt=this.calculateProjMatrix(Pe.tileID.toUnwrapped());let nr;r.isTerrainDEM||(nr=xt.getMinMaxForTile(Pe.tileID)),nr||(nr={min:V,max:ie});const vt=a.furthestTileCorner(this.rotation),zt=[vt[0]*a.EXTENT,vt[1]*a.EXTENT,nr.max];a.transformMat4(zt,zt,Yt),dt=(1-zt[1])*this.height*.5<Oe}return qe<be||dt})}return oe.sort((be,Oe)=>be.distanceSq-Oe.distanceSq).map(be=>be.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=a.clamp(r.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),p=this.projection.project(r.lng,l);return new a.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(r,l){const p=this.pointCoordinate(l),g=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(r);this.setLocation(new a.MercatorCoordinate(v.x-(p.x-g.x),v.y-(p.y-g.y)))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this._coordinatePoint(this.locationCoordinate(r),!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const p=l?a.mercatorZfromAltitude(l,r.lat):void 0,g=this.projection.project(r.lng,r.lat);return new a.MercatorCoordinate(g.x,g.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l!=null?l:this._centerAltitude,g=[r.x,r.y,0,1],v=[r.x,r.y,1,1];a.transformMat4$1(g,g,this.pixelMatrixInverse),a.transformMat4$1(v,v,this.pixelMatrixInverse);const w=v[3];a.scale$1(g,g,1/g[3]),a.scale$1(v,v,1/w);const T=g[2],I=v[2];return{p0:g,p1:v,t:T===I?0:(p-T)/(I-T)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return a.transformMat4$1(l,l,this.pixelMatrixInverse),a.transformMat4$1(p,p,this.pixelMatrixInverse),a.scale$1(l,l,1/l[3]),a.scale$1(p,p,1/p[3]),l[2]=a.mercatorZfromAltitude(l[2],this._center.lat)*this.worldSize,p[2]=a.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,a.scale$1(l,l,1/this.worldSize),a.scale$1(p,p,1/this.worldSize),new a.Ray([l[0],l[1],l[2]],a.normalize([],a.sub([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:g}=r,v=a.mercatorZfromAltitude(l[2],this._center.lat),w=a.mercatorZfromAltitude(p[2],this._center.lat);return new a.MercatorCoordinate(a.number(l[0],p[0],g)/this.worldSize,a.number(l[1],p[1],g)/this.worldSize,a.number(v,w,g))}pointCoordinate(r,l=this._centerAltitude){return this.projection.createTileTransform(this,this.worldSize).pointCoordinate(r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);const l=this.elevation;let p=this.elevation.pointCoordinate(r);if(p)return new a.MercatorCoordinate(p[0],p[1],p[2]);let g=0,v=this.horizonLineFromTop();if(r.y>v)return this.pointCoordinate(r);const w=.02*v,T=r.clone();for(let I=0;I<10&&v-g>w;I++){T.y=a.number(g,v,.66);const A=l.pointCoordinate(T);A?(v=T.y,p=A):g=T.y}return p?new a.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){if(this.elevation)return!this.elevation.pointCoordinate(r);{const l=this.horizonLineFromTop();return r.y<l}}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,g=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return a.transformMat4$1(g,g,this.pixelMatrix),g[3]>0?new a.pointGeometry(g[0]/g[3],g[1]/g[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(r,l){const p=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),g=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),v=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),w=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let T=this.pointCoordinate(p,r),I=this.pointCoordinate(g,r);const A=this.pointCoordinate(v,l),z=this.pointCoordinate(w,l),L=(F,$)=>($.y-F.y)/($.x-F.x);return T.y>1&&I.y>=0?T=new a.MercatorCoordinate((1-z.y)/L(z,T)+z.x,1):T.y<0&&I.y<=1&&(T=new a.MercatorCoordinate(-z.y/L(z,T)+z.x,0)),I.y>1&&T.y>=0?I=new a.MercatorCoordinate((1-A.y)/L(A,I)+A.x,1):I.y<0&&T.y<=1&&(I=new a.MercatorCoordinate(-A.y/L(A,I)+A.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(T)).extend(this.coordinateLocation(I)).extend(this.coordinateLocation(z)).extend(this.coordinateLocation(A))}_getBounds3D(){const r=this.elevation;if(!r.visibleDemTiles.length)return this._getBounds(0,0);const l=r.visibleDemTiles.reduce((p,g)=>{if(g.dem){const v=g.dem.tree;p.min=Math.min(p.min,v.minimums[0]),p.max=Math.max(p.max,v.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileTransform(this,l).createTileMatrix(r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const g=r.canonical,v=1/this.height,w=this.cameraWorldSize/this.zoomScale(g.z),T=(g.x+Math.pow(2,g.z)*r.wrap)*w,I=g.y*w,A=this.point,z=this.angle,L=Math.sin(-z),F=-Math.cos(-z);return p[l]={bearing:[L,F],center:[(A.x-T)*v,(A.y-I)*v],scale:w/a.EXTENT*v},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const g=this.calculatePosMatrix(r,this.cameraWorldSize);return a.multiply$1(g,this.worldToFogMatrix,g),p[l]=new Float32Array(g),p[l]}calculateProjMatrix(r,l=!1){const p=r.key,g=l?this._alignedProjMatrixCache:this._projMatrixCache;if(g[p])return g[p];const v=this.calculatePosMatrix(r,this.worldSize);return a.multiply$1(v,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:l?this.alignedProjMatrix:this.projMatrix,v),g[p]=new Float32Array(v),g[p]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const g=function(v,w){const{scale:T}=v.tileTransform,I=T*a.EXTENT/(v.tileSize*Math.pow(2,w.zoom-v.tileID.overscaledZ+v.tileID.canonical.z));return A=new Float32Array(4),F=(z=w.inverseAdjustmentMatrix)[1],$=z[2],N=z[3],ie=(L=[I,I])[1],A[0]=z[0]*(G=L[0]),A[1]=F*G,A[2]=$*ie,A[3]=N*ie,A;var A,z,L,F,$,N,G,ie}(r,this);return p[l]=g,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const l=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),g=this._camera.forward(),v=a.mercatorZfromAltitude(1,this._center.lat);p[2]/=v,g[2]/=v,a.normalize(g,g);const w=r.raycast(p,g,r.exaggeration());if(w){const T=a.scaleAndAdd([],p,g,w),I=new a.MercatorCoordinate(T[0],T[1],a.mercatorZfromAltitude(T[2],a.latFromMercatorY(T[1]))),A=(I.z+a.length([I.x-p[0],I.y-p[1],I.z-p[2]*v]))*this._projectionScaler;this._cameraZoom=this._zoomFromMercatorZ(A),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const l=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),g=r.getAtPointOrZero(new a.MercatorCoordinate(...p)),v=this._minimumHeightOverTerrain()*Math.cos(a.degToRad(this._maxPitch)),w=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*g;if(w<v){const T=this.locationCoordinate(this._center,this._centerAltitude),I=[T.x-p[0],T.y-p[1],T.z-p[2]],A=a.length(I);I[2]-=(v-w)/this._projectionScaler;const z=a.length(I);if(z===0)return;a.scale$2(I,I,A/z*this._projectionScaler),this._camera.position=[T.x-I[0],T.y-I[1],T.z*this._projectionScaler-I[2]],this._camera.orientation=au(I,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const L=this.center;return L.lat=a.clamp(L.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(L.lng=a.clamp(L.lng,this.minLng,this.maxLng)),this.center=L,void(this._constraining=!1)}const r=this._unmodified,{x:l,y:p}=this.point;let g=0,v=l,w=p;const T=this.width/2,I=this.height/2,A=this.worldMinY*this.scale,z=this.worldMaxY*this.scale;if(p-I<A&&(w=A+I),p+I>z&&(w=z-I),z-A<this.height&&(g=Math.max(g,this.height/(z-A)),w=(z+A)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const L=this.worldMinX*this.scale,F=this.worldMaxX*this.scale,$=this.worldSize/2-(L+F)/2;v=(l+$+this.worldSize)%this.worldSize-$,v-T<L&&(v=L+T),v+T>F&&(v=F-T),F-L<this.width&&(g=Math.max(g,this.width/(F-L)),v=(F+L)/2)}v===l&&w===p||(this.center=this.unproject(new a.pointGeometry(v,w))),g&&(this.zoom+=this.scaleZoom(g)),this._constrainCameraAltitude(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this._fov/2,l=this.centerOffset,p=this.pixelsPerMeter;this._projectionScaler=p/(a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(r)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const g=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?p:1),v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);v[8]=2*-l.x/this.width,v[9]=2*l.y/this.height;let w=a.mul([],v,g);if(this.projection.isReprojectedInTileSpace){const K=this.locationCoordinate(this.center),J=a.identity([]);a.translate(J,J,[K.x*this.worldSize,K.y*this.worldSize,0]),a.multiply$1(J,J,xd(this)),a.translate(J,J,[-K.x*this.worldSize,-K.y*this.worldSize,0]),a.multiply$1(w,w,J),this.inverseAdjustmentMatrix=function(oe){const ye=xd(oe,!0);return ce([],[ye[0],ye[1],ye[4],ye[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],w,[this.worldSize,this.worldSize,this.worldSize/p,1]),this.projMatrix=w,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const T=new Float32Array(16);a.identity(T),a.scale(T,T,[1,-1,1]),a.rotateX(T,T,this._pitch),a.rotateZ(T,T,this.angle);const I=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),A=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;I[8]=2*-l.x/this.width,I[9]=2*(l.y+A)/this.height,this.skyboxMatrix=a.multiply$1(T,I,T);const z=this.point,L=z.x,F=z.y,$=this.width%2/2,N=this.height%2/2,G=Math.cos(this.angle),ie=Math.sin(this.angle),V=L-Math.round(L)+G*$+ie*N,ee=F-Math.round(F)+G*N+ie*$,te=new Float64Array(w);if(a.translate(te,te,[V>.5?V-1:V,ee>.5?ee-1:ee,0]),this.alignedProjMatrix=te,w=a.create(),a.scale(w,w,[this.width/2,-this.height/2,1]),a.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=a.create(),a.scale(w,w,[1,-1,1]),a.translate(w,w,[-1,-1,0]),a.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=a.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},w=a.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");this.pixelMatrixInverse=w,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSize,l=this.cameraPixelsPerMeter,p=this._camera.position,g=1/this.height,v=[r,r,l];a.scale$2(v,v,g),a.scale$2(p,p,-1),a.multiply$2(p,p,v);const w=a.create();a.translate(w,w,p),a.scale(w,w,v),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,g)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),g=this.point,v=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[g.x/this.worldSize-p[0]*v,g.y/this.worldSize-p[1]*v,r/this.worldSize*this._centerAltitude-p[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=r[2];let g=1;p>0&&(g=Math.min((l-this._camera.position[2])/p,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,r,g),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:g}=this._camera.getPitchBearing(),v=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),T=Math.max((r[2]-v)/Math.cos(p),w),I=this._zoomFromMercatorZ(T);a.scaleAndAdd(r,r,l,T),this._pitch=a.clamp(p,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(g,-Math.PI,Math.PI),this._setZoom(a.clamp(I,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new a.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._cameraZoom!=null?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),g=Math.max(r.x,l.x),v=Math.min(r.y,l.y),w=Math.max(r.y,l.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const T=[new a.pointGeometry(p,v),new a.pointGeometry(g,w),new a.pointGeometry(p,w),new a.pointGeometry(g,v)],I=this.renderWorldCopies?-3:0,A=this.renderWorldCopies?4:1;for(const z of T){const L=this.pointRayIntersection(z);if(L.t<0)return!0;const F=this.rayIntersectionCoordinate(L);if(F.x<I||F.y<0||F.x>A||F.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,l){const p=a.length(a.sub([],this._camera.position,r)),g=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(g)}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,r))}}function fo(d,r){let l=!1,p=null;const g=()=>{p=null,l&&(d(),p=setTimeout(g,r),l=!1)};return()=>(l=!0,p||g(),p)}class wd{constructor(r){this._hashName=r&&encodeURIComponent(r),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=fo(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const l=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,g=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,g),w=Math.round(l.lng*v)/v,T=Math.round(l.lat*v)/v,I=this._map.getBearing(),A=this._map.getPitch();let z="";if(z+=r?`/${w}/${T}/${p}`:`${p}/${T}/${w}`,(I||A)&&(z+="/"+Math.round(10*I)/10),A&&(z+=`/${Math.round(A)}`),this._hashName){const L=this._hashName;let F=!1;const $=a.window.location.hash.slice(1).split("&").map(N=>{const G=N.split("=")[0];return G===L?(F=!0,`${G}=${z}`):N}).filter(N=>N);return F||$.push(`${L}=${z}`),`#${$.join("&")}`}return`#${z}`}_getCurrentHash(){const r=a.window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(l=>isNaN(l))){const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,r)}}const ji={linearity:.3,easing:a.bezier(0,0,.3,1)},ms=a.extend({deceleration:2500,maxSpeed:1400},ji),bd=a.extend({deceleration:20,maxSpeed:1400},ji),hu=a.extend({deceleration:1e3,maxSpeed:360},ji),qt=a.extend({deceleration:1e3,maxSpeed:90},ji);class Bl{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=a.exported.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)l.zoom+=v.zoomDelta||0,l.bearing+=v.bearingDelta||0,l.pitch+=v.pitchDelta||0,v.panDelta&&l.pan._add(v.panDelta),v.around&&(l.around=v.around),v.pinchAround&&(l.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(l.pan.mag()){const v=Ia(l.pan.mag(),p,a.extend({},ms,r||{}));g.offset=l.pan.mult(v.amount/l.pan.mag()),g.center=this._map.transform.center,Fl(g,v)}if(l.zoom){const v=Ia(l.zoom,p,bd);g.zoom=this._map.transform.zoom+v.amount,Fl(g,v)}if(l.bearing){const v=Ia(l.bearing,p,hu);g.bearing=this._map.transform.bearing+a.clamp(v.amount,-179,179),Fl(g,v)}if(l.pitch){const v=Ia(l.pitch,p,qt);g.pitch=this._map.transform.pitch+v.amount,Fl(g,v)}if(g.zoom||g.bearing){const v=l.pinchAround===void 0?l.around:l.pinchAround;g.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),a.extend(g,{noMoveStart:!0})}}function Fl(d,r){(!d.duration||d.duration<r.duration)&&(d.duration=r.duration,d.easing=r.easing)}function Ia(d,r,l){const{maxSpeed:p,linearity:g,deceleration:v}=l,w=a.clamp(d*g/(r/1e3),-p,p),T=Math.abs(w)/(v*g);return{easing:l.easing,duration:1e3*T,amount:w*(T/2)}}class nn extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,g={}){const v=se.mousePos(l.getCanvasContainer(),p),w=l.unproject(v);super(r,a.extend({point:v,lngLat:w,originalEvent:p},g)),this._defaultPrevented=!1,this.target=l}}class Ul extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const g=r==="touchend"?p.changedTouches:p.touches,v=se.touchPos(l.getCanvasContainer(),g),w=v.map(I=>l.unproject(I)),T=v.reduce((I,A,z,L)=>I.add(A.div(L.length)),new a.pointGeometry(0,0));super(r,{points:v,point:T,lngLats:w,lngLat:l.unproject(T),originalEvent:p}),this._defaultPrevented=!1}}class sm extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){super(r,{originalEvent:p}),this._defaultPrevented=!1}}class Td{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new sm(r.type,this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new nn(r.type,this._map,r))}mouseup(r){this._map.fire(new nn(r.type,this._map,r))}preclick(r){const l=a.extend({},r);l.type="preclick",this._map.fire(new nn(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new nn(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new nn(r.type,this._map,r))}mouseover(r){this._map.fire(new nn(r.type,this._map,r))}mouseout(r){this._map.fire(new nn(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Ul(r.type,this._map,r))}touchmove(r){this._map.fire(new Ul(r.type,this._map,r))}touchend(r){this._map.fire(new Ul(r.type,this._map,r))}touchcancel(r){this._map.fire(new Ul(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class am{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(r){this._map.fire(new nn(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new nn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new nn(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class du{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(se.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=p,this._box||(this._box=se.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const v=Math.min(g.x,p.x),w=Math.max(g.x,p.x),T=Math.min(g.y,p.y),I=Math.max(g.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${v}px,${T}px)`,this._box.style.width=w-v+"px",this._box.style.height=I-T+"px")})}mouseupWindow(r,l){if(!this._active||r.button!==0)return;const p=this._startPos,g=l;if(this.reset(),se.suppressClick(),p.x!==g.x||p.y!==g.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:v=>v.fitScreenCoordinates(p,g,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),se.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new a.Event(r,{originalEvent:l}))}}function _s(d,r){const l={};for(let p=0;p<d.length;p++)l[d[p].identifier]=r[p];return l}class Aa{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(g){const v=new a.pointGeometry(0,0);for(const w of g)v._add(w);return v.div(g.length)}(l),this.touches=_s(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const g=_s(p,l);for(const v in this.touches){const w=this.touches[v],T=g[v];(!T||T.dist(w)>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class za{constructor(r){this.singleTap=new Aa(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const g=this.singleTap.touchend(r,l,p);if(g){const v=r.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(g)<30;if(v&&w||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class pu{constructor(){this._zoomIn=new za({numTouches:1,numTaps:2}),this._zoomOut=new za({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const g=this._zoomIn.touchend(r,l,p),v=this._zoomOut.touchend(r,l,p);return g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(g)},{originalEvent:r})}):v?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(v)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Sd={0:1,2:2};class gs{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=se.mouseButton(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),function(g,v){const w=Sd[v];return g.buttons===void 0||(g.buttons&w)!==w}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&se.mouseButton(r)===this._eventButton&&(this._moved&&se.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nl extends gs{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class Xn extends gs{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class fu extends gs{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class Ed{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const g=_s(p,l),v=new a.pointGeometry(0,0),w=new a.pointGeometry(0,0);let T=0;for(const A in g){const z=g[A],L=this._touches[A];L&&(v._add(z),w._add(z.sub(L)),T++,g[A]=z)}if(this._touches=g,T<this._minTouches||!w.mag())return;const I=w.div(T);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(T),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=se.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class jl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){if(!this._firstTwoTouches)return;r.preventDefault();const[g,v]=this._firstTwoTouches,w=Vi(p,l,g),T=Vi(p,l,v);if(!w||!T)return;const I=this._aroundCenter?null:w.add(T).div(2);return this._move([w,T],I,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[g,v]=this._firstTwoTouches,w=Vi(p,l,g),T=Vi(p,l,v);w&&T||(this._active&&se.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Vi(d,r,l){for(let p=0;p<d.length;p++)if(d[p].identifier===l)return r[p]}function mu(d,r){return Math.log(d/r)/Math.LN2}class Vl extends jl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(mu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mu(this._distance,p),pinchAround:l}}}function $l(d,r){return 180*d.angleWith(r)/Math.PI}class Gl extends jl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:$l(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=$l(r,this._startVector);return Math.abs(p)<l}}function Zl(d){return Math.abs(d.y)>Math.abs(d.x)}class Cd extends jl{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(r){this._lastPoints=r,Zl(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const g=r[0].sub(this._lastPoints[0]),v=r[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&p.touches.length<3)&&(this._valid=this.gestureBeginsVertically(g,v,p.timeStamp),this._valid))return this._lastPoints=r,this._active=!0,{pitchDelta:(g.y+v.y)/2*-.5}}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const g=r.mag()>=2,v=l.mag()>=2;if(!g&&!v)return;if(!g||!v)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const w=r.y>0==l.y>0;return Zl(r)&&Zl(l)&&w}}const ys={panStep:100,bearingStep:15,pitchStep:10};class lm{constructor(){const r=ys;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,g=0,v=0,w=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),v=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),v=1);break;case 38:r.shiftKey?g=1:(r.preventDefault(),w=-1);break;case 40:r.shiftKey?g=-1:(r.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(p=0,g=0),{cameraAnimation:T=>{const I=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:cm,zoom:l?Math.round(I)+l*(r.shiftKey?2:1):I,bearing:T.getBearing()+p*this._bearingStep,pitch:T.getPitch()+g*this._pitchStep,offset:[-v*this._panStep,-w*this._panStep],center:T.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cm(d){return d*(2-d)}const _u=4.000244140625;class ql{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=a.exported.now(),g=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%_u==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(g*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=se.mousePos(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform,l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>_u?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&A!==0&&(A=1/A);const z=l(),L=Math.pow(2,z),F=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):L;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(F*A))),this._type==="wheel"&&(this._startZoom=l(),this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),g=this._startZoom,v=this._easing;let w,T=!1;if(this._type==="wheel"&&g&&v){const I=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),A=v(I);w=a.number(g,p,A),I<1?this._frameId||(this._frameId=!0):T=!0}else w=p,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:w-l(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=a.ease;if(this._prevEase){const p=this._prevEase,g=(a.exported.now()-p.start)/p.duration,v=p.easing(g+.01)-p.easing(g),w=.27/Math.sqrt(v*v+1e-4)*.01,T=Math.sqrt(.0729-w*w);l=a.bezier(w,T,.25,1)}return this._prevEase={start:a.exported.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=se.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!a.window.document.fullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class gu{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class kd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Md{constructor(){this._tap=new za({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const g=l[0],v=g.y-this._swipePoint.y;return this._swipePoint=g,r.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wl{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yu{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Id{constructor(r,l,p,g){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Pa=d=>d.zoom||d.drag||d.pitch||d.rotate;class Ad extends a.Event{}class zd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=a.sub([],l,r);this.radius=a.length(p[2]<0?a.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){a.div(r,r,this.constants),a.normalize(r,r),a.mul$1(r,r,this.constants);const l=a.scale$2([],r,this.radius);if(l[2]>0){const p=a.scale$2([],[0,0,1],a.dot(l,[0,0,1])),g=a.scale$2([],a.normalize([],[l[0],l[1],0]),this.radius),v=a.add([],l,a.scale$2([],a.sub([],a.add([],g,p),l),2));l[0]=v[0],l[1]=v[1]}return l}}function Da(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class vs{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bl(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new zd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),a.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[g,v,w]of this._listeners)g.addEventListener(v,g===a.window.document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[r,l,p]of this._listeners)r.removeEventListener(l,r===a.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new Td(l,r));const g=l.boxZoom=new du(l,r);this._add("boxZoom",g);const v=new pu,w=new kd;l.doubleClickZoom=new gu(w,v),this._add("tapZoom",v),this._add("clickZoom",w);const T=new Md;this._add("tapDragZoom",T);const I=l.touchPitch=new Cd(l);this._add("touchPitch",I);const A=new Xn(r),z=new fu(r);l.dragRotate=new yu(r,A,z),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const L=new Nl(r),F=new Ed(l,r);l.dragPan=new Wl(p,L,F),this._add("mousePan",L),this._add("touchPan",F,["touchZoom","touchRotate"]);const $=new Gl,N=new Vl;l.touchZoomRotate=new Id(p,N,$,T),this._add("touchRotate",$,["touchPan","touchZoom"]),this._add("touchZoom",N,["touchPan","touchRotate"]),this._add("blockableMapEvent",new am(l));const G=l.scrollZoom=new ql(l,this);this._add("scrollZoom",G,["mousePan"]);const ie=l.keyboard=new lm;this._add("keyboard",ie);for(const V of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[V]&&l[V].enable(r[V])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Pa(this._eventsInProgress))||this.isZooming()}_blockedByActive(r,l,p){for(const g in r)if(g!==p&&(!l||l.indexOf(g)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",g=p?void 0:r,v={needsRenderFrame:!1},w={},T={},I=r.touches?this._getMapTouches(r.touches):void 0,A=I?se.touchPos(this._el,I):p?void 0:se.mousePos(this._el,r);for(const{handlerName:F,handler:$,allowed:N}of this._handlers){if(!$.isEnabled())continue;let G;this._blockedByActive(T,N,F)?$.reset():$[l||r.type]&&(G=$[l||r.type](r,A,I),this.mergeHandlerResult(v,w,G,F,g),G&&G.needsRenderFrame&&this._triggerRenderFrame()),(G||$.isActive())&&(T[F]=$)}const z={};for(const F in this._previousActiveHandlers)T[F]||(z[F]=g);this._previousActiveHandlers=T,(Object.keys(z).length||Da(v))&&(this._changes.push([v,w,z]),this._triggerRenderFrame()),(Object.keys(T).length||Da(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:L}=v;L&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],L(this._map))}mergeHandlerResult(r,l,p,g,v){if(!p)return;a.extend(r,p);const w={handlerName:g,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(l.zoom=w),p.panDelta!==void 0&&(l.drag=w),p.pitchDelta!==void 0&&(l.pitch=w),p.bearingDelta!==void 0&&(l.rotate=w)}_applyChanges(){const r={},l={},p={};for(const[g,v,w]of this._changes)g.panDelta&&(r.panDelta=(r.panDelta||new a.pointGeometry(0,0))._add(g.panDelta)),g.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(r.around=g.around),g.aroundCoord!==void 0&&(r.aroundCoord=g.aroundCoord),g.pinchAround!==void 0&&(r.pinchAround=g.pinchAround),g.noInertia&&(r.noInertia=g.noInertia),a.extend(l,v),a.extend(p,w);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const g=this._map,v=g.transform,w=ee=>[ee.x,ee.y,ee.z];if((ee=>{const te=this._eventsInProgress.drag;return te&&!this._handlersById[te.handlerName].isActive()})()&&!Da(r)){const ee=v.zoom;v.cameraElevationReference="sea",v.recenterOnTerrain(),v.cameraElevationReference="ground",ee!==v.zoom&&this._map._update(!0)}if(!Da(r))return this._fireEvents(l,p,!0);let{panDelta:T,zoomDelta:I,bearingDelta:A,pitchDelta:z,around:L,aroundCoord:F,pinchAround:$}=r;$!==void 0&&(L=$),(ee=>l.drag&&!this._eventsInProgress.drag)()&&L&&(this._dragOrigin=w(v.pointCoordinate3D(L)),this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",g._stop(!0),L=L||g.transform.centerPoint,A&&(v.bearing+=A),z&&(v.pitch+=z),v._updateCameraState();const N=[0,0,0];if(T){const ee=v.pointCoordinate(L),te=v.pointCoordinate(L.sub(T));ee&&te&&(N[0]=te.x-ee.x,N[1]=te.y-ee.y)}const G=v.zoom,ie=[0,0,0];if(I){const ee=w(F||v.pointCoordinate3D(L)),te={dir:a.normalize([],a.sub([],ee,v._camera.position))};if(te.dir[2]<0){const K=v.zoomDeltaToMovement(ee,I);a.scale$2(ie,te.dir,K)}}const V=a.add(N,N,ie);v._translateCameraConstrained(V),I&&Math.abs(v.zoom-G)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const g=Pa(this._eventsInProgress),v=Pa(r),w={};for(const z in r){const{originalEvent:L}=r[z];this._eventsInProgress[z]||(w[`${z}start`]=L),this._eventsInProgress[z]=r[z]}!g&&v&&this._fireEvent("movestart",v.originalEvent);for(const z in w)this._fireEvent(z,w[z]);v&&this._fireEvent("move",v.originalEvent);for(const z in r){const{originalEvent:L}=r[z];this._fireEvent(z,L)}const T={};let I;for(const z in this._eventsInProgress){const{handlerName:L,originalEvent:F}=this._eventsInProgress[z];this._handlersById[L].isActive()||(delete this._eventsInProgress[z],I=l[L]||F,T[`${z}end`]=I)}for(const z in T)this._fireEvent(z,T[z]);const A=Pa(this._eventsInProgress);if(p&&(g||v)&&!A){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;z?(L(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:I})):(this._map.fire(new a.Event("moveend",{originalEvent:I})),L(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new a.Event(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Ad("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const vu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Pd extends a.Evented{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=a.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,a.extend({offset:r},l),p)}panTo(r,l,p){return this.easeTo(a.extend({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(a.extend({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(a.extend({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,a.extend({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=a.LngLatBounds.convert(r);const p=l&&l.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),p,l)}_extendCameraOptions(r){const l={top:0,bottom:0,right:0,left:0};if(typeof(r=a.extend({padding:l,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const p=r.padding;r.padding={top:p,bottom:p,right:p,left:p}}return r.padding=a.extend(l,r.padding),r}_cameraForBoxAndBearing(r,l,p,g){const v=this._extendCameraOptions(g),w=this.transform,T=w.padding,I=w.project(a.LngLat.convert(r)),A=w.project(a.LngLat.convert(l)),z=I.rotate(-a.degToRad(p)),L=A.rotate(-a.degToRad(p)),F=new a.pointGeometry(Math.max(z.x,L.x),Math.max(z.y,L.y)),$=new a.pointGeometry(Math.min(z.x,L.x),Math.min(z.y,L.y)),N=F.sub($),G=(w.width-(T.left+T.right+v.padding.left+v.padding.right))/N.x,ie=(w.height-(T.top+T.bottom+v.padding.top+v.padding.bottom))/N.y;if(ie<0||G<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const V=Math.min(w.scaleZoom(w.scale*Math.min(G,ie)),v.maxZoom),ee=typeof v.offset.x=="number"?new a.pointGeometry(v.offset.x,v.offset.y):a.pointGeometry.convert(v.offset),te=new a.pointGeometry((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(p*Math.PI/180),K=ee.add(te).mult(w.scale/w.zoomScale(V));return{center:w.unproject(I.add(A).div(2).sub(K)),zoom:V,bearing:p}}_cameraForBox(r,l,p,g,v){const w=this._extendCameraOptions(v);p=p||0,g=g||0,r=a.LngLat.convert(r),l=a.LngLat.convert(l);const T=this.transform.clone();T.padding=w.padding;const I=this.getFreeCameraOptions(),A=new a.LngLat(.5*(r.lng+l.lng),.5*(r.lat+l.lat)),z=.5*(p+g);if(T._camera.position[2]<a.mercatorZfromAltitude(z,A.lat))return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");I.lookAtPoint(A),T.setFreeCameraOptions(I);const L=a.MercatorCoordinate.fromLngLat(r),F=a.MercatorCoordinate.fromLngLat(l),$=T.pointRayIntersection(T.centerPoint,z),N=[(G=T.rayIntersectionCoordinate($)).x,G.y,G.z];var G;const ie=T.screenPointToMercatorRay(T.centerPoint),V=T.projection.name!=="globe";let ee,te=0;do{const K=Math.floor(T.zoom),J=1<<K,oe=Math.min(J*L.x,J*F.x),ye=Math.min(J*L.y,J*F.y),Se=Math.max(J*L.x,J*F.x),We=Math.max(J*L.y,J*F.y),Ne=new a.Aabb([oe,ye,p],[Se,We,g]),Be=a.Frustum.fromInvProjectionMatrix(T.invProjMatrix,T.worldSize,K,V);if(Ne.intersects(Be)!==2){ee&&(T._camera.position=a.scaleAndAdd([],T._camera.position,ie.dir,-ee),T._updateStateFromCamera());break}const ke=a.sub([],T._camera.position,N);ee=.5*a.length(ke),T._camera.position=a.scaleAndAdd([],T._camera.position,ie.dir,ee);try{T._updateStateFromCamera()}catch{return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++te<10);return{center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}}fitBounds(r,l,p){return this._fitInternal(this.cameraForBounds(r,l),l,p)}_raycastElevationBox(r,l){const p=this.transform.elevation;if(!p)return;const g=new a.pointGeometry(r.x,l.y),v=new a.pointGeometry(l.x,r.y),w=p.pointCoordinate(r);if(!w)return;const T=p.pointCoordinate(l);if(!T)return;const I=p.pointCoordinate(g);if(!I)return;const A=p.pointCoordinate(v);if(!A)return;const z=new a.MercatorCoordinate(w[0],w[1]).toLngLat(),L=new a.MercatorCoordinate(T[0],T[1]).toLngLat(),F=new a.MercatorCoordinate(I[0],I[1]).toLngLat(),$=new a.MercatorCoordinate(A[0],A[1]).toLngLat(),N=Math.min(z.lng,Math.min(L.lng,Math.min(F.lng,$.lng))),G=Math.min(z.lat,Math.min(L.lat,Math.min(F.lat,$.lat))),ie=Math.max(z.lng,Math.max(L.lng,Math.max(F.lng,$.lng))),V=Math.max(z.lat,Math.max(L.lat,Math.max(F.lat,$.lat))),ee=Math.min(w[3],Math.min(T[3],Math.min(I[3],A[3]))),te=Math.max(w[3],Math.max(T[3],Math.max(I[3],A[3])));return{minLngLat:new a.LngLat(N,G),maxLngLat:new a.LngLat(ie,V),minAltitude:ee,maxAltitude:te}}fitScreenCoordinates(r,l,p,g,v){let w,T,I,A;const z=a.pointGeometry.convert(r),L=a.pointGeometry.convert(l),F=this._raycastElevationBox(z,L);if(F)w=F.minLngLat,T=F.maxLngLat,I=F.minAltitude,A=F.maxAltitude;else{if(this.transform.anyCornerOffEdge(z,L))return this;w=this.transform.pointLocation(z),T=this.transform.pointLocation(L)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(r)),this.transform.pointLocation(a.pointGeometry.convert(l)),p,g):this._cameraForBox(w,T,I,A,g),g,v)}_fitInternal(r,l,p){return r?(delete(l=a.extend(r,l)).padding,l.linear?this.easeTo(l,p):this.flyTo(l,p)):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let g=!1,v=!1,w=!1;return"zoom"in r&&p.zoom!==+r.zoom&&(g=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=a.LngLat.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(v=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(w=!0,p.pitch=+r.pitch),r.padding==null||p.isPaddingEqual(r.padding)||(p.padding=r.padding),r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),g&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),v&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),w&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(vu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return void a.warnOnce(vu);this.stop();const g=p.zoom,v=p.pitch,w=p.bearing;p.setFreeCameraOptions(r);const T=g!==p.zoom,I=v!==p.pitch,A=w!==p.bearing;return this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),T&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),A&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),I&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=a.extend({offset:[0,0],duration:500,easing:a.ease},r)).animate===!1||!r.essential&&a.exported.prefersReducedMotion)&&(r.duration=0);const p=this.transform,g=this.getZoom(),v=this.getBearing(),w=this.getPitch(),T=this.getPadding(),I="zoom"in r?+r.zoom:g,A="bearing"in r?this._normalizeBearing(r.bearing,v):v,z="pitch"in r?+r.pitch:w,L="padding"in r?r.padding:p.padding,F=a.pointGeometry.convert(r.offset);let $=p.centerPoint.add(F);const N=p.projection.name==="globe"?p.pointCoordinate($).toLngLat():p.pointLocation($),G=a.LngLat.convert(r.center||N);this._normalizeCenter(G);const ie=p.project(N),V=p.project(G).sub(ie),ee=p.zoomScale(I-g);let te,K;r.around&&(te=a.LngLat.convert(r.around),K=p.locationPoint(te));const J=this._zooming||I!==g,oe=this._rotating||v!==A,ye=this._pitching||z!==w,Se=!p.isPaddingEqual(L),We=Be=>ke=>{if(J&&(Be.zoom=a.number(g,I,ke)),oe&&(Be.bearing=a.number(v,A,ke)),ye&&(Be.pitch=a.number(w,z,ke)),Se&&(Be.interpolatePadding(T,L,ke),$=Be.centerPoint.add(F)),te)Be.setLocationAtPoint(te,K);else{const be=Be.zoomScale(Be.zoom-g),Oe=I>g?Math.min(2,ee):Math.max(.5,ee),Pe=Math.pow(Oe,1-ke),ct=Be.unproject(ie.add(V.mult(ke*Pe)).mult(be));Be.setLocationAtPoint(Be.renderWorldCopies?ct.wrap():ct,$)}return r.preloadOnly||this._fireMoveEvents(l),Be};if(r.preloadOnly){const Be=this._emulate(We,r.duration,p);return this._preloadTiles(Be),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=J,this._rotating=oe,this._pitching=ye,this._padding=Se,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,Ne),this._ease(We(p),Be=>{p.recenterOnTerrain(),this._afterEase(l,Be)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",l||p.moving||this.fire(new a.Event("movestart",r)),this._zooming&&!p.zooming&&this.fire(new a.Event("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new a.Event("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new a.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new a.Event("move",r)),this._zooming&&this.fire(new a.Event("zoom",r)),this._rotating&&this.fire(new a.Event("rotate",r)),this._pitching&&this.fire(new a.Event("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId,this.transform.cameraElevationReference="ground";const p=this._zooming,g=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new a.Event("zoomend",r)),g&&this.fire(new a.Event("rotateend",r)),v&&this.fire(new a.Event("pitchend",r)),this.fire(new a.Event("moveend",r))}flyTo(r,l){if(!r.essential&&a.exported.prefersReducedMotion){const qe=a.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(qe,l)}this.stop(),r=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},r);const p=this.transform,g=this.getZoom(),v=this.getBearing(),w=this.getPitch(),T=this.getPadding(),I="zoom"in r?a.clamp(+r.zoom,p.minZoom,p.maxZoom):g,A="bearing"in r?this._normalizeBearing(r.bearing,v):v,z="pitch"in r?+r.pitch:w,L="padding"in r?r.padding:p.padding,F=p.zoomScale(I-g),$=a.pointGeometry.convert(r.offset);let N=p.centerPoint.add($);const G=p.pointLocation(N),ie=a.LngLat.convert(r.center||G);this._normalizeCenter(ie);const V=p.project(G),ee=p.project(ie).sub(V);let te=r.curve;const K=Math.max(p.width,p.height),J=K/F,oe=ee.mag();if("minZoom"in r){const qe=a.clamp(Math.min(r.minZoom,g,I),p.minZoom,p.maxZoom),dt=K/p.zoomScale(qe-g);te=Math.sqrt(dt/oe*2)}const ye=te*te;function Se(qe){const dt=(J*J-K*K+(qe?-1:1)*ye*ye*oe*oe)/(2*(qe?J:K)*ye*oe);return Math.log(Math.sqrt(dt*dt+1)-dt)}function We(qe){return(Math.exp(qe)-Math.exp(-qe))/2}function Ne(qe){return(Math.exp(qe)+Math.exp(-qe))/2}const Be=Se(0);let ke=function(qe){return Ne(Be)/Ne(Be+te*qe)},be=function(qe){return K*((Ne(Be)*(We(dt=Be+te*qe)/Ne(dt))-We(Be))/ye)/oe;var dt},Oe=(Se(1)-Be)/te;if(Math.abs(oe)<1e-6||!isFinite(Oe)){if(Math.abs(K-J)<1e-6)return this.easeTo(r,l);const qe=J<K?-1:1;Oe=Math.abs(Math.log(J/K))/te,be=function(){return 0},ke=function(dt){return Math.exp(qe*te*dt)}}r.duration="duration"in r?+r.duration:1e3*Oe/("screenSpeed"in r?+r.screenSpeed/te:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const Pe=v!==A,ct=z!==w,_t=!p.isPaddingEqual(L),kt=qe=>dt=>{const xt=dt*Oe,Yt=1/ke(xt);qe.zoom=dt===1?I:g+qe.scaleZoom(Yt),Pe&&(qe.bearing=a.number(v,A,dt)),ct&&(qe.pitch=a.number(w,z,dt)),_t&&(qe.interpolatePadding(T,L,dt),N=qe.centerPoint.add($));const nr=dt===1?ie:qe.unproject(V.add(ee.mult(be(xt))).mult(Yt));return qe.setLocationAtPoint(qe.renderWorldCopies?nr.wrap():nr,N),qe._updateCenterElevation(),r.preloadOnly||this._fireMoveEvents(l),qe};if(r.preloadOnly){const qe=this._emulate(kt,r.duration,p);return this._preloadTiles(qe),this}return this._zooming=!0,this._rotating=Pe,this._pitching=ct,this._padding=_t,this._prepareEase(l,!1),this._ease(kt(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=a.exported.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=a.wrap(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(!l.renderWorldCopies||l.maxBounds)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_emulate(r,l,p){const g=Math.ceil(15*l/1e3),v=[],w=r(p.clone());for(let T=0;T<=g;T++){const I=w(T/g);v.push(I.clone())}return v}}class xu{constructor(r={}){this.options=r,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact;return this._map=r,this._container=se.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=se.create("button","mapboxgl-ctrl-attrib-button",this._container),se.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=se.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,l){const p=this._map._getUIString(`AttributionControl.${l}`);r.setAttribute("aria-label",p),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(r){const p=l.reduce((g,v,w)=>(v.value&&(g+=`${v.key}=${v.value}${w<l.length-1?"&":""}`),g),"?");r.href=`${a.config.FEEDBACK_URL}/${p}${this._map._hash?this._map._hash.getHashString(!0):""}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const l=this._map.style._sourceCaches;for(const g in l){const v=l[g];if(v.used){const w=v.getSource();w.attribution&&r.indexOf(w.attribution)<0&&r.push(w.attribution)}}r.sort((g,v)=>g.length-v.length),r=r.filter((g,v)=>{for(let w=v+1;w<r.length;w++)if(r[w].indexOf(g)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class wu{constructor(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)}onAdd(r){this._map=r,this._container=se.create("div","mapboxgl-ctrl");const l=se.create("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class bu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const g of p)if(g.id===r)return void(g.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Tu(d,r,l){if(d=new a.LngLat(d.lng,d.lat),r){const p=new a.LngLat(d.lng-360,d.lat),g=new a.LngLat(d.lng+360,d.lat),v=360*Math.ceil(Math.abs(d.lng-l.center.lng)/360),w=l.locationPoint(d).distSqr(r),T=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(p).distSqr(r)<w&&(T||Math.abs(p.lng-l.center.lng)<v)?d=p:l.locationPoint(g).distSqr(r)<w&&(T||Math.abs(g.lng-l.center.lng)<v)&&(d=g)}for(;Math.abs(d.lng-l.center.lng)>180;){const p=l.locationPoint(d);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;d.lng>l.center.lng?d.lng-=360:d.lng+=360}return d}const Yr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Su extends a.Evented{constructor(r,l){if(super(),(r instanceof a.window.HTMLElement||l)&&(r=a.extend({element:r},l)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),r&&r.element)this._element=r.element,this._offset=a.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=se.create("div");const g=41,v=27,w=se.createSVG("svg",{display:"block",height:g*this._scale+"px",width:v*this._scale+"px",viewBox:`0 0 ${v} ${g}`},this._element),T=se.createSVG("radialGradient",{id:"shadowGradient"},se.createSVG("defs",{},w));se.createSVG("stop",{offset:"10%","stop-opacity":.4},T),se.createSVG("stop",{offset:"100%","stop-opacity":.05},T),se.createSVG("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},w),se.createSVG("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},w),se.createSVG("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},w),se.createSVG("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},w),this._offset=a.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()});const p=this._element.classList;for(const g in Yr)p.remove(`mapboxgl-marker-anchor-${g}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick)),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._updateMoving),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=a.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const l=38.1,p=13.5,g=Math.sqrt(Math.pow(p,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-l],"bottom-left":[g,-1*(l-p+g)],"bottom-right":[-g,-1*(l-p+g)],left:[p,-1*(l-p)],right:[-p,-1*(l-p)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const r=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(r))return void this._clearFadeTimer();const l=this._map.unproject(r);let p=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const v=this._map.getFreeCameraOptions();if(v.position){const w=v.position.toLngLat();p=w.distanceTo(l)<.9*w.distanceTo(this._lngLat)}}const g=(1-this._map._queryFogOpacity(l))*(p?.2:1);this._element.style.opacity=`${g}`,this._popup&&this._popup._setOpacity(`${g}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(r){const l=this._map.transform;return!!r&&r.x>=0&&r.x<l.width&&r.y>=0&&r.y<l.height}_updateDOM(){const r=this._pos||new a.pointGeometry(0,0),l=this._calculatePitch(),p=this._calculateRotation();this._element.style.transform=`${Yr[this._anchor]} translate(${r.x}px, ${r.y}px) rotateX(${l}deg) rotateZ(${p}deg)`}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(r){a.window.cancelAnimationFrame(this._updateFrameId),this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=Tu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset()),r===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}_transformedOffset(){if(!this._defaultMarker)return this._offset;const r=this._map.transform,l=this._offset.mult(this._scale);return this._rotationAlignment==="map"&&l._rotate(r.angle),this._pitchAlignment==="map"&&(l.y*=Math.cos(r._pitch)),l}getOffset(){return this._offset}setOffset(r){return this._offset=a.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class $i{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=a.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const Dd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:di,HTMLElement:xs,ImageBitmap:ws}=a.window,um={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Eu(d){d.parentNode&&d.parentNode.removeChild(d)}const hm={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ld{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new Xn({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new fu({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),se.disableDrag()}move(r,l){const p=this.map,g=this.mouseRotate.mousemoveWindow(r,l);if(g&&g.bearingDelta&&p.setBearing(p.getBearing()+g.bearingDelta),this.mousePitch){const v=this.mousePitch.mousemoveWindow(r,l);v&&v.pitchDelta&&p.setPitch(p.getPitch()+v.pitchDelta)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){se.enableDrag(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(a.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),se.mousePos(this.element,r)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,se.mousePos(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=se.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=se.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const La={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let pn,Oa=0,bs=!1;const Ra={maxWidth:100,unit:"metric"};function rt(d,r,l){const p=l&&l.maxWidth||100,g=d._containerHeight/2,v=d.unproject([0,g]),w=d.unproject([p,g]),T=v.distanceTo(w);if(l&&l.unit==="imperial"){const I=3.2808*T;I>5280?Ts(r,p,I/5280,d._getUIString("ScaleControl.Miles"),d):Ts(r,p,I,d._getUIString("ScaleControl.Feet"),d)}else l&&l.unit==="nautical"?Ts(r,p,T/1852,d._getUIString("ScaleControl.NauticalMiles"),d):T>=1e3?Ts(r,p,T/1e3,d._getUIString("ScaleControl.Kilometers"),d):Ts(r,p,T,d._getUIString("ScaleControl.Meters"),d)}function Ts(d,r,l,p,g){const v=function(T){const I=Math.pow(10,`${Math.floor(T)}`.length-1);let A=T/I;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(z){const L=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*L)/L}(A),I*A}(l),w=v/l;g._requestDomTask(()=>{d.style.width=r*w+"px",d.innerHTML=`${v}&nbsp;${p}`})}const Od={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ba=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),mo={version:a.version,supported:O,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Pd{constructor(d){if((d=a.extend({},um,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ma(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._renderTaskQueue=new bu,this._domRenderTaskQueue=new bu,this._controls=[],this._markers=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Dd,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new $i(0),this._requestManager=new a.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,typeof d.container=="string"){if(this._container=a.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof xs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new vs(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new wd(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,a.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new xu({customAttribution:d.customAttribution})),this._logoControl=new wu,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new a.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new a.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(d,r){if(r===void 0&&(r=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=d.onAdd(this);this._controls.push(d);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(d);return r>-1&&this._controls.splice(r,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new a.Event("movestart",d)).fire(new a.Event("move",d)),this.fire(new a.Event("resize",d)),r&&this.fire(new a.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(a.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d==null?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d==null?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d==null?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d==null?85:d)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getProjection(){return this.transform.getProjection()}setProjection(d){return this._lazyInitEmptyStyle(),typeof d=="string"&&(d={name:d}),this._runtimeProjection=d,this.style.updateProjection(),this._transitionFromGlobe=!1,this}project(d){return this.transform.locationPoint3D(a.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(a.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(d,r,l){if(d==="mouseenter"||d==="mouseover"){let p=!1;const g=w=>{const T=r.filter(A=>this.getLayer(A)),I=T.length?this.queryRenderedFeatures(w.point,{layers:T}):[];I.length?p||(p=!0,l.call(this,new nn(d,this,w.originalEvent,{features:I}))):p=!1},v=()=>{p=!1};return{layers:new Set(r),listener:l,delegates:{mousemove:g,mouseout:v}}}if(d==="mouseleave"||d==="mouseout"){let p=!1;const g=w=>{const T=r.filter(I=>this.getLayer(I));(T.length?this.queryRenderedFeatures(w.point,{layers:T}):[]).length?p=!0:p&&(p=!1,l.call(this,new nn(d,this,w.originalEvent)))},v=w=>{p&&(p=!1,l.call(this,new nn(d,this,w.originalEvent)))};return{layers:new Set(r),listener:l,delegates:{mousemove:g,mouseout:v}}}{const p=g=>{const v=r.filter(T=>this.getLayer(T)),w=v.length?this.queryRenderedFeatures(g.point,{layers:v}):[];w.length&&(g.features=w,l.call(this,g),delete g.features)};return{layers:new Set(r),listener:l,delegates:{[d]:p}}}}on(d,r,l){if(l===void 0)return super.on(d,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(d,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(p);for(const g in p.delegates)this.on(g,p.delegates[g]);return this}once(d,r,l){if(l===void 0)return super.once(d,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(d,r,l);for(const g in p.delegates)this.once(g,p.delegates[g]);return this}off(d,r,l){if(l===void 0)return super.off(d,r);r=new Set(Array.isArray(r)?r:[r]);const p=(v,w)=>{if(v.size!==w.size)return!1;for(const T of v)if(!w.has(T))return!1;return!0},g=this._delegatedListeners?this._delegatedListeners[d]:void 0;return g&&(v=>{for(let w=0;w<v.length;w++){const T=v[w];if(T.listener===l&&p(T.layers,r)){for(const I in T.delegates)this.off(I,T.delegates[I]);return v.splice(w,1),this}}})(g),this}queryRenderedFeatures(d,r){return this.style?(r!==void 0||d===void 0||d instanceof a.pointGeometry||Array.isArray(d)||(r=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(d,r){return this.style.querySourceFeatures(d,r)}queryTerrainElevation(d,r){const l=this.transform.elevation;return l?(r=a.extend({},{exaggerated:!0},r),l.getAtPoint(a.MercatorCoordinate.fromLngLat(d),null,r.exaggerated)):null}setStyle(d,r){return(r=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(d,r))}_getUIString(d){const r=this._locale[d];if(r==null)throw new Error(`Missing UI string '${d}'`);return r}_updateStyle(d,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),d&&(this.style=new wn(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new wn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,r){if(typeof d=="string"){const l=this._requestManager.normalizeStyleURL(d),p=this._requestManager.transformRequest(l,a.ResourceType.Style);a.getJSON(p,(g,v)=>{g?this.fire(new a.ErrorEvent(g)):v&&this._updateDiff(v,r)})}else typeof d=="object"&&this._updateDiff(d,r)}_updateDiff(d,r){try{this.style.setState(d)&&this._update(!0)}catch(l){a.warnOnce(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(d,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(d,r){return this._lazyInitEmptyStyle(),this.style.addSource(d,r),this._update(!0)}isSourceLoaded(d){const r=this.style&&this.style._getSourceCaches(d);if(r.length!==0)return r.every(l=>l.loaded());this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${d}'`)))}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const r in d){const l=d[r]._tiles;for(const p in l){const g=l[p];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}addSourceType(d,r,l){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,r,l)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,r,{pixelRatio:l=1,sdf:p=!1,stretchX:g,stretchY:v,content:w}={}){if(this._lazyInitEmptyStyle(),r instanceof di||ws&&r instanceof ws){const{width:T,height:I,data:A}=a.exported.getImageData(r);this.style.addImage(d,{data:new a.RGBAImage({width:T,height:I},A),pixelRatio:l,stretchX:g,stretchY:v,content:w,sdf:p,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:I,data:A}=r,z=r;this.style.addImage(d,{data:new a.RGBAImage({width:T,height:I},new Uint8Array(A)),pixelRatio:l,stretchX:g,stretchY:v,content:w,sdf:p,version:0,userImage:z}),z.onAdd&&z.onAdd(this,d)}}}updateImage(d,r){const l=this.style.getImage(d);if(!l)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof di||ws&&r instanceof ws?a.exported.getImageData(r):r,{width:g,height:v,data:w}=p;return g===void 0||v===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):g!==l.data.width||v!==l.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(l.data.replace(w,!(r instanceof di||ws&&r instanceof ws)),void this.style.updateImage(d,l))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,r){a.getImage(this._requestManager.transformRequest(d,a.ResourceType.Image),(l,p)=>{r(l,p instanceof di?a.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(d,r){return this._lazyInitEmptyStyle(),this.style.addLayer(d,r),this._update(!0)}moveLayer(d,r){return this.style.moveLayer(d,r),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,r,l){return this.style.setLayerZoomRange(d,r,l),this._update(!0)}setFilter(d,r,l={}){return this.style.setFilter(d,r,l),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,r,l,p={}){return this.style.setPaintProperty(d,r,l,p),this._update(!0)}getPaintProperty(d,r){return this.style.getPaintProperty(d,r)}setLayoutProperty(d,r,l,p={}){return this.style.setLayoutProperty(d,r,l,p),this._update(!0)}getLayoutProperty(d,r){return this.style.getLayoutProperty(d,r)}setLight(d,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}_updateProjection(){this.transform.projection.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX&&!this._transitionFromGlobe&&(this.setProjection({name:"mercator"}),this._transitionFromGlobe=!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(d),this.transform):0}setFeatureState(d,r){return this.style.setFeatureState(d,r),this._update()}removeFeatureState(d,r){return this.style.removeFeatureState(d,r),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p=this._container;for(;p&&!l;){const g=a.window.getComputedStyle(p).transform;g&&g!=="none"&&(l=g.match(/matrix.*\((.+)\)/)[1].split(", ")),p=p.parentElement}l?(this._containerWidth=l[0]&&l[0]!=="0"?Math.abs(d/l[0]):d,this._containerHeight=l[3]&&l[3]!=="0"?Math.abs(r/l[3]):r):(this._containerWidth=d,this._containerHeight=r)}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=se.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=se.create("div","mapboxgl-canvas-container",d);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=se.create("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=se.create("div","mapboxgl-control-container",d),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=se.create("div",`mapboxgl-ctrl-${g}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,r){const l=a.exported.devicePixelRatio||1;this._canvas.width=l*Math.ceil(d),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${r}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const r=this._markers.indexOf(d);r!==-1&&this._markers.splice(r,1)}_setupPainter(){const d=a.extend({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);r?(a.storeAuthState(r,!0),this.painter=new gd(r,this.transform),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(r)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let r;const l=this.painter.context.extTimerQuery,p=a.exported.now();this.listens("gpu-timing-frame")&&(r=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,r));let g=this._updateAverageElevation(p);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjection();let v=!1;const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,A=this.transform.pitch,z=a.exported.now();this.style.zoomHistory.update(I,z);const L=new a.EvaluationParameters(I,{now:z,fadeDuration:w,pitch:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),F=L.crossFadingFactor();F===1&&F===this._crossFadingFactor||(v=!0,this._crossFadingFactor=F),this.style.update(L)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||v)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const I=a.exported.now()-p;l.endQueryEXT(l.TIME_ELAPSED_EXT,r),setTimeout(()=>{const A=l.getQueryObjectEXT(r,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(r),this.fire(new a.Event("gpu-timing-frame",{cpuTime:I,gpuTime:A}))},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const A=this.painter.queryGpuTimers(I);this.fire(new a.Event("gpu-timing-layer",{layerTimes:A}))},50)}const T=this._sourcesDirty||this._styleDirty||this._placementDirty||g;if(T||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(g=this._updateAverageElevation(p,!0)),g)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const A=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:A})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||T||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const d of this._markers)d._update()}_updateAverageElevation(d,r=!1){const l=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);if((r||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const p=this.transform.averageElevation;let g=this.transform.sampleAverageElevation();isNaN(g)?g=0:this._averageElevationLastSampledAt=d;const v=Math.abs(p-g);if(v>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(g),l(g);this._averageElevation.easeTo(g,d,300)}else if(v>1e-4)return this._averageElevation.jumpTo(g),l(g)}return!!this._averageElevation.isEasing(d)&&l(this._averageElevation.getValue(d))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===a.AUTH_ERR_MSG||d.status===401)){const r=this.painter.context.gl;a.storeAuthState(r,!1),this._logoControl instanceof wu&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function g(v){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,v,0);const w=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,w),w}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(g(d),r.canvasCopies.map(g),r.timeStamps)}_canvasPixelComparison(d,r,l){let p=l[1]-l[0];const g=d.length/4;for(let v=0;v<r.length;v++){const w=r[v];let T=0;for(let I=0;I<w.length;I+=4)w[I]===d[I]&&w[I+1]===d[I+1]&&w[I+2]===d[I+2]&&w[I+3]===d[I+3]&&(T+=1);p+=(l[v+2]-l[v+1])*(1-T/g)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),Eu(this._canvasContainer),Eu(this._controlContainer),Eu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=a.exported.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(d){const r=this.style&&Object.values(this.style._sourceCaches)||[];return a.asyncAll(r,(l,p)=>l._preloadTiles(d,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,r){a.setCacheLimits(d,r)}get version(){return a.version}},NavigationControl:class{constructor(d){this.options=a.extend({},hm,d),this._container=se.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),se.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),se.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=se.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const d=this._map.getZoom(),r=d===this._map.getMaxZoom(),l=d===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())}_rotateCompassArrow(){const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ld(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){this._container.remove(),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,r){const l=se.create("button",d,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(d,r){const l=this._map._getUIString(`NavigationControl.${r}`);d.setAttribute("aria-label",l),d.firstElementChild&&d.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends a.Evented{constructor(d){super(),this.options=a.extend({},La,d),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=fo(this._updateMarkerRotation,20)}onAdd(d){var r;return this._map=d,this._container=se.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,pn!==void 0?r(pn):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(l=>{pn=l.state!=="denied",r(pn)}):(pn=!!a.window.navigator.geolocation,r(pn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,Oa=0,bs=!1}_isOutOfMapMaxBounds(d){const r=this._map.getMaxBounds(),l=d.coords;return r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",d)),this._finish()}}_updateCamera(d){const r=new a.LngLat(d.coords.longitude,d.coords.latitude),l=d.coords.accuracy,p=this._map.getBearing(),g=a.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),g,{geolocateSource:!0})}_updateMarker(d){if(d){const r=new a.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map._containerHeight/2,r=this._map.unproject([0,d]),l=this._map.unproject([100,d]),p=r.distanceTo(l)/100,g=Math.ceil(2*this._accuracy/p);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&bs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=se.create("button","mapboxgl-ctrl-geolocate",this._container),se.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",d===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=se.create("div","mapboxgl-user-location"),this._dotElement.appendChild(se.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(se.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Su({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=se.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Su({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Oa--,bs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Oa++,Oa>1?(d={maximumAge:6e5,timeout:0},bs=!0):(d=this.options.positionOptions,bs=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&d()}).catch(console.error):d()}_clearWatch(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xu,ScaleControl:class{constructor(d){this.options=a.extend({},Ra,d),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){rt(this._map,this._container,this.options)}onAdd(d){return this._map=d,this._container=se.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(d){this.options.unit=d,rt(this._map,this._container,this.options)}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof a.window.HTMLElement?this._container=d.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=se.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=se.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);se.create("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(d){super(),this.options=a.extend(Object.create(Od),d),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&this._content.remove(),this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=a.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(a.window.document.createTextNode(d))}setHTML(d){const r=a.window.document.createDocumentFragment(),l=a.window.document.createElement("body");let p;for(l.innerHTML=d;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=se.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._container&&this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._container&&this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let r;return this._classList.delete(d)?r=!1:(this._classList.add(d),r=!0),this._container&&this._updateClassList(),r}_createCloseButton(){this.options.closeButton&&(this._closeButton=se.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(d){this._update(d.point)}_onMouseMove(d){this._update(d.point)}_onDrag(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const r=this._pos,l=this._container.offsetWidth,p=this._container.offsetHeight;let g;return g=r.y+d.bottom.y<p?["top"]:r.y>this._map.transform.height-p?["bottom"]:[],r.x<l/2?g.push("left"):r.x>this._map.transform.width-l/2&&g.push("right"),g.length===0?"bottom":g.join("-")}_updateClassList(){const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),this._container.className=d.join(" ")}_update(d){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=se.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=se.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tu(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||d){const r=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat),l=function(v){if(v||(v=new a.pointGeometry(0,0)),typeof v=="number"){const w=Math.round(Math.sqrt(.5*Math.pow(v,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,v),"top-left":new a.pointGeometry(w,w),"top-right":new a.pointGeometry(-w,w),bottom:new a.pointGeometry(0,-v),"bottom-left":new a.pointGeometry(w,-w),"bottom-right":new a.pointGeometry(-w,-w),left:new a.pointGeometry(v,0),right:new a.pointGeometry(-v,0)}}if(v instanceof a.pointGeometry||Array.isArray(v)){const w=a.pointGeometry.convert(v);return{center:w,top:w,"top-left":w,"top-right":w,bottom:w,"bottom-left":w,"bottom-right":w,left:w,right:w}}return{center:a.pointGeometry.convert(v.center||[0,0]),top:a.pointGeometry.convert(v.top||[0,0]),"top-left":a.pointGeometry.convert(v["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(v["top-right"]||[0,0]),bottom:a.pointGeometry.convert(v.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(v["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(v["bottom-right"]||[0,0]),left:a.pointGeometry.convert(v.left||[0,0]),right:a.pointGeometry.convert(v.right||[0,0])}}(this.options.offset),p=this._anchor=this._getAnchor(l),g=r.add(l[p]).round();this._map._requestDomTask(()=>{this._container&&p&&(this._container.style.transform=`${Yr[p]} translate(${g.x}px,${g.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Ba);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._content&&(this._content.style.opacity=d),this._tip&&(this._tip.style.opacity=d)}},Marker:Su,Style:wn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:vd,Evented:a.Evented,config:a.config,prewarm:function(){ue().acquire(ae)},clearPrewarmedResources:function(){const d=_e;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(ae),_e=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(d){a.config.ACCESS_TOKEN=d},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(d){a.config.API_URL=d},get workerCount(){return me.workerCount},set workerCount(d){me.workerCount=d},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){a.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return mo});var k=_;return k})})(w2);var BA=w2.exports;/*!
 * Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 */var FA={prefix:"fas",iconName:"cloud",icon:[640,512,[],"f0c2","M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4z"]},UA={prefix:"fas",iconName:"code",icon:[640,512,[],"f121","M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"]},NA={prefix:"fas",iconName:"envelope",icon:[512,512,[],"f0e0","M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"]},jA={prefix:"fas",iconName:"lock",icon:[448,512,[],"f023","M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"]},VA={prefix:"fas",iconName:"map-marked-alt",icon:[576,512,[],"f5a0","M288 0c-69.59 0-126 56.41-126 126 0 56.26 82.35 158.8 113.9 196.02 6.39 7.54 17.82 7.54 24.2 0C331.65 284.8 414 182.26 414 126 414 56.41 357.59 0 288 0zm0 168c-23.2 0-42-18.8-42-42s18.8-42 42-42 42 18.8 42 42-18.8 42-42 42zM20.12 215.95A32.006 32.006 0 0 0 0 245.66v250.32c0 11.32 11.43 19.06 21.94 14.86L160 448V214.92c-8.84-15.98-16.07-31.54-21.25-46.42L20.12 215.95zM288 359.67c-14.07 0-27.38-6.18-36.51-16.96-19.66-23.2-40.57-49.62-59.49-76.72v182l192 64V266c-18.92 27.09-39.82 53.52-59.49 76.72-9.13 10.77-22.44 16.95-36.51 16.95zm266.06-198.51L416 224v288l139.88-55.95A31.996 31.996 0 0 0 576 426.34V176.02c0-11.32-11.43-19.06-21.94-14.86z"]},$A={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},GA={prefix:"fas",iconName:"phone-alt",icon:[512,512,[],"f879","M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z"]},ZA={prefix:"fas",iconName:"wrench",icon:[512,512,[],"f0ad","M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"]};/*!
 * Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 */function RI(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")}function T2(i,o){for(var u=0;u<o.length;u++){var m=o[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}function BI(i,o,u){return o&&T2(i.prototype,o),u&&T2(i,u),i}function FI(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}function sr(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{},m=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(m=m.concat(Object.getOwnPropertySymbols(u).filter(function(_){return Object.getOwnPropertyDescriptor(u,_).enumerable}))),m.forEach(function(_){FI(i,_,u[_])})}return i}function S2(i,o){return UI(i)||NI(i,o)||jI()}function UI(i){if(Array.isArray(i))return i}function NI(i,o){var u=[],m=!0,_=!1,S=void 0;try{for(var k=i[Symbol.iterator](),a;!(m=(a=k.next()).done)&&(u.push(a.value),!(o&&u.length===o));m=!0);}catch(O){_=!0,S=O}finally{try{!m&&k.return!=null&&k.return()}finally{if(_)throw S}}return u}function jI(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var E2=function(){},rv={},C2={},VI=null,k2={mark:E2,measure:E2};try{typeof window!="undefined"&&(rv=window),typeof document!="undefined"&&(C2=document),typeof MutationObserver!="undefined"&&(VI=MutationObserver),typeof performance!="undefined"&&(k2=performance)}catch{}var $I=rv.navigator||{},M2=$I.userAgent,I2=M2===void 0?"":M2,qf=rv,Vn=C2,Wf=k2;qf.document;var nv=!!Vn.documentElement&&!!Vn.head&&typeof Vn.addEventListener=="function"&&typeof Vn.createElement=="function";~I2.indexOf("MSIE")||~I2.indexOf("Trident/");var Jo="___FONT_AWESOME___",A2="fa",z2="svg-inline--fa",GI="data-fa-i2svg";(function(){try{return!0}catch{return!1}})();var iv={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},P2=qf.FontAwesomeConfig||{};function ZI(i){var o=Vn.querySelector("script["+i+"]");if(o)return o.getAttribute(i)}function qI(i){return i===""?!0:i==="false"?!1:i==="true"?!0:i}if(Vn&&typeof Vn.querySelector=="function"){var WI=[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];WI.forEach(function(i){var o=S2(i,2),u=o[0],m=o[1],_=qI(ZI(u));_!=null&&(P2[m]=_)})}var HI={familyPrefix:A2,replacementClass:z2,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},ov=sr({},HI,P2);ov.autoReplaceSvg||(ov.observeMutations=!1);var vi=sr({},ov);qf.FontAwesomeConfig=vi;var Qo=qf||{};Qo[Jo]||(Qo[Jo]={});Qo[Jo].styles||(Qo[Jo].styles={});Qo[Jo].hooks||(Qo[Jo].hooks={});Qo[Jo].shims||(Qo[Jo].shims=[]);var Io=Qo[Jo],XI=[],YI=function i(){Vn.removeEventListener("DOMContentLoaded",i),sv=1,XI.map(function(o){return o()})},sv=!1;nv&&(sv=(Vn.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Vn.readyState),sv||Vn.addEventListener("DOMContentLoaded",YI));typeof global!="undefined"&&typeof global.process!="undefined"&&global.process.emit;var Wc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function KI(i){if(!(!i||!nv)){var o=Vn.createElement("style");o.setAttribute("type","text/css"),o.innerHTML=i;for(var u=Vn.head.childNodes,m=null,_=u.length-1;_>-1;_--){var S=u[_],k=(S.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(k)>-1&&(m=S)}return Vn.head.insertBefore(o,m),i}}var JI="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Hf(){for(var i=12,o="";i-- >0;)o+=JI[Math.random()*62|0];return o}function D2(i){return"".concat(i).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function QI(i){return Object.keys(i||{}).reduce(function(o,u){return o+"".concat(u,'="').concat(D2(i[u]),'" ')},"").trim()}function L2(i){return Object.keys(i||{}).reduce(function(o,u){return o+"".concat(u,": ").concat(i[u],";")},"")}function O2(i){return i.size!==Wc.size||i.x!==Wc.x||i.y!==Wc.y||i.rotate!==Wc.rotate||i.flipX||i.flipY}function R2(i){var o=i.transform,u=i.containerWidth,m=i.iconWidth,_={transform:"translate(".concat(u/2," 256)")},S="translate(".concat(o.x*32,", ").concat(o.y*32,") "),k="scale(".concat(o.size/16*(o.flipX?-1:1),", ").concat(o.size/16*(o.flipY?-1:1),") "),a="rotate(".concat(o.rotate," 0 0)"),O={transform:"".concat(S," ").concat(k," ").concat(a)},X={transform:"translate(".concat(m/2*-1," -256)")};return{outer:_,inner:O,path:X}}var av={x:0,y:0,width:"100%",height:"100%"};function B2(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return i.attributes&&(i.attributes.fill||o)&&(i.attributes.fill="black"),i}function eA(i){return i.tag==="g"?i.children:[i]}function tA(i){var o=i.children,u=i.attributes,m=i.main,_=i.mask,S=i.maskId,k=i.transform,a=m.width,O=m.icon,X=_.width,xe=_.icon,ce=R2({transform:k,containerWidth:X,iconWidth:a}),he={tag:"rect",attributes:sr({},av,{fill:"white"})},se=O.children?{children:O.children.map(B2)}:{},De={tag:"g",attributes:sr({},ce.inner),children:[B2(sr({tag:O.tag,attributes:sr({},O.attributes,ce.path)},se))]},Te={tag:"g",attributes:sr({},ce.outer),children:[De]},ne="mask-".concat(S||Hf()),Y="clip-".concat(S||Hf()),Q={tag:"mask",attributes:sr({},av,{id:ne,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[he,Te]},ge={tag:"defs",children:[{tag:"clipPath",attributes:{id:Y},children:eA(xe)},Q]};return o.push(ge,{tag:"rect",attributes:sr({fill:"currentColor","clip-path":"url(#".concat(Y,")"),mask:"url(#".concat(ne,")")},av)}),{children:o,attributes:u}}function rA(i){var o=i.children,u=i.attributes,m=i.main,_=i.transform,S=i.styles,k=L2(S);if(k.length>0&&(u.style=k),O2(_)){var a=R2({transform:_,containerWidth:m.width,iconWidth:m.width});o.push({tag:"g",attributes:sr({},a.outer),children:[{tag:"g",attributes:sr({},a.inner),children:[{tag:m.icon.tag,children:m.icon.children,attributes:sr({},m.icon.attributes,a.path)}]}]})}else o.push(m.icon);return{children:o,attributes:u}}function nA(i){var o=i.children,u=i.main,m=i.mask,_=i.attributes,S=i.styles,k=i.transform;if(O2(k)&&u.found&&!m.found){var a=u.width,O=u.height,X={x:a/O/2,y:.5};_.style=L2(sr({},S,{"transform-origin":"".concat(X.x+k.x/16,"em ").concat(X.y+k.y/16,"em")}))}return[{tag:"svg",attributes:_,children:o}]}function iA(i){var o=i.prefix,u=i.iconName,m=i.children,_=i.attributes,S=i.symbol,k=S===!0?"".concat(o,"-").concat(vi.familyPrefix,"-").concat(u):S;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:sr({},_,{id:k}),children:m}]}]}function oA(i){var o=i.icons,u=o.main,m=o.mask,_=i.prefix,S=i.iconName,k=i.transform,a=i.symbol,O=i.title,X=i.maskId,xe=i.titleId,ce=i.extra,he=i.watchable,se=he===void 0?!1:he,De=m.found?m:u,Te=De.width,ne=De.height,Y=_==="fak",Q=Y?"":"fa-w-".concat(Math.ceil(Te/ne*16)),ge=[vi.replacementClass,S?"".concat(vi.familyPrefix,"-").concat(S):"",Q].filter(function(nt){return ce.classes.indexOf(nt)===-1}).filter(function(nt){return nt!==""||!!nt}).concat(ce.classes).join(" "),we={children:[],attributes:sr({},ce.attributes,{"data-prefix":_,"data-icon":S,class:ge,role:ce.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(Te," ").concat(ne)})},He=Y&&!~ce.classes.indexOf("fa-fw")?{width:"".concat(Te/ne*16*.0625,"em")}:{};se&&(we.attributes[GI]=""),O&&we.children.push({tag:"title",attributes:{id:we.attributes["aria-labelledby"]||"title-".concat(xe||Hf())},children:[O]});var Ee=sr({},we,{prefix:_,iconName:S,main:u,mask:m,maskId:X,transform:k,symbol:a,styles:sr({},He,ce.styles)}),Qe=m.found&&u.found?tA(Ee):rA(Ee),Ve=Qe.children,Fe=Qe.attributes;return Ee.children=Ve,Ee.attributes=Fe,a?iA(Ee):nA(Ee)}var F2=function(){};vi.measurePerformance&&Wf&&Wf.mark&&Wf.measure;var sA=function(o,u){return function(m,_,S,k){return o.call(u,m,_,S,k)}},lv=function(o,u,m,_){var S=Object.keys(o),k=S.length,a=_!==void 0?sA(u,_):u,O,X,xe;for(m===void 0?(O=1,xe=o[S[0]]):(O=0,xe=m);O<k;O++)X=S[O],xe=a(xe,o[X],X,o);return xe};function U2(i,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=u.skipHooks,_=m===void 0?!1:m,S=Object.keys(o).reduce(function(k,a){var O=o[a],X=!!O.icon;return X?k[O.iconName]=O.icon:k[a]=O,k},{});typeof Io.hooks.addPack=="function"&&!_?Io.hooks.addPack(i,S):Io.styles[i]=sr({},Io.styles[i]||{},S),i==="fas"&&U2("fa",o)}var N2=Io.styles,aA=Io.shims,j2=function(){var o=function(_){return lv(N2,function(S,k,a){return S[a]=lv(k,_,{}),S},{})};o(function(m,_,S){return _[3]&&(m[_[3]]=S),m}),o(function(m,_,S){var k=_[2];return m[S]=S,k.forEach(function(a){m[a]=S}),m});var u="far"in N2;lv(aA,function(m,_){var S=_[0],k=_[1],a=_[2];return k==="far"&&!u&&(k="fas"),m[S]={prefix:k,iconName:a},m},{})};j2();Io.styles;function V2(i,o,u){if(i&&i[o]&&i[o][u])return{prefix:o,iconName:u,icon:i[o][u]}}function $2(i){var o=i.tag,u=i.attributes,m=u===void 0?{}:u,_=i.children,S=_===void 0?[]:_;return typeof i=="string"?D2(i):"<".concat(o," ").concat(QI(m),">").concat(S.map($2).join(""),"</").concat(o,">")}var lA=function(o){var u={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return o?o.toLowerCase().split(" ").reduce(function(m,_){var S=_.toLowerCase().split("-"),k=S[0],a=S.slice(1).join("-");if(k&&a==="h")return m.flipX=!0,m;if(k&&a==="v")return m.flipY=!0,m;if(a=parseFloat(a),isNaN(a))return m;switch(k){case"grow":m.size=m.size+a;break;case"shrink":m.size=m.size-a;break;case"left":m.x=m.x-a;break;case"right":m.x=m.x+a;break;case"up":m.y=m.y-a;break;case"down":m.y=m.y+a;break;case"rotate":m.rotate=m.rotate+a;break}return m},u):u};function cv(i){this.name="MissingIcon",this.message=i||"Icon unavailable",this.stack=new Error().stack}cv.prototype=Object.create(Error.prototype);cv.prototype.constructor=cv;var Xf={fill:"currentColor"},G2={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};sr({},Xf,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"});var uv=sr({},G2,{attributeName:"opacity"});sr({},Xf,{cx:"256",cy:"364",r:"28"}),sr({},G2,{attributeName:"r",values:"28;14;28;28;14;28;"}),sr({},uv,{values:"1;0;1;1;0;1;"});sr({},Xf,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),sr({},uv,{values:"1;0;0;0;0;1;"});sr({},Xf,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),sr({},uv,{values:"0;0;1;1;0;0;"});Io.styles;function Z2(i){var o=i[0],u=i[1],m=i.slice(4),_=S2(m,1),S=_[0],k=null;return Array.isArray(S)?k={tag:"g",attributes:{class:"".concat(vi.familyPrefix,"-").concat(iv.GROUP)},children:[{tag:"path",attributes:{class:"".concat(vi.familyPrefix,"-").concat(iv.SECONDARY),fill:"currentColor",d:S[0]}},{tag:"path",attributes:{class:"".concat(vi.familyPrefix,"-").concat(iv.PRIMARY),fill:"currentColor",d:S[1]}}]}:k={tag:"path",attributes:{fill:"currentColor",d:S}},{found:!0,width:o,height:u,icon:k}}Io.styles;var cA=`svg:not(:root).svg-inline--fa {
  overflow: visible;
}

.svg-inline--fa {
  display: inline-block;
  font-size: inherit;
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.225em;
}
.svg-inline--fa.fa-w-1 {
  width: 0.0625em;
}
.svg-inline--fa.fa-w-2 {
  width: 0.125em;
}
.svg-inline--fa.fa-w-3 {
  width: 0.1875em;
}
.svg-inline--fa.fa-w-4 {
  width: 0.25em;
}
.svg-inline--fa.fa-w-5 {
  width: 0.3125em;
}
.svg-inline--fa.fa-w-6 {
  width: 0.375em;
}
.svg-inline--fa.fa-w-7 {
  width: 0.4375em;
}
.svg-inline--fa.fa-w-8 {
  width: 0.5em;
}
.svg-inline--fa.fa-w-9 {
  width: 0.5625em;
}
.svg-inline--fa.fa-w-10 {
  width: 0.625em;
}
.svg-inline--fa.fa-w-11 {
  width: 0.6875em;
}
.svg-inline--fa.fa-w-12 {
  width: 0.75em;
}
.svg-inline--fa.fa-w-13 {
  width: 0.8125em;
}
.svg-inline--fa.fa-w-14 {
  width: 0.875em;
}
.svg-inline--fa.fa-w-15 {
  width: 0.9375em;
}
.svg-inline--fa.fa-w-16 {
  width: 1em;
}
.svg-inline--fa.fa-w-17 {
  width: 1.0625em;
}
.svg-inline--fa.fa-w-18 {
  width: 1.125em;
}
.svg-inline--fa.fa-w-19 {
  width: 1.1875em;
}
.svg-inline--fa.fa-w-20 {
  width: 1.25em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: 0.3em;
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: 0.3em;
  width: auto;
}
.svg-inline--fa.fa-border {
  height: 1.5em;
}
.svg-inline--fa.fa-li {
  width: 2em;
}
.svg-inline--fa.fa-fw {
  width: 1.25em;
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: #ff253a;
  border-radius: 1em;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  color: #fff;
  height: 1.5em;
  line-height: 1;
  max-width: 5em;
  min-width: 1.5em;
  overflow: hidden;
  padding: 0.25em;
  right: 0;
  text-overflow: ellipsis;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: 0;
  right: 0;
  top: auto;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: 0;
  left: 0;
  right: auto;
  top: auto;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  right: 0;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: 0;
  right: auto;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-lg {
  font-size: 1.3333333333em;
  line-height: 0.75em;
  vertical-align: -0.0667em;
}

.fa-xs {
  font-size: 0.75em;
}

.fa-sm {
  font-size: 0.875em;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: 2.5em;
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: -2em;
  position: absolute;
  text-align: center;
  width: 2em;
  line-height: inherit;
}

.fa-border {
  border: solid 0.08em #eee;
  border-radius: 0.1em;
  padding: 0.2em 0.25em 0.15em;
}

.fa-pull-left {
  float: left;
}

.fa-pull-right {
  float: right;
}

.fa.fa-pull-left,
.fas.fa-pull-left,
.far.fa-pull-left,
.fal.fa-pull-left,
.fab.fa-pull-left {
  margin-right: 0.3em;
}
.fa.fa-pull-right,
.fas.fa-pull-right,
.far.fa-pull-right,
.fal.fa-pull-right,
.fab.fa-pull-right {
  margin-left: 0.3em;
}

.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
          animation: fa-spin 2s infinite linear;
}

.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
          animation: fa-spin 1s infinite steps(8);
}

@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}

@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical,
:root .fa-flip-both {
  -webkit-filter: none;
          filter: none;
}

.fa-stack {
  display: inline-block;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: #fff;
}

.sr-only {
  border: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

.sr-only-focusable:active, .sr-only-focusable:focus {
  clip: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  position: static;
  width: auto;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: 1;
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: 0.4;
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: 0.4;
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: 1;
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse {
  color: #fff;
}`;function uA(){var i=A2,o=z2,u=vi.familyPrefix,m=vi.replacementClass,_=cA;if(u!==i||m!==o){var S=new RegExp("\\.".concat(i,"\\-"),"g"),k=new RegExp("\\--".concat(i,"\\-"),"g"),a=new RegExp("\\.".concat(o),"g");_=_.replace(S,".".concat(u,"-")).replace(k,"--".concat(u,"-")).replace(a,".".concat(m))}return _}var hA=function(){function i(){RI(this,i),this.definitions={}}return BI(i,[{key:"add",value:function(){for(var u=this,m=arguments.length,_=new Array(m),S=0;S<m;S++)_[S]=arguments[S];var k=_.reduce(this._pullDefinitions,{});Object.keys(k).forEach(function(a){u.definitions[a]=sr({},u.definitions[a]||{},k[a]),U2(a,k[a]),j2()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(u,m){var _=m.prefix&&m.iconName&&m.icon?{0:m}:m;return Object.keys(_).map(function(S){var k=_[S],a=k.prefix,O=k.iconName,X=k.icon;u[a]||(u[a]={}),u[a][O]=X}),u}}]),i}();function dA(){vi.autoAddCss&&!W2&&(KI(uA()),W2=!0)}function pA(i,o){return Object.defineProperty(i,"abstract",{get:o}),Object.defineProperty(i,"html",{get:function(){return i.abstract.map(function(m){return $2(m)})}}),Object.defineProperty(i,"node",{get:function(){if(!!nv){var m=Vn.createElement("div");return m.innerHTML=i.html,m.children}}}),i}function q2(i){var o=i.prefix,u=o===void 0?"fa":o,m=i.iconName;if(!!m)return V2(mA.definitions,u,m)||V2(Io.styles,u,m)}function fA(i){return function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=(o||{}).icon?o:q2(o||{}),_=u.mask;return _&&(_=(_||{}).icon?_:q2(_||{})),i(m,sr({},u,{mask:_}))}}var mA=new hA,W2=!1,_A={transform:function(o){return lA(o)}},gA=fA(function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=o.transform,m=u===void 0?Wc:u,_=o.symbol,S=_===void 0?!1:_,k=o.mask,a=k===void 0?null:k,O=o.maskId,X=O===void 0?null:O,xe=o.title,ce=xe===void 0?null:xe,he=o.titleId,se=he===void 0?null:he,De=o.classes,Te=De===void 0?[]:De,ne=o.attributes,Y=ne===void 0?{}:ne,Q=o.styles,ge=Q===void 0?{}:Q;if(!!i){var we=i.prefix,He=i.iconName,Ee=i.icon;return pA(sr({type:"icon"},i),function(){return dA(),vi.autoA11y&&(ce?Y["aria-labelledby"]="".concat(vi.replacementClass,"-title-").concat(se||Hf()):(Y["aria-hidden"]="true",Y.focusable="false")),oA({icons:{main:Z2(Ee),mask:a?Z2(a.icon):{found:!1,width:null,height:null,icon:{}}},prefix:we,iconName:He,transform:sr({},Wc,m),symbol:S,title:ce,maskId:X,titleId:se,extra:{attributes:Y,styles:ge,classes:Te}})})}}),H2={exports:{}},yA="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",vA=yA,xA=vA;function X2(){}function Y2(){}Y2.resetWarningCache=X2;var wA=function(){function i(m,_,S,k,a,O){if(O!==xA){var X=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw X.name="Invariant Violation",X}}i.isRequired=i;function o(){return i}var u={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:Y2,resetWarningCache:X2};return u.PropTypes=u,u};H2.exports=wA();var tr=H2.exports;function K2(i,o){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);o&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),u.push.apply(u,m)}return u}function ra(i){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?K2(Object(u),!0).forEach(function(m){Hc(i,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(u)):K2(Object(u)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(u,m))})}return i}function Yf(i){return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Yf(i)}function Hc(i,o,u){return o in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}function bA(i,o){if(i==null)return{};var u={},m=Object.keys(i),_,S;for(S=0;S<m.length;S++)_=m[S],!(o.indexOf(_)>=0)&&(u[_]=i[_]);return u}function J2(i,o){if(i==null)return{};var u=bA(i,o),m,_;if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(i);for(_=0;_<S.length;_++)m=S[_],!(o.indexOf(m)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,m)||(u[m]=i[m]))}return u}function hv(i){return TA(i)||SA(i)||EA(i)||CA()}function TA(i){if(Array.isArray(i))return dv(i)}function SA(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function EA(i,o){if(!!i){if(typeof i=="string")return dv(i,o);var u=Object.prototype.toString.call(i).slice(8,-1);if(u==="Object"&&i.constructor&&(u=i.constructor.name),u==="Map"||u==="Set")return Array.from(i);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return dv(i,o)}}function dv(i,o){(o==null||o>i.length)&&(o=i.length);for(var u=0,m=new Array(o);u<o;u++)m[u]=i[u];return m}function CA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kA(i){var o,u=i.beat,m=i.fade,_=i.flash,S=i.spin,k=i.spinPulse,a=i.spinReverse,O=i.pulse,X=i.fixedWidth,xe=i.inverse,ce=i.border,he=i.listItem,se=i.flip,De=i.size,Te=i.rotation,ne=i.pull,Y=(o={"fa-beat":u,"fa-fade":m,"fa-flash":_,"fa-spin":S,"fa-spin-reverse":a,"fa-spin-pulse":k,"fa-pulse":O,"fa-fw":X,"fa-inverse":xe,"fa-border":ce,"fa-li":he,"fa-flip-horizontal":se==="horizontal"||se==="both","fa-flip-vertical":se==="vertical"||se==="both"},Hc(o,"fa-".concat(De),typeof De!="undefined"&&De!==null),Hc(o,"fa-rotate-".concat(Te),typeof Te!="undefined"&&Te!==null&&Te!==0),Hc(o,"fa-pull-".concat(ne),typeof ne!="undefined"&&ne!==null),Hc(o,"fa-swap-opacity",i.swapOpacity),o);return Object.keys(Y).map(function(Q){return Y[Q]?Q:null}).filter(function(Q){return Q})}function MA(i){return i=i-0,i===i}function Q2(i){return MA(i)?i:(i=i.replace(/[\-_\s]+(.)?/g,function(o,u){return u?u.toUpperCase():""}),i.substr(0,1).toLowerCase()+i.substr(1))}var IA=["style"];function AA(i){return i.charAt(0).toUpperCase()+i.slice(1)}function zA(i){return i.split(";").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,u){var m=u.indexOf(":"),_=Q2(u.slice(0,m)),S=u.slice(m+1).trim();return _.startsWith("webkit")?o[AA(_)]=S:o[_]=S,o},{})}function eT(i,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof o=="string")return o;var m=(o.children||[]).map(function(O){return eT(i,O)}),_=Object.keys(o.attributes||{}).reduce(function(O,X){var xe=o.attributes[X];switch(X){case"class":O.attrs.className=xe,delete o.attributes.class;break;case"style":O.attrs.style=zA(xe);break;default:X.indexOf("aria-")===0||X.indexOf("data-")===0?O.attrs[X.toLowerCase()]=xe:O.attrs[Q2(X)]=xe}return O},{attrs:{}}),S=u.style,k=S===void 0?{}:S,a=J2(u,IA);return _.attrs.style=ra(ra({},_.attrs.style),k),i.apply(void 0,[o.tag,ra(ra({},_.attrs),a)].concat(hv(m)))}var tT=!1;try{tT=!0}catch{}function PA(){if(!tT&&console&&typeof console.error=="function"){var i;(i=console).error.apply(i,arguments)}}function rT(i){if(i&&Yf(i)==="object"&&i.prefix&&i.iconName&&i.icon)return i;if(i===null)return null;if(i&&Yf(i)==="object"&&i.prefix&&i.iconName)return i;if(Array.isArray(i)&&i.length===2)return{prefix:i[0],iconName:i[1]};if(typeof i=="string")return{prefix:"fas",iconName:i}}function pv(i,o){return Array.isArray(o)&&o.length>0||!Array.isArray(o)&&o?Hc({},i,o):{}}var DA=["forwardedRef"];function Kf(i){var o=i.forwardedRef,u=J2(i,DA),m=u.icon,_=u.mask,S=u.symbol,k=u.className,a=u.title,O=u.titleId,X=rT(m),xe=pv("classes",[].concat(hv(kA(u)),hv(k.split(" ")))),ce=pv("transform",typeof u.transform=="string"?_A.transform(u.transform):u.transform),he=pv("mask",rT(_)),se=gA(X,ra(ra(ra(ra({},xe),ce),he),{},{symbol:S,title:a,titleId:O}));if(!se)return PA("Could not find icon",X),null;var De=se.abstract,Te={ref:o};return Object.keys(u).forEach(function(ne){Kf.defaultProps.hasOwnProperty(ne)||(Te[ne]=u[ne])}),LA(De[0],Te)}Kf.displayName="FontAwesomeIcon";Kf.propTypes={beat:tr.bool,border:tr.bool,className:tr.string,fade:tr.bool,flash:tr.bool,mask:tr.oneOfType([tr.object,tr.array,tr.string]),fixedWidth:tr.bool,inverse:tr.bool,flip:tr.oneOf(["horizontal","vertical","both"]),icon:tr.oneOfType([tr.object,tr.array,tr.string]),listItem:tr.bool,pull:tr.oneOf(["right","left"]),pulse:tr.bool,rotation:tr.oneOf([0,90,180,270]),size:tr.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:tr.bool,spinPulse:tr.bool,spinReverse:tr.bool,symbol:tr.oneOfType([tr.bool,tr.string]),title:tr.string,transform:tr.oneOfType([tr.string,tr.object]),swapOpacity:tr.bool};Kf.defaultProps={border:!1,className:"",mask:null,fixedWidth:!1,inverse:!1,flip:null,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,symbol:!1,title:"",transform:null,swapOpacity:!1};var LA=eT.bind(null,PE.createElement);export{Kf as F,OA as R,RA as S,GA as a,NA as b,jA as c,ZA as d,FA as e,VA as f,$A as g,UA as h,zI as j,BA as m,Yi as r};
